(self.webpackChunkInvocationlab_ERD_Online=self.webpackChunkInvocationlab_ERD_Online||[]).push([[7918],{52107:function(U,g){var u={UNKNOWN:0,KEYWORD:1,NUMBER:2,STRING:3,FUNCTION:4,VARIABLE:5,PARAMS:6,OPERATOR:7,COMMAS:8,MEMORY:9,COMMENT:99},D=function(d){for(var v=[],m=u.UNKNOWN,f="",_="",h="",O="",l=0;l<d.length;l++){if(_=d.charAt(l),_=="/"&&d.charAt(l+1)=="*"){for(f="",l++;++l<d.length;){if(h=d.charAt(l),O=d.charAt(l+1),h=="*"&&O=="/"){f=f.substr(0,f.length-1),l++;break}f===""?f+=h+O:f+=O}v[v.length]={text:f.replace(/^[\*\s]+/,"").replace(/[\s\*]+$/,""),type:u.COMMENT}}else if(_=="'"||_=='"'||_=="`"){for(f="";l<d.length&&_!=(h=d.charAt(++l));)f+=h=="\\"?d.charAt(++l):h;v[v.length]={text:f,type:_=="`"?u.VARIABLE:u.STRING}}else if(_==":"){for(f=_;l<d.length&&(h=d.charAt(++l),!!/^\w+$/i.test(h));)f+=h;l--,v[v.length]={text:f,type:u.PARAMS}}else if(/^[a-z_]+$/i.test(_)){for(f=_;l<d.length&&(h=d.charAt(++l),!!/^[\w\.:]+$/i.test(h));)f+=h;l--,v[v.length]={text:f,type:h=="("?u.FUNCTION:u.KEYWORD}}else if(_=="-"&&u.VARIABLE!=m||/\d+/.test(_)){for(f=_;l<d.length&&(h=d.charAt(++l),!!/^[\d\.]+$/.test(h));)f+=h;l--,f=="-"?v[v.length]={text:"-",type:u.OPERATOR}:v[v.length]={text:f-0,type:u.NUMBER}}else if(/^[\,;\(\)]+$/.test(_))v[v.length]={text:_,type:u.COMMAS};else if(/^(\+|\-|\*|\/|>|<|=|!)$/.test(_)){for(f=_;l<d.length&&(h=d.charAt(++l),!!/^(\+|\*|\/|>|<|=|!)+$/.test(h));)f+=h;l--,v[v.length]={text:f,type:u.OPERATOR}}m=v.length===0?m:v[v.length-1].type}return v},c=function(d){this.tokens=d instanceof Array?d:D(d.toString()),this.blocks=[];for(var v=0,m={"(":1,")":-1},f=0;f<this.tokens.length;++f){var _=this.tokens[f];_.type==u.COMMAS&&m[_.text]!==void 0?v+=m[_.text]:v||(this.blocks[this.blocks.length]=f)}};c.prototype.getAll=function(){return this.tokens},c.prototype.indexOf=function(T,_){var v=0,m=null;try{var f=new RegExp(T.text,"i")}catch(O){var f=T.text.toLowerCase()}for(var _=_==null?0:_+1,h=0;h<this.blocks.length;++h)if(v=this.blocks[h],!(v<_)&&(m=this.tokens[v],T.type==m.type&&(f instanceof RegExp&&f.test(m.text)||f==m.text.toLowerCase())))return this.blocks[h];return-1},g.vars=function(T,d,v){var m;if(v){var f=new c(d);d=f.getAll()}if(!d[T])return null;switch(d[T].type){case u.OPERATOR:m=[d[T-1],d[T+1]];break;case u.FUNCTION:m=[];for(var _=[],h=0,O=T+1,l=d.length;O<l;O++){var e=d[O];if(e.type!=u.COMMAS){_.push(e);continue}switch(e.text){case"(":h>0&&_.push(e),h++;break;case")":if(--h==0){m.push(_),_=[],O=l;break}else _.push(e);break;case",":h==1?(m.push(_),_=[]):_.push(e);break;default:break}}break;default:m=null;break}return m},g.text=function(T,d){var v=[];for(var m in T){var f=T[m];if(!f||!f.type||f.text==null)v.push(null);else switch(f.type){case u.STRING:v.push("'"+f.text+"'");break;case u.VARIABLE:v.push(f.text);break;default:v.push(f.text);break}d&&v.push(d)}return d&&v.pop(),v},g.types=u,g.create=function(T){return new c(T)}},95430:function(U,g,u){var D=u(52107),c=u(91459),T=u(93363);function d(r){for(var n=[],t=0,a=0,i=0;i<r.length;i++){var s=r[i].text;if(s==="("){t++;continue}if(s===")"){t--;continue}t===0&&/^UNION$/i.test(s)&&r[i].type===D.types.KEYWORD&&(n.push(c.removeParenthese(r.slice(a,i))),a=i+1)}return n.push(c.removeParenthese(r.slice(a))),n}function v(r){for(var n=[],t={},a=0,i=0,s=0;s<r.length;s++){var o=r[s].text,E=r[s].type;if(o==="("){i++;continue}if(o===")"){i--;continue}if(!(i!==0||E!==D.types.KEYWORD)){if(/^SELECT$/i.test(o)){if(t.column!==void 0)continue;n.push({keyword:"column",pos:s}),t.column=!0}else if(/^FROM$/i.test(o)){if(t.source!==void 0)continue;n.push({keyword:"source",pos:s}),t.source=!0}else if(/^(JOIN|INNER|OUTER|LEFT|RIGHT)$/i.test(o)){if(t.joinmap!==void 0)continue;n.push({keyword:"joinmap",pos:s}),t.joinmap=!0}else if(/^WHERE$/i.test(o)){if(t.where!==void 0)continue;n.push({keyword:"where",pos:s}),t.where=!0}else if(/^GROUP$/i.test(o)){if(t.groupby!==void 0)continue;n.push({keyword:"groupby",pos:s}),t.groupby=!0}else if(/^ORDER$/i.test(o)){if(t.orderby!==void 0)continue;n.push({keyword:"orderby",pos:s}),t.orderby=!0}else if(/^LIMIT$/i.test(o)){if(t.limit!==void 0)continue;n.push({keyword:"limit",pos:s}),t.limit=!0}}}for(var P={},s=1;s<n.length;s++)P[n[s-1].keyword]=r.slice(n[s-1].pos,n[s].pos);return P[n[n.length-1].keyword]=r.slice(n[n.length-1].pos),P}function m(r){var n={},t=c.pickUp(r,",");t[0].shift();for(var a=0;a<t.length;a++){var i=t[a],s=null;/^(distinct|all|distinctrow)$/i.test(i[0].text)&&(i[0].text=i[0].text.toUpperCase(),s=i[0],i.shift());var o,E;i[i.length-1].type===D.types.KEYWORD||i[i.length-1].type===D.types.VARIABLE?(E=i[i.length-1].text.indexOf("."))===-1?(o=i[i.length-1].text,i.length===1?n[o]={dist:s,expr:i}:/^as$/i.test(i[i.length-2].text)?n[o]={dist:s,expr:i.slice(0,i.length-2)}:n[o]={dist:s,expr:i.slice(0,i.length-1)}):(o=i[i.length-1].text.substr(E+1),n[o]={dist:s,expr:i}):(o=c.merge(i,""),n[o]={dist:s,expr:i})}return n}g.parseColumn=m;function f(r){var n={},t=c.pickUp(r,",");t[0].shift();for(var a=0;a<t.length;a++){var i=c.parseOneSource(t[a]);n[i.name]={type:i.type,source:i.source}}return n}g.parseSource=f;function _(r){for(var n={},t=c.pickUp(r,"JOIN"),a=void 0,i=0;i<t.length;i++){var s=t[i];if(s.length===1){a=s[0].text.toUpperCase();continue}var o=a===void 0?"INNER JOIN":a+" JOIN",E,P,R;a=/^(LEFT|RIGHT|OUTER|INNER)$/i.test(s[s.length-1].text)?s.pop().text:void 0;for(var y=void 0,b=0;b<s.length;b++)if(/^on$/i.test(s[b].text)){y=b;var I=s.slice(0,b),p=c.parseOneSource(I);R=p.name,E=p.type,P=p.source;break}if(y===void 0)throw new Error("no keyword 'on' in join part");var w=[],A=y+1;s.push({text:"and",type:1});for(var b=A;b<s.length;b++)if(/^and$/i.test(s[b].text)){var S=s.slice(A,b);w.push(c.parseOneWhere(S)),A=b+1}n[R]={type:E,source:P,method:c.JOIN[o.toUpperCase()],where:w}}return n}g.parseJoinmap=_;function h(r){var n=[],t=c.pickUp(r,"and");return t[0].shift(),t.forEach(function(a){n.push(c.parseOneWhere(a))}),n}g.parseWhere=h;function O(r){var n=[],t=c.pickUp(r,",");return t[0].shift(),t[0].shift(),t.forEach(function(a){n.push(a)}),n}g.parseGroupby=O;function l(r){var n=[],t=c.pickUp(r,",");t[0].shift(),t[0].shift();for(var a=0;a<t.length;a++){var i=t[a],s,o=i[i.length-1].text.toUpperCase();/^(ASC|DESC)$/i.test(o)?(s=c.ORDER[o],i.pop()):s=c.ORDER.ASC,i.length!==0&&n.push({type:s,expr:i})}return n}g.parseOrderby=l;function e(r){var n=[],t=c.pickUp(r,",");t[0].shift();for(var a=0;a<t.length;a++){var i=t[a];if(i.length>=2)throw new Error("something wrong in 'limit' part");n.push(i[0])}return n.length===1&&n.unshift({text:0,type:2}),n}g.parseLimit=e,g.createObj=function(r){for(var n=[],t=D.create(r).getAll(),a=d(t),i=0;i<a.length;i++){var s={},o=v(a[i]),E=c.getHint(o.column,1);E&&(s.hint=E),o.column&&(s.column=m(o.column)),o.source&&(s.source=f(o.source)),o.joinmap&&(s.joinmap=_(o.joinmap)),o.where&&(s.where=h(o.where)),o.groupby&&(s.groupby=O(o.groupby)),o.orderby&&(s.orderby=l(o.orderby)),o.limit&&(s.limit=e(o.limit)),n.push(s)}return n}},91459:function(U,g,u){var D=u(52107),c={"=":1,">":2,">=":3,"<":4,"<=":5,"<>":6,"!=":6,in:7,"not in":8,like:9,"not like":10,between:11,"is null":20,"not null":21};g.RELATE=c;var T={ASC:1,DESC:2};g.ORDER=T;var d={"INNER JOIN":1,"OUTER JOIN":2,"LEFT JOIN":3,"RIGHT JOIN":4};g.JOIN=d;function v(e){if(e[0]===void 0||e[0].text!=="(")return e;for(var r=0,n=0;n<e.length;n++)e[n].text==="("&&r++,e[n].text===")"&&r--;if(r===0&&e[e.length-1].text===")")return e.pop(),e.shift(),v(e);throw new Error("lack parenthese")}g.removeParenthese=v;function m(e,r){r=r===void 0?" ":r;for(var n="",t=0;t<e.length;t++)n+=e[t].text+r;return n.substr(0,n.length-r.length)}g.merge=m;function f(e,r){e.push({text:r});for(var n=[],t=0,a=0,i=0;i<e.length;i++)if(e[i].text==="("&&a++,e[i].text===")"&&a--,new RegExp("^"+r+"$","i").test(e[i].text)&&a===0){var s=e.slice(t,i);if(s.length===0){t=i+1;continue}n.push(s),t=i+1}return n}g.pickUp=f;function _(e,r){var n=void 0;if(e&&e[r]&&e[r].type===D.types.COMMENT){n=e[r];for(var t=e.slice(0,r),a=0;a<=r;a++)e.shift();for(;t.length>0;)e.unshift(t.pop())}return n}g.getHint=_;function h(e){var r,n,t,a,i=e[0].text.indexOf(".");if(n=e[0].text.substr(0,i),i===-1)if(e[0].text==="("){for(var s=1,o=1;o<e.length;o++)if(e[o].text==="("&&s++,e[o].text===")"&&s--,s===0){t=m(e.slice(1,o)," "),e=e.slice(o+1,e.length);break}}else t=e[0].text,e.shift();else if(i===e[0].text.length-1){if(e[1].text!=="(")throw new Error("something wrong in 'source' part");var s=0,o;for(o=1;o<e.length;o++)if(e[o].text==="("&&s++,e[o].text===")"&&s--,s===0){t=m(e.slice(2,o)," "),e=e.slice(o+1,e.length);break}if(o===e.length)throw new Error("lack parentheses in 'source' part")}else t=e[0].text.substr(i+1),e.shift();if(e.length===0)a={name:t,type:n,source:t};else{if(e.length>=3||e.length===2&&!/^as$/i.test(e[0].text)||e[e.length-1].type!==D.types.KEYWORD&&e[e.length-1].type!==D.types.VARIABLE)throw new Error("something wrong in 'source' part");a={name:e[e.length-1].text,type:n,source:t}}return a}g.parseOneSource=h;function O(e){var r={},n=e[1];if(r.column=e[0],!n)return r;if(n.type===D.types.OPERATOR){if(c[n.text]===void 0)throw new Error("unrecognized operator");r.relate=c[n.text],r.values=l(e.slice(2),",")}else if(n.text.toLowerCase()==="between")r.relate=c[n.text.toLowerCase()],r.values=l(e.slice(3,e.length-1),"and");else if(n.text.toLowerCase()==="in")r.relate=c[n.text.toLowerCase()],r.values=l(e.slice(3,e.length-1),",");else if(n.text.toLowerCase()==="like")r.relate=c[n.text.toLowerCase()],r.values=[[e[2]]];else if(n.text.toLowerCase()==="is")if(e[2].text.toLowerCase()==="not")r.relate=c["not null"],r.values=null;else if(e[2].text.toLowerCase()==="null")r.relate=c["is null"],r.values=null;else throw new Error('wrong key word after "is"');else if(n.text.toLowerCase()==="not")if(e[2].text.toLowerCase()==="in")r.relate=c["not in"],r.values=l(e.slice(4,e.length-1),",");else if(e[2].text.toLowerCase()==="like")r.relate=c["not like"],r.values=[[e[3]]];else throw new Error('wrong key word after "not"');else throw new Error("unrecognized relate");return r}g.parseOneWhere=O;function l(e,r){r=new RegExp(r,"i");var n=[],t=0,a=[];for(var i in e)r.test(e[i].text)?(n.push(a),a=[]):a.push(e[i]);return a.length!==0&&n.push(a),n}},33293:function(U,g,u){var D=u(91459),c=u(52107),T={select:u(95430)};g.parse=function(d){d=d.trim();var v=d.substr(0,d.indexOf(" ")).toLowerCase();if(T[v]===void 0)throw new Error("Unsupport sentence");return T[v].createObj(d)},g.RELATE=D.RELATE,g.JOIN=D.JOIN,g.ORDER=D.ORDER,g.types=c.types},46298:function(U,g,u){"use strict";u.d(g,{Z:function(){return R}});var D=u(9083),c=u.n(D),T=u(2927),d=u.n(T),v=u(98404),m=u(44761),f=u(86957),_=u(47470),h=u(44925),O=u(4185),l=u(12895),e=u(5891),r=u(42278),n=u(50205),t=u(8236),a=u(58168),i=u(33293),s=u(36422),o=new Map,E=new Map,P=function(b){var I=b.selectDB,p=b.mode,w=b.height,A=b.width,S=b.name,B=b.placeholder,G=b.value,Z=b.theme,Q=b.onChange,V=b.tables,$=(0,v.useRef)(null),F=function(){var W=V||[];E.set(I,{});var C=W.map(function(x){var L={name:x.title,value:x.title,meta:x.chnname};return E.get(I)[x.title]=x.fields.map(function(M){return{name:M.name,value:M.name,meta:"".concat(M.chnname,"(").concat(x.title,")"),remarks:M.chnname,dataType:M.dataType,notNull:M.notNull,autoIncrement:M.autoIncrement,defaultValue:M.defaultValue,pk:M.pk}}),L});o.set(I,C)},H=function(W){var C=[];try{var x=i.parse(W),L=Object.entries(x[0].source);x[0].joinmap&&L.push.apply(L,d()(Object.entries(x[0].joinmap))),L.forEach(function(M){var j=c()(M,2),K=j[0],Y=j[1],z=Y.source,J=E.get(I)[z];J&&C.push.apply(C,d()(J)),K!==z&&C.push({name:K,value:K,meta:z})})}catch(M){}return C};return(0,v.useImperativeHandle)(b.onRef,function(){return{selectLine:function(){return $.current.editor.selection.selectLine()},getEditor:function(){return $.current.editor},getSelectValue:function(){return $.current.editor.getSelectedText()},setSelectValue:function(W){return $.current.editor.insert(W)},getDbTableFieldsMap:function(W){var C={},x=E.get(I)[W];if(!x)return C;for(var L=0;L<x.length;L++){var M=x[L];C[M.name]=M}return C}}}),o.get(I)||F(),(0,v.useEffect)(function(){(0,n.addCompleter)({getCompletions:function(W,C,x,L,M){var j=C.getTextRange({start:{row:x.row,column:0},end:{row:x.row,column:2e3}}).toLowerCase(),K=[];if(j.includes("select")&&j.includes("from")){K=H(j),M(null,o.get(I).concat(K));return}j=C.getTextRange({start:{row:0,column:0},end:{row:100,column:2e3}}),j=j.replace(/[\r\n]/g," ").replace(/\s{2,}/g," "),K=H(j),M(null,o.get(I).concat(K))}})},[]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(m.ZP,{ref:$,width:A||"100%",height:w||"250px",mode:p||"sql",theme:Z||"xcode",placeholder:B||"",onChange:Q,name:S||"ace-editor",value:G,editorProps:{$blockScrolling:!0},fontSize:"14px",showGutter:!0,highlightActiveLine:!0,showPrintMargin:!1,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,wrap:!1}})})},R=v.memo(P)},90338:function(U,g,u){"use strict";u.d(g,{I:function(){return T}});var D=u(98404),c=u(36422),T=function(v){var m=v.prefixCount,f=m===void 0?10:m,_=v.suffixCount,h=_===void 0?4:_,O=v.children,l=v.title,e=v.style,r=O.length;if(r<=f)return(0,c.jsx)("span",{title:l,style:e,children:O});var n=r-f;if(n<=3)return(0,c.jsx)("span",{title:l,style:e,children:O});n<h&&(h=n);var t=O.slice(0,f).trim(),a=O.slice(-h).trim();return(0,c.jsxs)("span",{title:l,style:e,children:[t,"...",a]})}},49573:function(U,g,u){"use strict";u.d(g,{$5:function(){return r},Hk:function(){return i},K:function(){return n},Ow:function(){return t},gs:function(){return e},wx:function(){return a}});var D=u(2927),c=u.n(D),T=u(39346),d=u.n(T),v=u(42525),m=u.n(v),f=u(23759),_=u(23041),h=u.n(_),O=u(36422),l=["onResize","width"],e=function(o){var E=document.createElement("textarea");E.style.position="absolute",E.style.left="-9999px",E.style.top="-9999px",document.body.appendChild(E),E.value=o,E.select(),document.execCommand("copy"),document.body.removeChild(E),f.ZP.success("\u590D\u5236\u6210\u529F")},r=function(o,E){var P="";return o!=="key"?E!=null&&E.pk?P="*"+o+"(\u4E3B\u952E)":E!=null&&E.notNull?P="*"+o:P=o:P=o+"(\u865A\u62DF\u5217\u8BF7\u52FF\u4FEE\u6539)",P},n=function(o){var E="";return o&&(o.pk?E="".concat(o.remarks," --- ")+(o.autoIncrement?"(\u81EA\u589E)":"(\u975E\u81EA\u589E)")+"("+o.dataType+")":E="".concat(o.remarks)+" --- ("+o.dataType+")"+(o.defaultValue?"(\u9ED8\u8BA4\u503C:".concat(o.defaultValue,")"):"")),E},t=function(o,E,P){var R,y=E[o];return y?R={name:y.name,value:y.name,remarks:y.remarks,dataType:y.typeName,notNull:y.isNullable==="NO",autoIncrement:y.isAutoincrement==="YES",defaultValue:y.def,pk:y.primaryKey}:R=P[o],R},a={header:{cell:function(o){var E=o.onResize,P=o.width,R=m()(o,l);return P===void 0?(0,O.jsx)("th",d()({},R)):(0,O.jsx)(_.Resizable,{width:P,height:0,onResize:E,children:(0,O.jsx)("th",d()({},R))})}}},i=function(o,E,P){var R={width:o.width,onResize:function(b,I){var p=I.size;P(function(w){var A=c()(w);return A[E]=d()(d()({},A[E]),{},{width:p.width}),A})}};return R}},34973:function(U,g,u){"use strict";u.d(g,{D7:function(){return O},HT:function(){return s},UC:function(){return E},a4:function(){return a},dm:function(){return n},fU:function(){return e}});var D=u(43953),c=u.n(D),T=u(39346),d=u.n(T),v=u(91184),m=u.n(v),f=u(68413);function _(R,y,b){return h.apply(this,arguments)}function h(){return h=_asyncToGenerator(_regeneratorRuntime().mark(function R(y,b,I){var p,w;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return I||(I={}),p=JSON.stringify(I)==="{}",w=[],p||Object.keys(I).map(function(B,G){var Z=I[B];Z==="ascend"&&w.push({column:B,asc:!0}),Z==="descend"&&w.push({column:B,asc:!1})}),S.abrupt("return",request(y,{method:"GET",params:_objectSpread({size:b.pageSize,orders:w},b)}));case 5:case"end":return S.stop()}},R)})),h.apply(this,arguments)}function O(R,y){return l.apply(this,arguments)}function l(){return l=m()(c()().mark(function R(y,b){return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,f.ZP)(y,{method:"POST",data:d()({},b)}));case 1:case"end":return p.stop()}},R)})),l.apply(this,arguments)}function e(R,y){return r.apply(this,arguments)}function r(){return r=m()(c()().mark(function R(y,b){return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,f.ZP)(y,{method:"DELETE",data:d()({},b)}));case 1:case"end":return p.stop()}},R)})),r.apply(this,arguments)}function n(R,y){return t.apply(this,arguments)}function t(){return t=m()(c()().mark(function R(y,b){return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,f.ZP)(y,{method:"PUT",data:d()({},b)}));case 1:case"end":return p.stop()}},R)})),t.apply(this,arguments)}function a(R,y){return i.apply(this,arguments)}function i(){return i=m()(c()().mark(function R(y,b){return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,f.ZP)(y,{method:"POST",data:d()({},b)}));case 1:case"end":return p.stop()}},R)})),i.apply(this,arguments)}function s(R,y){return o.apply(this,arguments)}function o(){return o=m()(c()().mark(function R(y,b){return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,f.ZP)(y,{method:"GET",params:d()({},b)}));case 1:case"end":return p.stop()}},R)})),o.apply(this,arguments)}function E(R,y){return P.apply(this,arguments)}function P(){return P=m()(c()().mark(function R(y,b){return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,f.ZP)(y,{method:"GET",params:d()({},b)}));case 1:case"end":return p.stop()}},R)})),P.apply(this,arguments)}},85448:function(U,g,u){"use strict";var D=u(31777),c=u(34973),T=u(7599),d=u(29612),v=u(55074),m=u(44766),f=u.n(m),_=u(56918),h=u(23759),O=u(68413),l=(0,D.Z)(function(e,r){return{querySearchKey:"",treeData:[],dispatch:{queryHistory:function(t){return(0,c.HT)("/ncnb/queryHistory",t)},explain:function(t){return(0,c.a4)("/ncnb/queryInfo/explain",t)},exec:function(t){return(0,c.a4)("/ncnb/queryInfo/exec",t)},getTableRecordTotal:function(t){return(0,c.a4)("/ncnb/queryInfo/getTableRecordTotal",t)},exportSql:function(t,a){(0,O.Ht)(t,a,"/ncnb/queryInfo/exportSql")},updateSqlInfo:function(t){(0,c.dm)("/ncnb/queryInfo/"+t.id,t).then(function(a){if((a==null?void 0:a.code)===200){h.ZP.success(a==null?void 0:a.msg);return}})},renameQuery:function(t){(0,c.dm)("/ncnb/queryInfo/"+t.id,t).then(function(a){(a==null?void 0:a.code)===200&&(h.ZP.success("\u4FEE\u6539\u6210\u529F"),r().dispatch.fetchTreeData({projectId:t.projectId}))})},removeQuery:function(t){var a=d.rV(v.s.PROJECT_ID)||"";(0,c.fU)("/ncnb/queryInfo/"+a+"/"+t.id,{}).then(function(i){(i==null?void 0:i.code)===200&&(h.ZP.success("\u5220\u9664\u6210\u529F"),r().dispatch.fetchTreeData({projectId:a}))})},addQuery:function(t){(0,c.D7)("/ncnb/queryInfo",t).then(function(a){(a==null?void 0:a.code)===200&&(h.ZP.success("\u65B0\u589E\u6210\u529F"),r().dispatch.fetchTreeData({projectId:t.projectId}))})},fetchQueryInfo:function(t){return(0,c.HT)("/ncnb/queryInfo/"+t,{})},fetchTreeData:function(t){var a=r().querySearchKey;return a&&f().set(t,"title",a),new Promise(function(i,s){(0,c.UC)("/ncnb/queryInfo/tree",t).then(function(o){(o==null?void 0:o.code)===200?(e({treeData:(o==null?void 0:o.data)||[]}),i((o==null?void 0:o.data)||[])):s(o==null?void 0:o.code)})})},setQuerySearchKey:function(t){return e((0,T.ZP)(function(a){a.querySearchKey=t}))},onSelectNode:function(t,a){return e((0,T.ZP)(function(i){var s=_.ZP.getState().dispatch;a.node.isLeaf&&s.addTab({group:_.v0.QUERY,module:a.node.key+"",entity:a.node.title+""})}))}}}});g.Z=l},56918:function(U,g,u){"use strict";u.d(g,{v0:function(){return d}});var D=u(31777),c=u(7599),T=u(1993),d=function(_){return _[_.MODEL=0]="MODEL",_[_.QUERY=1]="QUERY",_}({}),v="",m="ERD-ONLINE-SQL-QUERY",f=(0,D.Z)(function(_,h){return{selectTabId:v,tableTabs:[],dispatch:{addTab:function(l){return _((0,c.ZP)(function(e){e.tableTabs.find(function(r){return(r==null?void 0:r.entity)===l.entity&&(r==null?void 0:r.module)===l.module})||e.tableTabs.push(l),e.selectTabId="".concat(l.module,"###").concat(l.entity)}))},activeTab:function(l){return _((0,c.ZP)(function(e){if(e.selectTabId="".concat(l.module,"###").concat(l.entity),l.group===d.MODEL){var r=T.ZP.getState().dispatch;r.setCurrentModule(l.module),r.setCurrentEntity(l.entity)}}))},removeTab:function(l){return _((0,c.ZP)(function(e){var r=e.tableTabs.findIndex(function(a){return(a==null?void 0:a.entity)===l.entity&&(a==null?void 0:a.module)===(l==null?void 0:l.module)});if(r>-1&&(e.tableTabs=e.tableTabs.filter(function(a,i){return i!==r}),h().selectTabId==="".concat(l==null?void 0:l.module,"###").concat(l==null?void 0:l.entity))){if(r===0)e.selectTabId=v;else if(r>0){var n=e.tableTabs[r-1];if(e.selectTabId="".concat(n==null?void 0:n.module,"###").concat(n==null?void 0:n.entity),l.group===d.MODEL){var t=T.ZP.getState().dispatch;t.setCurrentModule(n.module),t.setCurrentEntity(n.entity)}}}}))},removeLeftTab:function(l){return _((0,c.ZP)(function(e){var r=e.tableTabs.findIndex(function(n){return(n==null?void 0:n.entity)===l.entity&&(n==null?void 0:n.module)===(l==null?void 0:l.module)});r>-1&&(e.tableTabs=e.tableTabs.filter(function(n,t){return t>=r})),e.selectTabId="".concat(l.module,"###").concat(l.entity)}))},removeRightTab:function(l){return _((0,c.ZP)(function(e){var r=e.tableTabs.findIndex(function(n){return(n==null?void 0:n.entity)===l.entity&&(n==null?void 0:n.module)===(l==null?void 0:l.module)});r>-1&&(e.tableTabs=e.tableTabs.filter(function(n,t){return t<=r})),e.selectTabId="".concat(l.module,"###").concat(l.entity)}))},removeAllTab:function(l){return _((0,c.ZP)(function(e){e.tableTabs=[],e.selectTabId=v}))},containTab:function(l){return!!h().tableTabs.find(function(e){return e.entity===l})}}}});g.ZP=f}}]);
