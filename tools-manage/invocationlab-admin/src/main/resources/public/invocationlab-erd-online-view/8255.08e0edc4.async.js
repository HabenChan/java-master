!(function(){var Io=Object.defineProperty,Do=Object.defineProperties;var So=Object.getOwnPropertyDescriptors;var dn=Object.getOwnPropertySymbols;var Fo=Object.prototype.hasOwnProperty,Oo=Object.prototype.propertyIsEnumerable;var fn=(n,s,d)=>s in n?Io(n,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):n[s]=d,Qt=(n,s)=>{for(var d in s||(s={}))Fo.call(s,d)&&fn(n,d,s[d]);if(dn)for(var d of dn(s))Oo.call(s,d)&&fn(n,d,s[d]);return n},pn=(n,s)=>Do(n,So(s));(self.webpackChunkInvocationlab_ERD_Online=self.webpackChunkInvocationlab_ERD_Online||[]).push([[8255],{51947:function(){"use strict"},53643:function(){"use strict"},9368:function(){"use strict"},62171:function(module,__unused_webpack_exports,__webpack_require__){if(!jSuites)var jSuites=__webpack_require__(89126);(function(n,s){module.exports=s()})(self,function(){return function(){var __webpack_modules__={243:function(n){var s;n.exports=(function(){var d={765:function(Y,c){var a;a=function(j){j.version="1.0.2";var R=Math;function P(ve,ie){for(var Ye=0,Ge=0;Ye<ve.length;++Ye)Ge=ie*Ge+ve[Ye];return Ge}function g(ve,ie,Ye,Ge,Ue){if(ie===0)return Ye;if(ie===1)return Ge;for(var Be=2/ve,lt=Ge,U=1;U<ie;++U)lt=Ge*U*Be+Ue*Ye,Ye=Ge,Ge=lt;return lt}function u(ve,ie,Ye,Ge,Ue){return function(Be,lt){if(Ge){if(Be===0)return Ge==1?-1/0:1/0;if(Be<0)return NaN}return lt===0?ve(Be):lt===1?ie(Be):lt<0?NaN:g(Be,lt|=0,ve(Be),ie(Be),Ue)}}var m,b,h,w,T,N,V,H,M,F,J,q,ae,ge=function(){var ve=.636619772,ie=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Ye=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),Ge=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Ue=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function Be(De){var Oe=0,Pe=0,Ke=0,Je=De*De;if(De<8)Oe=(Pe=P(ie,Je))/(Ke=P(Ye,Je));else{var ut=De-.785398164;Pe=P(Ge,Je=64/Je),Ke=P(Ue,Je),Oe=R.sqrt(ve/De)*(R.cos(ut)*Pe-R.sin(ut)*Ke*8/De)}return Oe}var lt=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),U=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Me=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),ze=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function Se(De){var Oe=0,Pe=0,Ke=0,Je=De*De,ut=R.abs(De)-2.356194491;return Math.abs(De)<8?Oe=(Pe=De*P(lt,Je))/(Ke=P(U,Je)):(Pe=P(Me,Je=64/Je),Ke=P(ze,Je),Oe=R.sqrt(ve/R.abs(De))*(R.cos(ut)*Pe-R.sin(ut)*Ke*8/R.abs(De)),De<0&&(Oe=-Oe)),Oe}return function De(Oe,Pe){if(Pe=Math.round(Pe),!isFinite(Oe))return isNaN(Oe)?Oe:0;if(Pe<0)return(Pe%2?-1:1)*De(Oe,-Pe);if(Oe<0)return(Pe%2?-1:1)*De(-Oe,Pe);if(Pe===0)return Be(Oe);if(Pe===1)return Se(Oe);if(Oe===0)return 0;var Ke=0;if(Oe>Pe)Ke=g(Oe,Pe,Be(Oe),Se(Oe),-1);else{for(var Je=!1,ut=0,ft=0,ct=1,ht=0,vt=2/Oe,mt=2*R.floor((Pe+R.floor(R.sqrt(40*Pe)))/2);mt>0;mt--)ht=mt*vt*ct-ut,ut=ct,ct=ht,R.abs(ct)>1e10&&(ct*=1e-10,ut*=1e-10,Ke*=1e-10,ft*=1e-10),Je&&(ft+=ct),Je=!Je,mt==Pe&&(Ke=ut);Ke/=ft=2*ft-ct}return Ke}}(),se=(m=.636619772,b=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),h=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),w=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),T=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),N=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),V=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),H=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),M=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),u(function(ve){var ie=0,Ye=0,Ge=0,Ue=ve*ve,Be=ve-.785398164;return ve<8?ie=(Ye=P(b,Ue))/(Ge=P(h,Ue))+m*ge(ve,0)*R.log(ve):(Ye=P(w,Ue=64/Ue),Ge=P(T,Ue),ie=R.sqrt(m/ve)*(R.sin(Be)*Ye+R.cos(Be)*Ge*8/ve)),ie},function(ve){var ie=0,Ye=0,Ge=0,Ue=ve*ve,Be=ve-2.356194491;return ve<8?ie=(Ye=ve*P(N,Ue))/(Ge=P(V,Ue))+m*(ge(ve,1)*R.log(ve)-1/ve):(Ye=P(H,Ue=64/Ue),Ge=P(M,Ue),ie=R.sqrt(m/ve)*(R.sin(Be)*Ye+R.cos(Be)*Ge*8/ve)),ie},0,1,-1)),xe=(F=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),J=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),q=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),ae=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function ve(ie,Ye){if((Ye=Math.round(Ye))===0)return function(ze){return ze<=3.75?P(F,ze*ze/14.0625):R.exp(R.abs(ze))/R.sqrt(R.abs(ze))*P(J,3.75/R.abs(ze))}(ie);if(Ye===1)return function(ze){return ze<3.75?ze*P(q,ze*ze/14.0625):(ze<0?-1:1)*R.exp(R.abs(ze))/R.sqrt(R.abs(ze))*P(ae,3.75/R.abs(ze))}(ie);if(Ye<0)return NaN;if(R.abs(ie)===0)return 0;if(ie==1/0)return 1/0;var Ge,Ue=0,Be=2/R.abs(ie),lt=0,U=1,Me=0;for(Ge=2*R.round((Ye+R.round(R.sqrt(40*Ye)))/2);Ge>0;Ge--)Me=Ge*Be*U+lt,lt=U,U=Me,R.abs(U)>1e10&&(U*=1e-10,lt*=1e-10,Ue*=1e-10),Ge==Ye&&(Ue=lt);return Ue*=ve(ie,0)/U,ie<0&&Ye%2?-Ue:Ue}),Le=function(){var ve=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),ie=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Ye=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),Ge=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return u(function(Ue){return Ue<=2?-R.log(Ue/2)*xe(Ue,0)+P(ve,Ue*Ue/4):R.exp(-Ue)/R.sqrt(Ue)*P(ie,2/Ue)},function(Ue){return Ue<=2?R.log(Ue/2)*xe(Ue,1)+1/Ue*P(Ye,Ue*Ue/4):R.exp(-Ue)/R.sqrt(Ue)*P(Ge,2/Ue)},0,2,1)}();j.besselj=ge,j.bessely=se,j.besseli=xe,j.besselk=Le},a(typeof DO_NOT_EXPORT_BESSEL=="undefined"?c:{})},162:function(Y){var c;Y.exports=(c=function(a,j){var R=Array.prototype.concat,P=Array.prototype.slice,g=Object.prototype.toString;function u(M,F){var J=M>F?M:F;return a.pow(10,17-~~(a.log(J>0?J:-J)*a.LOG10E))}var m=Array.isArray||function(M){return g.call(M)==="[object Array]"};function b(M){return g.call(M)==="[object Function]"}function h(M){return typeof M=="number"&&M-M==0}function w(){return new w._init(arguments)}function T(){return 0}function N(){return 1}function V(M,F){return M===F?1:0}w.fn=w.prototype,w._init=function(M){if(m(M[0]))if(m(M[0][0])){b(M[1])&&(M[0]=w.map(M[0],M[1]));for(var F=0;F<M[0].length;F++)this[F]=M[0][F];this.length=M[0].length}else this[0]=b(M[1])?w.map(M[0],M[1]):M[0],this.length=1;else if(h(M[0]))this[0]=w.seq.apply(null,M),this.length=1;else{if(M[0]instanceof w)return w(M[0].toArray());this[0]=[],this.length=1}return this},w._init.prototype=w.prototype,w._init.constructor=w,w.utils={calcRdx:u,isArray:m,isFunction:b,isNumber:h,toVector:function(M){return R.apply([],M)}},w._random_fn=a.random,w.setRandom=function(M){if(typeof M!="function")throw new TypeError("fn is not a function");w._random_fn=M},w.extend=function(M){var F,J;if(arguments.length===1){for(J in M)w[J]=M[J];return this}for(F=1;F<arguments.length;F++)for(J in arguments[F])M[J]=arguments[F][J];return M},w.rows=function(M){return M.length||1},w.cols=function(M){return M[0].length||1},w.dimensions=function(M){return{rows:w.rows(M),cols:w.cols(M)}},w.row=function(M,F){return m(F)?F.map(function(J){return w.row(M,J)}):M[F]},w.rowa=function(M,F){return w.row(M,F)},w.col=function(M,F){if(m(F)){var J=w.arange(M.length).map(function(){return new Array(F.length)});return F.forEach(function(ge,se){w.arange(M.length).forEach(function(xe){J[xe][se]=M[xe][ge]})}),J}for(var q=new Array(M.length),ae=0;ae<M.length;ae++)q[ae]=[M[ae][F]];return q},w.cola=function(M,F){return w.col(M,F).map(function(J){return J[0]})},w.diag=function(M){for(var F=w.rows(M),J=new Array(F),q=0;q<F;q++)J[q]=[M[q][q]];return J},w.antidiag=function(M){for(var F=w.rows(M)-1,J=new Array(F),q=0;F>=0;F--,q++)J[q]=[M[q][F]];return J},w.transpose=function(M){var F,J,q,ae,ge,se=[];for(m(M[0])||(M=[M]),J=M.length,q=M[0].length,ge=0;ge<q;ge++){for(F=new Array(J),ae=0;ae<J;ae++)F[ae]=M[ae][ge];se.push(F)}return se.length===1?se[0]:se},w.map=function(M,F,J){var q,ae,ge,se,xe;for(m(M[0])||(M=[M]),ae=M.length,ge=M[0].length,se=J?M:new Array(ae),q=0;q<ae;q++)for(se[q]||(se[q]=new Array(ge)),xe=0;xe<ge;xe++)se[q][xe]=F(M[q][xe],q,xe);return se.length===1?se[0]:se},w.cumreduce=function(M,F,J){var q,ae,ge,se,xe;for(m(M[0])||(M=[M]),ae=M.length,ge=M[0].length,se=J?M:new Array(ae),q=0;q<ae;q++)for(se[q]||(se[q]=new Array(ge)),ge>0&&(se[q][0]=M[q][0]),xe=1;xe<ge;xe++)se[q][xe]=F(se[q][xe-1],M[q][xe]);return se.length===1?se[0]:se},w.alter=function(M,F){return w.map(M,F,!0)},w.create=function(M,F,J){var q,ae,ge=new Array(M);for(b(F)&&(J=F,F=M),q=0;q<M;q++)for(ge[q]=new Array(F),ae=0;ae<F;ae++)ge[q][ae]=J(q,ae);return ge},w.zeros=function(M,F){return h(F)||(F=M),w.create(M,F,T)},w.ones=function(M,F){return h(F)||(F=M),w.create(M,F,N)},w.rand=function(M,F){return h(F)||(F=M),w.create(M,F,w._random_fn)},w.identity=function(M,F){return h(F)||(F=M),w.create(M,F,V)},w.symmetric=function(M){var F,J,q=M.length;if(M.length!==M[0].length)return!1;for(F=0;F<q;F++)for(J=0;J<q;J++)if(M[J][F]!==M[F][J])return!1;return!0},w.clear=function(M){return w.alter(M,T)},w.seq=function(M,F,J,q){b(q)||(q=!1);var ae,ge=[],se=u(M,F),xe=(F*se-M*se)/((J-1)*se),Le=M;for(ae=0;Le<=F&&ae<J;Le=(M*se+xe*se*++ae)/se)ge.push(q?q(Le,ae):Le);return ge},w.arange=function(M,F,J){var q,ae=[];if(J=J||1,F===j&&(F=M,M=0),M===F||J===0)return[];if(M<F&&J<0)return[];if(M>F&&J>0)return[];if(J>0)for(q=M;q<F;q+=J)ae.push(q);else for(q=M;q>F;q+=J)ae.push(q);return ae},w.slice=function(){function M(F,J,q,ae){var ge,se=[],xe=F.length;if(J===j&&q===j&&ae===j)return w.copy(F);if(ae=ae||1,(J=(J=J||0)>=0?J:xe+J)===(q=(q=q||F.length)>=0?q:xe+q)||ae===0)return[];if(J<q&&ae<0)return[];if(J>q&&ae>0)return[];if(ae>0)for(ge=J;ge<q;ge+=ae)se.push(F[ge]);else for(ge=J;ge>q;ge+=ae)se.push(F[ge]);return se}return function(F,J){var q,ae;return h((J=J||{}).row)?h(J.col)?F[J.row][J.col]:M(w.rowa(F,J.row),(q=J.col||{}).start,q.end,q.step):h(J.col)?M(w.cola(F,J.col),(ae=J.row||{}).start,ae.end,ae.step):(ae=J.row||{},q=J.col||{},M(F,ae.start,ae.end,ae.step).map(function(ge){return M(ge,q.start,q.end,q.step)}))}}(),w.sliceAssign=function(M,F,J){var q,ae;if(h(F.row)){if(h(F.col))return M[F.row][F.col]=J;F.col=F.col||{},F.col.start=F.col.start||0,F.col.end=F.col.end||M[0].length,F.col.step=F.col.step||1,q=w.arange(F.col.start,a.min(M.length,F.col.end),F.col.step);var ge=F.row;return q.forEach(function(xe,Le){M[ge][xe]=J[Le]}),M}if(h(F.col)){F.row=F.row||{},F.row.start=F.row.start||0,F.row.end=F.row.end||M.length,F.row.step=F.row.step||1,ae=w.arange(F.row.start,a.min(M[0].length,F.row.end),F.row.step);var se=F.col;return ae.forEach(function(xe,Le){M[xe][se]=J[Le]}),M}return J[0].length===j&&(J=[J]),F.row.start=F.row.start||0,F.row.end=F.row.end||M.length,F.row.step=F.row.step||1,F.col.start=F.col.start||0,F.col.end=F.col.end||M[0].length,F.col.step=F.col.step||1,ae=w.arange(F.row.start,a.min(M.length,F.row.end),F.row.step),q=w.arange(F.col.start,a.min(M[0].length,F.col.end),F.col.step),ae.forEach(function(xe,Le){q.forEach(function(ve,ie){M[xe][ve]=J[Le][ie]})}),M},w.diagonal=function(M){var F=w.zeros(M.length,M.length);return M.forEach(function(J,q){F[q][q]=J}),F},w.copy=function(M){return M.map(function(F){return h(F)?F:F.map(function(J){return J})})};var H=w.prototype;return H.length=0,H.push=Array.prototype.push,H.sort=Array.prototype.sort,H.splice=Array.prototype.splice,H.slice=Array.prototype.slice,H.toArray=function(){return this.length>1?P.call(this):P.call(this)[0]},H.map=function(M,F){return w(w.map(this,M,F))},H.cumreduce=function(M,F){return w(w.cumreduce(this,M,F))},H.alter=function(M){return w.alter(this,M),this},function(M){for(var F=0;F<M.length;F++)(function(J){H[J]=function(q){var ae,ge=this;return q?(setTimeout(function(){q.call(ge,H[J].call(ge))}),this):(ae=w[J](this),m(ae)?w(ae):ae)}})(M[F])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(M){for(var F=0;F<M.length;F++)(function(J){H[J]=function(q,ae){var ge=this;return ae?(setTimeout(function(){ae.call(ge,H[J].call(ge,q))}),this):w(w[J](this,q))}})(M[F])}("row col".split(" ")),function(M){for(var F=0;F<M.length;F++)(function(J){H[J]=function(){return w(w[J].apply(null,arguments))}})(M[F])}("create zeros ones rand identity".split(" ")),w}(Math),function(a,j){var R=a.utils.isFunction;function P(m,b){return m-b}function g(m,b,h){return j.max(b,j.min(m,h))}a.sum=function(m){for(var b=0,h=m.length;--h>=0;)b+=m[h];return b},a.sumsqrd=function(m){for(var b=0,h=m.length;--h>=0;)b+=m[h]*m[h];return b},a.sumsqerr=function(m){for(var b,h=a.mean(m),w=0,T=m.length;--T>=0;)w+=(b=m[T]-h)*b;return w},a.sumrow=function(m){for(var b=0,h=m.length;--h>=0;)b+=m[h];return b},a.product=function(m){for(var b=1,h=m.length;--h>=0;)b*=m[h];return b},a.min=function(m){for(var b=m[0],h=0;++h<m.length;)m[h]<b&&(b=m[h]);return b},a.max=function(m){for(var b=m[0],h=0;++h<m.length;)m[h]>b&&(b=m[h]);return b},a.unique=function(m){for(var b={},h=[],w=0;w<m.length;w++)b[m[w]]||(b[m[w]]=!0,h.push(m[w]));return h},a.mean=function(m){return a.sum(m)/m.length},a.meansqerr=function(m){return a.sumsqerr(m)/m.length},a.geomean=function(m){var b=m.map(j.log),h=a.mean(b);return j.exp(h)},a.median=function(m){var b=m.length,h=m.slice().sort(P);return 1&b?h[b/2|0]:(h[b/2-1]+h[b/2])/2},a.cumsum=function(m){return a.cumreduce(m,function(b,h){return b+h})},a.cumprod=function(m){return a.cumreduce(m,function(b,h){return b*h})},a.diff=function(m){var b,h=[],w=m.length;for(b=1;b<w;b++)h.push(m[b]-m[b-1]);return h},a.rank=function(m){var b,h=[],w={};for(b=0;b<m.length;b++)w[H=m[b]]?w[H]++:(w[H]=1,h.push(H));var T=h.sort(P),N={},V=1;for(b=0;b<T.length;b++){var H,M=w[H=T[b]],F=(V+(V+M-1))/2;N[H]=F,V+=M}return m.map(function(J){return N[J]})},a.mode=function(m){var b,h=m.length,w=m.slice().sort(P),T=1,N=0,V=0,H=[];for(b=0;b<h;b++)w[b]===w[b+1]?T++:(T>N?(H=[w[b]],N=T,V=0):T===N&&(H.push(w[b]),V++),T=1);return V===0?H[0]:H},a.range=function(m){return a.max(m)-a.min(m)},a.variance=function(m,b){return a.sumsqerr(m)/(m.length-(b?1:0))},a.pooledvariance=function(m){return m.reduce(function(b,h){return b+a.sumsqerr(h)},0)/(m.reduce(function(b,h){return b+h.length},0)-m.length)},a.deviation=function(m){for(var b=a.mean(m),h=m.length,w=new Array(h),T=0;T<h;T++)w[T]=m[T]-b;return w},a.stdev=function(m,b){return j.sqrt(a.variance(m,b))},a.pooledstdev=function(m){return j.sqrt(a.pooledvariance(m))},a.meandev=function(m){for(var b=a.mean(m),h=[],w=m.length-1;w>=0;w--)h.push(j.abs(m[w]-b));return a.mean(h)},a.meddev=function(m){for(var b=a.median(m),h=[],w=m.length-1;w>=0;w--)h.push(j.abs(m[w]-b));return a.median(h)},a.coeffvar=function(m){return a.stdev(m)/a.mean(m)},a.quartiles=function(m){var b=m.length,h=m.slice().sort(P);return[h[j.round(b/4)-1],h[j.round(b/2)-1],h[j.round(3*b/4)-1]]},a.quantiles=function(m,b,h,w){var T,N,V,H,M,F=m.slice().sort(P),J=[b.length],q=m.length;for(h===void 0&&(h=.375),w===void 0&&(w=.375),T=0;T<b.length;T++)V=q*(N=b[T])+(h+N*(1-h-w)),H=j.floor(g(V,1,q-1)),M=g(V-H,0,1),J[T]=(1-M)*F[H-1]+M*F[H];return J},a.percentile=function(m,b,h){var w=m.slice().sort(P),T=b*(w.length+(h?1:-1))+(h?0:1),N=parseInt(T),V=T-N;return N+1<w.length?w[N-1]+V*(w[N]-w[N-1]):w[N-1]},a.percentileOfScore=function(m,b,h){var w,T,N=0,V=m.length,H=!1;for(h==="strict"&&(H=!0),T=0;T<V;T++)w=m[T],(H&&w<b||!H&&w<=b)&&N++;return N/V},a.histogram=function(m,b){b=b||4;var h,w=a.min(m),T=(a.max(m)-w)/b,N=m.length,V=[];for(h=0;h<b;h++)V[h]=0;for(h=0;h<N;h++)V[j.min(j.floor((m[h]-w)/T),b-1)]+=1;return V},a.covariance=function(m,b){var h,w=a.mean(m),T=a.mean(b),N=m.length,V=new Array(N);for(h=0;h<N;h++)V[h]=(m[h]-w)*(b[h]-T);return a.sum(V)/(N-1)},a.corrcoeff=function(m,b){return a.covariance(m,b)/a.stdev(m,1)/a.stdev(b,1)},a.spearmancoeff=function(m,b){return m=a.rank(m),b=a.rank(b),a.corrcoeff(m,b)},a.stanMoment=function(m,b){for(var h=a.mean(m),w=a.stdev(m),T=m.length,N=0,V=0;V<T;V++)N+=j.pow((m[V]-h)/w,b);return N/m.length},a.skewness=function(m){return a.stanMoment(m,3)},a.kurtosis=function(m){return a.stanMoment(m,4)-3};var u=a.prototype;(function(m){for(var b=0;b<m.length;b++)(function(h){u[h]=function(w,T){var N=[],V=0,H=this;if(R(w)&&(T=w,w=!1),T)return setTimeout(function(){T.call(H,u[h].call(H,w))}),this;if(this.length>1){for(H=w===!0?this:this.transpose();V<H.length;V++)N[V]=a[h](H[V]);return N}return a[h](this[0],w)}})(m[b])})("cumsum cumprod".split(" ")),function(m){for(var b=0;b<m.length;b++)(function(h){u[h]=function(w,T){var N=[],V=0,H=this;if(R(w)&&(T=w,w=!1),T)return setTimeout(function(){T.call(H,u[h].call(H,w))}),this;if(this.length>1){for(h!=="sumrow"&&(H=w===!0?this:this.transpose());V<H.length;V++)N[V]=a[h](H[V]);return w===!0?a[h](a.utils.toVector(N)):N}return a[h](this[0],w)}})(m[b])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(m){for(var b=0;b<m.length;b++)(function(h){u[h]=function(){var w,T=[],N=0,V=this,H=Array.prototype.slice.call(arguments);if(R(H[H.length-1])){w=H[H.length-1];var M=H.slice(0,H.length-1);return setTimeout(function(){w.call(V,u[h].apply(V,M))}),this}w=void 0;var F=function(J){return a[h].apply(V,[J].concat(H))};if(this.length>1){for(V=V.transpose();N<V.length;N++)T[N]=F(V[N]);return T}return F(this[0])}})(m[b])}("quantiles percentileOfScore".split(" "))}(c,Math),function(a,j){a.gammaln=function(R){var P,g,u,m=0,b=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],h=1.000000000190015;for(u=(g=P=R)+5.5,u-=(P+.5)*j.log(u);m<6;m++)h+=b[m]/++g;return j.log(2.5066282746310007*h/P)-u},a.loggam=function(R){var P,g,u,m,b,h,w,T=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(P=R,w=0,R==1||R==2)return 0;for(R<=7&&(P=R+(w=j.floor(7-R))),g=1/(P*P),u=2*j.PI,b=T[9],h=8;h>=0;h--)b*=g,b+=T[h];if(m=b/P+.5*j.log(u)+(P-.5)*j.log(P)-P,R<=7)for(h=1;h<=w;h++)m-=j.log(P-1),P-=1;return m},a.gammafn=function(R){var P,g,u,m,b=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],w=!1,T=0,N=0,V=0,H=R;if(R>171.6243769536076)return 1/0;if(H<=0){if(!(m=H%1+36e-17))return 1/0;w=(1&H?-1:1)*j.PI/j.sin(j.PI*m),H=1-H}for(u=H,g=H<1?H++:(H-=T=(0|H)-1)-1,P=0;P<8;++P)V=(V+b[P])*g,N=N*g+h[P];if(m=V/N+1,u<H)m/=u;else if(u>H)for(P=0;P<T;++P)m*=H,H++;return w&&(m=w/m),m},a.gammap=function(R,P){return a.lowRegGamma(R,P)*a.gammafn(R)},a.lowRegGamma=function(R,P){var g,u=a.gammaln(R),m=R,b=1/R,h=b,w=P+1-R,T=1/1e-30,N=1/w,V=N,H=1,M=-~(8.5*j.log(R>=1?R:1/R)+.4*R+17);if(P<0||R<=0)return NaN;if(P<R+1){for(;H<=M;H++)b+=h*=P/++m;return b*j.exp(-P+R*j.log(P)-u)}for(;H<=M;H++)V*=(N=1/(N=(g=-H*(H-R))*N+(w+=2)))*(T=w+g/T);return 1-V*j.exp(-P+R*j.log(P)-u)},a.factorialln=function(R){return R<0?NaN:a.gammaln(R+1)},a.factorial=function(R){return R<0?NaN:a.gammafn(R+1)},a.combination=function(R,P){return R>170||P>170?j.exp(a.combinationln(R,P)):a.factorial(R)/a.factorial(P)/a.factorial(R-P)},a.combinationln=function(R,P){return a.factorialln(R)-a.factorialln(P)-a.factorialln(R-P)},a.permutation=function(R,P){return a.factorial(R)/a.factorial(R-P)},a.betafn=function(R,P){if(!(R<=0||P<=0))return R+P>170?j.exp(a.betaln(R,P)):a.gammafn(R)*a.gammafn(P)/a.gammafn(R+P)},a.betaln=function(R,P){return a.gammaln(R)+a.gammaln(P)-a.gammaln(R+P)},a.betacf=function(R,P,g){var u,m,b,h,w=1e-30,T=1,N=P+g,V=P+1,H=P-1,M=1,F=1-N*R/V;for(j.abs(F)<w&&(F=w),h=F=1/F;T<=100&&(F=1+(m=T*(g-T)*R/((H+(u=2*T))*(P+u)))*F,j.abs(F)<w&&(F=w),M=1+m/M,j.abs(M)<w&&(M=w),h*=(F=1/F)*M,F=1+(m=-(P+T)*(N+T)*R/((P+u)*(V+u)))*F,j.abs(F)<w&&(F=w),M=1+m/M,j.abs(M)<w&&(M=w),h*=b=(F=1/F)*M,!(j.abs(b-1)<3e-7));T++);return h},a.gammapinv=function(R,P){var g,u,m,b,h,w,T=0,N=P-1,V=a.gammaln(P);if(R>=1)return j.max(100,P+100*j.sqrt(P));if(R<=0)return 0;for(P>1?(h=j.log(N),w=j.exp(N*(h-1)-V),b=R<.5?R:1-R,g=(2.30753+.27061*(u=j.sqrt(-2*j.log(b))))/(1+u*(.99229+.04481*u))-u,R<.5&&(g=-g),g=j.max(.001,P*j.pow(1-1/(9*P)-g/(3*j.sqrt(P)),3))):g=R<(u=1-P*(.253+.12*P))?j.pow(R/u,1/P):1-j.log(1-(R-u)/(1-u));T<12;T++){if(g<=0)return 0;if((g-=u=(m=(a.lowRegGamma(P,g)-R)/(u=P>1?w*j.exp(-(g-N)+N*(j.log(g)-h)):j.exp(-g+N*j.log(g)-V)))/(1-.5*j.min(1,m*((P-1)/g-1))))<=0&&(g=.5*(g+u)),j.abs(u)<1e-8*g)break}return g},a.erf=function(R){var P,g,u,m,b=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=b.length-1,w=!1,T=0,N=0;for(R<0&&(R=-R,w=!0),g=4*(P=2/(2+R))-2;h>0;h--)u=T,T=g*T-N+b[h],N=u;return m=P*j.exp(-R*R+.5*(b[0]+g*T)-N),w?m-1:1-m},a.erfc=function(R){return 1-a.erf(R)},a.erfcinv=function(R){var P,g,u,m,b=0;if(R>=2)return-100;if(R<=0)return 100;for(m=R<1?R:2-R,P=-.70711*((2.30753+.27061*(u=j.sqrt(-2*j.log(m/2))))/(1+u*(.99229+.04481*u))-u);b<2;b++)P+=(g=a.erfc(P)-m)/(1.1283791670955126*j.exp(-P*P)-P*g);return R<1?P:-P},a.ibetainv=function(R,P,g){var u,m,b,h,w,T,N,V,H,M,F=P-1,J=g-1,q=0;if(R<=0)return 0;if(R>=1)return 1;for(P>=1&&g>=1?(b=R<.5?R:1-R,T=(2.30753+.27061*(h=j.sqrt(-2*j.log(b))))/(1+h*(.99229+.04481*h))-h,R<.5&&(T=-T),N=(T*T-3)/6,V=2/(1/(2*P-1)+1/(2*g-1)),H=T*j.sqrt(N+V)/V-(1/(2*g-1)-1/(2*P-1))*(N+.8333333333333334-2/(3*V)),T=P/(P+g*j.exp(2*H))):(u=j.log(P/(P+g)),m=j.log(g/(P+g)),T=R<(h=j.exp(P*u)/P)/(H=h+(w=j.exp(g*m)/g))?j.pow(P*H*R,1/P):1-j.pow(g*H*(1-R),1/g)),M=-a.gammaln(P)-a.gammaln(g)+a.gammaln(P+g);q<10;q++){if(T===0||T===1)return T;if((T-=h=(w=(a.ibeta(T,P,g)-R)/(h=j.exp(F*j.log(T)+J*j.log(1-T)+M)))/(1-.5*j.min(1,w*(F/T-J/(1-T)))))<=0&&(T=.5*(T+h)),T>=1&&(T=.5*(T+h+1)),j.abs(h)<1e-8*T&&q>0)break}return T},a.ibeta=function(R,P,g){var u=R===0||R===1?0:j.exp(a.gammaln(P+g)-a.gammaln(P)-a.gammaln(g)+P*j.log(R)+g*j.log(1-R));return!(R<0||R>1)&&(R<(P+1)/(P+g+2)?u*a.betacf(R,P,g)/P:1-u*a.betacf(1-R,g,P)/g)},a.randn=function(R,P){var g,u,m,b,h;if(P||(P=R),R)return a.create(R,P,function(){return a.randn()});do g=a._random_fn(),u=1.7156*(a._random_fn()-.5),h=(m=g-.449871)*m+(b=j.abs(u)+.386595)*(.196*b-.25472*m);while(h>.27597&&(h>.27846||u*u>-4*j.log(g)*g*g));return u/g},a.randg=function(R,P,g){var u,m,b,h,w,T,N=R;if(g||(g=P),R||(R=1),P)return(T=a.zeros(P,g)).alter(function(){return a.randg(R)}),T;R<1&&(R+=1),u=R-.3333333333333333,m=1/j.sqrt(9*u);do{do h=1+m*(w=a.randn());while(h<=0);h*=h*h,b=a._random_fn()}while(b>1-.331*j.pow(w,4)&&j.log(b)>.5*w*w+u*(1-h+j.log(h)));if(R==N)return u*h;do b=a._random_fn();while(b===0);return j.pow(b,1/N)*u*h},function(R){for(var P=0;P<R.length;P++)(function(g){a.fn[g]=function(){return a(a.map(this,function(u){return a[g](u)}))}})(R[P])}("gammaln gammafn factorial factorialln".split(" ")),function(R){for(var P=0;P<R.length;P++)(function(g){a.fn[g]=function(){return a(a[g].apply(null,arguments))}})(R[P])}("randn".split(" "))}(c,Math),function(a,j){function R(g,u,m,b){for(var h,w=0,T=1,N=1,V=1,H=0,M=0;j.abs((N-M)/N)>b;)M=N,T=V+(h=-(u+H)*(u+m+H)*g/(u+2*H)/(u+2*H+1))*T,N=(w=N+h*w)+(h=(H+=1)*(m-H)*g/(u+2*H-1)/(u+2*H))*N,w/=V=T+h*V,T/=V,N/=V,V=1;return N/u}function P(g,u,m){var b=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],h=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],w=.5*g;if(w>=8)return 1;var T,N=2*a.normal.cdf(w,0,1,1,0)-1;N=N>=j.exp(-50/m)?j.pow(N,m):0;for(var V=w,H=(8-w)/(T=g>3?2:3),M=V+H,F=0,J=m-1,q=1;q<=T;q++){for(var ae=0,ge=.5*(M+V),se=.5*(M-V),xe=1;xe<=12;xe++){var Le,ve=ge+se*(6<xe?b[(Le=12-xe+1)-1]:-b[(Le=xe)-1]),ie=ve*ve;if(ie>60)break;var Ye=2*a.normal.cdf(ve,0,1,1,0)*.5-2*a.normal.cdf(ve,g,1,1,0)*.5;Ye>=j.exp(-30/J)&&(ae+=Ye=h[Le-1]*j.exp(-.5*ie)*j.pow(Ye,J))}F+=ae*=2*se*m/j.sqrt(2*j.PI),V=M,M+=H}return(N+=F)<=j.exp(-30/u)?0:(N=j.pow(N,u))>=1?1:N}(function(g){for(var u=0;u<g.length;u++)(function(m){a[m]=function b(h,w,T){return this instanceof b?(this._a=h,this._b=w,this._c=T,this):new b(h,w,T)},a.fn[m]=function(b,h,w){var T=a[m](b,h,w);return T.data=this,T},a[m].prototype.sample=function(b){var h=this._a,w=this._b,T=this._c;return b?a.alter(b,function(){return a[m].sample(h,w,T)}):a[m].sample(h,w,T)},function(b){for(var h=0;h<b.length;h++)(function(w){a[m].prototype[w]=function(T){var N=this._a,V=this._b,H=this._c;return T||T===0||(T=this.data),typeof T!="number"?a.fn.map.call(T,function(M){return a[m][w](M,N,V,H)}):a[m][w](T,N,V,H)}})(b[h])}("pdf cdf inv".split(" ")),function(b){for(var h=0;h<b.length;h++)(function(w){a[m].prototype[w]=function(){return a[m][w](this._a,this._b,this._c)}})(b[h])}("mean median mode variance".split(" "))})(g[u])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),a.extend(a.beta,{pdf:function(g,u,m){return g>1||g<0?0:u==1&&m==1?1:u<512&&m<512?j.pow(g,u-1)*j.pow(1-g,m-1)/a.betafn(u,m):j.exp((u-1)*j.log(g)+(m-1)*j.log(1-g)-a.betaln(u,m))},cdf:function(g,u,m){return g>1||g<0?1*(g>1):a.ibeta(g,u,m)},inv:function(g,u,m){return a.ibetainv(g,u,m)},mean:function(g,u){return g/(g+u)},median:function(g,u){return a.ibetainv(.5,g,u)},mode:function(g,u){return(g-1)/(g+u-2)},sample:function(g,u){var m=a.randg(g);return m/(m+a.randg(u))},variance:function(g,u){return g*u/(j.pow(g+u,2)*(g+u+1))}}),a.extend(a.centralF,{pdf:function(g,u,m){var b;return g<0?0:u<=2?g===0&&u<2?1/0:g===0&&u===2?1:1/a.betafn(u/2,m/2)*j.pow(u/m,u/2)*j.pow(g,u/2-1)*j.pow(1+u/m*g,-(u+m)/2):(b=u*g/(m+g*u),u*(m/(m+g*u))/2*a.binomial.pdf((u-2)/2,(u+m-2)/2,b))},cdf:function(g,u,m){return g<0?0:a.ibeta(u*g/(u*g+m),u/2,m/2)},inv:function(g,u,m){return m/(u*(1/a.ibetainv(g,u/2,m/2)-1))},mean:function(g,u){return u>2?u/(u-2):void 0},mode:function(g,u){return g>2?u*(g-2)/(g*(u+2)):void 0},sample:function(g,u){return 2*a.randg(g/2)/g/(2*a.randg(u/2)/u)},variance:function(g,u){if(!(u<=4))return 2*u*u*(g+u-2)/(g*(u-2)*(u-2)*(u-4))}}),a.extend(a.cauchy,{pdf:function(g,u,m){return m<0?0:m/(j.pow(g-u,2)+j.pow(m,2))/j.PI},cdf:function(g,u,m){return j.atan((g-u)/m)/j.PI+.5},inv:function(g,u,m){return u+m*j.tan(j.PI*(g-.5))},median:function(g){return g},mode:function(g){return g},sample:function(g,u){return a.randn()*j.sqrt(1/(2*a.randg(.5)))*u+g}}),a.extend(a.chisquare,{pdf:function(g,u){return g<0?0:g===0&&u===2?.5:j.exp((u/2-1)*j.log(g)-g/2-u/2*j.log(2)-a.gammaln(u/2))},cdf:function(g,u){return g<0?0:a.lowRegGamma(u/2,g/2)},inv:function(g,u){return 2*a.gammapinv(g,.5*u)},mean:function(g){return g},median:function(g){return g*j.pow(1-2/(9*g),3)},mode:function(g){return g-2>0?g-2:0},sample:function(g){return 2*a.randg(g/2)},variance:function(g){return 2*g}}),a.extend(a.exponential,{pdf:function(g,u){return g<0?0:u*j.exp(-u*g)},cdf:function(g,u){return g<0?0:1-j.exp(-u*g)},inv:function(g,u){return-j.log(1-g)/u},mean:function(g){return 1/g},median:function(g){return 1/g*j.log(2)},mode:function(){return 0},sample:function(g){return-1/g*j.log(a._random_fn())},variance:function(g){return j.pow(g,-2)}}),a.extend(a.gamma,{pdf:function(g,u,m){return g<0?0:g===0&&u===1?1/m:j.exp((u-1)*j.log(g)-g/m-a.gammaln(u)-u*j.log(m))},cdf:function(g,u,m){return g<0?0:a.lowRegGamma(u,g/m)},inv:function(g,u,m){return a.gammapinv(g,u)*m},mean:function(g,u){return g*u},mode:function(g,u){if(g>1)return(g-1)*u},sample:function(g,u){return a.randg(g)*u},variance:function(g,u){return g*u*u}}),a.extend(a.invgamma,{pdf:function(g,u,m){return g<=0?0:j.exp(-(u+1)*j.log(g)-m/g-a.gammaln(u)+u*j.log(m))},cdf:function(g,u,m){return g<=0?0:1-a.lowRegGamma(u,m/g)},inv:function(g,u,m){return m/a.gammapinv(1-g,u)},mean:function(g,u){return g>1?u/(g-1):void 0},mode:function(g,u){return u/(g+1)},sample:function(g,u){return u/a.randg(g)},variance:function(g,u){if(!(g<=2))return u*u/((g-1)*(g-1)*(g-2))}}),a.extend(a.kumaraswamy,{pdf:function(g,u,m){return g===0&&u===1?m:g===1&&m===1?u:j.exp(j.log(u)+j.log(m)+(u-1)*j.log(g)+(m-1)*j.log(1-j.pow(g,u)))},cdf:function(g,u,m){return g<0?0:g>1?1:1-j.pow(1-j.pow(g,u),m)},inv:function(g,u,m){return j.pow(1-j.pow(1-g,1/m),1/u)},mean:function(g,u){return u*a.gammafn(1+1/g)*a.gammafn(u)/a.gammafn(1+1/g+u)},median:function(g,u){return j.pow(1-j.pow(2,-1/u),1/g)},mode:function(g,u){if(g>=1&&u>=1&&g!==1&&u!==1)return j.pow((g-1)/(g*u-1),1/g)},variance:function(){throw new Error("variance not yet implemented")}}),a.extend(a.lognormal,{pdf:function(g,u,m){return g<=0?0:j.exp(-j.log(g)-.5*j.log(2*j.PI)-j.log(m)-j.pow(j.log(g)-u,2)/(2*m*m))},cdf:function(g,u,m){return g<0?0:.5+.5*a.erf((j.log(g)-u)/j.sqrt(2*m*m))},inv:function(g,u,m){return j.exp(-1.4142135623730951*m*a.erfcinv(2*g)+u)},mean:function(g,u){return j.exp(g+u*u/2)},median:function(g){return j.exp(g)},mode:function(g,u){return j.exp(g-u*u)},sample:function(g,u){return j.exp(a.randn()*u+g)},variance:function(g,u){return(j.exp(u*u)-1)*j.exp(2*g+u*u)}}),a.extend(a.noncentralt,{pdf:function(g,u,m){return j.abs(m)<1e-14?a.studentt.pdf(g,u):j.abs(g)<1e-14?j.exp(a.gammaln((u+1)/2)-m*m/2-.5*j.log(j.PI*u)-a.gammaln(u/2)):u/g*(a.noncentralt.cdf(g*j.sqrt(1+2/u),u+2,m)-a.noncentralt.cdf(g,u,m))},cdf:function(g,u,m){var b=1e-14;if(j.abs(m)<b)return a.studentt.cdf(g,u);var h=!1;g<0&&(h=!0,m=-m);for(var w=a.normal.cdf(-m,0,1),T=b+1,N=T,V=g*g/(g*g+u),H=0,M=j.exp(-m*m/2),F=j.exp(-m*m/2-.5*j.log(2)-a.gammaln(1.5))*m;H<200||N>b||T>b;)N=T,H>0&&(M*=m*m/(2*H),F*=m*m/(2*(H+.5))),w+=.5*(T=M*a.beta.cdf(V,H+.5,u/2)+F*a.beta.cdf(V,H+1,u/2)),H++;return h?1-w:w}}),a.extend(a.normal,{pdf:function(g,u,m){return j.exp(-.5*j.log(2*j.PI)-j.log(m)-j.pow(g-u,2)/(2*m*m))},cdf:function(g,u,m){return .5*(1+a.erf((g-u)/j.sqrt(2*m*m)))},inv:function(g,u,m){return-1.4142135623730951*m*a.erfcinv(2*g)+u},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},sample:function(g,u){return a.randn()*u+g},variance:function(g,u){return u*u}}),a.extend(a.pareto,{pdf:function(g,u,m){return g<u?0:m*j.pow(u,m)/j.pow(g,m+1)},cdf:function(g,u,m){return g<u?0:1-j.pow(u/g,m)},inv:function(g,u,m){return u/j.pow(1-g,1/m)},mean:function(g,u){if(!(u<=1))return u*j.pow(g,u)/(u-1)},median:function(g,u){return g*(u*j.SQRT2)},mode:function(g){return g},variance:function(g,u){if(!(u<=2))return g*g*u/(j.pow(u-1,2)*(u-2))}}),a.extend(a.studentt,{pdf:function(g,u){return u=u>1e100?1e100:u,1/(j.sqrt(u)*a.betafn(.5,u/2))*j.pow(1+g*g/u,-(u+1)/2)},cdf:function(g,u){var m=u/2;return a.ibeta((g+j.sqrt(g*g+u))/(2*j.sqrt(g*g+u)),m,m)},inv:function(g,u){var m=a.ibetainv(2*j.min(g,1-g),.5*u,.5);return m=j.sqrt(u*(1-m)/m),g>.5?m:-m},mean:function(g){return g>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(g){return a.randn()*j.sqrt(g/(2*a.randg(g/2)))},variance:function(g){return g>2?g/(g-2):g>1?1/0:void 0}}),a.extend(a.weibull,{pdf:function(g,u,m){return g<0||u<0||m<0?0:m/u*j.pow(g/u,m-1)*j.exp(-j.pow(g/u,m))},cdf:function(g,u,m){return g<0?0:1-j.exp(-j.pow(g/u,m))},inv:function(g,u,m){return u*j.pow(-j.log(1-g),1/m)},mean:function(g,u){return g*a.gammafn(1+1/u)},median:function(g,u){return g*j.pow(j.log(2),1/u)},mode:function(g,u){return u<=1?0:g*j.pow((u-1)/u,1/u)},sample:function(g,u){return g*j.pow(-j.log(a._random_fn()),1/u)},variance:function(g,u){return g*g*a.gammafn(1+2/u)-j.pow(a.weibull.mean(g,u),2)}}),a.extend(a.uniform,{pdf:function(g,u,m){return g<u||g>m?0:1/(m-u)},cdf:function(g,u,m){return g<u?0:g<m?(g-u)/(m-u):1},inv:function(g,u,m){return u+g*(m-u)},mean:function(g,u){return .5*(g+u)},median:function(g,u){return a.mean(g,u)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,u){return g/2+u/2+(u/2-g/2)*(2*a._random_fn()-1)},variance:function(g,u){return j.pow(u-g,2)/12}}),a.extend(a.binomial,{pdf:function(g,u,m){return m===0||m===1?u*m===g?1:0:a.combination(u,g)*j.pow(m,g)*j.pow(1-m,u-g)},cdf:function(g,u,m){var b,h=1e-10;if(g<0)return 0;if(g>=u)return 1;if(m<0||m>1||u<=0)return NaN;var w=m,T=(g=j.floor(g))+1,N=u-g,V=T+N,H=j.exp(a.gammaln(V)-a.gammaln(N)-a.gammaln(T)+T*j.log(w)+N*j.log(1-w));return b=w<(T+1)/(V+2)?H*R(w,T,N,h):1-H*R(1-w,N,T,h),j.round(1/h*(1-b))/(1/h)}}),a.extend(a.negbin,{pdf:function(g,u,m){return g===g>>>0&&(g<0?0:a.combination(g+u-1,u-1)*j.pow(1-m,g)*j.pow(m,u))},cdf:function(g,u,m){var b=0,h=0;if(g<0)return 0;for(;h<=g;h++)b+=a.negbin.pdf(h,u,m);return b}}),a.extend(a.hypgeom,{pdf:function(g,u,m,b){if(g!=g|0)return!1;if(g<0||g<m-(u-b)||g>b||g>m)return 0;if(2*m>u)return 2*b>u?a.hypgeom.pdf(u-m-b+g,u,u-m,u-b):a.hypgeom.pdf(b-g,u,u-m,b);if(2*b>u)return a.hypgeom.pdf(m-g,u,m,u-b);if(m<b)return a.hypgeom.pdf(g,u,b,m);for(var h=1,w=0,T=0;T<g;T++){for(;h>1&&w<b;)h*=1-m/(u-w),w++;h*=(b-T)*(m-T)/((T+1)*(u-m-b+T+1))}for(;w<b;w++)h*=1-m/(u-w);return j.min(1,j.max(0,h))},cdf:function(g,u,m,b){if(g<0||g<m-(u-b))return 0;if(g>=b||g>=m)return 1;if(2*m>u)return 2*b>u?a.hypgeom.cdf(u-m-b+g,u,u-m,u-b):1-a.hypgeom.cdf(b-g-1,u,u-m,b);if(2*b>u)return 1-a.hypgeom.cdf(m-g-1,u,m,u-b);if(m<b)return a.hypgeom.cdf(g,u,b,m);for(var h=1,w=1,T=0,N=0;N<g;N++){for(;h>1&&T<b;){var V=1-m/(u-T);w*=V,h*=V,T++}h+=w*=(b-N)*(m-N)/((N+1)*(u-m-b+N+1))}for(;T<b;T++)h*=1-m/(u-T);return j.min(1,j.max(0,h))}}),a.extend(a.poisson,{pdf:function(g,u){return u<0||g%1!=0||g<0?0:j.pow(u,g)*j.exp(-u)/a.factorial(g)},cdf:function(g,u){var m=[],b=0;if(g<0)return 0;for(;b<=g;b++)m.push(a.poisson.pdf(b,u));return a.sum(m)},mean:function(g){return g},variance:function(g){return g},sampleSmall:function(g){var u=1,m=0,b=j.exp(-g);do m++,u*=a._random_fn();while(u>b);return m-1},sampleLarge:function(g){var u,m,b,h,w,T,N,V,H,M,F=g;for(h=j.sqrt(F),w=j.log(F),T=.02483*(N=.931+2.53*h)-.059,V=1.1239+1.1328/(N-3.4),H=.9277-3.6224/(N-2);;)if(m=j.random()-.5,b=j.random(),M=.5-j.abs(m),u=j.floor((2*T/M+N)*m+F+.43),M>=.07&&b<=H||!(u<0||M<.013&&b>M)&&j.log(b)+j.log(V)-j.log(T/(M*M)+N)<=u*w-F-a.loggam(u+1))return u},sample:function(g){return g<10?this.sampleSmall(g):this.sampleLarge(g)}}),a.extend(a.triangular,{pdf:function(g,u,m,b){return m<=u||b<u||b>m?NaN:g<u||g>m?0:g<b?2*(g-u)/((m-u)*(b-u)):g===b?2/(m-u):2*(m-g)/((m-u)*(m-b))},cdf:function(g,u,m,b){return m<=u||b<u||b>m?NaN:g<=u?0:g>=m?1:g<=b?j.pow(g-u,2)/((m-u)*(b-u)):1-j.pow(m-g,2)/((m-u)*(m-b))},inv:function(g,u,m,b){return m<=u||b<u||b>m?NaN:g<=(b-u)/(m-u)?u+(m-u)*j.sqrt(g*((b-u)/(m-u))):u+(m-u)*(1-j.sqrt((1-g)*(1-(b-u)/(m-u))))},mean:function(g,u,m){return(g+u+m)/3},median:function(g,u,m){return m<=(g+u)/2?u-j.sqrt((u-g)*(u-m))/j.sqrt(2):m>(g+u)/2?g+j.sqrt((u-g)*(m-g))/j.sqrt(2):void 0},mode:function(g,u,m){return m},sample:function(g,u,m){var b=a._random_fn();return b<(m-g)/(u-g)?g+j.sqrt(b*(u-g)*(m-g)):u-j.sqrt((1-b)*(u-g)*(u-m))},variance:function(g,u,m){return(g*g+u*u+m*m-g*u-g*m-u*m)/18}}),a.extend(a.arcsine,{pdf:function(g,u,m){return m<=u?NaN:g<=u||g>=m?0:2/j.PI*j.pow(j.pow(m-u,2)-j.pow(2*g-u-m,2),-.5)},cdf:function(g,u,m){return g<u?0:g<m?2/j.PI*j.asin(j.sqrt((g-u)/(m-u))):1},inv:function(g,u,m){return u+(.5-.5*j.cos(j.PI*g))*(m-u)},mean:function(g,u){return u<=g?NaN:(g+u)/2},median:function(g,u){return u<=g?NaN:(g+u)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,u){return(g+u)/2+(u-g)/2*j.sin(2*j.PI*a.uniform.sample(0,1))},variance:function(g,u){return u<=g?NaN:j.pow(u-g,2)/8}}),a.extend(a.laplace,{pdf:function(g,u,m){return m<=0?0:j.exp(-j.abs(g-u)/m)/(2*m)},cdf:function(g,u,m){return m<=0?0:g<u?.5*j.exp((g-u)/m):1-.5*j.exp(-(g-u)/m)},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},variance:function(g,u){return 2*u*u},sample:function(g,u){var m,b=a._random_fn()-.5;return g-u*((m=b)/j.abs(m))*j.log(1-2*j.abs(b))}}),a.extend(a.tukey,{cdf:function(g,u,m){var b=u,h=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],w=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(g<=0)return 0;if(m<2||b<2)return NaN;if(!Number.isFinite(g))return 1;if(m>25e3)return P(g,1,b);var T,N=.5*m,V=N*j.log(m)-m*j.log(2)-a.gammaln(N),H=N-1,M=.25*m;T=m<=100?1:m<=800?.5:m<=5e3?.25:.125,V+=j.log(T);for(var F=0,J=1;J<=50;J++){for(var q=0,ae=(2*J-1)*T,ge=1;ge<=16;ge++){var se,xe;8<ge?(se=ge-8-1,xe=V+H*j.log(ae+h[se]*T)-(h[se]*T+ae)*M):(se=ge-1,xe=V+H*j.log(ae-h[se]*T)+(h[se]*T-ae)*M),xe>=-30&&(q+=P(8<ge?g*j.sqrt(.5*(h[se]*T+ae)):g*j.sqrt(.5*(-h[se]*T+ae)),1,b)*w[se]*j.exp(xe))}if(J*T>=1&&q<=1e-14)break;F+=q}if(q>1e-14)throw new Error("tukey.cdf failed to converge");return F>1&&(F=1),F},inv:function(g,u,m){if(m<2||u<2)return NaN;if(g<0||g>1)return NaN;if(g===0)return 0;if(g===1)return 1/0;var b,h=function(H,M,F){var J=.5-.5*H,q=j.sqrt(j.log(1/(J*J))),ae=q+((((-453642210148e-16*q-.204231210125)*q-.342242088547)*q-1)*q+.322232421088)/((((.0038560700634*q+.10353775285)*q+.531103462366)*q+.588581570495)*q+.099348462606);F<120&&(ae+=(ae*ae*ae+ae)/F/4);var ge=.8832-.2368*ae;return F<120&&(ge+=-1.214/F+1.208*ae/F),ae*(ge*j.log(M-1)+1.4142)}(g,u,m),w=a.tukey.cdf(h,u,m)-g;b=w>0?j.max(0,h-1):h+1;for(var T,N=a.tukey.cdf(b,u,m)-g,V=1;V<50;V++)if(T=b-N*(b-h)/(N-w),w=N,h=b,T<0&&(T=0,N=-g),N=a.tukey.cdf(T,u,m)-g,b=T,j.abs(b-h)<1e-4)return T;throw new Error("tukey.inv failed to converge")}})}(c,Math),function(a,j){var R,P,g=Array.prototype.push,u=a.utils.isArray;function m(b){return u(b)||b instanceof a}a.extend({add:function(b,h){return m(h)?(m(h[0])||(h=[h]),a.map(b,function(w,T,N){return w+h[T][N]})):a.map(b,function(w){return w+h})},subtract:function(b,h){return m(h)?(m(h[0])||(h=[h]),a.map(b,function(w,T,N){return w-h[T][N]||0})):a.map(b,function(w){return w-h})},divide:function(b,h){return m(h)?(m(h[0])||(h=[h]),a.multiply(b,a.inv(h))):a.map(b,function(w){return w/h})},multiply:function(b,h){var w,T,N,V,H,M,F,J;if(b.length===void 0&&h.length===void 0)return b*h;if(H=b.length,M=b[0].length,F=a.zeros(H,N=m(h)?h[0].length:M),J=0,m(h)){for(;J<N;J++)for(w=0;w<H;w++){for(V=0,T=0;T<M;T++)V+=b[w][T]*h[T][J];F[w][J]=V}return H===1&&J===1?F[0][0]:F}return a.map(b,function(q){return q*h})},outer:function(b,h){return a.multiply(b.map(function(w){return[w]}),[h])},dot:function(b,h){m(b[0])||(b=[b]),m(h[0])||(h=[h]);for(var w,T,N=b[0].length===1&&b.length!==1?a.transpose(b):b,V=h[0].length===1&&h.length!==1?a.transpose(h):h,H=[],M=0,F=N.length,J=N[0].length;M<F;M++){for(H[M]=[],w=0,T=0;T<J;T++)w+=N[M][T]*V[M][T];H[M]=w}return H.length===1?H[0]:H},pow:function(b,h){return a.map(b,function(w){return j.pow(w,h)})},exp:function(b){return a.map(b,function(h){return j.exp(h)})},log:function(b){return a.map(b,function(h){return j.log(h)})},abs:function(b){return a.map(b,function(h){return j.abs(h)})},norm:function(b,h){var w=0,T=0;for(isNaN(h)&&(h=2),m(b[0])&&(b=b[0]);T<b.length;T++)w+=j.pow(j.abs(b[T]),h);return j.pow(w,1/h)},angle:function(b,h){return j.acos(a.dot(b,h)/(a.norm(b)*a.norm(h)))},aug:function(b,h){var w,T=[];for(w=0;w<b.length;w++)T.push(b[w].slice());for(w=0;w<T.length;w++)g.apply(T[w],h[w]);return T},inv:function(b){for(var h,w=b.length,T=b[0].length,N=a.identity(w,T),V=a.gauss_jordan(b,N),H=[],M=0;M<w;M++)for(H[M]=[],h=T;h<V[0].length;h++)H[M][h-T]=V[M][h];return H},det:function b(h){if(h.length===2)return h[0][0]*h[1][1]-h[0][1]*h[1][0];for(var w=0,T=0;T<h.length;T++){for(var N=[],V=1;V<h.length;V++){N[V-1]=[];for(var H=0;H<h.length;H++)H<T?N[V-1][H]=h[V][H]:H>T&&(N[V-1][H-1]=h[V][H])}var M=T%2?-1:1;w+=b(N)*h[0][T]*M}return w},gauss_elimination:function(b,h){var w,T,N,V,H=0,M=0,F=b.length,J=b[0].length,q=1,ae=0,ge=[];for(w=(b=a.aug(b,h))[0].length,H=0;H<F;H++){for(T=b[H][H],M=H,V=H+1;V<J;V++)T<j.abs(b[V][H])&&(T=b[V][H],M=V);if(M!=H)for(V=0;V<w;V++)N=b[H][V],b[H][V]=b[M][V],b[M][V]=N;for(M=H+1;M<F;M++)for(q=b[M][H]/b[H][H],V=H;V<w;V++)b[M][V]=b[M][V]-q*b[H][V]}for(H=F-1;H>=0;H--){for(ae=0,M=H+1;M<=F-1;M++)ae+=ge[M]*b[H][M];ge[H]=(b[H][w-1]-ae)/b[H][H]}return ge},gauss_jordan:function(b,h){var w,T,N,V=a.aug(b,h),H=V.length,M=V[0].length,F=0;for(T=0;T<H;T++){var J=T;for(N=T+1;N<H;N++)j.abs(V[N][T])>j.abs(V[J][T])&&(J=N);var q=V[T];for(V[T]=V[J],V[J]=q,N=T+1;N<H;N++)for(F=V[N][T]/V[T][T],w=T;w<M;w++)V[N][w]-=V[T][w]*F}for(T=H-1;T>=0;T--){for(F=V[T][T],N=0;N<T;N++)for(w=M-1;w>T-1;w--)V[N][w]-=V[T][w]*V[N][T]/F;for(V[T][T]/=F,w=H;w<M;w++)V[T][w]/=F}return V},triaUpSolve:function(b,h){var w,T=b[0].length,N=a.zeros(1,T)[0],V=!1;return h[0].length!=null&&(h=h.map(function(H){return H[0]}),V=!0),a.arange(T-1,-1,-1).forEach(function(H){w=a.arange(H+1,T).map(function(M){return N[M]*b[H][M]}),N[H]=(h[H]-a.sum(w))/b[H][H]}),V?N.map(function(H){return[H]}):N},triaLowSolve:function(b,h){var w,T=b[0].length,N=a.zeros(1,T)[0],V=!1;return h[0].length!=null&&(h=h.map(function(H){return H[0]}),V=!0),a.arange(T).forEach(function(H){w=a.arange(H).map(function(M){return b[H][M]*N[M]}),N[H]=(h[H]-a.sum(w))/b[H][H]}),V?N.map(function(H){return[H]}):N},lu:function(b){var h,w=b.length,T=a.identity(w),N=a.zeros(b.length,b[0].length);return a.arange(w).forEach(function(V){N[0][V]=b[0][V]}),a.arange(1,w).forEach(function(V){a.arange(V).forEach(function(H){h=a.arange(H).map(function(M){return T[V][M]*N[M][H]}),T[V][H]=(b[V][H]-a.sum(h))/N[H][H]}),a.arange(V,w).forEach(function(H){h=a.arange(V).map(function(M){return T[V][M]*N[M][H]}),N[V][H]=b[h.length][H]-a.sum(h)})}),[T,N]},cholesky:function(b){var h,w=b.length,T=a.zeros(b.length,b[0].length);return a.arange(w).forEach(function(N){h=a.arange(N).map(function(V){return j.pow(T[N][V],2)}),T[N][N]=j.sqrt(b[N][N]-a.sum(h)),a.arange(N+1,w).forEach(function(V){h=a.arange(N).map(function(H){return T[N][H]*T[V][H]}),T[V][N]=(b[N][V]-a.sum(h))/T[N][N]})}),T},gauss_jacobi:function(b,h,w,T){for(var N,V,H,M,F=0,J=0,q=b.length,ae=[],ge=[],se=[];F<q;F++)for(ae[F]=[],ge[F]=[],se[F]=[],J=0;J<q;J++)F>J?(ae[F][J]=b[F][J],ge[F][J]=se[F][J]=0):F<J?(ge[F][J]=b[F][J],ae[F][J]=se[F][J]=0):(se[F][J]=b[F][J],ae[F][J]=ge[F][J]=0);for(H=a.multiply(a.multiply(a.inv(se),a.add(ae,ge)),-1),V=a.multiply(a.inv(se),h),N=w,M=a.add(a.multiply(H,w),V),F=2;j.abs(a.norm(a.subtract(M,N)))>T;)N=M,M=a.add(a.multiply(H,N),V),F++;return M},gauss_seidel:function(b,h,w,T){for(var N,V,H,M,F,J=0,q=b.length,ae=[],ge=[],se=[];J<q;J++)for(ae[J]=[],ge[J]=[],se[J]=[],N=0;N<q;N++)J>N?(ae[J][N]=b[J][N],ge[J][N]=se[J][N]=0):J<N?(ge[J][N]=b[J][N],ae[J][N]=se[J][N]=0):(se[J][N]=b[J][N],ae[J][N]=ge[J][N]=0);for(M=a.multiply(a.multiply(a.inv(a.add(se,ae)),ge),-1),H=a.multiply(a.inv(a.add(se,ae)),h),V=w,F=a.add(a.multiply(M,w),H),J=2;j.abs(a.norm(a.subtract(F,V)))>T;)V=F,F=a.add(a.multiply(M,V),H),J+=1;return F},SOR:function(b,h,w,T,N){for(var V,H,M,F,J,q=0,ae=b.length,ge=[],se=[],xe=[];q<ae;q++)for(ge[q]=[],se[q]=[],xe[q]=[],V=0;V<ae;V++)q>V?(ge[q][V]=b[q][V],se[q][V]=xe[q][V]=0):q<V?(se[q][V]=b[q][V],ge[q][V]=xe[q][V]=0):(xe[q][V]=b[q][V],ge[q][V]=se[q][V]=0);for(F=a.multiply(a.inv(a.add(xe,a.multiply(ge,N))),a.subtract(a.multiply(xe,1-N),a.multiply(se,N))),M=a.multiply(a.multiply(a.inv(a.add(xe,a.multiply(ge,N))),h),N),H=w,J=a.add(a.multiply(F,w),M),q=2;j.abs(a.norm(a.subtract(J,H)))>T;)H=J,J=a.add(a.multiply(F,H),M),q++;return J},householder:function(b){for(var h,w,T,N,V=b.length,H=b[0].length,M=0,F=[],J=[];M<V-1;M++){for(h=0,N=M+1;N<H;N++)h+=b[N][M]*b[N][M];for(h=(b[M+1][M]>0?-1:1)*j.sqrt(h),w=j.sqrt((h*h-b[M+1][M]*h)/2),(F=a.zeros(V,1))[M+1][0]=(b[M+1][M]-h)/(2*w),T=M+2;T<V;T++)F[T][0]=b[T][M]/(2*w);J=a.subtract(a.identity(V,H),a.multiply(a.multiply(F,a.transpose(F)),2)),b=a.multiply(J,a.multiply(b,J))}return b},QR:(R=a.sum,P=a.arange,function(b){var h,w,T,N=b.length,V=b[0].length,H=a.zeros(V,V);for(b=a.copy(b),w=0;w<V;w++){for(H[w][w]=j.sqrt(R(P(N).map(function(M){return b[M][w]*b[M][w]}))),h=0;h<N;h++)b[h][w]=b[h][w]/H[w][w];for(T=w+1;T<V;T++)for(H[w][T]=R(P(N).map(function(M){return b[M][w]*b[M][T]})),h=0;h<N;h++)b[h][T]=b[h][T]-b[h][w]*H[w][T]}return[b,H]}),lstsq:function(b,h){var w=!1;h[0].length===void 0&&(h=h.map(function(ae){return[ae]}),w=!0);var T=a.QR(b),N=T[0],V=T[1],H=b[0].length,M=a.slice(N,{col:{end:H}}),F=function(ae){var ge=(ae=a.copy(ae)).length,se=a.identity(ge);return a.arange(ge-1,-1,-1).forEach(function(xe){a.sliceAssign(se,{row:xe},a.divide(a.slice(se,{row:xe}),ae[xe][xe])),a.sliceAssign(ae,{row:xe},a.divide(a.slice(ae,{row:xe}),ae[xe][xe])),a.arange(xe).forEach(function(Le){var ve=a.multiply(ae[Le][xe],-1),ie=a.slice(ae,{row:Le}),Ye=a.multiply(a.slice(ae,{row:xe}),ve);a.sliceAssign(ae,{row:Le},a.add(ie,Ye));var Ge=a.slice(se,{row:Le}),Ue=a.multiply(a.slice(se,{row:xe}),ve);a.sliceAssign(se,{row:Le},a.add(Ge,Ue))})}),se}(a.slice(V,{row:{end:H}})),J=a.transpose(M);J[0].length===void 0&&(J=[J]);var q=a.multiply(a.multiply(F,J),h);return q.length===void 0&&(q=[[q]]),w?q.map(function(ae){return ae[0]}):q},jacobi:function(b){for(var h,w,T,N,V,H,M,F=1,J=b.length,q=a.identity(J,J),ae=[];F===1;){for(V=b[0][1],T=0,N=1,h=0;h<J;h++)for(w=0;w<J;w++)h!=w&&V<j.abs(b[h][w])&&(V=j.abs(b[h][w]),T=h,N=w);for(H=b[T][T]===b[N][N]?b[T][N]>0?j.PI/4:-j.PI/4:j.atan(2*b[T][N]/(b[T][T]-b[N][N]))/2,(M=a.identity(J,J))[T][T]=j.cos(H),M[T][N]=-j.sin(H),M[N][T]=j.sin(H),M[N][N]=j.cos(H),q=a.multiply(q,M),b=a.multiply(a.multiply(a.inv(M),b),M),F=0,h=1;h<J;h++)for(w=1;w<J;w++)h!=w&&j.abs(b[h][w])>.001&&(F=1)}for(h=0;h<J;h++)ae.push(b[h][h]);return[q,ae]},rungekutta:function(b,h,w,T,N,V){var H,M,F;if(V===2)for(;T<=w;)N+=((H=h*b(T,N))+(M=h*b(T+h,N+H)))/2,T+=h;if(V===4)for(;T<=w;)N+=((H=h*b(T,N))+2*(M=h*b(T+h/2,N+H/2))+2*(F=h*b(T+h/2,N+M/2))+h*b(T+h,N+F))/6,T+=h;return N},romberg:function(b,h,w,T){for(var N,V,H,M,F,J=0,q=(w-h)/2,ae=[],ge=[],se=[];J<T/2;){for(F=b(h),H=h,M=0;H<=w;H+=q,M++)ae[M]=H;for(N=ae.length,H=1;H<N-1;H++)F+=(H%2!=0?4:2)*b(ae[H]);F=q/3*(F+b(w)),se[J]=F,q/=2,J++}for(V=se.length,N=1;V!==1;){for(H=0;H<V-1;H++)ge[H]=(j.pow(4,N)*se[H+1]-se[H])/(j.pow(4,N)-1);V=ge.length,se=ge,ge=[],N++}return se},richardson:function(b,h,w,T){function N(xe,Le){for(var ve,ie=0,Ye=xe.length;ie<Ye;ie++)xe[ie]===Le&&(ve=ie);return ve}for(var V,H,M,F,J,q=j.abs(w-b[N(b,w)+1]),ae=0,ge=[],se=[];T>=q;)V=N(b,w+T),H=N(b,w),ge[ae]=(h[V]-2*h[H]+h[2*H-V])/(T*T),T/=2,ae++;for(F=ge.length,M=1;F!=1;){for(J=0;J<F-1;J++)se[J]=(j.pow(4,M)*ge[J+1]-ge[J])/(j.pow(4,M)-1);F=se.length,ge=se,se=[],M++}return ge},simpson:function(b,h,w,T){for(var N,V=(w-h)/T,H=b(h),M=[],F=h,J=0,q=1;F<=w;F+=V,J++)M[J]=F;for(N=M.length;q<N-1;q++)H+=(q%2!=0?4:2)*b(M[q]);return V/3*(H+b(w))},hermite:function(b,h,w,T){for(var N,V=b.length,H=0,M=0,F=[],J=[],q=[],ae=[];M<V;M++){for(F[M]=1,N=0;N<V;N++)M!=N&&(F[M]*=(T-b[N])/(b[M]-b[N]));for(J[M]=0,N=0;N<V;N++)M!=N&&(J[M]+=1/(b[M]-b[N]));q[M]=(1-2*(T-b[M])*J[M])*(F[M]*F[M]),ae[M]=(T-b[M])*(F[M]*F[M]),H+=q[M]*h[M]+ae[M]*w[M]}return H},lagrange:function(b,h,w){for(var T,N,V=0,H=0,M=b.length;H<M;H++){for(N=h[H],T=0;T<M;T++)H!=T&&(N*=(w-b[T])/(b[H]-b[T]));V+=N}return V},cubic_spline:function(b,h,w){for(var T,N,V=b.length,H=0,M=[],F=[],J=[],q=[],ae=[],ge=[];H<V-1;H++)q[H]=b[H+1]-b[H];for(J[0]=0,H=1;H<V-1;H++)J[H]=3/q[H]*(h[H+1]-h[H])-3/q[H-1]*(h[H]-h[H-1]);for(H=1;H<V-1;H++)M[H]=[],F[H]=[],M[H][H-1]=q[H-1],M[H][H]=2*(q[H-1]+q[H]),M[H][H+1]=q[H],F[H][0]=J[H];for(N=a.multiply(a.inv(M),F),T=0;T<V-1;T++)ae[T]=(h[T+1]-h[T])/q[T]-q[T]*(N[T+1][0]+2*N[T][0])/3,ge[T]=(N[T+1][0]-N[T][0])/(3*q[T]);for(T=0;T<V&&!(b[T]>w);T++);return h[T-=1]+(w-b[T])*ae[T]+a.sq(w-b[T])*N[T]+(w-b[T])*a.sq(w-b[T])*ge[T]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(b){var h,w,T,N,V,H=b.length,M=b[0].length,F=0,J=[],q=[],ae=[],ge=[],se=[],xe=[],Le=[];for(F=0;F<H;F++)J[F]=a.sum(b[F])/M;for(F=0;F<M;F++)for(se[F]=[],h=0;h<H;h++)se[F][h]=b[h][F]-J[h];for(se=a.transpose(se),F=0;F<H;F++)for(xe[F]=[],h=0;h<H;h++)xe[F][h]=a.dot([se[F]],[se[h]])/(M-1);for(V=(T=a.jacobi(xe))[0],q=T[1],Le=a.transpose(V),F=0;F<q.length;F++)for(h=F;h<q.length;h++)q[F]<q[h]&&(w=q[F],q[F]=q[h],q[h]=w,ae=Le[F],Le[F]=Le[h],Le[h]=ae);for(N=a.transpose(se),F=0;F<H;F++)for(ge[F]=[],h=0;h<N.length;h++)ge[F][h]=a.dot([Le[F]],[N[h]]);return[b,q,Le,ge]}}),function(b){for(var h=0;h<b.length;h++)(function(w){a.fn[w]=function(T,N){var V=this;return N?(setTimeout(function(){N.call(V,a.fn[w].call(V,T))},15),this):typeof a[w](this,T)=="number"?a[w](this,T):a(a[w](this,T))}})(b[h])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(c,Math),function(a,j){var R=[].slice,P=a.utils.isNumber,g=a.utils.isArray;function u(m,b,h,w){if(m>1||h>1||m<=0||h<=0)throw new Error("Proportions should be greater than 0 and less than 1");var T=(m*b+h*w)/(b+w);return(m-h)/j.sqrt(T*(1-T)*(1/b+1/w))}a.extend({zscore:function(){var m=R.call(arguments);return P(m[1])?(m[0]-m[1])/m[2]:(m[0]-a.mean(m[1]))/a.stdev(m[1],m[2])},ztest:function(){var m,b=R.call(arguments);return g(b[1])?(m=a.zscore(b[0],b[1],b[3]),b[2]===1?a.normal.cdf(-j.abs(m),0,1):2*a.normal.cdf(-j.abs(m),0,1)):b.length>2?(m=a.zscore(b[0],b[1],b[2]),b[3]===1?a.normal.cdf(-j.abs(m),0,1):2*a.normal.cdf(-j.abs(m),0,1)):(m=b[0],b[1]===1?a.normal.cdf(-j.abs(m),0,1):2*a.normal.cdf(-j.abs(m),0,1))}}),a.extend(a.fn,{zscore:function(m,b){return(m-this.mean())/this.stdev(b)},ztest:function(m,b,h){var w=j.abs(this.zscore(m,h));return b===1?a.normal.cdf(-w,0,1):2*a.normal.cdf(-w,0,1)}}),a.extend({tscore:function(){var m=R.call(arguments);return m.length===4?(m[0]-m[1])/(m[2]/j.sqrt(m[3])):(m[0]-a.mean(m[1]))/(a.stdev(m[1],!0)/j.sqrt(m[1].length))},ttest:function(){var m,b=R.call(arguments);return b.length===5?(m=j.abs(a.tscore(b[0],b[1],b[2],b[3])),b[4]===1?a.studentt.cdf(-m,b[3]-1):2*a.studentt.cdf(-m,b[3]-1)):P(b[1])?(m=j.abs(b[0]),b[2]==1?a.studentt.cdf(-m,b[1]-1):2*a.studentt.cdf(-m,b[1]-1)):(m=j.abs(a.tscore(b[0],b[1])),b[2]==1?a.studentt.cdf(-m,b[1].length-1):2*a.studentt.cdf(-m,b[1].length-1))}}),a.extend(a.fn,{tscore:function(m){return(m-this.mean())/(this.stdev(!0)/j.sqrt(this.cols()))},ttest:function(m,b){return b===1?1-a.studentt.cdf(j.abs(this.tscore(m)),this.cols()-1):2*a.studentt.cdf(-j.abs(this.tscore(m)),this.cols()-1)}}),a.extend({anovafscore:function(){var m,b,h,w,T,N,V,H,M=R.call(arguments);if(M.length===1){for(T=new Array(M[0].length),V=0;V<M[0].length;V++)T[V]=M[0][V];M=T}for(b=new Array,V=0;V<M.length;V++)b=b.concat(M[V]);for(h=a.mean(b),m=0,V=0;V<M.length;V++)m+=M[V].length*j.pow(a.mean(M[V])-h,2);for(m/=M.length-1,N=0,V=0;V<M.length;V++)for(w=a.mean(M[V]),H=0;H<M[V].length;H++)N+=j.pow(M[V][H]-w,2);return m/(N/(b.length-M.length))},anovaftest:function(){var m,b,h,w,T=R.call(arguments);if(P(T[0]))return 1-a.centralF.cdf(T[0],T[1],T[2]);var N=a.anovafscore(T);for(m=T.length-1,h=0,w=0;w<T.length;w++)h+=T[w].length;return b=h-m-1,1-a.centralF.cdf(N,m,b)},ftest:function(m,b,h){return 1-a.centralF.cdf(m,b,h)}}),a.extend(a.fn,{anovafscore:function(){return a.anovafscore(this.toArray())},anovaftes:function(){var m,b=0;for(m=0;m<this.length;m++)b+=this[m].length;return a.ftest(this.anovafscore(),this.length-1,b-this.length)}}),a.extend({qscore:function(){var m,b,h,w,T,N=R.call(arguments);return P(N[0])?(m=N[0],b=N[1],h=N[2],w=N[3],T=N[4]):(m=a.mean(N[0]),b=a.mean(N[1]),h=N[0].length,w=N[1].length,T=N[2]),j.abs(m-b)/(T*j.sqrt((1/h+1/w)/2))},qtest:function(){var m,b=R.call(arguments);b.length===3?(m=b[0],b=b.slice(1)):b.length===7?(m=a.qscore(b[0],b[1],b[2],b[3],b[4]),b=b.slice(5)):(m=a.qscore(b[0],b[1],b[2]),b=b.slice(3));var h=b[0],w=b[1];return 1-a.tukey.cdf(m,w,h-w)},tukeyhsd:function(m){for(var b=a.pooledstdev(m),h=m.map(function(M){return a.mean(M)}),w=m.reduce(function(M,F){return M+F.length},0),T=[],N=0;N<m.length;++N)for(var V=N+1;V<m.length;++V){var H=a.qtest(h[N],h[V],m[N].length,m[V].length,b,w,m.length);T.push([[N,V],H])}return T}}),a.extend({normalci:function(){var m,b=R.call(arguments),h=new Array(2);return m=b.length===4?j.abs(a.normal.inv(b[1]/2,0,1)*b[2]/j.sqrt(b[3])):j.abs(a.normal.inv(b[1]/2,0,1)*a.stdev(b[2])/j.sqrt(b[2].length)),h[0]=b[0]-m,h[1]=b[0]+m,h},tci:function(){var m,b=R.call(arguments),h=new Array(2);return m=b.length===4?j.abs(a.studentt.inv(b[1]/2,b[3]-1)*b[2]/j.sqrt(b[3])):j.abs(a.studentt.inv(b[1]/2,b[2].length-1)*a.stdev(b[2],!0)/j.sqrt(b[2].length)),h[0]=b[0]-m,h[1]=b[0]+m,h},significant:function(m,b){return m<b}}),a.extend(a.fn,{normalci:function(m,b){return a.normalci(m,b,this.toArray())},tci:function(m,b){return a.tci(m,b,this.toArray())}}),a.extend(a.fn,{oneSidedDifferenceOfProportions:function(m,b,h,w){var T=u(m,b,h,w);return a.ztest(T,1)},twoSidedDifferenceOfProportions:function(m,b,h,w){var T=u(m,b,h,w);return a.ztest(T,2)}})}(c,Math),c.models=function(){function a(j,R){var P=j.length,g=R[0].length-1,u=P-g-1,m=c.lstsq(R,j),b=c.multiply(R,m.map(function(H){return[H]})).map(function(H){return H[0]}),h=c.subtract(j,b),w=c.mean(j),T=c.sum(b.map(function(H){return Math.pow(H-w,2)})),N=c.sum(j.map(function(H,M){return Math.pow(H-b[M],2)})),V=T+N;return{exog:R,endog:j,nobs:P,df_model:g,df_resid:u,coef:m,predict:b,resid:h,ybar:w,SST:V,SSE:T,SSR:N,R2:T/V}}return{ols:function(j,R){var P=a(j,R),g=function(b){var h,w,T=(h=b.exog,w=h[0].length,c.arange(w).map(function(q){var ae=c.arange(w).filter(function(ge){return ge!==q});return a(c.col(h,q).map(function(ge){return ge[0]}),c.col(h,ae))})),N=Math.sqrt(b.SSR/b.df_resid),V=T.map(function(q){var ae=q.SST,ge=q.R2;return N/Math.sqrt(ae*(1-ge))}),H=b.coef.map(function(q,ae){return(q-0)/V[ae]}),M=H.map(function(q){var ae=c.studentt.cdf(q,b.df_resid);return 2*(ae>.5?1-ae:ae)}),F=c.studentt.inv(.975,b.df_resid),J=b.coef.map(function(q,ae){var ge=F*V[ae];return[q-ge,q+ge]});return{se:V,t:H,p:M,sigmaHat:N,interval95:J}}(P),u=function(b){var h,w,T,N=b.R2/b.df_model/((1-b.R2)/b.df_resid);return{F_statistic:N,pvalue:1-(h=N,w=b.df_model,T=b.df_resid,c.beta.cdf(h/(T/w+h),w/2,T/2))}}(P),m=1-(1-P.R2)*((P.nobs-1)/P.df_resid);return P.t=g,P.f=u,P.adjust_R2=m,P}}}(),c.extend({buildxmatrix:function(){for(var a=new Array(arguments.length),j=0;j<arguments.length;j++)a[j]=[1].concat(arguments[j]);return c(a)},builddxmatrix:function(){for(var a=new Array(arguments[0].length),j=0;j<arguments[0].length;j++)a[j]=[1].concat(arguments[0][j]);return c(a)},buildjxmatrix:function(a){for(var j=new Array(a.length),R=0;R<a.length;R++)j[R]=a[R];return c.builddxmatrix(j)},buildymatrix:function(a){return c(a).transpose()},buildjymatrix:function(a){return a.transpose()},matrixmult:function(a,j){var R,P,g,u,m;if(a.cols()==j.rows()){if(j.rows()>1){for(u=[],R=0;R<a.rows();R++)for(u[R]=[],P=0;P<j.cols();P++){for(m=0,g=0;g<a.cols();g++)m+=a.toArray()[R][g]*j.toArray()[g][P];u[R][P]=m}return c(u)}for(u=[],R=0;R<a.rows();R++)for(u[R]=[],P=0;P<j.cols();P++){for(m=0,g=0;g<a.cols();g++)m+=a.toArray()[R][g]*j.toArray()[P];u[R][P]=m}return c(u)}},regress:function(a,j){var R=c.xtranspxinv(a),P=a.transpose(),g=c.matrixmult(c(R),P);return c.matrixmult(g,j)},regresst:function(a,j,R){var P=c.regress(a,j),g={anova:{}},u=c.jMatYBar(a,P);g.yBar=u;var m=j.mean();g.anova.residuals=c.residuals(j,u),g.anova.ssr=c.ssr(u,m),g.anova.msr=g.anova.ssr/(a[0].length-1),g.anova.sse=c.sse(j,u),g.anova.mse=g.anova.sse/(j.length-(a[0].length-1)-1),g.anova.sst=c.sst(j,m),g.anova.mst=g.anova.sst/(j.length-1),g.anova.r2=1-g.anova.sse/g.anova.sst,g.anova.r2<0&&(g.anova.r2=0),g.anova.fratio=g.anova.msr/g.anova.mse,g.anova.pvalue=c.anovaftest(g.anova.fratio,a[0].length-1,j.length-(a[0].length-1)-1),g.anova.rmse=Math.sqrt(g.anova.mse),g.anova.r2adj=1-g.anova.mse/g.anova.mst,g.anova.r2adj<0&&(g.anova.r2adj=0),g.stats=new Array(a[0].length);for(var b,h,w,T=c.xtranspxinv(a),N=0;N<P.length;N++)b=Math.sqrt(g.anova.mse*Math.abs(T[N][N])),h=Math.abs(P[N]/b),w=c.ttest(h,j.length-a[0].length-1,R),g.stats[N]=[P[N],b,h,w];return g.regress=P,g},xtranspx:function(a){return c.matrixmult(a.transpose(),a)},xtranspxinv:function(a){var j=c.matrixmult(a.transpose(),a);return c.inv(j)},jMatYBar:function(a,j){var R=c.matrixmult(a,j);return new c(R)},residuals:function(a,j){return c.matrixsubtract(a,j)},ssr:function(a,j){for(var R=0,P=0;P<a.length;P++)R+=Math.pow(a[P]-j,2);return R},sse:function(a,j){for(var R=0,P=0;P<a.length;P++)R+=Math.pow(a[P]-j[P],2);return R},sst:function(a,j){for(var R=0,P=0;P<a.length;P++)R+=Math.pow(a[P]-j,2);return R},matrixsubtract:function(a,j){for(var R=new Array(a.length),P=0;P<a.length;P++){R[P]=new Array(a[P].length);for(var g=0;g<a[P].length;g++)R[P][g]=a[P][g]-j[P][g]}return c(R)}}),c.jStat=c,c)},960:function(Y,c,a){const j=a(592);Y.exports=function(R){function P(N,V){const H=V.split(".");let M=N;for(const F of H){if(M==null)return;M=M[F]}return M}for(let N=0;N<Object.keys(j).length;N++){let V,H=Object.keys(j)[N],M=[];if(typeof j[H]=="object"){M=Object.keys(j[H]),V=Object.values(j[H]);for(let F=0;F<V.length;F++)if(typeof V[F]=="object"){let J=M[F];j[H][J]&&(M=[...M,...Object.keys(j[H][J]).map(q=>J+"."+q)],M.splice(M.indexOf(J),1))}}if(M.length<1)R[H]=j[H];else for(let F=0;F<M.length;F++)typeof P(j[H],M[F])=="function"&&(R[H]=P(j[H],M[F]))}let g=function(N){return typeof N=="number"&&(N=parseInt(N)),N},u=null,m=null,b=null;R.TABLE=function(){return b},R.COLUMN=R.COL=function(){return b.tracking&&b.tracking.push(T.getColumnNameFromCoords(g(u),g(m))),g(u)+1},R.ROW=function(){return b.tracking&&b.tracking.push(T.getColumnNameFromCoords(g(u),g(m))),g(m)+1},R.CELL=function(){return T.getColumnNameFromCoords(u,m)},R.VALUE=function(N,V,H){return b.getValueFromCoords(g(N)-1,g(V)-1,H)},R.THISROWCELL=function(N){return b.getValueFromCoords(g(N)-1,g(m))};const h=function(N,V){for(let H=0;H<N.length;H++){let M=T.getTokensFromRange(N[H]);V=V.replace(N[H],"["+M.join(",")+"]")}return V},w=function(N){return typeof N=="string"&&(N=N.trim()),!isNaN(N)&&N!==null&&N!==""},T=function(N,V,H,M,F){b=F,u=H,m=M;let J="",q={};if(V)if(V.size){let se,xe=null;V.forEach(function(Le,ve){se=ve.replace(/!/g,"."),se.indexOf(".")!==-1&&(se=se.split("."),q[se[0]]=!0)}),se=Object.keys(q);for(let Le=0;Le<se.length;Le++)J+="var "+se[Le]+" = {};";V.forEach(function(Le,ve){se=ve.replace(/!/g,"."),Le===null||w(Le)||(xe=Le.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),xe&&xe.length&&(Le=updateRanges(xe,Le))),se.indexOf(".")>0?J+=se+" = "+V.get(ve)+`;
`:J+="var "+se+" = "+Le+`;
`})}else{let se=Object.keys(V);if(se.length){let xe,Le={};for(let ve=0;ve<se.length;ve++)if(xe=se[ve].replace(/\!/g,"."),xe.indexOf(".")>0){let ie=ie.split(".");Le[ie[0]]={}}xe=Object.keys(Le);for(let ve=0;ve<xe.length;ve++)J+="var "+xe[ve]+" = {};";for(let ve=0;ve<se.length;ve++){if(xe=se[ve].replace(/!/g,"."),V[se[ve]]!==null&&!w(V[se[ve]])){let ie=V[se[ve]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ie&&ie.length&&(V[se[ve]]=h(ie,V[se[ve]]))}xe.indexOf(".")>0?J+=xe+" = "+V[se[ve]]+`;
`:J+="var "+xe+" = "+V[se[ve]]+`;
`}}}let ae=(N=function(se,xe){let Le="",ve=0,ie=["=","!",">","<"];for(let Ye=0;Ye<se.length;Ye++)se[Ye]==='"'&&(ve=ve===0?1:0),ve===1?Le+=se[Ye]:(Le+=se[Ye].toUpperCase(),Ye>0&&se[Ye]==="="&&ie.indexOf(se[Ye-1])===-1&&ie.indexOf(se[Ye+1])===-1&&(Le+="="));return Le=Le.replace(/\^/g,"**"),Le=Le.replace(/<>/g,"!="),Le=Le.replace(/&/g,"+"),Le=Le.replace(/\$/g,""),Le}(N=(N=N.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ae&&ae.length&&(N=h(ae,N));let ge=new Function(J+"; return "+N)();return ge===null&&(ge=0),ge};return T.getColumnNameFromCoords=function(N,V){return M="",(H=parseInt(N))>701?(M+=String.fromCharCode(64+parseInt(H/676)),M+=String.fromCharCode(64+parseInt(H%676/26))):H>25&&(M+=String.fromCharCode(64+parseInt(H/26))),M+String.fromCharCode(65+H%26)+(parseInt(V)+1);var H,M},T.getCoordsFromColumnName=function(N){var V=/^[a-zA-Z]+/.exec(N);if(V){for(var H=0,M=0;M<V[0].length;M++)H+=parseInt(V[0].charCodeAt(M)-64)*Math.pow(26,V[0].length-1-M);--H<0&&(H=0);var F=parseInt(/[0-9]+$/.exec(N))||null;return F>0&&F--,[H,F]}},T.getRangeFromTokens=function(N){N=N.filter(function(F){return F!="#REF!"});for(var V="",H="",M=0;M<N.length;M++)N[M].indexOf(".")>=0?V=".":N[M].indexOf("!")>=0&&(V="!"),V&&(H=N[M].split(V),N[M]=H[1],H=H[0]+V);return N.sort(function(F,J){var q=Helpers.getCoordsFromColumnName(F),ae=Helpers.getCoordsFromColumnName(J);return q[1]>ae[1]?1:q[1]<ae[1]?-1:q[0]>ae[0]?1:q[0]<ae[0]?-1:0}),N.length?H+(N[0]+":")+N[N.length-1]:"#REF!"},T.getTokensFromRange=function(N){if(N.indexOf(".")>0){var V=N.split(".");N=V[1],V=V[0]+"."}else N.indexOf("!")>0?(V=N.split("!"),N=V[1],V=V[0]+"!"):V="";N=N.split(":");var H=T.getCoordsFromColumnName(N[0]),M=T.getCoordsFromColumnName(N[1]);if(H[0]<=M[0])var F=H[0],J=M[0];else F=M[0],J=H[0];if(H[1]===null&&M[1]==null)for(var q=null,ae=null,ge=Object.keys(vars),se=0;se<ge.length;se++){var xe=T.getCoordsFromColumnName(ge[se]);xe[0]===H[0]&&(q===null||xe[1]<q)&&(q=xe[1]),xe[0]===M[0]&&(ae===null||xe[1]>ae)&&(ae=xe[1])}else H[1]<=M[1]?(q=H[1],ae=M[1]):(q=M[1],ae=H[1]);for(var Le=[],ve=q;ve<=ae;ve++){var ie=[];for(se=F;se<=J;se++)ie.push(V+T.getColumnNameFromCoords(se,ve));Le.push(ie)}return Le},T.setFormula=function(N){let V=Object.keys(N);for(let H=0;H<V.length;H++)typeof N[V[H]]=="function"&&(R[V[H]]=N[V[H]])},T.basic=!0,T}(typeof window=="undefined"?a.g:window)},592:function(Y,c,a){"use strict";var j=a(162),R=a(765);const P=new Error("#NULL!"),g=new Error("#DIV/0!"),u=new Error("#VALUE!"),m=new Error("#REF!"),b=new Error("#NAME?"),h=new Error("#NUM!"),w=new Error("#N/A"),T=new Error("#ERROR!"),N=new Error("#GETTING_DATA");var V=Object.freeze({__proto__:null,data:N,div0:g,error:T,na:w,name:b,nil:P,num:h,ref:m,value:u});function H(e){const t=[];return M(e,r=>{t.push(r)}),t}function M(e,t){let r=-1;const p=e.length;for(;++r<p&&t(e[r],r,e)!==!1;);return e}function F(e){let t,r=e.length;for(;r--;)if(t=e[r],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const p=U(t);e[r]=p instanceof Error?0:p}}else e[r]=0;else e[r]=1;return e}function J(e,t){if(!e)return u;e.every(L=>Array.isArray(L))&&e.length!==0||(e=[[...e]]),e.map((L,B)=>{L.map((z,ne)=>{z||(e[B][ne]=0)})});const r=e.reduce((L,B,z)=>B.length>e[L].length?z:L,0),p=e[r].length;return e.map(L=>[...L,...Array(p-L.length).fill(t||0)])}function q(){let e;if(arguments.length===1){const r=arguments[0];e=(t=r)!=null&&typeof t.length=="number"&&typeof t!="string"?H.apply(null,arguments):[r]}else e=Array.from(arguments);for(var t;!ge(e);)e=ae(e);return e}function ae(e){return e&&e.reduce?e.reduce((t,r)=>{const p=Array.isArray(t),L=Array.isArray(r);return p&&L?t.concat(r):p?(t.push(r),t):L?[t].concat(r):[t,r]}):[e]}function ge(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function se(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function xe(e){return e?e[0].map((t,r)=>e.map(p=>p[r])):u}function Le(e,t){let r=null;return M(e,(p,L)=>{if(p[0]===t)return r=L,!1}),r==null?u:r}function ve(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function ie(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function Ye(e){return Math.round(e*1e14)/1e14}function Ge(){return q.apply(null,arguments).filter(e=>typeof e=="number")}function Ue(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||u}function Be(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?h:function(r){r<60&&(r+=1);const p=Math.floor(r-25569),L=new Date(86400*p*1e3),B=r-Math.floor(r)+1e-7;let z=Math.floor(86400*B);const ne=z%60;z-=ne;const fe=Math.floor(z/3600),we=Math.floor(z/60)%60;let Fe=L.getUTCDate(),Ve=L.getUTCMonth();return r>=60&&r<61&&(Fe=29,Ve=1),new Date(L.getUTCFullYear(),Ve,Fe,fe,we,ne)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?u:e}function lt(e){let t,r=e.length;for(;r--;){if(t=Be(e[r]),t===u)return t;e[r]=t}return e}function U(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?u:parseFloat(e))}function Me(e){let t,r;if(!e||(t=e.length)===0)return u;for(;t--;){if(e[t]instanceof Error)return e[t];if(r=U(e[t]),r instanceof Error)return r;e[t]=r}return e}function ze(e){return e instanceof Error?e:e==null?"":e.toString()}function Se(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function De(e){return e!=null}const Oe="=",Pe=[">",">=","<","<=","=","<>"],Ke="operator",Je="literal",ut=[Ke,Je],ft=Ke,ct=Je;function ht(e,t){if(ut.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function vt(e){return function(t){let r="";const p=[];for(let L=0;L<t.length;L++){const B=t[L];L===0&&Pe.indexOf(B)>=0?p.push(ht(B,ft)):r+=B}return r.length>0&&p.push(ht(function(L){return typeof L!="string"||/^\d+(\.\d+)?$/.test(L)&&(L=L.indexOf(".")===-1?parseInt(L,10):parseFloat(L)),L}(r),ct)),p.length>0&&p[0].type!==ft&&p.unshift(ht(Oe,ft)),p}(function(t){const r=t.length,p=[];let L=0,B="",z="";for(;L<r;){const ne=t.charAt(L);switch(ne){case">":case"<":case"=":z+=ne,B.length>0&&(p.push(B),B="");break;default:z.length>0&&(p.push(z),z=""),B+=ne}L++}return B.length>0&&p.push(B),z.length>0&&p.push(z),p}(e))}const mt=function(e){const t=[];let r;for(let p=0;p<e.length;p++){const L=e[p];switch(L.type){case ft:r=L.value;break;case ct:t.push(L.value)}}return function(p,L){let B=!1;switch(L){case">":B=p[0]>p[1];break;case">=":B=p[0]>=p[1];break;case"<":B=p[0]<p[1];break;case"<=":B=p[0]<=p[1];break;case"=":B=p[0]==p[1];break;case"<>":B=p[0]!=p[1]}return B}(t,r)},St={};function gt(e){return[u,m,g,h,b,P].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function Nt(e){return gt(e)||e===w}function Ft(e){return e===!0||e===!1}function v(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function C(e){return typeof e=="string"}function l(){const e=[];for(let t=0;t<arguments.length;++t){let r=!1;const p=arguments[t];for(let L=0;L<e.length&&(r=e[L]===p,!r);++L);r||e.push(p)}return e}function o(e,t,r,p){if(!t||!r)return w;p=!(p===0||p===!1);let L=w;const B=typeof e=="number";let z=!1;for(let ne=0;ne<t.length;ne++){const fe=t[ne];if(fe[0]===e){L=r<fe.length+1?fe[r-1]:m;break}!z&&(B&&p&&fe[0]<=e||p&&typeof fe[0]=="string"&&fe[0].localeCompare(e)<0)&&(L=r<fe.length+1?fe[r-1]:m),B&&fe[0]>e&&(z=!0)}return L}function k(){const e=q(arguments).filter(De);if(e.length===0)return g;const t=ve.apply(void 0,e);if(t)return t;const r=Ge(e),p=r.length;let L,B=0,z=0;for(let ne=0;ne<p;ne++)B+=r[ne],z+=1;return L=B/z,isNaN(L)&&(L=h),L}function Q(){const e=q(arguments).filter(De);if(e.length===0)return g;const t=ve.apply(void 0,e);if(t)return t;const r=e,p=r.length;let L,B=0,z=0;for(let ne=0;ne<p;ne++){const fe=r[ne];typeof fe=="number"&&(B+=fe),fe===!0&&B++,fe!==null&&z++}return L=B/z,isNaN(L)&&(L=h),L}St.TYPE=e=>{switch(e){case P:return 1;case g:return 2;case u:return 3;case m:return 4;case b:return 5;case h:return 6;case w:return 7;case N:return 8}return w};const te={DIST:function(e,t,r,p,L,B){return arguments.length<4?u:(L=L===void 0?0:L,B=B===void 0?1:B,ie(e=U(e),t=U(t),r=U(r),L=U(L),B=U(B))?u:(e=(e-L)/(B-L),p?j.beta.cdf(e,t,r):j.beta.pdf(e,t,r)))},INV:(e,t,r,p,L)=>(p=p===void 0?0:p,L=L===void 0?1:L,ie(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L))?u:j.beta.inv(e,t,r)*(L-p)+p)},O={DIST:(e,t,r,p)=>ie(e=U(e),t=U(t),r=U(r),p=U(p))?u:p?j.binomial.cdf(e,t,r):j.binomial.pdf(e,t,r)};O.DIST.RANGE=(e,t,r,p)=>{if(p=p===void 0?r:p,ie(e=U(e),t=U(t),r=U(r),p=U(p)))return u;let L=0;for(let B=r;B<=p;B++)L+=et(e,B)*Math.pow(t,B)*Math.pow(1-t,e-B);return L},O.INV=(e,t,r)=>{if(ie(e=U(e),t=U(t),r=U(r)))return u;let p=0;for(;p<=e;){if(j.binomial.cdf(p,e,t)>=r)return p;p++}};const I={DIST:(e,t,r)=>ie(e=U(e),t=U(t))?u:r?j.chisquare.cdf(e,t):j.chisquare.pdf(e,t)};I.DIST.RT=(e,t)=>!e|!t?w:e<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?u:1-j.chisquare.cdf(e,t),I.INV=(e,t)=>ie(e=U(e),t=U(t))?u:j.chisquare.inv(e,t),I.INV.RT=(e,t)=>!e|!t?w:e<0||e>1||t<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?u:j.chisquare.inv(1-e,t),I.TEST=function(e,t){if(arguments.length!==2)return w;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return u;const r=e.length;let p,L,B;for(L=0;L<r;L++)e[L]instanceof Array||(p=e[L],e[L]=[],e[L].push(p)),t[L]instanceof Array||(p=t[L],t[L]=[],t[L].push(p));const z=e[0].length,ne=z===1?r-1:(r-1)*(z-1);let fe=0;const we=Math.PI;for(L=0;L<r;L++)for(B=0;B<z;B++)fe+=Math.pow(e[L][B]-t[L][B],2)/t[L][B];return Math.round(1e6*function(Fe,Ve){let Re=Math.exp(-.5*Fe);Ve%2==1&&(Re*=Math.sqrt(2*Fe/we));let We=Ve;for(;We>=2;)Re=Re*Fe/We,We-=2;let tt=Re,ot=Ve;for(;tt>1e-10*Re;)ot+=2,tt=tt*Fe/ot,Re+=tt;return 1-Re}(fe,ne))/1e6};const _={};function W(){return Ge(q(arguments)).length}function oe(){const e=q(arguments);return e.length-be(e)}function be(){const e=q(arguments);let t,r=0;for(let p=0;p<e.length;p++)t=e[p],t!=null&&t!==""||r++;return r}_.NORM=(e,t,r)=>ie(e=U(e),t=U(t),r=U(r))?u:j.normalci(1,e,t,r)[1]-1,_.T=(e,t,r)=>ie(e=U(e),t=U(t),r=U(r))?u:j.tci(1,e,t,r)[1]-1;const ue={P:(e,t)=>{if(ie(e=Me(q(e)),t=Me(q(t))))return u;const r=j.mean(e),p=j.mean(t);let L=0;const B=e.length;for(let z=0;z<B;z++)L+=(e[z]-r)*(t[z]-p);return L/B},S:(e,t)=>ie(e=Me(q(e)),t=Me(q(t)))?u:j.covariance(e,t)},pe={DIST:(e,t,r)=>ie(e=U(e),t=U(t))?u:r?j.exponential.cdf(e,t):j.exponential.pdf(e,t)},le={};function je(e,t,r){if(ie(e=U(e),t=Me(q(t)),r=Me(q(r))))return u;const p=j.mean(r),L=j.mean(t),B=r.length;let z=0,ne=0;for(let we=0;we<B;we++)z+=(r[we]-p)*(t[we]-L),ne+=Math.pow(r[we]-p,2);const fe=z/ne;return L-fe*p+fe*e}function Ce(e){return(e=U(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?h:j.gammafn(e)}function qe(e){return(e=U(e))instanceof Error?e:j.gammaln(e)}le.DIST=(e,t,r,p)=>ie(e=U(e),t=U(t),r=U(r))?u:p?j.centralF.cdf(e,t,r):j.centralF.pdf(e,t,r),le.DIST.RT=function(e,t,r){return arguments.length!==3?w:e<0||t<1||r<1?h:typeof e!="number"||typeof t!="number"||typeof r!="number"?u:1-j.centralF.cdf(e,t,r)},le.INV=(e,t,r)=>ie(e=U(e),t=U(t),r=U(r))?u:e<=0||e>1?h:j.centralF.inv(e,t,r),le.INV.RT=function(e,t,r){return arguments.length!==3?w:e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"||typeof r!="number"?u:j.centralF.inv(1-e,t,r)},le.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return w;if(e.length<2||t.length<2)return g;const r=(B,z)=>{let ne=0;for(let fe=0;fe<B.length;fe++)ne+=Math.pow(B[fe]-z,2);return ne},p=At(e)/e.length,L=At(t)/t.length;return r(e,p)/(e.length-1)/(r(t,L)/(t.length-1))},Ce.DIST=function(e,t,r,p){return arguments.length!==4?w:e<0||t<=0||r<=0||typeof e!="number"||typeof t!="number"||typeof r!="number"?u:p?j.gamma.cdf(e,t,r,!0):j.gamma.pdf(e,t,r,!1)},Ce.INV=function(e,t,r){return arguments.length!==3?w:e<0||e>1||t<=0||r<=0?h:typeof e!="number"||typeof t!="number"||typeof r!="number"?u:j.gamma.inv(e,t,r)},qe.PRECISE=function(e){return arguments.length!==1?w:e<=0?h:typeof e!="number"?u:j.gammaln(e)};const Ze={};function he(e,t){return ie(e=Me(q(e)),t=U(t))?e:t<0||e.length<t?u:e.sort((r,p)=>p-r)[t-1]}function Ee(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return u;const r=j.mean(e),p=j.mean(t),L=t.length;let B=0,z=0;for(let fe=0;fe<L;fe++)B+=(t[fe]-p)*(e[fe]-r),z+=Math.pow(t[fe]-p,2);const ne=B/z;return[ne,r-ne*p]}Ze.DIST=(e,t,r,p,L)=>{if(ie(e=U(e),t=U(t),r=U(r),p=U(p)))return u;function B(z,ne,fe,we){return et(fe,z)*et(we-fe,ne-z)/et(we,ne)}return L?function(z,ne,fe,we){let Fe=0;for(let Ve=0;Ve<=z;Ve++)Fe+=B(Ve,ne,fe,we);return Fe}(e,t,r,p):B(e,t,r,p)};const G={};function X(){const e=q(arguments),t=ve.apply(void 0,e);if(t)return t;const r=Ge(e);return r.length===0?0:Math.max.apply(Math,r)}function re(){const e=q(arguments),t=ve.apply(void 0,e);if(t)return t;const r=F(e);let p=j.median(r);return isNaN(p)&&(p=h),p}function A(){const e=q(arguments),t=ve.apply(void 0,e);if(t)return t;const r=Ge(e);return r.length===0?0:Math.min.apply(Math,r)}G.DIST=(e,t,r,p)=>ie(e=U(e),t=U(t),r=U(r))?u:p?j.lognormal.cdf(e,t,r):j.lognormal.pdf(e,t,r),G.INV=(e,t,r)=>ie(e=U(e),t=U(t),r=U(r))?u:j.lognormal.inv(e,t,r);const S={MULT:function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=e.length,r={};let p,L=[],B=0;for(let z=0;z<t;z++)p=e[z],r[p]=r[p]?r[p]+1:1,r[p]>B&&(B=r[p],L=[]),r[p]===B&&(L[L.length]=p);return L},SNGL:function(){const e=Me(q(arguments));return e instanceof Error?e:S.MULT(e).sort((t,r)=>t-r)[0]}},Z={DIST:(e,t,r,p)=>ie(e=U(e),t=U(t),r=U(r))?u:p?j.negbin.cdf(e,t,r):j.negbin.pdf(e,t,r)},ce={};function de(e,t){if(ie(t=Me(q(t)),e=Me(q(e))))return u;const r=j.mean(e),p=j.mean(t),L=e.length;let B=0,z=0,ne=0;for(let fe=0;fe<L;fe++)B+=(e[fe]-r)*(t[fe]-p),z+=Math.pow(e[fe]-r,2),ne+=Math.pow(t[fe]-p,2);return B/Math.sqrt(z*ne)}ce.DIST=(e,t,r,p)=>ie(e=U(e),t=U(t),r=U(r))?u:r<=0?h:p?j.normal.cdf(e,t,r):j.normal.pdf(e,t,r),ce.INV=(e,t,r)=>ie(e=U(e),t=U(t),r=U(r))?u:j.normal.inv(e,t,r),ce.S={},ce.S.DIST=(e,t)=>(e=U(e))instanceof Error?u:t?j.normal.cdf(e,0,1):j.normal.pdf(e,0,1),ce.S.INV=e=>(e=U(e))instanceof Error?u:j.normal.inv(e,0,1);const K={EXC:(e,t)=>{if(ie(e=Me(q(e)),t=U(t)))return u;const r=(e=e.sort((B,z)=>B-z)).length;if(t<1/(r+1)||t>1-1/(r+1))return h;const p=t*(r+1)-1,L=Math.floor(p);return Ye(p===L?e[p]:e[L]+(p-L)*(e[L+1]-e[L]))},INC:(e,t)=>{if(ie(e=Me(q(e)),t=U(t)))return u;const r=t*((e=e.sort((L,B)=>L-B)).length-1),p=Math.floor(r);return Ye(r===p?e[r]:e[p]+(r-p)*(e[p+1]-e[p]))}},ye={EXC:(e,t,r)=>{if(r=r===void 0?3:r,ie(e=Me(q(e)),t=U(t),r=U(r)))return u;e=e.sort((Fe,Ve)=>Fe-Ve);const p=l.apply(null,e),L=e.length,B=p.length,z=Math.pow(10,r);let ne=0,fe=!1,we=0;for(;!fe&&we<B;)t===p[we]?(ne=(e.indexOf(p[we])+1)/(L+1),fe=!0):t>=p[we]&&(t<p[we+1]||we===B-1)&&(ne=(e.indexOf(p[we])+1+(t-p[we])/(p[we+1]-p[we]))/(L+1),fe=!0),we++;return Math.floor(ne*z)/z},INC:(e,t,r)=>{if(r=r===void 0?3:r,ie(e=Me(q(e)),t=U(t),r=U(r)))return u;e=e.sort((Fe,Ve)=>Fe-Ve);const p=l.apply(null,e),L=e.length,B=p.length,z=Math.pow(10,r);let ne=0,fe=!1,we=0;for(;!fe&&we<B;)t===p[we]?(ne=e.indexOf(p[we])/(L-1),fe=!0):t>=p[we]&&(t<p[we+1]||we===B-1)&&(ne=(e.indexOf(p[we])+(t-p[we])/(p[we+1]-p[we]))/(L-1),fe=!0),we++;return Math.floor(ne*z)/z}},Ne={DIST:(e,t,r)=>ie(e=U(e),t=U(t))?u:r?j.poisson.cdf(e,t):j.poisson.pdf(e,t)},Ie={EXC:(e,t)=>{if(ie(e=Me(q(e)),t=U(t)))return u;switch(t){case 1:return K.EXC(e,.25);case 2:return K.EXC(e,.5);case 3:return K.EXC(e,.75);default:return h}},INC:(e,t)=>{if(ie(e=Me(q(e)),t=U(t)))return u;switch(t){case 1:return K.INC(e,.25);case 2:return K.INC(e,.5);case 3:return K.INC(e,.75);default:return h}}},Te={};function _e(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=j.mean(e),r=e.length;let p=0;for(let L=0;L<r;L++)p+=Math.pow(e[L]-t,3);return r*p/((r-1)*(r-2)*Math.pow(j.stdev(e,!0),3))}function $e(e,t){return ie(e=Me(q(e)),t=U(t))?e:e.sort((r,p)=>r-p)[t-1]}Te.AVG=(e,t,r)=>{if(ie(e=U(e),t=Me(q(t))))return u;const p=(r=r||!1)?(z,ne)=>z-ne:(z,ne)=>ne-z,L=(t=(t=q(t)).sort(p)).length;let B=0;for(let z=0;z<L;z++)t[z]===e&&B++;return B>1?(2*t.indexOf(e)+B+1)/2:t.indexOf(e)+1},Te.EQ=(e,t,r)=>{if(ie(e=U(e),t=Me(q(t))))return u;const p=(r=r||!1)?(L,B)=>L-B:(L,B)=>B-L;return(t=t.sort(p)).indexOf(e)+1},_e.P=function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=j.mean(e),r=e.length;let p=0,L=0;for(let B=0;B<r;B++)L+=Math.pow(e[B]-t,3),p+=Math.pow(e[B]-t,2);return L/=r,p/=r,L/Math.pow(p,1.5)};const nt={P:function(){const e=me.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},S:function(){const e=me.S.apply(this,arguments);return Math.sqrt(e)}},ee={DIST:(e,t,r)=>r!==1&&r!==2?h:r===1?ee.DIST.RT(e,t):ee.DIST["2T"](e,t)};ee.DIST["2T"]=function(e,t){return arguments.length!==2?w:e<0||t<1?h:typeof e!="number"||typeof t!="number"?u:2*(1-j.studentt.cdf(e,t))},ee.DIST.RT=function(e,t){return arguments.length!==2?w:e<0||t<1?h:typeof e!="number"||typeof t!="number"?u:1-j.studentt.cdf(e,t)},ee.INV=(e,t)=>ie(e=U(e),t=U(t))?u:j.studentt.inv(e,t),ee.INV["2T"]=(e,t)=>(e=U(e),t=U(t),e<=0||e>1||t<1?h:ie(e,t)?u:Math.abs(j.studentt.inv(e/2,t))),ee.TEST=(e,t)=>{if(ie(e=Me(q(e)),t=Me(q(t))))return u;const r=j.mean(e),p=j.mean(t);let L,B=0,z=0;for(L=0;L<e.length;L++)B+=Math.pow(e[L]-r,2);for(L=0;L<t.length;L++)z+=Math.pow(t[L]-p,2);B/=e.length-1,z/=t.length-1;const ne=Math.abs(r-p)/Math.sqrt(B/e.length+z/t.length);return ee.DIST["2T"](ne,e.length+t.length-2)};const me={};function Ae(){const e=q(arguments),t=e.length;let r=0,p=0;const L=Q(e);for(let B=0;B<t;B++){const z=e[B];r+=Math.pow(typeof z=="number"?z-L:z===!0?1-L:0-L,2),z!==null&&p++}return r/(p-1)}function ke(){const e=q(arguments),t=e.length;let r=0,p=0;const L=Q(e);let B;for(let z=0;z<t;z++){const ne=e[z];r+=Math.pow(typeof ne=="number"?ne-L:ne===!0?1-L:0-L,2),ne!==null&&p++}return B=r/p,isNaN(B)&&(B=h),B}me.P=function(){const e=Ge(q(arguments)),t=e.length;let r=0;const p=k(e);let L;for(let B=0;B<t;B++)r+=Math.pow(e[B]-p,2);return L=r/t,isNaN(L)&&(L=h),L},me.S=function(){const e=Ge(q(arguments)),t=e.length;let r=0;const p=k(e);for(let L=0;L<t;L++)r+=Math.pow(e[L]-p,2);return r/(t-1)};const rt={DIST:(e,t,r,p)=>ie(e=U(e),t=U(t),r=U(r))?u:p?1-Math.exp(-Math.pow(e/r,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/r,t))*t/Math.pow(r,t)},Xe={};function Qe(e,t,r){const p=ve(e=U(e),t=U(t),r=U(r));if(p)return p;if(t===0)return 0;t=Math.abs(t);const L=-Math.floor(Math.log(t)/Math.log(10));return e>=0?wt(Math.ceil(e/t)*t,L):r===0?-wt(Math.floor(Math.abs(e)/t)*t,L):-wt(Math.ceil(Math.abs(e)/t)*t,L)}function et(e,t){return ve(e=U(e),t=U(t))||(e<t?h:st(e)/(st(t)*st(e-t)))}Xe.TEST=(e,t,r)=>{if(ie(e=Me(q(e)),t=U(t)))return u;r=r||nt.S(e);const p=e.length;return 1-ce.S.DIST((k(e)-t)/(r/Math.sqrt(p)),!0)},Qe.MATH=Qe,Qe.PRECISE=Qe;const He=[];function st(e){if((e=U(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(He[t]>0||(He[t]=st(t-1)*t),He[t])}function xt(e,t){const r=ve(e=U(e),t=U(t));if(r)return r;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return h;t=Math.abs(t);const p=-Math.floor(Math.log(t)/Math.log(10));return e>=0?wt(Math.floor(e/t)*t,p):-wt(Math.ceil(Math.abs(e)/t),p)}xt.MATH=(e,t,r)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const p=ve(e=U(e),t=U(t),r=U(r));if(p)return p;if(t===0)return 0;t=t?Math.abs(t):1;const L=-Math.floor(Math.log(t)/Math.log(10));return e>=0?wt(Math.floor(e/t)*t,L):r===0||r===void 0?-wt(Math.ceil(Math.abs(e)/t)*t,L):-wt(Math.floor(Math.abs(e)/t)*t,L)},xt.PRECISE=xt.MATH;const hn={CEILING:Qe};function en(e,t){const r=ve(e=U(e),t=U(t));if(r)return r;if(e===0&&t===0)return h;const p=Math.pow(e,t);return isNaN(p)?h:p}function Vt(){const e=q(arguments).filter(p=>p!=null);if(e.length===0)return 0;const t=Me(e);if(t instanceof Error)return t;let r=1;for(let p=0;p<t.length;p++)r*=t[p];return r}function wt(e,t){return ve(e=U(e),t=U(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function At(){let e=0;return M(H(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const r=parseFloat(t);!isNaN(r)&&(e+=r)}else if(Array.isArray(t)){const r=At.apply(null,t);r instanceof Error?e=r:e+=r}}),e}var gn=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?w:ve(e=U(e),t=U(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?w:ve(e=U(e),t=U(t))||(t===0?g:e/t)},EQ:function(e,t){return arguments.length!==2?w:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?w:e instanceof Error?e:t instanceof Error?t:(Se(e,t)?(e=ze(e),t=ze(t)):(e=U(e),t=U(t)),ve(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?w:(Se(e,t)?(e=ze(e),t=ze(t)):(e=U(e),t=U(t)),ve(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?w:(Se(e,t)?(e=ze(e),t=ze(t)):(e=U(e),t=U(t)),ve(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?w:(Se(e,t)?(e=ze(e),t=ze(t)):(e=U(e),t=U(t)),ve(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?w:ve(e=U(e),t=U(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?w:ve(e=U(e),t=U(t))||e*t},NE:function(e,t){return arguments.length!==2?w:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?w:en(e,t)}});const mn=new Date(Date.UTC(1900,0,1)),bn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],jn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Ot=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function It(e,t,r){r=r.toUpperCase(),e=Be(e),t=Be(t);const p=e.getFullYear(),L=e.getMonth(),B=e.getDate(),z=t.getFullYear(),ne=t.getMonth(),fe=t.getDate();let we;switch(r){case"Y":we=Math.floor(Ut(e,t));break;case"D":we=Lt(t,e);break;case"M":we=ne-L+12*(z-p),fe<B&&we--;break;case"MD":B<=fe?we=fe-B:(ne===0?(e.setFullYear(z-1),e.setMonth(12)):(e.setFullYear(z),e.setMonth(ne-1)),we=Lt(t,e));break;case"YM":we=ne-L+12*(z-p),fe<B&&we--,we%=12;break;case"YD":ne>L||ne===L&&fe<B?e.setFullYear(z):e.setFullYear(z-1),we=Lt(t,e)}return we}function kt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Lt(e,t){return e=Be(e),t=Be(t),e instanceof Error?e:t instanceof Error?t:nn(kt(e))-nn(kt(t))}function Ct(e,t,r){if(r=Ue(r||"false"),e=Be(e),t=Be(t),e instanceof Error)return e;if(t instanceof Error)return t;if(r instanceof Error)return r;const p=e.getMonth();let L,B,z=t.getMonth();if(r)L=e.getDate()===31?30:e.getDate(),B=t.getDate()===31?30:t.getDate();else{const ne=new Date(e.getFullYear(),p+1,0).getDate(),fe=new Date(t.getFullYear(),z+1,0).getDate();L=e.getDate()===ne?30:e.getDate(),t.getDate()===fe?L<30?(z++,B=1):B=30:B=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(z-p)+(B-L)}function tn(e){if((e=Be(e))instanceof Error)return e;(e=kt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function Rt(e,t,r){return Rt.INTL(e,t,1,r)}function Ht(e,t,r){return Ht.INTL(e,t,1,r)}function Yt(e){return new Date(e,1,29).getMonth()===1}function Bt(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function Ut(e,t,r){if((e=Be(e))instanceof Error)return e;if((t=Be(t))instanceof Error)return t;r=r||0;let p=e.getDate();const L=e.getMonth()+1,B=e.getFullYear();let z=t.getDate();const ne=t.getMonth()+1,fe=t.getFullYear();switch(r){case 0:return p===31&&z===31?(p=30,z=30):p===31?p=30:p===30&&z===31&&(z=30),(z+30*ne+360*fe-(p+30*L+360*B))/360;case 1:{const we=(We,tt)=>{const ot=We.getFullYear(),bt=new Date(ot,2,1);if(Yt(ot)&&We<bt&&tt>=bt)return!0;const dt=tt.getFullYear(),Et=new Date(dt,2,1);return Yt(dt)&&tt>=Et&&We<Et};let Fe=365;if(B===fe||B+1===fe&&(L>ne||L===ne&&p>=z))return(B===fe&&Yt(B)||we(e,t)||ne===1&&z===29)&&(Fe=366),Bt(e,t)/Fe;const Ve=fe-B+1,Re=(new Date(fe+1,0,1)-new Date(B,0,1))/1e3/60/60/24/Ve;return Bt(e,t)/Re}case 2:return Bt(e,t)/360;case 3:return Bt(e,t)/365;case 4:return(z+30*ne+360*fe-(p+30*L+360*B))/360}}function nn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-mn)/864e5)+t}function on(e){return(e=U(e))===0?u:e instanceof Error?e:String.fromCharCode(e)}function rn(e){if(ie(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=u),t}function an(){const e=q(arguments),t=ve.apply(void 0,e);if(t)return t;let r=0;for(;(r=e.indexOf(!0))>-1;)e[r]="TRUE";let p=0;for(;(p=e.indexOf(!1))>-1;)e[p]="FALSE";return e.join("")}Rt.INTL=(e,t,r,p)=>{if((e=Be(e))instanceof Error)return e;if((t=Be(t))instanceof Error)return t;let L=!1;const B=[],z=[1,2,3,4,5,6,0],ne=new RegExp("^[0|1]{7}$");if(r===void 0)r=Ot[1];else if(typeof r=="string"&&ne.test(r)){L=!0,r=r.split("");for(let Ve=0;Ve<r.length;Ve++)r[Ve]==="1"&&B.push(z[Ve])}else r=Ot[r];if(!(r instanceof Array))return u;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let Ve=0;Ve<p.length;Ve++){const Re=Be(p[Ve]);if(Re instanceof Error)return Re;p[Ve]=Re}const fe=Math.round((t-e)/864e5)+1;let we=fe;const Fe=e;for(let Ve=0;Ve<fe;Ve++){const Re=new Date().getTimezoneOffset()>0?Fe.getUTCDay():Fe.getDay();let We=L?B.includes(Re):Re===r[0]||Re===r[1];for(let tt=0;tt<p.length;tt++){const ot=p[tt];if(ot.getDate()===Fe.getDate()&&ot.getMonth()===Fe.getMonth()&&ot.getFullYear()===Fe.getFullYear()){We=!0;break}}We&&we--,Fe.setDate(Fe.getDate()+1)}return we},Ht.INTL=(e,t,r,p)=>{if((e=Be(e))instanceof Error)return e;if((t=U(t))instanceof Error)return t;if(t<0)return h;if(!((r=r===void 0?Ot[1]:Ot[r])instanceof Array))return u;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let B=0;B<p.length;B++){const z=Be(p[B]);if(z instanceof Error)return z;p[B]=z}let L=0;for(;L<t;){e.setDate(e.getDate()+1);const B=e.getDay();if(B!==r[0]&&B!==r[1]){for(let z=0;z<p.length;z++){const ne=p[z];if(ne.getDate()===e.getDate()&&ne.getMonth()===e.getMonth()&&ne.getFullYear()===e.getFullYear()){L--;break}}L++}}return e};const vn=an;function sn(e,t=2,r=!1){if(e=U(e),isNaN(e)||(t=U(t),isNaN(t)))return u;if(t<0){const p=Math.pow(10,-t);e=Math.round(e/p)*p}else e=e.toFixed(t);if(r)e=e.toString().replace(/,/g,"");else{const p=e.toString().split(".");p[0]=p[0].replace(/\B(?=(\d{3})+$)/g,","),e=p.join(".")}return e}function jt(e,t){return ve(e,t)||(e=ze(e),(t=U(t))instanceof Error?t:new Array(t+1).join(e))}const yn=on,xn=rn;function qt(e){return/^[01]{1,10}$/.test(e)}function pt(e,t,r){if(ie(e=U(e),t=U(t)))return e;if((r=r===void 0?"i":r)!=="i"&&r!=="j")return u;if(e===0&&t===0)return 0;if(e===0)return t===1?r:t.toString()+r;if(t===0)return e.toString();{const p=t>0?"+":"";return e.toString()+p+(t===1?r:t.toString()+r)}}function zt(e,t){return t=t===void 0?0:t,ie(e=U(e),t=U(t))?u:j.erf(e)}function Wt(e){return isNaN(e)?u:j.erfc(e)}function Xt(e){const t=at(e),r=it(e);return ie(t,r)?u:Math.sqrt(Math.pow(t,2)+Math.pow(r,2))}function it(e){if(e===void 0||e===!0||e===!1)return u;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),r=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),r===0&&(r=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),L=p==="i"||p==="j";return t>=0||r>=0?L?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?h:-Number(e.substring(r+1,e.length-1)):h:L?isNaN(e.substring(0,e.length-1))?h:e.substring(0,e.length-1):isNaN(e)?h:0}function Gt(e){const t=at(e),r=it(e);return ie(t,r)?u:t===0&&r===0?g:t===0&&r>0?Math.PI/2:t===0&&r<0?-Math.PI/2:r===0&&t>0?0:r===0&&t<0?-Math.PI:t>0?Math.atan(r/t):t<0&&r>=0?Math.atan(r/t)+Math.PI:Math.atan(r/t)-Math.PI}function _t(e){const t=at(e),r=it(e);if(ie(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(t)*(Math.exp(r)+Math.exp(-r))/2,-Math.sin(t)*(Math.exp(r)-Math.exp(-r))/2,p)}function ln(e){const t=at(e),r=it(e);if(ie(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2,p)}function Mt(e,t){const r=at(e),p=it(e),L=at(t),B=it(t);if(ie(r,p,L,B))return u;const z=e.substring(e.length-1),ne=t.substring(t.length-1);let fe="i";if((z==="j"||ne==="j")&&(fe="j"),L===0&&B===0)return h;const we=L*L+B*B;return pt((r*L+p*B)/we,(p*L-r*B)/we,fe)}function at(e){if(e===void 0||e===!0||e===!1)return u;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),r=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),r===0&&(r=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),L=p==="i"||p==="j";return t>=0||r>=0?L?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(0,t)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?h:Number(e.substring(0,r)):h:L?isNaN(e.substring(0,e.length-1))?h:0:isNaN(e)?h:e}function Pt(e){const t=at(e),r=it(e);if(ie(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.sin(t)*(Math.exp(r)+Math.exp(-r))/2,Math.cos(t)*(Math.exp(r)-Math.exp(-r))/2,p)}function un(e){const t=at(e),r=it(e);if(ie(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2,p)}zt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Wt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const wn=te.DIST,Cn=te.INV,En=O.DIST,An=Qe.MATH,Ln=Qe.PRECISE,Mn=I.DIST,Tn=I.DIST.RT,Nn=I.INV,In=I.INV.RT,Dn=I.TEST,Sn=ue.P,Fn=ue.P,On=ue.S,kn=O.INV,Rn=Wt.PRECISE,Hn=zt.PRECISE,Bn=pe.DIST,_n=le.DIST,Pn=le.DIST.RT,Vn=le.INV,Yn=le.INV.RT,Un=xt.MATH,qn=xt.PRECISE,zn=le.TEST,Wn=Ce.DIST,Xn=Ce.INV,Gn=qe.PRECISE,Kn=Ze.DIST,$n=G.INV,Jn=G.DIST,Zn=G.INV,Qn=S.MULT,eo=S.SNGL,to=Z.DIST,no=Rt.INTL,oo=ce.DIST,ro=ce.INV,io=ce.S.DIST,ao=ce.S.INV,so=K.EXC,lo=K.INC,uo=ye.EXC,co=ye.INC,fo=Ne.DIST,po=Ie.EXC,ho=Ie.INC,go=Te.AVG,mo=Te.EQ,bo=_e.P,jo=nt.P,vo=nt.S,yo=ee.DIST,xo=ee.DIST.RT,wo=ee.INV,Co=ee.TEST,Eo=me.P,Ao=me.S,Lo=rt.DIST,Mo=Ht.INTL,To=Xe.TEST;function Kt(e){const t=[];return M(e,r=>{r&&t.push(r)}),t}function yt(e,t){const r={};for(let B=1;B<e[0].length;++B)r[B]=!0;let p=t[0].length;for(let B=1;B<t.length;++B)t[B].length>p&&(p=t[B].length);for(let B=1;B<e.length;++B)for(let z=1;z<e[B].length;++z){let ne=!1,fe=!1;for(let we=0;we<t.length;++we){const Fe=t[we];if(Fe.length<p)continue;const Ve=Fe[0];if(e[B][0]===Ve){fe=!0;for(let Re=1;Re<Fe.length;++Re)if(!ne)if(Fe[Re]===void 0||Fe[Re]==="*")ne=!0;else{const We=vt(Fe[Re]+""),tt=[ht(e[B][z],ct)].concat(We);ne=mt(tt)}}}fe&&(r[z]=r[z]&&ne)}const L=[];for(let B=0;B<e[0].length;++B)r[B]&&L.push(B-1);return L}function $t(e){return e&&e.getTime&&!isNaN(e.getTime())}function Jt(e){return e instanceof Date?e:new Date(e)}function Tt(e,t,r,p,L){if(p=p||0,L=L||0,ie(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L)))return u;let B;if(e===0)B=p+r*t;else{const z=Math.pow(1+e,t);B=L===1?p*z+r*(1+e)*(z-1)/e:p*z+r*(z-1)/e}return-B}function cn(e,t,r,p,L,B){if(L=L||0,B=B||0,ie(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L),B=U(B)))return u;const z=Dt(e,r,p,L,B);return(t===1?B===1?0:-p:B===1?Tt(e,t-2,z,p,1)-z:Tt(e,t-1,z,p,0))*e}function Zt(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=e[0];let r=0;for(let p=1;p<e.length;p++)r+=e[p]/Math.pow(1+t,p);return r}function Dt(e,t,r,p,L){if(p=p||0,L=L||0,ie(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L)))return u;let B;if(e===0)B=(r+p)/t;else{const z=Math.pow(1+e,t);B=L===1?(p*e/(z-1)+r*e/(1-1/z))/(1+e):p*e/(z-1)+r*e/(1-1/z)}return-B}const No={errors:V,symbols:gn};c.ABS=function(e){return(e=U(e))instanceof Error?e:Math.abs(e)},c.ACCRINT=function(e,t,r,p,L,B,z){return e=Jt(e),t=Jt(t),r=Jt(r),$t(e)&&$t(t)&&$t(r)?p<=0||L<=0||[1,2,4].indexOf(B)===-1||[0,1,2,3,4].indexOf(z)===-1||r<=e?h:(L=L||0)*p*Ut(e,r,z=z||0):u},c.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},c.ACOS=function(e){if((e=U(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=h),t},c.ACOSH=function(e){if((e=U(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=h),t},c.ACOT=function(e){return(e=U(e))instanceof Error?e:Math.atan(1/e)},c.ACOTH=function(e){if((e=U(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=h),t},c.AGGREGATE=function(e,t,r,p){if(ie(e=U(e),U(e)))return u;switch(e){case 1:return k(r);case 2:return W(r);case 3:return oe(r);case 4:return X(r);case 5:return A(r);case 6:return Vt(r);case 7:return nt.S(r);case 8:return nt.P(r);case 9:return At(r);case 10:return me.S(r);case 11:return me.P(r);case 12:return re(r);case 13:return S.SNGL(r);case 14:return he(r,p);case 15:return $e(r,p);case 16:return K.INC(r,p);case 17:return Ie.INC(r,p);case 18:return K.EXC(r,p);case 19:return Ie.EXC(r,p)}},c.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},c.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},c.AND=function(){const e=q(arguments);let t=u;for(let r=0;r<e.length;r++){if(e[r]instanceof Error)return e[r];e[r]!==void 0&&e[r]!==null&&typeof e[r]!="string"&&(t===u&&(t=!0),e[r]||(t=!1))}return t},c.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return u;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,r=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),t},c.ASC=function(){throw new Error("ASC is not implemented")},c.ASIN=function(e){if((e=U(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=h),t},c.ASINH=function(e){return(e=U(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},c.ATAN=function(e){return(e=U(e))instanceof Error?e:Math.atan(e)},c.ATAN2=function(e,t){return ve(e=U(e),t=U(t))||Math.atan2(e,t)},c.ATANH=function(e){if((e=U(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=h),t},c.AVEDEV=function(){const e=q(arguments).filter(De);if(e.length===0)return h;const t=Me(e);return t instanceof Error?t:j.sum(j(t).subtract(j.mean(t)).abs()[0])/t.length},c.AVERAGE=k,c.AVERAGEA=Q,c.AVERAGEIF=function(e,t,r){if(arguments.length<=1)return w;if(r=Me(q(r=r||e).filter(De)),e=q(e),r instanceof Error)return r;let p=0,L=0;const B=t===void 0||t==="*",z=B?null:vt(t+"");for(let ne=0;ne<e.length;ne++){const fe=e[ne];if(B)L+=r[ne],p++;else{const we=[ht(fe,ct)].concat(z);mt(we)&&(L+=r[ne],p++)}}return L/p},c.AVERAGEIFS=function(){const e=H(arguments),t=(e.length-1)/2,r=q(e[0]);let p=0,L=0;for(let z=0;z<r.length;z++){let ne=!1;for(let fe=0;fe<t;fe++){const we=e[2*fe+1][z],Fe=e[2*fe+2];let Ve=!1;if(Fe===void 0||Fe==="*")Ve=!0;else{const Re=vt(Fe+""),We=[ht(we,ct)].concat(Re);Ve=mt(We)}if(!Ve){ne=!1;break}ne=!0}ne&&(L+=r[z],p++)}const B=L/p;return isNaN(B)?0:B},c.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},c.BASE=function(e,t,r){const p=ve(e=U(e),t=U(t),r=U(r));if(p)return p;if(t===0)return h;const L=e.toString(t);return new Array(Math.max(r+1-L.length,0)).join("0")+L},c.BESSELI=function(e,t){return ie(e=U(e),t=U(t))?u:R.besseli(e,t)},c.BESSELJ=function(e,t){return ie(e=U(e),t=U(t))?u:R.besselj(e,t)},c.BESSELK=function(e,t){return ie(e=U(e),t=U(t))?u:R.besselk(e,t)},c.BESSELY=function(e,t){return ie(e=U(e),t=U(t))?u:R.bessely(e,t)},c.BETA=te,c.BETADIST=wn,c.BETAINV=Cn,c.BIN2DEC=function(e){if(!qt(e))return h;const t=parseInt(e,2),r=e.toString();return r.length===10&&r.substring(0,1)==="1"?parseInt(r.substring(1),2)-512:t},c.BIN2HEX=function(e,t){if(!qt(e))return h;const r=e.toString();if(r.length===10&&r.substring(0,1)==="1")return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16);const p=parseInt(e,2).toString(16);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?jt("0",t-p.length)+p:h},c.BIN2OCT=function(e,t){if(!qt(e))return h;const r=e.toString();if(r.length===10&&r.substring(0,1)==="1")return(1073741312+parseInt(r.substring(1),2)).toString(8);const p=parseInt(e,2).toString(8);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?jt("0",t-p.length)+p:h},c.BINOM=O,c.BINOMDIST=En,c.BITAND=function(e,t){return ie(e=U(e),t=U(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e&t},c.BITLSHIFT=function(e,t){return ie(e=U(e),t=U(t))?u:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e<<t:e>>-t},c.BITOR=function(e,t){return ie(e=U(e),t=U(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e|t},c.BITRSHIFT=function(e,t){return ie(e=U(e),t=U(t))?u:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e>>t:e<<-t},c.BITXOR=function(e,t){return ie(e=U(e),t=U(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e^t},c.CEILING=Qe,c.CEILINGMATH=An,c.CEILINGPRECISE=Ln,c.CELL=function(){throw new Error("CELL is not implemented")},c.CHAR=on,c.CHIDIST=Mn,c.CHIDISTRT=Tn,c.CHIINV=Nn,c.CHIINVRT=In,c.CHISQ=I,c.CHITEST=Dn,c.CHOOSE=function(){if(arguments.length<2)return w;const e=arguments[0];return e<1||e>254||arguments.length<e+1?u:arguments[e]},c.CLEAN=function(e){return ie(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},c.CODE=rn,c.COLUMN=function(e,t){return arguments.length!==2?w:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?j.col(e,t):void 0:u},c.COLUMNS=function(e){return arguments.length!==1?w:e instanceof Array?e.length===0?0:j.cols(e):u},c.COMBIN=et,c.COMBINA=function(e,t){return ve(e=U(e),t=U(t))||(e<t?h:e===0&&t===0?1:et(e+t-1,e-1))},c.COMPLEX=pt,c.CONCAT=vn,c.CONCATENATE=an,c.CONFIDENCE=_,c.CONVERT=function(e,t,r){if((e=U(e))instanceof Error)return e;const p=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],L={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},B={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let z,ne=null,fe=null,we=t,Fe=r,Ve=1,Re=1;for(let We=0;We<p.length;We++)z=p[We][2]===null?[]:p[We][2],(p[We][1]===we||z.indexOf(we)>=0)&&(ne=p[We]),(p[We][1]===Fe||z.indexOf(Fe)>=0)&&(fe=p[We]);if(ne===null){const We=L[t.substring(0,2)];let tt=B[t.substring(0,1)];t.substring(0,2)==="da"&&(tt=["dekao",10,"da"]),We?(Ve=We[2],we=t.substring(2)):tt&&(Ve=tt[1],we=t.substring(tt[2].length));for(let ot=0;ot<p.length;ot++)z=p[ot][2]===null?[]:p[ot][2],(p[ot][1]===we||z.indexOf(we)>=0)&&(ne=p[ot])}if(fe===null){const We=L[r.substring(0,2)];let tt=B[r.substring(0,1)];r.substring(0,2)==="da"&&(tt=["dekao",10,"da"]),We?(Re=We[2],Fe=r.substring(2)):tt&&(Re=tt[1],Fe=r.substring(tt[2].length));for(let ot=0;ot<p.length;ot++)z=p[ot][2]===null?[]:p[ot][2],(p[ot][1]===Fe||z.indexOf(Fe)>=0)&&(fe=p[ot])}return ne===null||fe===null||ne[3]!==fe[3]?w:e*ne[6]*Ve/(fe[6]*Re)},c.CORREL=function(e,t){return ie(e=Me(q(e)),t=Me(q(t)))?u:j.corrcoeff(e,t)},c.COS=function(e){return(e=U(e))instanceof Error?e:Math.cos(e)},c.COSH=function(e){return(e=U(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},c.COT=function(e){return(e=U(e))instanceof Error?e:e===0?g:1/Math.tan(e)},c.COTH=function(e){if((e=U(e))instanceof Error)return e;if(e===0)return g;const t=Math.exp(2*e);return(t+1)/(t-1)},c.COUNT=W,c.COUNTA=oe,c.COUNTBLANK=be,c.COUNTIF=function(e,t){if(e=q(e),t===void 0||t==="*")return e.length;let r=0;const p=vt(t+"");for(let L=0;L<e.length;L++){const B=[ht(e[L],ct)].concat(p);mt(B)&&r++}return r},c.COUNTIFS=function(){const e=H(arguments),t=new Array(q(e[0]).length);for(let p=0;p<t.length;p++)t[p]=!0;for(let p=0;p<e.length;p+=2){const L=q(e[p]),B=e[p+1];if(B!==void 0&&B!=="*"){const z=vt(B+"");for(let ne=0;ne<L.length;ne++){const fe=[ht(L[ne],ct)].concat(z);t[ne]=t[ne]&&mt(fe)}}}let r=0;for(let p=0;p<t.length;p++)t[p]&&r++;return r},c.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},c.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},c.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},c.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},c.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},c.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},c.COVAR=Sn,c.COVARIANCE=ue,c.COVARIANCEP=Fn,c.COVARIANCES=On,c.CRITBINOM=kn,c.CSC=function(e){return(e=U(e))instanceof Error?e:e===0?g:1/Math.sin(e)},c.CSCH=function(e){return(e=U(e))instanceof Error?e:e===0?g:2/(Math.exp(e)-Math.exp(-e))},c.CUMIPMT=function(e,t,r,p,L,B){if(ie(e=U(e),t=U(t),r=U(r)))return u;if(e<=0||t<=0||r<=0||p<1||L<1||p>L||B!==0&&B!==1)return h;const z=Dt(e,t,r,0,B);let ne=0;p===1&&(B===0&&(ne=-r),p++);for(let fe=p;fe<=L;fe++)ne+=B===1?Tt(e,fe-2,z,r,1)-z:Tt(e,fe-1,z,r,0);return ne*=e,ne},c.CUMPRINC=function(e,t,r,p,L,B){if(ie(e=U(e),t=U(t),r=U(r)))return u;if(e<=0||t<=0||r<=0||p<1||L<1||p>L||B!==0&&B!==1)return h;const z=Dt(e,t,r,0,B);let ne=0;p===1&&(ne=B===0?z+r*e:z,p++);for(let fe=p;fe<=L;fe++)ne+=B>0?z-(Tt(e,fe-2,z,r,1)-z)*e:z-Tt(e,fe-1,z,r,0)*e;return ne},c.DATE=function(e,t,r){let p;return ie(e=U(e),t=U(t),r=U(r))?p=u:(p=new Date(e,t-1,r),p.getFullYear()<0&&(p=h)),p},c.DATEDIF=It,c.DATEVALUE=function(e){if(typeof e!="string")return u;const t=Date.parse(e);return isNaN(t)?u:new Date(e)},c.DAVERAGE=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const z=Le(e,t);L=se(e[z])}else L=se(e[t]);let B=0;return M(p,z=>{B+=L[z]}),p.length===0?g:B/p.length},c.DAY=function(e){const t=Be(e);return t instanceof Error?t:t.getDate()},c.DAYS=Lt,c.DAYS360=Ct,c.DB=function(e,t,r,p,L){if(L=L===void 0?12:L,ie(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L)))return u;if(e<0||t<0||r<0||p<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(L)===-1||p>r)return h;if(t>=e)return 0;const B=(1-Math.pow(t/e,1/r)).toFixed(3),z=e*B*L/12;let ne=z,fe=0;const we=p===r?r-1:p;for(let Fe=2;Fe<=we;Fe++)fe=(e-ne)*B,ne+=fe;return p===1?z:p===r?(e-ne)*B:fe},c.DBCS=function(){throw new Error("DBCS is not implemented")},c.DCOUNT=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const z=Le(e,t);L=se(e[z])}else L=se(e[t]);const B=[];return M(p,z=>{B.push(L[z])}),W(B)},c.DCOUNTA=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const z=Le(e,t);L=se(e[z])}else L=se(e[t]);const B=[];return M(p,z=>{B.push(L[z])}),oe(B)},c.DDB=function(e,t,r,p,L){if(L=L===void 0?2:L,ie(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L)))return u;if(e<0||t<0||r<0||p<0||L<=0||p>r)return h;if(t>=e)return 0;let B=0,z=0;for(let ne=1;ne<=p;ne++)z=Math.min(L/r*(e-B),e-t-B),B+=z;return z},c.DEC2BIN=function(e,t){if((e=U(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return h;if(e<0)return"1"+jt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const r=parseInt(e,10).toString(2);return t===void 0?r:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=r.length?jt("0",t-r.length)+r:h},c.DEC2HEX=function(e,t){if((e=U(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return h;if(e<0)return(1099511627776+e).toString(16);const r=parseInt(e,10).toString(16);return t===void 0?r:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=r.length?jt("0",t-r.length)+r:h},c.DEC2OCT=function(e,t){if((e=U(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return h;if(e<0)return(1073741824+e).toString(8);const r=parseInt(e,10).toString(8);return t===void 0?r:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=r.length?jt("0",t-r.length)+r:h},c.DECIMAL=function(e,t){return arguments.length<1?u:ve(e=U(e),t=U(t))||(t===0?h:parseInt(e,t))},c.DEGREES=function(e){return(e=U(e))instanceof Error?e:180*e/Math.PI},c.DELTA=function(e,t){return t=t===void 0?0:t,ie(e=U(e),t=U(t))?u:e===t?1:0},c.DEVSQ=function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=j.mean(e);let r=0;for(let p=0;p<e.length;p++)r+=Math.pow(e[p]-t,2);return r},c.DGET=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];return L=se(typeof t=="string"?e[Le(e,t)]:e[t]),p.length===0?u:p.length>1?h:L[p[0]]},c.DISC=function(e,t,r,p,L){if(ie(e=Be(e),t=Be(t),r=U(r),p=U(p),L=(L=U(L))||0))return u;if(r<=0||p<=0)return h;if(e>=t)return u;let B,z;switch(L){case 0:B=360,z=Ct(e,t,!1);break;case 1:case 3:B=365,z=It(e,t,"D");break;case 2:B=360,z=It(e,t,"D");break;case 4:B=360,z=Ct(e,t,!0);break;default:return h}return(p-r)/p*B/z},c.DMAX=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const z=Le(e,t);L=se(e[z])}else L=se(e[t]);let B=L[p[0]];return M(p,z=>{B<L[z]&&(B=L[z])}),B},c.DMIN=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const z=Le(e,t);L=se(e[z])}else L=se(e[t]);let B=L[p[0]];return M(p,z=>{B>L[z]&&(B=L[z])}),B},c.DOLLAR=function(e,t=2){if(e=U(e),isNaN(e))return u;const r={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},p=(e=wt(e,t)).toLocaleString("en-US",r);return e<0?"$("+p.slice(2)+")":p},c.DOLLARDE=function(e,t){if(ie(e=U(e),t=U(t)))return u;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let r=parseInt(e,10);r+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const p=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return r=Math.round(r*p)/p,r},c.DOLLARFR=function(e,t){if(ie(e=U(e),t=U(t)))return u;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let r=parseInt(e,10);return r+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,r},c.DPRODUCT=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const ne=Le(e,t);L=se(e[ne])}else L=se(e[t]);let B=[];M(p,ne=>{B.push(L[ne])}),B=Kt(B);let z=1;return M(B,ne=>{z*=ne}),z},c.DSTDEV=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const z=Le(e,t);L=se(e[z])}else L=se(e[t]);let B=[];return M(p,z=>{B.push(L[z])}),B=Kt(B),nt.S(B)},c.DSTDEVP=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const z=Le(e,t);L=se(e[z])}else L=se(e[t]);let B=[];return M(p,z=>{B.push(L[z])}),B=Kt(B),nt.P(B)},c.DSUM=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const z=Le(e,t);L=se(e[z])}else L=se(e[t]);const B=[];return M(p,z=>{B.push(L[z])}),At(B)},c.DURATION=function(){throw new Error("DURATION is not implemented")},c.DVAR=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const z=Le(e,t);L=se(e[z])}else L=se(e[t]);const B=[];return M(p,z=>{B.push(L[z])}),me.S(B)},c.DVARP=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const z=Le(e,t);L=se(e[z])}else L=se(e[t]);const B=[];return M(p,z=>{B.push(L[z])}),me.P(B)},c.EDATE=function(e,t){return(e=Be(e))instanceof Error?e:isNaN(t)?u:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},c.EFFECT=function(e,t){return ie(e=U(e),t=U(t))?u:e<=0||t<1?h:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},c.EOMONTH=function(e,t){return(e=Be(e))instanceof Error?e:isNaN(t)?u:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},c.ERF=zt,c.ERFC=Wt,c.ERFCPRECISE=Rn,c.ERFPRECISE=Hn,c.ERROR=St,c.EVEN=function(e){return(e=U(e))instanceof Error?e:Qe(e,-2,-1)},c.EXACT=function(e,t){return arguments.length!==2?w:ve(e,t)||(e=ze(e))===ze(t)},c.EXP=function(e){return arguments.length<1?w:arguments.length>1?T:(e=U(e))instanceof Error?e:e=Math.exp(e)},c.EXPON=pe,c.EXPONDIST=Bn,c.F=le,c.FACT=st,c.FACTDOUBLE=function e(t){if((t=U(t))instanceof Error)return t;const r=Math.floor(t);return r<=0?1:r*e(r-2)},c.FALSE=function(){return!1},c.FDIST=_n,c.FDISTRT=Pn,c.FIND=function(e,t,r){if(arguments.length<2)return w;e=ze(e),r=r===void 0?0:r;const p=(t=ze(t)).indexOf(e,r-1);return p===-1?u:p+1},c.FINV=Vn,c.FINVRT=Yn,c.FISHER=function(e){return(e=U(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},c.FISHERINV=function(e){if((e=U(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},c.FIXED=sn,c.FLOOR=xt,c.FLOORMATH=Un,c.FLOORPRECISE=qn,c.FORECAST=je,c.FREQUENCY=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return u;const r=e.length,p=t.length,L=[];for(let B=0;B<=p;B++){L[B]=0;for(let z=0;z<r;z++)B===0?e[z]<=t[0]&&(L[0]+=1):B<p?e[z]>t[B-1]&&e[z]<=t[B]&&(L[B]+=1):B===p&&e[z]>t[p-1]&&(L[p]+=1)}return L},c.FTEST=zn,c.FV=Tt,c.FVSCHEDULE=function(e,t){if(ie(e=U(e),t=Me(q(t))))return u;const r=t.length;let p=e;for(let L=0;L<r;L++)p*=1+t[L];return p},c.GAMMA=Ce,c.GAMMADIST=Wn,c.GAMMAINV=Xn,c.GAMMALN=qe,c.GAMMALNPRECISE=Gn,c.GAUSS=function(e){return(e=U(e))instanceof Error?e:j.normal.cdf(e,0,1)-.5},c.GCD=function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=e.length,r=e[0];let p=r<0?-r:r;for(let L=1;L<t;L++){const B=e[L];let z=B<0?-B:B;for(;p&&z;)p>z?p%=z:z%=p;p+=z}return p},c.GEOMEAN=function(){const e=Me(q(arguments));return e instanceof Error?e:j.geomean(e)},c.GESTEP=function(e,t){return ie(t=t||0,e=U(e))?e:e>=t?1:0},c.GROWTH=function(e,t,r,p){if((e=Me(e))instanceof Error)return e;let L;if(t===void 0)for(t=[],L=1;L<=e.length;L++)t.push(L);if(r===void 0)for(r=[],L=1;L<=e.length;L++)r.push(L);if(ie(t=Me(t),r=Me(r)))return u;p===void 0&&(p=!0);const B=e.length;let z,ne,fe=0,we=0,Fe=0,Ve=0;for(L=0;L<B;L++){const We=t[L],tt=Math.log(e[L]);fe+=We,we+=tt,Fe+=We*tt,Ve+=We*We}fe/=B,we/=B,Fe/=B,Ve/=B,p?(z=(Fe-fe*we)/(Ve-fe*fe),ne=we-z*fe):(z=Fe/Ve,ne=0);const Re=[];for(L=0;L<r.length;L++)Re.push(Math.exp(ne+z*r[L]));return Re},c.HARMEAN=function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=e.length;let r=0;for(let p=0;p<t;p++)r+=1/e[p];return t/r},c.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const r=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),p=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(p<-512||p>511)return h;if(r)return"1"+jt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const L=p.toString(2);return t===void 0?L:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=L.length?jt("0",t-L.length)+L:h},c.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},c.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const r=parseInt(e,16);if(r>536870911&&r<0xffe0000000)return h;if(r>=0xffe0000000)return(r-0xffc0000000).toString(8);const p=r.toString(8);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?jt("0",t-p.length)+p:h},c.HLOOKUP=function(e,t,r,p){return o(e,xe(t),r,p)},c.HOUR=function(e){return(e=Be(e))instanceof Error?e:e.getHours()},c.HYPGEOM=Ze,c.HYPGEOMDIST=Kn,c.IF=function(e,t,r){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(r=arguments.length===3&&r)==null&&(r=0),e?t:r)},c.IFERROR=function(e,t){return Nt(e)?t:e},c.IFNA=function(e,t){return e===w?t:e},c.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return w},c.IMABS=Xt,c.IMAGINARY=it,c.IMARGUMENT=Gt,c.IMCONJUGATE=function(e){const t=at(e),r=it(e);if(ie(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",r!==0?pt(t,-r,p):e},c.IMCOS=_t,c.IMCOSH=ln,c.IMCOT=function(e){return ie(at(e),it(e))?u:Mt(_t(e),Pt(e))},c.IMCSC=function(e){return e===!0||e===!1?u:ie(at(e),it(e))?h:Mt("1",Pt(e))},c.IMCSCH=function(e){return e===!0||e===!1?u:ie(at(e),it(e))?h:Mt("1",un(e))},c.IMDIV=Mt,c.IMEXP=function(e){const t=at(e),r=it(e);if(ie(t,r))return u;let p=e.substring(e.length-1);p=p==="i"||p==="j"?p:"i";const L=Math.exp(t);return pt(L*Math.cos(r),L*Math.sin(r),p)},c.IMLN=function(e){const t=at(e),r=it(e);if(ie(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+r*r)),Math.atan(r/t),p)},c.IMLOG10=function(e){const t=at(e),r=it(e);if(ie(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+r*r))/Math.log(10),Math.atan(r/t)/Math.log(10),p)},c.IMLOG2=function(e){const t=at(e),r=it(e);if(ie(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+r*r))/Math.log(2),Math.atan(r/t)/Math.log(2),p)},c.IMPOWER=function(e,t){if(ie(t=U(t),at(e),it(e)))return u;let r=e.substring(e.length-1);r=r==="i"||r==="j"?r:"i";const p=Math.pow(Xt(e),t),L=Gt(e);return pt(p*Math.cos(t*L),p*Math.sin(t*L),r)},c.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return u;for(let t=1;t<arguments.length;t++){const r=at(e),p=it(e),L=at(arguments[t]),B=it(arguments[t]);if(ie(r,p,L,B))return u;e=pt(r*L-p*B,r*B+p*L)}return e},c.IMREAL=at,c.IMSEC=function(e){return e===!0||e===!1||ie(at(e),it(e))?u:Mt("1",_t(e))},c.IMSECH=function(e){return ie(at(e),it(e))?u:Mt("1",ln(e))},c.IMSIN=Pt,c.IMSINH=un,c.IMSQRT=function(e){if(ie(at(e),it(e)))return u;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const r=Math.sqrt(Xt(e)),p=Gt(e);return pt(r*Math.cos(p/2),r*Math.sin(p/2),t)},c.IMSUB=function(e,t){const r=at(e),p=it(e),L=at(t),B=it(t);if(ie(r,p,L,B))return u;const z=e.substring(e.length-1),ne=t.substring(t.length-1);let fe="i";return(z==="j"||ne==="j")&&(fe="j"),pt(r-L,p-B,fe)},c.IMSUM=function(){if(!arguments.length)return u;const e=q(arguments);let t=e[0];for(let r=1;r<e.length;r++){const p=at(t),L=it(t),B=at(e[r]),z=it(e[r]);if(ie(p,L,B,z))return u;t=pt(p+B,L+z)}return t},c.IMTAN=function(e){return e===!0||e===!1||ie(at(e),it(e))?u:Mt(Pt(e),_t(e))},c.INDEX=function(e,t,r){const p=ve(e,t,r);if(p)return p;if(!Array.isArray(e))return u;const L=e.length>0&&!Array.isArray(e[0]);return L&&!r?(r=t,t=1):(r=r||1,t=t||1),r<0||t<0?u:L&&t===1&&r<=e.length?e[r-1]:t<=e.length&&r<=e[t-1].length?e[t-1][r-1]:m},c.INFO=function(){throw new Error("INFO is not implemented")},c.INT=function(e){return(e=U(e))instanceof Error?e:Math.floor(e)},c.INTERCEPT=function(e,t){return ie(e=Me(e),t=Me(t))?u:e.length!==t.length?w:je(0,e,t)},c.INTRATE=function(){throw new Error("INTRATE is not implemented")},c.IPMT=cn,c.IRR=function(e,t){if(t=t||0,ie(e=Me(q(e)),t=U(t)))return u;const r=(Re,We,tt)=>{const ot=tt+1;let bt=Re[0];for(let dt=1;dt<Re.length;dt++)bt+=Re[dt]/Math.pow(ot,(We[dt]-We[0])/365);return bt},p=(Re,We,tt)=>{const ot=tt+1;let bt=0;for(let dt=1;dt<Re.length;dt++){const Et=(We[dt]-We[0])/365;bt-=Et*Re[dt]/Math.pow(ot,Et+1)}return bt},L=[];let B=!1,z=!1;for(let Re=0;Re<e.length;Re++)L[Re]=Re===0?0:L[Re-1]+365,e[Re]>0&&(B=!0),e[Re]<0&&(z=!0);if(!B||!z)return h;let ne,fe,we,Fe=t=t===void 0?.1:t,Ve=!0;do we=r(e,L,Fe),ne=Fe-we/p(e,L,Fe),fe=Math.abs(ne-Fe),Fe=ne,Ve=fe>1e-10&&Math.abs(we)>1e-10;while(Ve);return Fe},c.ISBLANK=function(e){return e===null},c.ISERR=gt,c.ISERROR=Nt,c.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},c.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},c.ISLOGICAL=Ft,c.ISNA=function(e){return e===w},c.ISNONTEXT=function(e){return typeof e!="string"},c.ISNUMBER=v,c.ISO=hn,c.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},c.ISOWEEKNUM=tn,c.ISPMT=function(e,t,r,p){return ie(e=U(e),t=U(t),r=U(r),p=U(p))?u:p*e*(t/r-1)},c.ISREF=function(){throw new Error("ISREF is not implemented")},c.ISTEXT=C,c.KURT=function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=j.mean(e),r=e.length;let p=0;for(let L=0;L<r;L++)p+=Math.pow(e[L]-t,4);return p/=Math.pow(j.stdev(e,!0),4),r*(r+1)/((r-1)*(r-2)*(r-3))*p-3*(r-1)*(r-1)/((r-2)*(r-3))},c.LARGE=he,c.LCM=function(){const e=Me(q(arguments));if(e instanceof Error)return e;for(var t,r,p,L,B=1;(p=e.pop())!==void 0;){if(p===0)return 0;for(;p>1;){if(p%2){for(t=3,r=Math.floor(Math.sqrt(p));t<=r&&p%t;t+=2);L=t<=r?t:p}else L=2;for(p/=L,B*=L,t=e.length;t;e[--t]%L==0&&(e[t]/=L)==1&&e.splice(t,1));}}return B},c.LEFT=function(e,t){return ve(e,t)||(e=ze(e),(t=U(t=t===void 0?1:t))instanceof Error||typeof e!="string"?u:e.substring(0,t))},c.LEN=function(e){return arguments.length===0?T:e instanceof Error?e:Array.isArray(e)?u:ze(e).length},c.LINEST=Ee,c.LN=function(e){return(e=U(e))instanceof Error?e:e===0?h:Math.log(e)},c.LOG=function(e,t){return ve(e=U(e),t=U(t))||(e===0||t===0?h:Math.log(e)/Math.log(t))},c.LOG10=function(e){return(e=U(e))instanceof Error?e:e===0?h:Math.log(e)/Math.log(10)},c.LOGEST=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t)))||e.length!==t.length)return u;for(let p=0;p<e.length;p++)e[p]=Math.log(e[p]);const r=Ee(e,t);return r[0]=Math.round(1e6*Math.exp(r[0]))/1e6,r[1]=Math.round(1e6*Math.exp(r[1]))/1e6,r},c.LOGINV=$n,c.LOGNORM=G,c.LOGNORMDIST=Jn,c.LOGNORMINV=Zn,c.LOOKUP=function(e,t,r){t=q(t),r=r?q(r):t;const p=typeof e=="number";let L=w;for(let B=0;B<t.length;B++){if(t[B]===e)return r[B];if(p&&t[B]<=e||typeof t[B]=="string"&&t[B].localeCompare(e)<0)L=r[B];else if(p&&t[B]>e)return L}return L},c.LOWER=function(e){return arguments.length!==1?u:ie(e=ze(e))?e:e.toLowerCase()},c.MATCH=function(e,t,r){if(!e||!t||(arguments.length===2&&(r=1),!((t=q(t))instanceof Array))||r!==-1&&r!==0&&r!==1)return w;let p,L;for(let B=0;B<t.length;B++)if(r===1){if(t[B]===e)return B+1;t[B]<e&&(L?t[B]>L&&(p=B+1,L=t[B]):(p=B+1,L=t[B]))}else if(r===0){if(typeof e=="string"&&typeof t[B]=="string"){const z=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+z+"$").test(t[B].toLowerCase()))return B+1}else if(t[B]===e)return B+1}else if(r===-1){if(t[B]===e)return B+1;t[B]>e&&(L?t[B]<L&&(p=B+1,L=t[B]):(p=B+1,L=t[B]))}return p||w},c.MAX=X,c.MAXA=function(){const e=q(arguments),t=ve.apply(void 0,e);if(t)return t;let r=F(e);return r=r.map(p=>p==null?0:p),r.length===0?0:Math.max.apply(Math,r)},c.MDURATION=function(){throw new Error("MDURATION is not implemented")},c.MEDIAN=re,c.MID=function(e,t,r){if(t==null)return u;if(ie(t=U(t),r=U(r))||typeof e!="string")return r;const p=t-1,L=p+r;return e.substring(p,L)},c.MIN=A,c.MINA=function(){const e=q(arguments),t=ve.apply(void 0,e);if(t)return t;let r=F(e);return r=r.map(p=>p==null?0:p),r.length===0?0:Math.min.apply(Math,r)},c.MINUTE=function(e){return(e=Be(e))instanceof Error?e:e.getMinutes()},c.MIRR=function(e,t,r){if(ie(e=Me(q(e)),t=U(t),r=U(r)))return u;const p=e.length,L=[],B=[];for(let fe=0;fe<p;fe++)e[fe]<0?L.push(e[fe]):B.push(e[fe]);const z=-Zt(r,B)*Math.pow(1+r,p-1),ne=Zt(t,L)*(1+t);return Math.pow(z/ne,1/(p-1))-1},c.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(r=>!r.length)||t.some(r=>!r.length)||ae(e).some(r=>typeof r!="number")||ae(t).some(r=>typeof r!="number")||e[0].length!==t.length?u:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((r,p)=>r.map((L,B)=>e[p].reduce((z,ne,fe)=>z+ne*t[fe][B],0)))},c.MOD=function(e,t){const r=ve(e=U(e),t=U(t));if(r)return r;if(t===0)return g;let p=Math.abs(e%t);return p=e<0?t-p:p,t>0?p:-p},c.MODE=S,c.MODEMULT=Qn,c.MODESNGL=eo,c.MONTH=function(e){return(e=Be(e))instanceof Error?e:e.getMonth()+1},c.MROUND=function(e,t){return ve(e=U(e),t=U(t))||(e*t==0?0:e*t<0?h:Math.round(e/t)*t)},c.MULTINOMIAL=function(){const e=Me(q(arguments));if(e instanceof Error)return e;let t=0,r=1;for(let p=0;p<e.length;p++)t+=e[p],r*=st(e[p]);return st(t)/r},c.MUNIT=function(e){return arguments.length>1?w:!(e=parseInt(e))||e<=0?u:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,r)=>(t[r]=1,t))},c.N=function(e){return v(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:Nt(e)?e:0},c.NA=function(){return w},c.NEGBINOM=Z,c.NEGBINOMDIST=to,c.NETWORKDAYS=Rt,c.NETWORKDAYSINTL=no,c.NOMINAL=function(e,t){return ie(e=U(e),t=U(t))?u:e<=0||t<1?h:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},c.NORM=ce,c.NORMDIST=oo,c.NORMINV=ro,c.NORMSDIST=io,c.NORMSINV=ao,c.NOT=function(e){return typeof e=="string"?u:e instanceof Error?e:!e},c.NOW=function(){return new Date},c.NPER=function(e,t,r,p,L){if(L=L===void 0?0:L,p=p===void 0?0:p,ie(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L)))return u;if(e===0)return-(r+p)/t;{const B=t*(1+e*L)-p*e,z=r*e+t*(1+e*L);return Math.log(B/z)/Math.log(1+e)}},c.NPV=Zt,c.NUMBERVALUE=function(e,t,r){return typeof(e=De(e)?e:"")=="number"?e:typeof e!="string"?w:(t=t===void 0?".":t,r=r===void 0?",":r,Number(e.replace(t,".").replace(r,"")))},c.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const r=!(e.length!==10||e.substring(0,1)!=="7"),p=r?parseInt(e,8)-1073741824:parseInt(e,8);if(p<-512||p>511)return h;if(r)return"1"+jt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const L=p.toString(2);return t===void 0?L:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=L.length?jt("0",t-L.length)+L:h},c.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return h;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},c.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const r=parseInt(e,8);if(r>=536870912)return"ff"+(r+3221225472).toString(16);const p=r.toString(16);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?jt("0",t-p.length)+p:h},c.ODD=function(e){if((e=U(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},c.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},c.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},c.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},c.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},c.OR=function(){const e=q(arguments);let t=u;for(let r=0;r<e.length;r++){if(e[r]instanceof Error)return e[r];e[r]!==void 0&&e[r]!==null&&typeof e[r]!="string"&&(t===u&&(t=!1),e[r]&&(t=!0))}return t},c.PDURATION=function(e,t,r){return ie(e=U(e),t=U(t),r=U(r))?u:e<=0?h:(Math.log(r)-Math.log(t))/Math.log(1+e)},c.PEARSON=de,c.PERCENTILE=K,c.PERCENTILEEXC=so,c.PERCENTILEINC=lo,c.PERCENTRANK=ye,c.PERCENTRANKEXC=uo,c.PERCENTRANKINC=co,c.PERMUT=function(e,t){return ie(e=U(e),t=U(t))?u:st(e)/st(e-t)},c.PERMUTATIONA=function(e,t){return ie(e=U(e),t=U(t))?u:Math.pow(e,t)},c.PHI=function(e){return(e=U(e))instanceof Error?u:Math.exp(-.5*e*e)/2.5066282746310002},c.PI=function(){return Math.PI},c.PMT=Dt,c.POISSON=Ne,c.POISSONDIST=fo,c.POWER=en,c.PPMT=function(e,t,r,p,L,B){return L=L||0,B=B||0,ie(e=U(e),r=U(r),p=U(p),L=U(L),B=U(B))?u:Dt(e,r,p,L,B)-cn(e,t,r,p,L,B)},c.PRICE=function(){throw new Error("PRICE is not implemented")},c.PRICEDISC=function(e,t,r,p,L){if(ie(e=Be(e),t=Be(t),r=U(r),p=U(p),L=(L=U(L))||0))return u;if(r<=0||p<=0)return h;if(e>=t)return u;let B,z;switch(L){case 0:B=360,z=Ct(e,t,!1);break;case 1:case 3:B=365,z=It(e,t,"D");break;case 2:B=360,z=It(e,t,"D");break;case 4:B=360,z=Ct(e,t,!0);break;default:return h}return p-r*p*z/B},c.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},c.PROB=function(e,t,r,p){if(r===void 0)return 0;if(p=p===void 0?r:p,ie(e=Me(q(e)),t=Me(q(t)),r=U(r),p=U(p)))return u;if(r===p)return e.indexOf(r)>=0?t[e.indexOf(r)]:0;const L=e.sort((ne,fe)=>ne-fe),B=L.length;let z=0;for(let ne=0;ne<B;ne++)L[ne]>=r&&L[ne]<=p&&(z+=t[e.indexOf(L[ne])]);return z},c.PRODUCT=Vt,c.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},c.PROPER=function(e){return ie(e)?e:isNaN(e)&&typeof e=="number"?u:(e=ze(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},c.PV=function(e,t,r,p,L){return p=p||0,L=L||0,ie(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L))?u:e===0?-r*t-p:((1-Math.pow(1+e,t))/e*r*(1+e*L)-p)/Math.pow(1+e,t)},c.QUARTILE=Ie,c.QUARTILEEXC=po,c.QUARTILEINC=ho,c.QUOTIENT=function(e,t){return ve(e=U(e),t=U(t))||parseInt(e/t,10)},c.RADIANS=function(e){return(e=U(e))instanceof Error?e:e*Math.PI/180},c.RAND=function(){return Math.random()},c.RANDBETWEEN=function(e,t){return ve(e=U(e),t=U(t))||e+Math.ceil((t-e+1)*Math.random())-1},c.RANK=Te,c.RANKAVG=go,c.RANKEQ=mo,c.RATE=function(e,t,r,p,L,B){if(B=B===void 0?.01:B,p=p===void 0?0:p,L=L===void 0?0:L,ie(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L),B=U(B)))return u;const z=1e-10;let ne=B;L=L?1:0;for(let fe=0;fe<20;fe++){if(ne<=-1)return h;let we,Fe,Ve;if(Math.abs(ne)<z?we=r*(1+e*ne)+t*(1+ne*L)*e+p:(Fe=Math.pow(1+ne,e),we=r*Fe+t*(1/ne+L)*(Fe-1)+p),Math.abs(we)<z)return ne;if(Math.abs(ne)<z)Ve=r*e+t*L*e;else{Fe=Math.pow(1+ne,e);const Re=e*Math.pow(1+ne,e-1);Ve=r*Re+t*(1/ne+L)*Re+t*(-1/(ne*ne))*(Fe-1)}ne-=we/Ve}return ne},c.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},c.REPLACE=function(e,t,r,p){return ie(t=U(t),r=U(r))||typeof e!="string"||typeof p!="string"?u:e.substr(0,t-1)+p+e.substr(t-1+r)},c.REPT=jt,c.RIGHT=function(e,t){return ve(e,t)||(e=ze(e),(t=U(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},c.ROMAN=function(e){if((e=U(e))instanceof Error)return e;const t=String(e).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let p="",L=3;for(;L--;)p=(r[+t.pop()+10*L]||"")+p;return new Array(+t.join("")+1).join("M")+p},c.ROUND=wt,c.ROUNDDOWN=function(e,t){return ve(e=U(e),t=U(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},c.ROUNDUP=function(e,t){return ve(e=U(e),t=U(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},c.ROW=function(e,t){return arguments.length!==2?w:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?j.row(e,t):void 0:u},c.ROWS=function(e){return arguments.length!==1?w:e instanceof Array?e.length===0?0:j.rows(e):u},c.RRI=function(e,t,r){return ie(e=U(e),t=U(t),r=U(r))?u:e===0||t===0?h:Math.pow(r/t,1/e)-1},c.RSQ=function(e,t){return ie(e=Me(q(e)),t=Me(q(t)))?u:Math.pow(de(e,t),2)},c.SEARCH=function(e,t,r){let p;return typeof e!="string"||typeof t!="string"?u:(r=r===void 0?0:r,p=t.toLowerCase().indexOf(e.toLowerCase(),r-1)+1,p===0?u:p)},c.SEC=function(e){return(e=U(e))instanceof Error?e:1/Math.cos(e)},c.SECH=function(e){return(e=U(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},c.SECOND=function(e){return(e=Be(e))instanceof Error?e:e.getSeconds()},c.SERIESSUM=function(e,t,r,p){if(ie(e=U(e),t=U(t),r=U(r),p=Me(p)))return u;let L=p[0]*Math.pow(e,t);for(let B=1;B<p.length;B++)L+=p[B]*Math.pow(e,t+B*r);return L},c.SHEET=function(){throw new Error("SHEET is not implemented")},c.SHEETS=function(){throw new Error("SHEETS is not implemented")},c.SIGN=function(e){return(e=U(e))instanceof Error?e:e<0?-1:e===0?0:1},c.SIN=function(e){return(e=U(e))instanceof Error?e:Math.sin(e)},c.SINH=function(e){return(e=U(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},c.SKEW=_e,c.SKEWP=bo,c.SLN=function(e,t,r){return ie(e=U(e),t=U(t),r=U(r))?u:r===0?h:(e-t)/r},c.SLOPE=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return u;const r=j.mean(t),p=j.mean(e),L=t.length;let B=0,z=0;for(let ne=0;ne<L;ne++)B+=(t[ne]-r)*(e[ne]-p),z+=Math.pow(t[ne]-r,2);return B/z},c.SMALL=$e,c.SORT=function(e,t=1,r=1,p=!1){if(!e||!Array.isArray(e))return w;if(e.length===0)return 0;if(!(t=U(t))||t<1||(r=U(r))!==1&&r!==-1)return u;if(typeof(p=Ue(p))!="boolean")return b;const L=ne=>ne.sort((fe,we)=>(fe=ze(fe[t-1]),we=ze(we[t-1]),r===1?fe<we?-1*r:r:fe>we?r:-1*r)),B=J(e),z=p?xe(B):B;return t>=1&&t<=z[0].length?p?xe(L(z)):L(z):u},c.SQRT=function(e){return(e=U(e))instanceof Error?e:e<0?h:Math.sqrt(e)},c.SQRTPI=function(e){return(e=U(e))instanceof Error?e:Math.sqrt(e*Math.PI)},c.STANDARDIZE=function(e,t,r){return ie(e=U(e),t=U(t),r=U(r))?u:(e-t)/r},c.STDEV=nt,c.STDEVA=function(){const e=Ae.apply(this,arguments);return Math.sqrt(e)},c.STDEVP=jo,c.STDEVPA=function(){const e=ke.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},c.STDEVS=vo,c.STEYX=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return u;const r=j.mean(t),p=j.mean(e),L=t.length;let B=0,z=0,ne=0;for(let fe=0;fe<L;fe++)B+=Math.pow(e[fe]-p,2),z+=(t[fe]-r)*(e[fe]-p),ne+=Math.pow(t[fe]-r,2);return Math.sqrt((B-z*z/ne)/(L-2))},c.SUBSTITUTE=function(e,t,r,p){if(arguments.length<3)return w;if(e&&t){if(p===void 0)return e.split(t).join(r);{if(p=Math.floor(Number(p)),Number.isNaN(p)||p<=0)return u;let L=0,B=0;for(;L>-1&&e.indexOf(t,L)>-1;)if(L=e.indexOf(t,L+1),B++,L>-1&&B===p)return e.substring(0,L)+r+e.substring(L+t.length);return e}}return e},c.SUBTOTAL=function(e,t){if((e=U(e))instanceof Error)return e;switch(e){case 1:case 101:return k(t);case 2:case 102:return W(t);case 3:case 103:return oe(t);case 4:case 104:return X(t);case 5:case 105:return A(t);case 6:case 106:return Vt(t);case 7:case 107:return nt.S(t);case 8:case 108:return nt.P(t);case 9:case 109:return At(t);case 10:case 110:return me.S(t);case 11:case 111:return me.P(t)}},c.SUM=At,c.SUMIF=function(e,t,r){if(e=q(e),r=r?q(r):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let p=0;const L=t==="*",B=L?null:vt(t+"");for(let z=0;z<e.length;z++){const ne=e[z],fe=r[z];if(L)p+=ne;else{const we=[ht(ne,ct)].concat(B);p+=mt(we)?fe:0}}return p},c.SUMIFS=function(){const e=H(arguments),t=Me(q(e.shift()));if(t instanceof Error)return t;const r=e,p=r.length/2;for(let B=0;B<p;B++)r[2*B]=q(r[2*B]);let L=0;for(let B=0;B<t.length;B++){let z=!1;for(let ne=0;ne<p;ne++){const fe=r[2*ne][B],we=r[2*ne+1];let Fe=!1;if(we===void 0||we==="*")Fe=!0;else{const Ve=vt(we+""),Re=[ht(fe,ct)].concat(Ve);Fe=mt(Re)}if(!Fe){z=!1;break}z=!0}z&&(L+=t[B])}return L},c.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return u;const e=arguments.length+1;let t,r,p,L,B=0;for(let z=0;z<arguments[0].length;z++)if(arguments[0][z]instanceof Array)for(let ne=0;ne<arguments[0][z].length;ne++){for(t=1,r=1;r<e;r++){const fe=arguments[r-1][z][ne];if(fe instanceof Error)return fe;if(L=U(fe),L instanceof Error)return L;t*=L}B+=t}else{for(t=1,r=1;r<e;r++){const ne=arguments[r-1][z];if(ne instanceof Error)return ne;if(p=U(ne),p instanceof Error)return p;t*=p}B+=t}return B},c.SUMSQ=function(){const e=Me(q(arguments));if(e instanceof Error)return e;let t=0;const r=e.length;for(let p=0;p<r;p++)t+=v(e[p])?e[p]*e[p]:0;return t},c.SUMX2MY2=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return u;let r=0;for(let p=0;p<e.length;p++)r+=e[p]*e[p]-t[p]*t[p];return r},c.SUMX2PY2=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return u;let r=0;e=Me(q(e)),t=Me(q(t));for(let p=0;p<e.length;p++)r+=e[p]*e[p]+t[p]*t[p];return r},c.SUMXMY2=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return u;let r=0;e=q(e),t=q(t);for(let p=0;p<e.length;p++)r+=Math.pow(e[p]-t[p],2);return r},c.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],r=arguments.length-1,p=Math.floor(r/2);let L=!1;const B=r%2!=0,z=r%2==0?null:arguments[arguments.length-1];if(p){for(let ne=0;ne<p;ne++)if(t===arguments[2*ne+1]){e=arguments[2*ne+2],L=!0;break}}L||(e=B?z:w)}else e=u;return e},c.SYD=function(e,t,r,p){return ie(e=U(e),t=U(t),r=U(r),p=U(p))?u:r===0||p<1||p>r?h:(e-t)*(r-(p=parseInt(p,10))+1)*2/(r*(r+1))},c.T=function(e){return e instanceof Error||typeof e=="string"?e:""},c.TAN=function(e){return(e=U(e))instanceof Error?e:Math.tan(e)},c.TANH=function(e){if((e=U(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},c.TBILLEQ=function(e,t,r){return ie(e=Be(e),t=Be(t),r=U(r))?u:r<=0||e>t||t-e>31536e6?h:365*r/(360-r*Ct(e,t,!1))},c.TBILLPRICE=function(e,t,r){return ie(e=Be(e),t=Be(t),r=U(r))?u:r<=0||e>t||t-e>31536e6?h:100*(1-r*Ct(e,t,!1)/360)},c.TBILLYIELD=function(e,t,r){return ie(e=Be(e),t=Be(t),r=U(r))?u:r<=0||e>t||t-e>31536e6?h:360*(100-r)/(r*Ct(e,t,!1))},c.TDIST=yo,c.TDISTRT=xo,c.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return w;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return u;const r=t.startsWith("$")?"$":"",p=t.endsWith("%");return p&&(e*=100),e=(e=sn(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+r+(e=e.replace("-","")):r+e,p&&(e+="%"),e},c.TEXTJOIN=function(e,t,...r){if(typeof t!="boolean"&&(t=Ue(t)),arguments.length<3)return w;e=e!=null?e:"";let p=q(r),L=t?p.filter(B=>B):p;if(Array.isArray(e)){e=q(e);let B=L.map(ne=>[ne]),z=0;for(let ne=0;ne<B.length-1;ne++)B[ne].push(e[z]),z++,z===e.length&&(z=0);return L=q(B),L.join("")}return L.join(e)},c.TIME=function(e,t,r){return ie(e=U(e),t=U(t),r=U(r))?u:e<0||t<0||r<0?h:(3600*e+60*t+r)/86400},c.TIMEVALUE=function(e){return(e=Be(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},c.TINV=wo,c.TODAY=function(){return kt(new Date)},c.TRANSPOSE=function(e){return e?xe(J(e)):w},c.TREND=function(e,t,r){if(ie(e=Me(q(e)),t=Me(q(t)),r=Me(q(r))))return u;const p=Ee(e,t),L=p[0],B=p[1],z=[];return r.forEach(ne=>{z.push(L*ne+B)}),z},c.TRIM=function(e){return(e=ze(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},c.TRIMMEAN=function(e,t){if(ie(e=Me(q(e)),t=U(t)))return u;const r=xt(e.length*t,2)/2;return j.mean((L=(L=r)||1,(p=se(e.sort((B,z)=>B-z),r))&&typeof p.slice=="function"?p.slice(0,p.length-L):p));var p,L},c.TRUE=function(){return!0},c.TRUNC=function(e,t){return ve(e=U(e),t=U(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},c.TTEST=Co,c.TYPE=function(e){return v(e)?1:C(e)?2:Ft(e)?4:Nt(e)?16:Array.isArray(e)?64:void 0},c.UNICHAR=yn,c.UNICODE=xn,c.UNIQUE=l,c.UPPER=function(e){return(e=ze(e))instanceof Error?e:e.toUpperCase()},c.VALUE=function(e){const t=ve(e);if(t)return t;if(typeof e=="number")return e;if(De(e)||(e=""),typeof e!="string")return u;const r=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let p=Number(e);return isNaN(p)?u:(p=p||0,r&&(p*=.01),p)},c.VAR=me,c.VARA=Ae,c.VARP=Eo,c.VARPA=ke,c.VARS=Ao,c.VDB=function(){throw new Error("VDB is not implemented")},c.VLOOKUP=o,c.WEEKDAY=function(e,t){if((e=Be(e))instanceof Error)return e;t===void 0&&(t=1);const r=e.getDay();return jn[t][r]},c.WEEKNUM=function(e,t){if((e=Be(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return tn(e);const r=bn[t];let p=new Date(e.getFullYear(),0,1);const L=p.getDay()<r?1:0;return p-=24*Math.abs(p.getDay()-r)*60*60*1e3,Math.floor((e-p)/864e5/7+1)+L},c.WEIBULL=rt,c.WEIBULLDIST=Lo,c.WORKDAY=Ht,c.WORKDAYINTL=Mo,c.XIRR=function(e,t,r){if(ie(e=Me(q(e)),t=lt(q(t)),r=U(r)))return u;const p=(Re,We,tt)=>{const ot=tt+1;let bt=Re[0];for(let dt=1;dt<Re.length;dt++)bt+=Re[dt]/Math.pow(ot,Lt(We[dt],We[0])/365);return bt},L=(Re,We,tt)=>{const ot=tt+1;let bt=0;for(let dt=1;dt<Re.length;dt++){const Et=Lt(We[dt],We[0])/365;bt-=Et*Re[dt]/Math.pow(ot,Et+1)}return bt};let B=!1,z=!1;for(let Re=0;Re<e.length;Re++)e[Re]>0&&(B=!0),e[Re]<0&&(z=!0);if(!B||!z)return h;let ne,fe,we,Fe=r=r||.1,Ve=!0;do we=p(e,t,Fe),ne=Fe-we/L(e,t,Fe),fe=Math.abs(ne-Fe),Fe=ne,Ve=fe>1e-10&&Math.abs(we)>1e-10;while(Ve);return Fe},c.XNPV=function(e,t,r){if(ie(e=U(e),t=Me(q(t)),r=lt(q(r))))return u;let p=0;for(let L=0;L<t.length;L++)p+=t[L]/Math.pow(1+e,Lt(r[L],r[0])/365);return p},c.XOR=function(){const e=q(arguments);let t=u;for(let r=0;r<e.length;r++){if(e[r]instanceof Error)return e[r];e[r]!==void 0&&e[r]!==null&&typeof e[r]!="string"&&(t===u&&(t=0),e[r]&&t++)}return t===u?t:!!(1&Math.floor(Math.abs(t)))},c.YEAR=function(e){return(e=Be(e))instanceof Error?e:e.getFullYear()},c.YEARFRAC=Ut,c.YIELD=function(){throw new Error("YIELD is not implemented")},c.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},c.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},c.Z=Xe,c.ZTEST=To,c.utils=No}},f={};function E(Y){var c=f[Y];if(c!==void 0)return c.exports;var a=f[Y]={exports:{}};return d[Y].call(a.exports,a,a.exports,E),a.exports}E.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(Y){if(typeof window=="object")return window}}();var D=E(960);s=D}(),s)},138:function(module,__unused_webpack_exports,__nested_webpack_require_141081__){if(!formula)var formula=__nested_webpack_require_141081__(243);var factory;factory=function(){"use strict";var Version=(info={title:"Jspreadsheet",version:"4.13.2",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(n){var s=(""+n)[0];return s=="="||s=="#"},getMask=function(n){if(n.format||n.mask||n.locale){var s={};return n.mask?s.mask=n.mask:n.format?s.mask=n.format:(s.locale=n.locale,s.options=n.options),n.decimal&&(s.options||(s.options={}),s.options={decimal:n.decimal}),s}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(n){n==null&&(n=!obj.options.fullscreen),obj.options.fullscreen!=n&&(obj.options.fullscreen=n,n==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(n){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var s=obj.options.onevent.apply(this,arguments);typeof obj.options[n]=="function"&&(s=obj.options[n].apply(this,Array.prototype.slice.call(arguments,1)))}if(n=="onafterchanges"&&obj.options.persistance){var d=obj.options.persistance==1?obj.options.url:obj.options.persistance,f=obj.prepareJson(arguments[2]);obj.save(d,f)}return s},obj.prepareTable=function(){var n=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var s=Object.keys(obj.options.data[0]);s.length>n&&(n=s.length)}obj.options.minDimensions[0]>n&&(n=obj.options.minDimensions[0]);for(var d=[],f=0;f<n;f++)obj.options.colHeaders[f]||(obj.options.colHeaders[f]=""),obj.options.colWidths[f]||(obj.options.colWidths[f]=obj.options.defaultColWidth),obj.options.colAlignments[f]||(obj.options.colAlignments[f]=obj.options.defaultColAlign),obj.options.columns[f]?obj.options.columns[f].type||(obj.options.columns[f].type="text"):obj.options.columns[f]={type:"text"},obj.options.columns[f].name||(obj.options.columns[f].name=s&&s[f]?s[f]:f),obj.options.columns[f].source||(obj.options.columns[f].source=[]),obj.options.columns[f].options||(obj.options.columns[f].options=[]),obj.options.columns[f].editor||(obj.options.columns[f].editor=null),obj.options.columns[f].allowEmpty||(obj.options.columns[f].allowEmpty=!1),obj.options.columns[f].title||(obj.options.columns[f].title=obj.options.colHeaders[f]?obj.options.colHeaders[f]:""),obj.options.columns[f].width||(obj.options.columns[f].width=obj.options.colWidths[f]?obj.options.colWidths[f]:obj.options.defaultColWidth),obj.options.columns[f].align||(obj.options.columns[f].align=obj.options.colAlignments[f]?obj.options.colAlignments[f]:"center"),obj.options.columns[f].type=="autocomplete"||obj.options.columns[f].type=="dropdown"?obj.options.columns[f].url&&d.push({url:obj.options.columns[f].url,index:f,method:"GET",dataType:"json",success:function(E){for(var D=0;D<E.length;D++)obj.options.columns[this.index].source.push(E[D])}}):obj.options.columns[f].type=="calendar"&&(obj.options.columns[f].options.format||(obj.options.columns[f].options.format="DD/MM/YYYY"));d.length?jSuites.ajax(d,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(h){obj.scrollControls(h)},obj.content.onwheel=function(h){obj.wheelControls(h)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var n=document.createElement("div"),s=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),n.appendChild(s),n.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var d=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var f=0;f<obj.options.paginationOptions.length;f++){var E=document.createElement("option");E.value=obj.options.paginationOptions[f],E.innerHTML=obj.options.paginationOptions[f],obj.paginationDropdown.appendChild(E)}obj.paginationDropdown.value=obj.options.pagination,d.appendChild(document.createTextNode(obj.options.text.show)),d.appendChild(obj.paginationDropdown),d.appendChild(document.createTextNode(obj.options.text.entries))}var D,Y=document.createElement("div");if(Y.classList.add("jexcel_filter"),Y.appendChild(d),Y.appendChild(n),obj.colgroupContainer=document.createElement("colgroup"),(D=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(D),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var c=0;c<obj.options.nestedHeaders.length;c++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[c]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(D=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(D),f=0;f<obj.options.columns.length;f++)obj.createCellHeader(f),obj.headerContainer.appendChild(obj.headers[f]),obj.colgroupContainer.appendChild(obj.colgroup[f]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var a=document.createElement("td");for(obj.filter.appendChild(a),f=0;f<obj.options.columns.length;f++)(a=document.createElement("td")).innerHTML="&nbsp;",a.setAttribute("data-x",f),a.className="jexcel_column_filter",obj.options.columns[f].type=="hidden"&&(a.style.display="none"),obj.filter.appendChild(a);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var j=document.createElement("a");j.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if(typeof sessionStorage!="undefined"&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var R=document.createElement("img");R.src="//bossanova.uk/jspreadsheet/logo.png",j.appendChild(R)}}catch(h){}var P=document.createElement("span");P.innerHTML="Jspreadsheet CE",j.appendChild(P),obj.ads.appendChild(j),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var g=document.createElement("div"),u=document.createElement("div");if(obj.pagination.appendChild(g),obj.pagination.appendChild(u),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(Y),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var m=Object.keys(obj.options.classes);for(f=0;f<m.length;f++){var b=jexcel.getIdFromColumnName(m[f],!0);obj.records[b[1]][b[0]].classList.add(obj.options.classes[m[f]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(n){if(n&&(typeof n=="string"&&(n=JSON.parse(n)),obj.options.data=n),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){n=[];for(var s=0;s<obj.options.data.length;s++){for(var d=[],f=0;f<obj.options.columns.length;f++)d[f]=obj.options.data[s][obj.options.columns[f].name];n.push(d)}obj.options.data=n}s=0,f=0;var E=obj.options.columns.length,D=obj.options.data.length,Y=obj.options.minDimensions[0],c=obj.options.minDimensions[1],a=Y>E?Y:E,j=c>D?c:D;for(s=0;s<j;s++)for(f=0;f<a;f++)obj.options.data[s]==null&&(obj.options.data[s]=[]),obj.options.data[s][f]==null&&(obj.options.data[s][f]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var R=0,P=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,R=obj.options.pagination*obj.pageNumber,P=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<P&&(P=obj.options.data.length)):(R=0,P=obj.options.data.length);for(s=0;s<obj.options.data.length;s++){var g=obj.createRow(s,obj.options.data[s]);s>=R&&s<P&&obj.tbody.appendChild(g)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var u=Object.keys(obj.options.mergeCells);for(f=0;f<u.length;f++){var m=obj.options.mergeCells[u[f]];obj.setMerge(u[f],m[0],m[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(n,s){for(var d=[],f=0,E=0,D=s==1||obj.options.copyCompatibility==0,Y=obj.options.columns.length,c=obj.options.data.length,a=0;a<c;a++){f=0;for(var j=0;j<Y;j++)n&&!obj.records[a][j].classList.contains("highlight")||(d[E]||(d[E]=[]),d[E][f]=D?obj.options.data[a][j]:obj.records[a][j].innerHTML,f++);f>0&&E++}return d},obj.getJsonRow=function(n){for(var s=obj.options.data[n],d=obj.options.columns.length,f={},E=0;E<d;E++)obj.options.columns[E].name||(obj.options.columns[E].name=E),f[obj.options.columns[E].name]=s[E];return f},obj.getJson=function(n){for(var s=[],d=obj.options.columns.length,f=obj.options.data.length,E=0;E<f;E++){for(var D=null,Y=0;Y<d;Y++)n&&!obj.records[E][Y].classList.contains("highlight")||(D==null&&(D={}),obj.options.columns[Y].name||(obj.options.columns[Y].name=Y),D[obj.options.columns[Y].name]=obj.options.data[E][Y]);D!=null&&s.push(D)}return s},obj.prepareJson=function(n){for(var s=[],d=0;d<n.length;d++){var f=n[d].x,E=n[d].y,D=obj.options.columns[f].name?obj.options.columns[f].name:f;s[E]||(s[E]={row:E,data:{}}),s[E].data[D]=n[d].newValue}return s.filter(function(Y){return Y!=null})},obj.save=function(n,s){var d=obj.dispatch("onbeforesave",el,obj,s);if(d)s=d;else if(d===!1)return!1;jSuites.ajax({url:n,method:"POST",dataType:"json",data:{data:JSON.stringify(s)},success:function(f){obj.dispatch("onsave",el,obj,s)}})},obj.getRowData=function(n){return obj.options.data[n]},obj.setRowData=function(n,s){for(var d=0;d<obj.headers.length;d++){var f=jexcel.getColumnNameFromId([d,n]);s[d]!=null&&obj.setValue(f,s[d])}},obj.getColumnData=function(n){for(var s=[],d=0;d<obj.options.data.length;d++)s.push(obj.options.data[d][n]);return s},obj.setColumnData=function(n,s){for(var d=0;d<obj.rows.length;d++){var f=jexcel.getColumnNameFromId([n,d]);s[d]!=null&&obj.setValue(f,s[d])}},obj.createRow=function(n,s){obj.records[n]||(obj.records[n]=[]),s||(s=obj.options.data[n]),obj.rows[n]=document.createElement("tr"),obj.rows[n].setAttribute("data-y",n);var d=null;obj.options.defaultRowHeight&&(obj.rows[n].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[n]&&(obj.options.rows[n].height&&(obj.rows[n].style.height=obj.options.rows[n].height),obj.options.rows[n].title&&(d=obj.options.rows[n].title)),d||(d=parseInt(n+1));var f=document.createElement("td");f.innerHTML=d,f.setAttribute("data-y",n),f.className="jexcel_row",obj.rows[n].appendChild(f);for(var E=0;E<obj.options.columns.length;E++)obj.records[n][E]=obj.createCell(E,n,s[E]),obj.rows[n].appendChild(obj.records[n][E]);return obj.rows[n]},obj.parseValue=function(n,s,d,f){(""+d).substr(0,1)=="="&&obj.options.parseFormulas==1&&(d=obj.executeFormula(d,n,s));var E=obj.options.columns[n];if(E&&!isFormula(d)){var D=null;if(D=getMask(E)){d&&d==Number(d)&&(d=Number(d));var Y=jSuites.mask.render(d,D,!0);if(f&&D.mask){var c=D.mask.split(";");c[1]&&(c[1].match(new RegExp("\\[Red\\]","gi"))&&(d<0?f.classList.add("red"):f.classList.remove("red")),c[1].match(new RegExp("\\(","gi"))&&d<0&&(Y="("+Y+")"))}Y&&(d=Y)}}return d};var validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])};obj.createCell=function(n,s,d){var f=document.createElement("td");if(f.setAttribute("data-x",n),f.setAttribute("data-y",s),(""+d).substr(0,1)=="="&&obj.options.secureFormulas==1){var E=secureFormula(d);E!=d&&(d=E)}if(obj.options.columns[n].editor)obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=d:f.textContent=d,typeof obj.options.columns[n].editor.createCell=="function"&&(f=obj.options.columns[n].editor.createCell(f));else if(obj.options.columns[n].type=="hidden")f.style.display="none",f.textContent=d;else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){var D=document.createElement("input");D.type=obj.options.columns[n].type,D.name="c"+n,D.checked=d==1||d==1||d=="true",D.onclick=function(){obj.setValue(f,this.checked)},obj.options.columns[n].readOnly!=1&&obj.options.editable!=0||D.setAttribute("disabled","disabled"),f.appendChild(D),obj.options.data[s][n]=D.checked}else if(obj.options.columns[n].type=="calendar"){var Y=null;if(!validDate(d)){var c=jSuites.calendar.extractDateFromString(d,obj.options.columns[n].options.format);c&&(Y=c)}f.textContent=jSuites.calendar.getDateString(Y||d,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")f.classList.add("jexcel_dropdown"),f.textContent=obj.getDropDownValue(n,d);else if(obj.options.columns[n].type=="color")if(obj.options.columns[n].render=="square"){var a=document.createElement("div");a.className="color",a.style.backgroundColor=d,f.appendChild(a)}else f.style.color=d,f.textContent=d;else if(obj.options.columns[n].type=="image"){if(d&&d.substr(0,10)=="data:image"){var j=document.createElement("img");j.src=d,f.appendChild(j)}}else obj.options.columns[n].type=="html"||obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=stripScript(obj.parseValue(n,s,d,f)):f.textContent=obj.parseValue(n,s,d,f);obj.options.columns[n].readOnly==1&&(f.className="readonly");var R=obj.options.columns[n].align?obj.options.columns[n].align:"center";return f.style.textAlign=R,obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||f.innerHTML.length>200)&&(f.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(d||f.innerHTML?obj.records[s][n-1].style.overflow="hidden":n==obj.options.columns.length-1&&(f.style.overflow="hidden")),f},obj.createCellHeader=function(n){var s=obj.options.columns[n].width?obj.options.columns[n].width:obj.options.defaultColWidth,d=obj.options.columns[n].align?obj.options.columns[n].align:obj.options.defaultColAlign;obj.headers[n]=document.createElement("td"),obj.options.stripHTML?obj.headers[n].textContent=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n):obj.headers[n].innerHTML=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n),obj.headers[n].setAttribute("data-x",n),obj.headers[n].style.textAlign=d,obj.options.columns[n].title&&obj.headers[n].setAttribute("title",obj.headers[n].innerText),obj.options.columns[n].id&&obj.headers[n].setAttribute("id",obj.options.columns[n].id),obj.colgroup[n]=document.createElement("col"),obj.colgroup[n].setAttribute("width",s),obj.options.columns[n].type=="hidden"&&(obj.headers[n].style.display="none",obj.colgroup[n].style.display="none")},obj.updateNestedHeader=function(n,s,d){obj.options.nestedHeaders[s][n].title&&(obj.options.nestedHeaders[s][n].title=d,obj.options.nestedHeaders[s].element.children[n+1].textContent=d)},obj.createNestedHeader=function(n){var s=document.createElement("tr");s.classList.add("jexcel_nested");var d=document.createElement("td");s.appendChild(d),n.element=s;for(var f=0,E=0;E<n.length;E++){n[E].colspan||(n[E].colspan=1),n[E].align||(n[E].align="center"),n[E].title||(n[E].title=""),n[E].id||(n[E].id="");for(var D=n[E].colspan,Y=[],c=0;c<D;c++)obj.options.columns[f]&&obj.options.columns[f].type=="hidden"&&D++,Y.push(f),f++;(d=document.createElement("td")).setAttribute("data-column",Y.join(",")),d.setAttribute("colspan",n[E].colspan),d.setAttribute("align",n[E].align),d.setAttribute("id",n[E].id),d.textContent=n[E].title,s.appendChild(d)}return s},obj.createToolbar=function(n){n?obj.options.toolbar=n:n=obj.options.toolbar;for(var s=0;s<n.length;s++)if(n[s].type=="i")(D=document.createElement("i")).classList.add("jexcel_toolbar_item"),D.classList.add("material-icons"),D.setAttribute("data-k",n[s].k),D.setAttribute("data-v",n[s].v),D.setAttribute("id",n[s].id),n[s].tooltip&&D.setAttribute("title",n[s].tooltip),n[s].onclick&&(n[s].onclick,1)?D.onclick=function(Y){var c=Y;return function(){n[c].onclick(el,obj,this)}}(s):D.onclick=function(){var Y=this.getAttribute("data-k"),c=this.getAttribute("data-v");obj.setStyle(obj.highlighted,Y,c)},D.textContent=n[s].content,obj.toolbar.appendChild(D);else if(n[s].type=="select"){var d=!1;(D=document.createElement("select")).classList.add("jexcel_toolbar_item"),D.setAttribute("data-k",n[s].k),n[s].tooltip&&D.setAttribute("title",n[s].tooltip),n[s].onchange&&(n[s].onchange,1)?(D.onchange=n[s].onchange,d=!0):D.onchange=function(){var Y=this.getAttribute("data-k");obj.setStyle(obj.highlighted,Y,this.value)};for(var f=0;f<n[s].v.length;f++){var E=document.createElement("option");E.value=n[s].v[f],E.textContent=n[s].v[f],n[s].selectedValue&&E.value===n[s].selectedValue&&(E.selected=!0),D.appendChild(E)}d&&D.dispatchEvent(new Event("change")),obj.toolbar.appendChild(D)}else if(n[s].type=="color"){var D;(D=document.createElement("i")).classList.add("jexcel_toolbar_item"),D.classList.add("material-icons"),D.setAttribute("data-k",n[s].k),D.setAttribute("data-v",""),n[s].tooltip&&D.setAttribute("title",n[s].tooltip),obj.toolbar.appendChild(D),D.textContent=n[s].content,jSuites.color(D,{onchange:function(Y,c){var a=Y.getAttribute("data-k");obj.setStyle(obj.highlighted,a,c)}})}},obj.setMerge=function(n,s,d,f){var E=!1;if(!n){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var D=parseInt(obj.highlighted[0].getAttribute("data-x")),Y=parseInt(obj.highlighted[0].getAttribute("data-y")),c=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),a=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));n=jexcel.getColumnNameFromId([D,Y]),s=c-D+1,d=a-Y+1}var j=jexcel.getIdFromColumnName(n,!0);if(obj.options.mergeCells[n])obj.records[j[1]][j[0]].getAttribute("data-merged")&&(E=obj.options.text.cellAlreadyMerged);else if((!s||s<2)&&(!d||d<2))E=obj.options.text.invalidMergeProperties;else for(var R=j[1];R<j[1]+d;R++)for(var P=j[0];P<j[0]+s;P++)jexcel.getColumnNameFromId([P,R]),obj.records[R][P].getAttribute("data-merged")&&(E=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(E)alert(E);else{s>1?obj.records[j[1]][j[0]].setAttribute("colspan",s):s=1,d>1?obj.records[j[1]][j[0]].setAttribute("rowspan",d):d=1,obj.options.mergeCells[n]=[s,d,[]],obj.records[j[1]][j[0]].setAttribute("data-merged","true"),obj.records[j[1]][j[0]].style.overflow="hidden";for(var g=[],u=j[1];u<j[1]+d;u++)for(var m=j[0];m<j[0]+s;m++)j[0]==m&&j[1]==u||(g.push(obj.options.data[u][m]),obj.updateCell(m,u,"",!0),obj.options.mergeCells[n][2].push(obj.records[u][m]),obj.records[u][m].style.display="none",obj.records[u][m]=obj.records[j[1]][j[0]]);obj.updateSelection(obj.records[j[1]][j[0]]),f||(obj.setHistory({action:"setMerge",column:n,colspan:s,rowspan:d,data:g}),obj.dispatch("onmerge",el,n,s,d))}},obj.getMerge=function(n){var s={};if(n)s=obj.options.mergeCells[n]?[obj.options.mergeCells[n][0],obj.options.mergeCells[n][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var d=Object.keys(obj.options.mergeCells),f=0;f<d.length;f++)s[d[f]]=[obj.options.mergeCells[d[f]][0],obj.options.mergeCells[d[f]][1]]}return s},obj.removeMerge=function(n,s,d){if(obj.options.mergeCells[n]){var f=jexcel.getIdFromColumnName(n,!0);obj.records[f[1]][f[0]].removeAttribute("colspan"),obj.records[f[1]][f[0]].removeAttribute("rowspan"),obj.records[f[1]][f[0]].removeAttribute("data-merged");for(var E=obj.options.mergeCells[n],D=0,Y=0;Y<E[1];Y++)for(var c=0;c<E[0];c++)(Y>0||c>0)&&(obj.records[f[1]+Y][f[0]+c]=E[2][D],obj.records[f[1]+Y][f[0]+c].style.display="",s&&s[D]&&obj.updateCell(f[0]+c,f[1]+Y,s[D]),D++);obj.updateSelection(obj.records[f[1]][f[0]],obj.records[f[1]+Y-1][f[0]+c-1]),d||delete obj.options.mergeCells[n]}},obj.destroyMerged=function(n){if(obj.options.mergeCells){obj.options.mergeCells;for(var s=Object.keys(obj.options.mergeCells),d=0;d<s.length;d++)obj.removeMerge(s[d],null,n)}},obj.isColMerged=function(n,s){var d=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),E=0;E<f.length;E++){var D=jexcel.getIdFromColumnName(f[E],!0),Y=obj.options.mergeCells[f[E]][0],c=D[0],a=D[0]+(Y>1?Y-1:0);s==null?c<=n&&a>=n&&d.push(f[E]):s?c<n&&a>=n&&d.push(f[E]):c<=n&&a>n&&d.push(f[E])}return d},obj.isRowMerged=function(n,s){var d=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),E=0;E<f.length;E++){var D=jexcel.getIdFromColumnName(f[E],!0),Y=obj.options.mergeCells[f[E]][1],c=D[1],a=D[1]+(Y>1?Y-1:0);s==null?c<=n&&a>=n&&d.push(f[E]):s?c<n&&a>=n&&d.push(f[E]):c<=n&&a>n&&d.push(f[E])}return d},obj.openFilter=function(n){if(obj.options.filters){n=parseInt(n),obj.resetSelection();var s=[];if(obj.options.columns[n].type=="checkbox")s.push({id:"true",name:"True"}),s.push({id:"false",name:"False"});else{for(var d=[],f=!1,E=0;E<obj.options.data.length;E++){var D=obj.options.data[E][n],Y=obj.records[E][n].innerHTML;D&&Y?d[D]=Y:f=!0}var c=Object.keys(d);for(s=[],E=0;E<c.length;E++)s.push({id:c[E],name:d[c[E]]});f&&s.push({value:"",id:"",name:"(Blanks)"})}var a=document.createElement("div");obj.filter.children[n+1].innerHTML="",obj.filter.children[n+1].appendChild(a),obj.filter.children[n+1].style.paddingLeft="0px",obj.filter.children[n+1].style.paddingRight="0px",obj.filter.children[n+1].style.overflow="initial";var j={data:s,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[n]!==void 0?obj.filters[n]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(R){obj.resetFilters(),obj.filters[n]=R.dropdown.getValue(!0),obj.filter.children[n+1].innerHTML=R.dropdown.getText(),obj.filter.children[n+1].style.paddingLeft="",obj.filter.children[n+1].style.paddingRight="",obj.filter.children[n+1].style.overflow="",obj.closeFilter(n),obj.refreshSelection()}};jSuites.dropdown(a,j)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var n=0;n<obj.filter.children.length;n++)obj.filter.children[n].innerHTML="&nbsp;",obj.filters[n]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(n){if(!n)for(var s=0;s<obj.filter.children.length;s++)obj.filters[s]&&(n=s);var d=function(D,Y,c){for(var a=0;a<D.length;a++){var j=""+obj.options.data[c][Y],R=""+obj.records[c][Y].innerHTML;if(D[a]==j||D[a]==R)return!0}return!1},f=obj.filters[n];obj.results=[];for(var E=0;E<obj.options.data.length;E++)d(f,n,E)&&obj.results.push(E);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(n,s,d){var f=n.getAttribute("data-y"),E=n.getAttribute("data-x");obj.dispatch("oneditionstart",el,n,E,f),E>0&&(obj.records[f][E-1].style.overflow="hidden");var D=function(T){var N=n.getBoundingClientRect(),V=document.createElement(T);return V.style.width=N.width+"px",V.style.height=N.height-2+"px",V.style.minHeight=N.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(V),obj.dispatch("oncreateeditor",el,n,E,f,V),V};if(n.classList.contains("readonly")!=1){if(obj.edition=[obj.records[f][E],obj.records[f][E].innerHTML,E,f],obj.options.columns[E].editor)obj.options.columns[E].editor.openEditor(n,el,s,d);else if(obj.options.columns[E].type!="hidden")if(obj.options.columns[E].type=="checkbox"||obj.options.columns[E].type=="radio"){var Y=!n.children[0].checked;obj.setValue(n,Y),obj.edition=null}else if(obj.options.columns[E].type=="dropdown"||obj.options.columns[E].type=="autocomplete"){if(Y=obj.options.data[f][E],obj.options.columns[E].multiple&&!Array.isArray(Y)&&(Y=Y.split(";")),typeof obj.options.columns[E].filter=="function")var c=obj.options.columns[E].filter(el,n,E,f,obj.options.columns[E].source);else c=obj.options.columns[E].source;for(var a=[],j=0;j<c.length;j++)a.push(c[j]);var R=D("div"),P={data:a,multiple:!!obj.options.columns[E].multiple,autocomplete:!(!obj.options.columns[E].autocomplete&&obj.options.columns[E].type!="autocomplete"),opened:!0,value:Y,width:"100%",height:R.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(n,!0)}};obj.options.columns[E].options&&obj.options.columns[E].options.type&&(P.type=obj.options.columns[E].options.type),jSuites.dropdown(R,P)}else if(obj.options.columns[E].type=="calendar"||obj.options.columns[E].type=="color")Y=obj.options.data[f][E],(R=D("input")).value=Y,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[E].options.position=!0),obj.options.columns[E].options.value=obj.options.data[f][E],obj.options.columns[E].options.opened=!0,obj.options.columns[E].options.onclose=function(T,N){obj.closeEditor(n,!0)},obj.options.columns[E].type=="color"?jSuites.color(R,obj.options.columns[E].options):jSuites.calendar(R,obj.options.columns[E].options),R.focus();else if(obj.options.columns[E].type=="html"){Y=obj.options.data[f][E],(R=D("div")).style.position="relative",(m=document.createElement("div")).classList.add("jexcel_richtext"),R.appendChild(m),jSuites.editor(m,{focus:!0,value:Y});var g=n.getBoundingClientRect(),u=m.getBoundingClientRect();window.innerHeight<g.bottom+u.height?m.style.top=g.top-(u.height+2)+"px":m.style.top=g.top+"px"}else if(obj.options.columns[E].type=="image"){var m,b=n.children[0];(R=D("div")).style.position="relative",(m=document.createElement("div")).classList.add("jclose"),b&&b.src&&m.appendChild(b),R.appendChild(m),jSuites.image(m,obj.options.imageOptions),g=n.getBoundingClientRect(),u=m.getBoundingClientRect(),window.innerHeight<g.bottom+u.height?m.style.top=g.top-(u.height+2)+"px":m.style.top=g.top+"px"}else{Y=s==1?"":obj.options.data[f][E],obj.options.columns[E].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[E].wordWrap!=1?R=D("input"):R=D("textarea"),R.focus(),R.value=Y,P=obj.options.columns[E];var h=null;if(!isFormula(Y)&&(h=getMask(P))){if(!P.disabledMaskOnEdition)if(P.mask){var w=P.mask.split(";");R.setAttribute("data-mask",w[0])}else P.locale&&R.setAttribute("data-locale",P.locale);h.input=R,R.mask=h,jSuites.mask.render(Y,h,!1)}R.onblur=function(){obj.closeEditor(n,!0)},R.scrollLeft=R.scrollWidth}}},obj.closeEditor=function(n,s){var d=parseInt(n.getAttribute("data-x")),f=parseInt(n.getAttribute("data-y"));if(s==1){if(obj.options.columns[d].editor)var E=obj.options.columns[d].editor.closeEditor(n,s);else if(!(obj.options.columns[d].type=="checkbox"||obj.options.columns[d].type=="radio"||obj.options.columns[d].type=="hidden"))if(obj.options.columns[d].type=="dropdown"||obj.options.columns[d].type=="autocomplete")E=n.children[0].dropdown.close(!0);else if(obj.options.columns[d].type=="calendar")E=n.children[0].calendar.close(!0);else if(obj.options.columns[d].type=="color")E=n.children[0].color.close(!0);else if(obj.options.columns[d].type=="html")E=n.children[0].children[0].editor.getData();else if(obj.options.columns[d].type=="image"){var D=n.children[0].children[0].children[0];E=D&&D.tagName=="IMG"?D.src:""}else if(obj.options.columns[d].type=="numeric")(""+(E=n.children[0].value)).substr(0,1)!="="&&E==""&&(E=obj.options.columns[d].allowEmpty?"":0),n.children[0].onblur=null;else{E=n.children[0].value,n.children[0].onblur=null;var Y,c=obj.options.columns[d];if((Y=getMask(c))&&E!==""&&!isFormula(E)&&typeof E!="number"){var a=jSuites.mask.extract(E,Y,!0);a&&a.value!==""&&(E=a.value)}}obj.options.data[f][d]==E?n.innerHTML=obj.edition[1]:obj.setValue(n,E)}else obj.options.columns[d].editor?obj.options.columns[d].editor.closeEditor(n,s):obj.options.columns[d].type=="dropdown"||obj.options.columns[d].type=="autocomplete"?n.children[0].dropdown.close(!0):obj.options.columns[d].type=="calendar"?n.children[0].calendar.close(!0):obj.options.columns[d].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,n,d,f,E,s),n.classList.remove("editor"),obj.edition=null},obj.getCell=function(n){var s=(n=jexcel.getIdFromColumnName(n,!0))[0],d=n[1];return obj.records[d][s]},obj.getColumnOptions=function(n,s){var d=obj.options.columns[n];return d||(d={type:"text"}),d},obj.getCellFromCoords=function(n,s){return obj.records[s][n]},obj.getLabel=function(n){var s=(n=jexcel.getIdFromColumnName(n,!0))[0],d=n[1];return obj.records[d][s].innerHTML},obj.getLabelFromCoords=function(n,s){return obj.records[s][n].innerHTML},obj.getValue=function(n,s){if(typeof n=="object")var d=n.getAttribute("data-x"),f=n.getAttribute("data-y");else d=(n=jexcel.getIdFromColumnName(n,!0))[0],f=n[1];var E=null;return d!=null&&f!=null&&(obj.records[f]&&obj.records[f][d]&&(s||obj.options.copyCompatibility==1)?E=obj.records[f][d].innerHTML:obj.options.data[f]&&obj.options.data[f][d]!="undefined"&&(E=obj.options.data[f][d])),E},obj.getValueFromCoords=function(n,s,d){var f=null;return n!=null&&s!=null&&(obj.records[s]&&obj.records[s][n]&&d||obj.options.copyCompatibility==1?f=obj.records[s][n].innerHTML:obj.options.data[s]&&obj.options.data[s][n]!="undefined"&&(f=obj.options.data[s][n])),f},obj.setValue=function(n,s,d){var f=[];if(typeof n=="string"){var E=(a=jexcel.getIdFromColumnName(n,!0))[0],D=a[1];f.push(obj.updateCell(E,D,s,d)),obj.updateFormulaChain(E,D,f)}else if(E=null,D=null,n&&n.getAttribute&&(E=n.getAttribute("data-x"),D=n.getAttribute("data-y")),E!=null&&D!=null)f.push(obj.updateCell(E,D,s,d)),obj.updateFormulaChain(E,D,f);else{var Y=Object.keys(n);if(Y.length>0)for(var c=0;c<Y.length;c++){var a;typeof n[c]=="string"?(E=(a=jexcel.getIdFromColumnName(n[c],!0))[0],D=a[1]):n[c].x!=null&&n[c].y!=null?(E=n[c].x,D=n[c].y,n[c].newValue!=null?s=n[c].newValue:n[c].value!=null&&(s=n[c].value)):(E=n[c].getAttribute("data-x"),D=n[c].getAttribute("data-y")),E!=null&&D!=null&&(f.push(obj.updateCell(E,D,s,d)),obj.updateFormulaChain(E,D,f))}}obj.setHistory({action:"setValue",records:f,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,f)},obj.setValueFromCoords=function(n,s,d,f){var E=[];E.push(obj.updateCell(n,s,d,f)),obj.updateFormulaChain(n,s,E),obj.setHistory({action:"setValue",records:E,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,E)},obj.setCheckRadioValue=function(){for(var n=[],s=Object.keys(obj.highlighted),d=0;d<s.length;d++){var f=obj.highlighted[d].getAttribute("data-x"),E=obj.highlighted[d].getAttribute("data-y");obj.options.columns[f].type!="checkbox"&&obj.options.columns[f].type!="radio"||n.push(obj.updateCell(f,E,!obj.options.data[E][f]))}n.length&&(obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.onafterchanges(el,n))};var stripScript=function(n){var s=new Option;s.innerHTML=n;var d=null;for(n=s.getElementsByTagName("script");d=n[0];)d.parentNode.removeChild(d);return s.innerHTML};obj.updateCell=function(n,s,d,f){if(obj.records[s][n].classList.contains("readonly")!=1||f){var E;(""+d).substr(0,1)=="="&&obj.options.secureFormulas==1&&(E=secureFormula(d))!=d&&(d=E),(E=obj.dispatch("onbeforechange",el,obj.records[s][n],n,s,d))!=null&&(d=E),obj.options.columns[n].editor&&typeof obj.options.columns[n].editor.updateCell=="function"&&(d=obj.options.columns[n].editor.updateCell(obj.records[s][n],d,f)),R={x:n,y:s,col:n,row:s,newValue:d,oldValue:obj.options.data[s][n]};let P=obj.options.columns[n].editor;if(P)obj.options.data[s][n]=d,typeof P.setValue=="function"&&P.setValue(obj.records[s][n],d);else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){if(obj.options.columns[n].type=="radio")for(var D=0;D<obj.options.data.length;D++)obj.options.data[D][n]=!1;obj.records[s][n].children[0].checked=d==1||d==1||d=="true"||d=="TRUE",obj.options.data[s][n]=obj.records[s][n].children[0].checked}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")obj.options.data[s][n]=d,obj.records[s][n].textContent=obj.getDropDownValue(n,d);else if(obj.options.columns[n].type=="calendar"){var Y=null;if(!validDate(d)){var c=jSuites.calendar.extractDateFromString(d,obj.options.columns[n].options.format);c&&(Y=c)}obj.options.data[s][n]=d,obj.records[s][n].textContent=jSuites.calendar.getDateString(Y||d,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="color")if(obj.options.data[s][n]=d,obj.options.columns[n].render=="square"){var a=document.createElement("div");a.className="color",a.style.backgroundColor=d,obj.records[s][n].textContent="",obj.records[s][n].appendChild(a)}else obj.records[s][n].style.color=d,obj.records[s][n].textContent=d;else if(obj.options.columns[n].type=="image"){if(d=""+d,obj.options.data[s][n]=d,obj.records[s][n].innerHTML="",d&&d.substr(0,10)=="data:image"){var j=document.createElement("img");j.src=d,obj.records[s][n].appendChild(j)}}else obj.options.data[s][n]=d,obj.options.columns[n].type=="html"?obj.records[s][n].innerHTML=stripScript(obj.parseValue(n,s,d)):obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?obj.records[s][n].innerHTML=stripScript(obj.parseValue(n,s,d,obj.records[s][n])):obj.records[s][n].textContent=obj.parseValue(n,s,d,obj.records[s][n]),obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||obj.records[s][n].innerHTML.length>200)?obj.records[s][n].style.whiteSpace="pre-wrap":obj.records[s][n].style.whiteSpace="";n>0&&(obj.records[s][n-1].style.overflow=d?"hidden":""),obj.dispatch("onchange",el,obj.records[s]&&obj.records[s][n]?obj.records[s][n]:null,n,s,d,R.oldValue)}else var R={x:n,y:s,col:n,row:s};return R},obj.copyData=function(n,s){var d=obj.getData(!0,!0),f=obj.selectedContainer,E=parseInt(n.getAttribute("data-x")),D=parseInt(n.getAttribute("data-y")),Y=parseInt(s.getAttribute("data-x")),c=parseInt(s.getAttribute("data-y")),a=[],j=!1;if(f[0]==E){if(D<f[1])var R=D-f[1];else R=1;var P=0}else P=E<f[0]?E-f[0]:1,R=0;for(var g=0,u=0,m=D;m<=c;m++)if(!obj.rows[m]||obj.rows[m].style.display!="none"){d[u]==null&&(u=0),g=0,f[0]!=E&&(P=E<f[0]?E-f[0]:1);for(var b=E;b<=Y;b++){if(obj.records[m][b]&&!obj.records[m][b].classList.contains("readonly")&&obj.records[m][b].style.display!="none"&&j==0){if(!obj.selection.length&&obj.options.data[m][b]!=""){j=!0;continue}(d[u]==null||d[u][g]==null)&&(g=0);var h=d[u][g];if(h&&!d[1]&&obj.options.autoIncrement==1){if(obj.options.columns[b].type=="text"||obj.options.columns[b].type=="number")if((""+h).substr(0,1)=="="){var w=h.match(/([A-Z]+[0-9]+)/g);if(w){for(var T=[],N=0;N<w.length;N++){var V=jexcel.getIdFromColumnName(w[N],1);V[0]+=P,V[1]+=R,V[1]<0&&(V[1]=0);var H=jexcel.getColumnNameFromId([V[0],V[1]]);H!=w[N]&&(T[w[N]]=H)}T&&(h=obj.updateFormula(h,T))}}else h==Number(h)&&(h=Number(h)+R);else if(obj.options.columns[b].type=="calendar"){var M=new Date(h);M.setDate(M.getDate()+R),h=M.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(M.getMonth()+1))+"-"+jexcel.doubleDigitFormat(M.getDate())+" 00:00:00"}}a.push(obj.updateCell(b,m,h)),obj.updateFormulaChain(b,m,a)}g++,f[0]!=E&&P++}u++,R++}obj.setHistory({action:"setValue",records:a,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,a)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(n,s,d){if(n==1){if(obj.selectedCell&&(s>=obj.selectedCell[1]&&s<=obj.selectedCell[3]||d>=obj.selectedCell[1]&&d<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(s>=obj.selectedCell[0]&&s<=obj.selectedCell[2]||d>=obj.selectedCell[0]&&d<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(n){if(obj.highlighted.length){j=1;for(var s=0;s<obj.highlighted.length;s++){obj.highlighted[s].classList.remove("highlight"),obj.highlighted[s].classList.remove("highlight-left"),obj.highlighted[s].classList.remove("highlight-right"),obj.highlighted[s].classList.remove("highlight-top"),obj.highlighted[s].classList.remove("highlight-bottom"),obj.highlighted[s].classList.remove("highlight-selected");var d=parseInt(obj.highlighted[s].getAttribute("data-x")),f=parseInt(obj.highlighted[s].getAttribute("data-y"));if(obj.highlighted[s].getAttribute("data-merged"))var E=parseInt(obj.highlighted[s].getAttribute("colspan")),D=parseInt(obj.highlighted[s].getAttribute("rowspan")),Y=E>0?d+(E-1):d,c=D>0?f+(D-1):f;else Y=d,c=f;for(var a=d;a<=Y;a++)obj.headers[a]&&obj.headers[a].classList.remove("selected");for(a=f;a<=c;a++)obj.rows[a]&&obj.rows[a].classList.remove("selected")}}else var j=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",n==1&&j==1&&obj.dispatch("onblur",el),j},obj.updateSelection=function(n,s,d){var f=n.getAttribute("data-x"),E=n.getAttribute("data-y");if(s)var D=s.getAttribute("data-x"),Y=s.getAttribute("data-y");else D=f,Y=E;obj.updateSelectionFromCoords(f,E,D,Y,d)},obj.updateSelectionFromCoords=function(n,s,d,f,E){var D=obj.resetSelection();if(s==null&&(s=0,f=obj.rows.length-1),d==null&&(d=n),f==null&&(f=s),n>=obj.headers.length&&(n=obj.headers.length-1),s>=obj.rows.length&&(s=obj.rows.length-1),d>=obj.headers.length&&(d=obj.headers.length-1),f>=obj.rows.length&&(f=obj.rows.length-1),obj.selectedCell=[n,s,d,f],n!=null){if(obj.records[s][n]&&obj.records[s][n].classList.add("highlight-selected"),parseInt(n)<parseInt(d))var Y=parseInt(n),c=parseInt(d);else Y=parseInt(d),c=parseInt(n);if(parseInt(s)<parseInt(f))var a=parseInt(s),j=parseInt(f);else a=parseInt(f),j=parseInt(s);for(var R=Y;R<=c;R++)for(var P=a;P<=j;P++)if(obj.records[P][R]&&obj.records[P][R].getAttribute("data-merged")){var g=parseInt(obj.records[P][R].getAttribute("data-x")),u=parseInt(obj.records[P][R].getAttribute("data-y")),m=parseInt(obj.records[P][R].getAttribute("colspan")),b=parseInt(obj.records[P][R].getAttribute("rowspan"));m>1&&(g<Y&&(Y=g),g+m>c&&(c=g+m-1)),b&&(u<a&&(a=u),u+b>j&&(j=u+b-1))}var h=null,w=null,T=null,N=null;for(P=a;P<=j;P++)obj.rows[P].style.display!="none"&&(T==null&&(T=P),N=P);for(R=Y;R<=c;R++){for(P=a;P<=j;P++)obj.rows[P].style.display!="none"&&obj.records[P][R].style.display!="none"&&(obj.records[P][R].classList.add("highlight"),obj.highlighted.push(obj.records[P][R]));obj.options.columns[R].type!="hidden"&&(h==null&&(h=R),w=R)}for(h||(h=0),w||(w=0),R=h;R<=w;R++)obj.options.columns[R].type!="hidden"&&(obj.records[T]&&obj.records[T][R]&&obj.records[T][R].classList.add("highlight-top"),obj.records[N]&&obj.records[N][R]&&obj.records[N][R].classList.add("highlight-bottom"),obj.headers[R].classList.add("selected"));for(P=T;P<=N;P++)obj.rows[P]&&obj.rows[P].style.display!="none"&&(obj.records[P][h].classList.add("highlight-left"),obj.records[P][w].classList.add("highlight-right"),obj.rows[P].classList.add("selected"));obj.selectedContainer=[h,T,w,N]}D==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,h,T,w,N,E),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var n=0;n<obj.selection.length;n++)obj.selection[n].classList.remove("selection"),obj.selection[n].classList.remove("selection-left"),obj.selection[n].classList.remove("selection-right"),obj.selection[n].classList.remove("selection-top"),obj.selection[n].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(n,s){obj.removeCopySelection();var d=obj.selectedContainer[0],f=obj.selectedContainer[1],E=obj.selectedContainer[2],D=obj.selectedContainer[3];if(n!=null&&s!=null){if(n-E>0)var Y=parseInt(E)+1,c=parseInt(n);else Y=parseInt(n),c=parseInt(d)-1;if(s-D>0)var a=parseInt(D)+1,j=parseInt(s);else a=parseInt(s),j=parseInt(f)-1;c-Y<=j-a?(Y=parseInt(d),c=parseInt(E)):(a=parseInt(f),j=parseInt(D));for(var R=a;R<=j;R++)for(var P=Y;P<=c;P++)obj.records[R][P]&&obj.rows[R].style.display!="none"&&obj.records[R][P].style.display!="none"&&(obj.records[R][P].classList.add("selection"),obj.records[a][P].classList.add("selection-top"),obj.records[j][P].classList.add("selection-bottom"),obj.records[R][Y].classList.add("selection-left"),obj.records[R][c].classList.add("selection-right"),obj.selection.push(obj.records[R][P]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var n=obj.highlighted[obj.highlighted.length-1],s=n.getAttribute("data-x"),d=obj.content.getBoundingClientRect(),f=d.left,E=d.top,D=n.getBoundingClientRect(),Y=D.left,c=D.top,a=D.width,j=D.height,R=Y-f+obj.content.scrollLeft+a-4,P=c-E+obj.content.scrollTop+j-4;if(obj.corner.style.top=P+"px",obj.corner.style.left=R+"px",obj.options.freezeColumns){var g=obj.getFreezeWidth();s>obj.options.freezeColumns-1&&Y-f+a<g?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(n){var s=obj.content.getBoundingClientRect(),d=s.left,f=s.top,E=s.width,D=s.height,Y=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),c=Y.left,a=Y.top,j=Y.width,R=Y.height;if(n==0||n==1)var P=c-d+obj.content.scrollLeft,g=a-f+obj.content.scrollTop-2;else P=c-d+obj.content.scrollLeft+j,g=a-f+obj.content.scrollTop+R;g>obj.content.scrollTop+30&&g<obj.content.scrollTop+D||(g<obj.content.scrollTop+30?obj.content.scrollTop=g-R:obj.content.scrollTop=g-(D-2));var u=obj.getFreezeWidth();P>obj.content.scrollLeft+u&&P<obj.content.scrollLeft+E||(P<obj.content.scrollLeft+30?(obj.content.scrollLeft=P,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):P<obj.content.scrollLeft+u?obj.content.scrollLeft=P-u-1:obj.content.scrollLeft=P-(E-20))},obj.getWidth=function(n){if(n===void 0)for(var s=[],d=0;d<obj.headers.length;d++)s.push(obj.options.columns[d].width);else typeof n=="object"&&(n=n.getAttribute("data-x")),s=obj.colgroup[n].getAttribute("width");return s},obj.setWidth=function(n,s,d){if(s){if(Array.isArray(n)){d||(d=[]);for(var f=0;f<n.length;f++){d[f]||(d[f]=obj.colgroup[n[f]].getAttribute("width"));var E=Array.isArray(s)&&s[f]?s[f]:s;obj.colgroup[n[f]].setAttribute("width",E),obj.options.columns[n[f]].width=E}}else d||(d=obj.colgroup[n].getAttribute("width")),obj.colgroup[n].setAttribute("width",s),obj.options.columns[n].width=s;obj.setHistory({action:"setWidth",column:n,oldValue:d,newValue:s}),obj.dispatch("onresizecolumn",el,n,s,d),obj.updateCornerPosition()}},obj.setHeight=function(n,s,d){s>0&&(typeof n=="object"&&(n=n.getAttribute("data-y")),d||(d=obj.rows[n].getAttribute("height"))||(d=obj.rows[n].getBoundingClientRect().height),s=parseInt(s),obj.rows[n].style.height=s+"px",obj.options.rows[n]||(obj.options.rows[n]={}),obj.options.rows[n].height=s,obj.setHistory({action:"setHeight",row:n,oldValue:d,newValue:s}),obj.dispatch("onresizerow",el,n,s,d),obj.updateCornerPosition())},obj.getHeight=function(n){if(n===void 0)for(var s=[],d=0;d<obj.rows.length;d++){var f=obj.rows[d].style.height;f&&(s[d]=f)}else typeof n=="object"&&(n=$(n).getAttribute("data-y")),s=obj.rows[n].style.height;return s},obj.setFooter=function(n){if(n&&(obj.options.footers=n),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var s=0;s<obj.options.footers.length;s++){if(obj.tfoot.children[s])var d=obj.tfoot.children[s];else{d=document.createElement("tr");var f=document.createElement("td");d.appendChild(f),obj.tfoot.appendChild(d)}for(var E=0;E<obj.headers.length;E++){if(obj.options.footers[s][E]||(obj.options.footers[s][E]=""),obj.tfoot.children[s].children[E+1])f=obj.tfoot.children[s].children[E+1];else{f=document.createElement("td"),d.appendChild(f);var D=obj.options.columns[E].align?obj.options.columns[E].align:"center";f.style.textAlign=D}f.textContent=obj.parseValue(+obj.records.length+E,s,obj.options.footers[s][E]),f.style.display=obj.colgroup[E].style.display}}}},obj.getHeader=function(n){return obj.headers[n].textContent},obj.setHeader=function(n,s){if(obj.headers[n]){var d=obj.headers[n].textContent;s||(s=prompt(obj.options.text.columnName,d)),s&&(obj.headers[n].textContent=s,obj.headers[n].setAttribute("title",s),obj.options.columns[n].title=s),obj.setHistory({action:"setHeader",column:n,oldValue:d,newValue:s}),obj.dispatch("onchangeheader",el,n,d,s)}},obj.getHeaders=function(n){for(var s=[],d=0;d<obj.headers.length;d++)s.push(obj.getHeader(d));return n?s:s.join(obj.options.csvDelimiter)},obj.getMeta=function(n,s){return n?s?obj.options.meta[n]&&obj.options.meta[n][s]?obj.options.meta[n][s]:null:obj.options.meta[n]?obj.options.meta[n]:null:obj.options.meta},obj.setMeta=function(n,s,d){if(obj.options.meta||(obj.options.meta={}),s&&d)obj.options.meta[n]||(obj.options.meta[n]={}),obj.options.meta[n][s]=d;else for(var f=Object.keys(n),E=0;E<f.length;E++){obj.options.meta[f[E]]||(obj.options.meta[f[E]]={});for(var D=Object.keys(n[f[E]]),Y=0;Y<D.length;Y++)obj.options.meta[f[E]][D[Y]]=n[f[E]][D[Y]]}obj.dispatch("onchangemeta",el,n,s,d)},obj.updateMeta=function(n){if(obj.options.meta){for(var s={},d=Object.keys(obj.options.meta),f=0;f<d.length;f++)n[d[f]]?s[n[d[f]]]=obj.options.meta[d[f]]:s[d[f]]=obj.options.meta[d[f]];obj.options.meta=s}},obj.getStyle=function(n,s){if(n)return n=jexcel.getIdFromColumnName(n,!0),s?obj.records[n[1]][n[0]].style[s]:obj.records[n[1]][n[0]].getAttribute("style");for(var d={},f=obj.options.data[0].length,E=obj.options.data.length,D=0;D<E;D++)for(var Y=0;Y<f;Y++){var c=s?obj.records[D][Y].style[s]:obj.records[D][Y].getAttribute("style");c&&(d[jexcel.getColumnNameFromId([Y,D])]=c)}return d},obj.resetStyle=function(n,s){for(var d=Object.keys(n),f=0;f<d.length;f++){var E=jexcel.getIdFromColumnName(d[f],!0);obj.records[E[1]]&&obj.records[E[1]][E[0]]&&obj.records[E[1]][E[0]].setAttribute("style","")}obj.setStyle(n,null,null,null,s)},obj.setStyle=function(n,s,d,f,E){var D={},Y={},c=function(h,w,T){var N=jexcel.getIdFromColumnName(h,!0);if(obj.records[N[1]]&&obj.records[N[1]][N[0]]&&(obj.records[N[1]][N[0]].classList.contains("readonly")==0||f)){var V=obj.records[N[1]][N[0]].style[w];V!=T||f?obj.records[N[1]][N[0]].style[w]=T:(T="",obj.records[N[1]][N[0]].style[w]=""),Y[h]||(Y[h]=[]),D[h]||(D[h]=[]),Y[h].push([w+":"+V]),D[h].push([w+":"+T])}};if(s&&d)if(typeof n=="string")c(n,s,d);else for(var a=[],j=0;j<n.length;j++){var R=n[j].getAttribute("data-x"),P=n[j].getAttribute("data-y"),g=jexcel.getColumnNameFromId([R,P]);a[g]||(c(g,s,d),a[g]=!0)}else{var u=Object.keys(n);for(j=0;j<u.length;j++){var m=n[u[j]];typeof m=="string"&&(m=m.split(";"));for(var b=0;b<m.length;b++)typeof m[b]=="string"&&(m[b]=m[b].split(":")),m[b][0].trim()&&c(u[j],m[b][0].trim(),m[b][1])}}for(u=Object.keys(Y),j=0;j<u.length;j++)Y[u[j]]=Y[u[j]].join(";");for(u=Object.keys(D),j=0;j<u.length;j++)D[u[j]]=D[u[j]].join(";");E||obj.setHistory({action:"setStyle",oldValue:Y,newValue:D}),obj.dispatch("onchangestyle",el,n,s,d)},obj.getComments=function(n,s){if(n)return typeof n=="string"&&(n=jexcel.getIdFromColumnName(n,!0)),s?[obj.records[n[1]][n[0]].getAttribute("title"),obj.records[n[1]][n[0]].getAttribute("author")]:obj.records[n[1]][n[0]].getAttribute("title")||"";for(var d={},f=0;f<obj.options.data.length;f++)for(var E=0;E<obj.options.columns.length;E++){var D=obj.records[f][E].getAttribute("title");D&&(d[n=jexcel.getColumnNameFromId([E,f])]=D)}return d},obj.setComments=function(n,s,d){if(typeof n=="string")var f=jexcel.getIdFromColumnName(n,!0);else f=n;var E=obj.records[f[1]][f[0]].getAttribute("title"),D=[E,d=obj.records[f[1]][f[0]].getAttribute("data-author")];obj.records[f[1]][f[0]].setAttribute("title",s||""),obj.records[f[1]][f[0]].setAttribute("data-author",d||""),s?obj.records[f[1]][f[0]].classList.add("jexcel_comments"):obj.records[f[1]][f[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:n,newValue:[s,d],oldValue:D}),obj.dispatch("oncomments",el,s,E,f,f[0],f[1])},obj.getConfig=function(){var n=obj.options;return n.style=obj.getStyle(),n.mergeCells=obj.getMerge(),n.comments=obj.getComments(),n},obj.orderBy=function(n,s){if(n>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}s=s==null?obj.headers[n].classList.contains("arrow-down")?1:0:s?1:0;var d=[];if(obj.options.columns[n].type=="number"||obj.options.columns[n].type=="numeric"||obj.options.columns[n].type=="percentage"||obj.options.columns[n].type=="autonumber"||obj.options.columns[n].type=="color")for(var f=0;f<obj.options.data.length;f++)d[f]=[f,Number(obj.options.data[f][n])];else if(obj.options.columns[n].type=="calendar"||obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio")for(f=0;f<obj.options.data.length;f++)d[f]=[f,obj.options.data[f][n]];else for(f=0;f<obj.options.data.length;f++)d[f]=[f,obj.records[f][n].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(D){return function(Y,c){var a=Y[1],j=c[1];return D?a===""&&j!==""?1:a!==""&&j===""||a>j?-1:a<j?1:0:a===""&&j!==""?1:a!==""&&j===""?-1:a>j?1:a<j?-1:0}}),d=d.sort(obj.options.sorting(s));var E=[];for(f=0;f<d.length;f++)E[f]=d[f][0];return obj.setHistory({action:"orderBy",rows:E,column:n,order:s}),obj.updateOrderArrow(n,s),obj.updateOrder(E),obj.dispatch("onsort",el,n,s),!0}},obj.updateOrderArrow=function(n,s){for(var d=0;d<obj.headers.length;d++)obj.headers[d].classList.remove("arrow-up"),obj.headers[d].classList.remove("arrow-down");s?obj.headers[n].classList.add("arrow-up"):obj.headers[n].classList.add("arrow-down")},obj.updateOrder=function(n){for(var s=[],d=0;d<n.length;d++)s[d]=obj.options.data[n[d]];for(obj.options.data=s,s=[],d=0;d<n.length;d++)s[d]=obj.records[n[d]];for(obj.records=s,s=[],d=0;d<n.length;d++)s[d]=obj.rows[n[d]];if(obj.rows=s,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(d=0;d<obj.rows.length;d++)obj.tbody.appendChild(obj.rows[d])},obj.moveRow=function(n,s,d){if(Object.keys(obj.options.mergeCells).length>0){if(n>s)var f=1;else f=0;if(obj.isRowMerged(n).length||obj.isRowMerged(s,f).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}d||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[s])>=0?n>s?obj.tbody.insertBefore(obj.rows[n],obj.rows[s]):obj.tbody.insertBefore(obj.rows[n],obj.rows[s].nextSibling):obj.tbody.removeChild(obj.rows[n])),obj.rows.splice(s,0,obj.rows.splice(n,1)[0]),obj.records.splice(s,0,obj.records.splice(n,1)[0]),obj.options.data.splice(s,0,obj.options.data.splice(n,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:n,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,n,s)},obj.insertRow=function(n,s,d){if(obj.options.allowInsertRow==1){var f=[];if(n>0)var E=n;else E=1,n&&(f=n);d=!!d;var D=obj.options.data.length-1;if((s==null||s>=parseInt(D)||s<0)&&(s=D),obj.dispatch("onbeforeinsertrow",el,s,E,d)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(s,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var Y=d?s:s+1,c=obj.records.splice(Y),a=obj.options.data.splice(Y),j=obj.rows.splice(Y),R=[],P=[],g=[],u=Y;u<E+Y;u++){obj.options.data[u]=[];for(var m=0;m<obj.options.columns.length;m++)obj.options.data[u][m]=f[m]?f[m]:"";var b=obj.createRow(u,obj.options.data[u]);j[0]?Array.prototype.indexOf.call(obj.tbody.children,j[0])>=0&&obj.tbody.insertBefore(b,j[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[s])>=0&&obj.tbody.appendChild(b),R.push(obj.records[u]),P.push(obj.options.data[u]),g.push(b)}Array.prototype.push.apply(obj.records,c),Array.prototype.push.apply(obj.options.data,a),Array.prototype.push.apply(obj.rows,j),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:s,numOfRows:E,insertBefore:d,rowRecords:R,rowData:P,rowNode:g}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,s,E,R,d)}},obj.deleteRow=function(n,s){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(n==null){var d=obj.getSelectedRows();d[0]?(n=parseInt(d[0].getAttribute("data-y")),s=d.length):(n=obj.options.data.length-1,s=1)}var f=obj.options.data.length-1;if((n==null||n>f||n<0)&&(n=f),s||(s=1),n+s>=obj.options.data.length&&(s=obj.options.data.length-n),obj.dispatch("onbeforedeleterow",el,n,s)===!1)return!1;if(parseInt(n)>-1){var E=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var D=n;D<n+s;D++)obj.isRowMerged(D,!1).length&&(E=!0);if(E){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&f+1===s&&(s--,console.error("Jspreadsheet: It is not possible to delete the last row")),D=n;D<n+s;D++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[D])>=0&&(obj.rows[D].className="",obj.rows[D].parentNode.removeChild(obj.rows[D]));var Y=obj.records.splice(n,s),c=obj.options.data.splice(n,s),a=obj.rows.splice(n,s);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,n,n+s-1),obj.setHistory({action:"deleteRow",rowNumber:n,numOfRows:s,insertBefore:1,rowRecords:Y,rowData:c,rowNode:a}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,n,s,Y)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(n,s){if(Object.keys(obj.options.mergeCells).length>0){if(n>s)var d=1;else d=0;if(obj.isColMerged(n).length||obj.isColMerged(s,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((n=parseInt(n))>(s=parseInt(s))){obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s]),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s]);for(var f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][s])}else for(obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s].nextSibling),f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][s].nextSibling);for(obj.options.columns.splice(s,0,obj.options.columns.splice(n,1)[0]),obj.headers.splice(s,0,obj.headers.splice(n,1)[0]),obj.colgroup.splice(s,0,obj.colgroup.splice(n,1)[0]),f=0;f<obj.rows.length;f++)obj.options.data[f].splice(s,0,obj.options.data[f].splice(n,1)[0]),obj.records[f].splice(s,0,obj.records[f].splice(n,1)[0]);if(obj.options.footers)for(f=0;f<obj.options.footers.length;f++)obj.options.footers[f].splice(s,0,obj.options.footers[f].splice(n,1)[0]);obj.setHistory({action:"moveColumn",oldValue:n,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,n,s)},obj.insertColumn=function(n,s,d,f){if(obj.options.allowInsertColumn==1){var E=[];if(n>0)var D=n;else D=1,n&&(E=n);d=!!d;var Y=obj.options.columns.length-1;if((s==null||s>=parseInt(Y)||s<0)&&(s=Y),obj.dispatch("onbeforeinsertcolumn",el,s,D,d)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(s,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}f||(f=[]);for(var c=0;c<D;c++)f[c]||(f[c]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var a=d?s:s+1;obj.options.columns=jexcel.injectArray(obj.options.columns,a,f);for(var j=obj.headers.splice(a),R=obj.colgroup.splice(a),P=[],g=[],u=[],m=[],b=[],h=a;h<D+a;h++)obj.createCellHeader(h),obj.headerContainer.insertBefore(obj.headers[h],obj.headerContainer.children[h+1]),obj.colgroupContainer.insertBefore(obj.colgroup[h],obj.colgroupContainer.children[h+1]),P.push(obj.headers[h]),g.push(obj.colgroup[h]);if(obj.options.footers)for(var w=0;w<obj.options.footers.length;w++){for(b[w]=[],c=0;c<D;c++)b[w].push("");obj.options.footers[w].splice(a,0,b[w])}for(var T=0;T<obj.options.data.length;T++){var N=obj.options.data[T].splice(a),V=obj.records[T].splice(a);for(m[T]=[],u[T]=[],h=a;h<D+a;h++){var H=E[T]?E[T]:"";obj.options.data[T][h]=H;var M=obj.createCell(h,T,obj.options.data[T][h]);obj.records[T][h]=M,obj.rows[T]&&obj.rows[T].insertBefore(M,obj.rows[T].children[h+1]),m[T].push(H),u[T].push(M)}Array.prototype.push.apply(obj.options.data[T],N),Array.prototype.push.apply(obj.records[T],V)}if(Array.prototype.push.apply(obj.headers,j),Array.prototype.push.apply(obj.colgroup,R),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(w=0;w<obj.options.nestedHeaders.length;w++){var F=parseInt(obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan)+D;obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan=F,obj.thead.children[w].children[obj.thead.children[w].children.length-1].setAttribute("colspan",F);var J=obj.thead.children[w].children[obj.thead.children[w].children.length-1].getAttribute("data-column");for(J=J.split(","),h=a;h<D+a;h++)J.push(h);obj.thead.children[w].children[obj.thead.children[w].children.length-1].setAttribute("data-column",J)}else F=parseInt(obj.options.nestedHeaders[0].colspan)+D,obj.options.nestedHeaders[0].colspan=F,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",F);obj.setHistory({action:"insertColumn",columnNumber:s,numOfColumns:D,insertBefore:d,columns:f,headers:P,colgroup:g,records:u,footers:b,data:m}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,s,D,u,d)}},obj.deleteColumn=function(n,s){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(n==null){var d=obj.getSelectedColumns(!0);d.length?(n=parseInt(d[0]),s=parseInt(d.length)):(n=obj.headers.length-1,s=1)}var f=obj.options.data[0].length-1;if((n==null||n>f||n<0)&&(n=f),s||(s=1),s>obj.options.data[0].length-n&&(s=obj.options.data[0].length-n),obj.dispatch("onbeforedeletecolumn",el,n,s)===!1)return!1;if(parseInt(n)>-1){var E=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var D=n;D<n+s;D++)obj.isColMerged(D,!1).length&&(E=!0);if(E){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var Y=obj.options.columns.splice(n,s);for(D=n;D<n+s;D++)obj.colgroup[D].className="",obj.headers[D].className="",obj.colgroup[D].parentNode.removeChild(obj.colgroup[D]),obj.headers[D].parentNode.removeChild(obj.headers[D]);for(var c=obj.headers.splice(n,s),a=obj.colgroup.splice(n,s),j=[],R=[],P=[],g=0;g<obj.options.data.length;g++)for(D=n;D<n+s;D++)obj.records[g][D].className="",obj.records[g][D].parentNode.removeChild(obj.records[g][D]);for(g=0;g<obj.options.data.length;g++)R[g]=obj.options.data[g].splice(n,s),j[g]=obj.records[g].splice(n,s);if(obj.options.footers)for(g=0;g<obj.options.footers.length;g++)P[g]=obj.options.footers[g].splice(n,s);if(obj.conditionalSelectionUpdate(0,n,n+s-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var u=0;u<obj.options.nestedHeaders.length;u++){var m=parseInt(obj.options.nestedHeaders[u][obj.options.nestedHeaders[u].length-1].colspan)-s;obj.options.nestedHeaders[u][obj.options.nestedHeaders[u].length-1].colspan=m,obj.thead.children[u].children[obj.thead.children[u].children.length-1].setAttribute("colspan",m)}else m=parseInt(obj.options.nestedHeaders[0].colspan)-s,obj.options.nestedHeaders[0].colspan=m,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",m);obj.setHistory({action:"deleteColumn",columnNumber:n,numOfColumns:s,insertBefore:1,columns:Y,headers:c,colgroup:a,records:j,footers:P,data:R}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,n,s,j)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(n){for(var s=[],d=0;d<obj.rows.length;d++)obj.rows[d].classList.contains("selected")&&(n?s.push(d):s.push(obj.rows[d]));return s},obj.getSelectedColumns=function(){for(var n=[],s=0;s<obj.headers.length;s++)obj.headers[s].classList.contains("selected")&&n.push(s);return n},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var n=0;n<obj.headers.length;n++)(D=obj.headers[n].getAttribute("data-x"))!=n&&(obj.headers[n].setAttribute("data-x",n),obj.headers[n].getAttribute("title")||(obj.headers[n].innerHTML=jexcel.getColumnName(n)));for(var s=0;s<obj.rows.length;s++)obj.rows[s]&&(Y=obj.rows[s].getAttribute("data-y"))!=s&&(obj.rows[s].setAttribute("data-y",s),obj.rows[s].children[0].setAttribute("data-y",s),obj.rows[s].children[0].innerHTML=s+1);var d=[],f=[],E=function(u,m,b,h){if(u!=b&&obj.records[h][b].setAttribute("data-x",b),m!=h&&obj.records[h][b].setAttribute("data-y",h),u!=b||m!=h){var w=jexcel.getColumnNameFromId([u,m]),T=jexcel.getColumnNameFromId([b,h]);d[w]=T}};for(s=0;s<obj.records.length;s++)for(n=0;n<obj.records[0].length;n++)if(obj.records[s][n]){var D=obj.records[s][n].getAttribute("data-x"),Y=obj.records[s][n].getAttribute("data-y");if(obj.records[s][n].getAttribute("data-merged")){var c=jexcel.getColumnNameFromId([D,Y]),a=jexcel.getColumnNameFromId([n,s]);if(f[c]==null)if(c==a)f[c]=!1;else{var j=parseInt(n-D),R=parseInt(s-Y);f[c]=[a,j,R]}}else E(D,Y,n,s)}var P=Object.keys(f);if(P.length){for(n=0;n<P.length;n++)if(f[P[n]]){var g=jexcel.getIdFromColumnName(P[n],!0);for(E(D=g[0],Y=g[1],D+f[P[n]][1],Y+f[P[n]][2]),c=P[n],a=f[P[n]][0],s=0;s<obj.options.mergeCells[c][2].length;s++)D=parseInt(obj.options.mergeCells[c][2][s].getAttribute("data-x")),Y=parseInt(obj.options.mergeCells[c][2][s].getAttribute("data-y")),obj.options.mergeCells[c][2][s].setAttribute("data-x",D+f[P[n]][1]),obj.options.mergeCells[c][2][s].setAttribute("data-y",Y+f[P[n]][2]);obj.options.mergeCells[a]=obj.options.mergeCells[c],delete obj.options.mergeCells[c]}}obj.updateFormulas(d),obj.updateMeta(d),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var n=0,s=obj.rows.length-1;s>=0;s--){for(var d=!1,f=0;f<obj.headers.length;f++)obj.options.data[s][f]&&(d=!0);if(d)break;n++}obj.options.minSpareRows-n>0&&obj.insertRow(obj.options.minSpareRows-n)}if(obj.options.minSpareCols>0){var E=0;for(f=obj.headers.length-1;f>=0;f--){for(d=!1,s=0;s<obj.rows.length;s++)obj.options.data[s][f]&&(d=!0);if(d)break;E++}obj.options.minSpareCols-E>0&&obj.insertColumn(obj.options.minSpareCols-E)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),s=0;s<obj.rows.length;s++)for(f=0;f<obj.headers.length;f++)obj.options.updateTable(el,obj.records[s][f],f,s,obj.options.data[s][f],obj.records[s][f].textContent,jexcel.getColumnNameFromId([f,s]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(n){if(n=obj.getCell(n))return!!n.classList.contains("readonly")},obj.setReadOnly=function(n,s){(n=obj.getCell(n))&&(s?n.classList.add("readonly"):n.classList.remove("readonly"))},obj.showRow=function(n){obj.rows[n].style.display=""},obj.hideRow=function(n){obj.rows[n].style.display="none"},obj.showColumn=function(n){obj.headers[n].style.display="",obj.colgroup[n].style.display="",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="");for(var s=0;s<obj.options.data.length;s++)obj.records[s][n].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(n){obj.headers[n].style.display="none",obj.colgroup[n].style.display="none",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="none");for(var s=0;s<obj.options.data.length;s++)obj.records[s][n].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(n,s,d){var f=jexcel.getColumnNameFromId([n,s]);if(obj.formula[f]&&obj.formula[f].length>0)if(chainLoopProtection[f])obj.records[s][n].innerHTML="#ERROR",obj.formula[f]="";else{chainLoopProtection[f]=!0;for(var E=0;E<obj.formula[f].length;E++){var D=jexcel.getIdFromColumnName(obj.formula[f][E],!0),Y=""+obj.options.data[D[1]][D[0]];Y.substr(0,1)=="="?d.push(obj.updateCell(D[0],D[1],Y,!0)):Object.keys(obj.formula)[E]=null,obj.updateFormulaChain(D[0],D[1],d)}}chainLoopProtection=[]},obj.updateFormulas=function(n){for(var s=0;s<obj.options.data.length;s++)for(var d=0;d<obj.options.data[0].length;d++)if((c=""+obj.options.data[s][d]).substr(0,1)=="="){var f=obj.updateFormula(c,n);f!=c&&(obj.options.data[s][d]=f)}var E=[],D=Object.keys(obj.formula);for(s=0;s<D.length;s++){var Y=D[s],c=obj.formula[Y];for(n[Y]&&(Y=n[Y]),E[Y]=[],d=0;d<c.length;d++){var a=c[d];n[a]&&(a=n[a]),E[Y].push(a)}}obj.formula=E},obj.updateFormula=function(n,s){for(var d=/[A-Z]/,f=/[0-9]/,E="",D=null,Y=null,c="",a=0;a<n.length;a++)d.exec(n[a])?(D=1,Y=0,c+=n[a]):f.exec(n[a])?(Y=D?1:0,c+=n[a]):(D&&Y&&(c=s[c]?s[c]:c),E+=c,E+=n[a],D=0,Y=0,c="");return c&&(D&&Y&&(c=s[c]?s[c]:c),E+=c),E};var secureFormula=function(n){for(var s="",d=0,f=0;f<n.length;f++)n[f]=='"'&&(d=d==0?1:0),s+=d==1?n[f]:n[f].toUpperCase();return s};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(n){for(var s=0;s<n.length;s++){var d=[],f=n[s].split(":"),E=jexcel.getIdFromColumnName(f[0],!0),D=jexcel.getIdFromColumnName(f[1],!0);if(E[0]<=D[0])var Y=E[0],c=D[0];else Y=D[0],c=E[0];if(E[1]<=D[1])var a=E[1],j=D[1];else a=D[1],j=E[1];for(var R=a;R<=j;R++)for(var P=Y;P<=c;P++)d.push(jexcel.getColumnNameFromId([P,R]));expression=expression.replace(n[s],d.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(n){var res="#ERROR";console.log(n)}return res};return execute(expression,x,y)},obj.parseNumber=function(n,s){var d=s&&obj.options.columns[s].decimal?obj.options.columns[s].decimal:".",f=""+n;return(f=f.split(d))[0]=f[0].match(/[+-]?[0-9]/g),f[0]&&(f[0]=f[0].join("")),f[1]&&(f[1]=f[1].match(/[0-9]*/g).join("")),f[0]&&Number.isInteger(Number(f[0]))?f[1]?n=+(f[0]+"."+f[1]):n=+(f[0]+".00"):n=null,n},obj.row=function(n){},obj.col=function(n){},obj.up=function(n,s){if(n?obj.selectedCell[3]>0&&obj.up.visible(1,s?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var d=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-d<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var f=obj.whichPage(obj.selectedCell[3]);f!=obj.pageNumber&&obj.page(f)}obj.updateScroll(1)},obj.up.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=0;E<f;E++)if(obj.records[E][d].style.display!="none"&&obj.rows[E].style.display!="none"){f=E;break}}else f=obj.up.get(d,f);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=f):(obj.selectedCell[2]=d,obj.selectedCell[3]=f)},obj.up.get=function(n,s){n=parseInt(n);for(var d=(s=parseInt(s))-1;d>=0;d--)if(obj.records[d][n].style.display!="none"&&obj.rows[d].style.display!="none"){if(obj.records[d][n].getAttribute("data-merged")&&obj.records[d][n]==obj.records[s][n])continue;s=d;break}return s},obj.down=function(n,s){if(n?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,s?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}obj.updateScroll(3)},obj.down.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=obj.rows.length-1;E>f;E--)if(obj.records[E][d].style.display!="none"&&obj.rows[E].style.display!="none"){f=E;break}}else f=obj.down.get(d,f);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=f):(obj.selectedCell[2]=d,obj.selectedCell[3]=f)},obj.down.get=function(n,s){n=parseInt(n);for(var d=(s=parseInt(s))+1;d<obj.rows.length;d++)if(obj.records[d][n].style.display!="none"&&obj.rows[d].style.display!="none"){if(obj.records[d][n].getAttribute("data-merged")&&obj.records[d][n]==obj.records[s][n])continue;s=d;break}return s},obj.right=function(n,s){n?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,s?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=obj.headers.length-1;E>d;E--)if(obj.records[f][E].style.display!="none"){d=E;break}}else d=obj.right.get(d,f);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=f):(obj.selectedCell[2]=d,obj.selectedCell[3]=f)},obj.right.get=function(n,s){n=parseInt(n),s=parseInt(s);for(var d=n+1;d<obj.headers.length;d++)if(obj.records[s][d].style.display!="none"){if(obj.records[s][d].getAttribute("data-merged")&&obj.records[s][d]==obj.records[s][n])continue;n=d;break}return n},obj.left=function(n,s){n?obj.selectedCell[2]>0&&obj.left.visible(1,s?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=0;E<d;E++)if(obj.records[f][E].style.display!="none"){d=E;break}}else d=obj.left.get(d,f);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=f):(obj.selectedCell[2]=d,obj.selectedCell[3]=f)},obj.left.get=function(n,s){n=parseInt(n),s=parseInt(s);for(var d=n-1;d>=0;d--)if(obj.records[s][d].style.display!="none"){if(obj.records[s][d].getAttribute("data-merged")&&obj.records[s][d]==obj.records[s][n])continue;n=d;break}return n},obj.first=function(n,s){if(n?s?obj.selectedCell[3]=0:obj.left.visible(1,0):(s?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(n,s){if(n?s?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(s?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(n){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)s=obj.rows;else var s=obj.results;var d=100;n!=null&&n!=-1||(n=Math.ceil(s.length/d)-1);var f=n*d,E=n*d+d;E>s.length&&(E=s.length),(f=E-100)<0&&(f=0);for(var D=f;D<E;D++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[D]):obj.tbody.appendChild(obj.rows[s[D]]),obj.tbody.children.length>d&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var s=0;if(n.length>100){var d=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(d=n.indexOf(d)),d>0)for(var f=0;f<30;f++)(d-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[d],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[n[d]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),s=1))}return s},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var s=0;if(n.length>100){var d=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(d=n.indexOf(d)),d<obj.rows.length-1)for(var f=0;f<=30;f++)d<n.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[d]):obj.tbody.appendChild(obj.rows[n[d]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),s=1)),d+=1}return s},obj.loadValidation=function(){if(obj.selectedCell){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,s=parseInt(obj.selectedCell[3]/100),d=parseInt(obj.rows.length/100);if(n!=s&&s<=d&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(s),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(n){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],n){var s=function(f){obj.results.indexOf(f)==-1&&obj.results.push(f)},d=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");d=new RegExp(d,"i"),obj.options.data.forEach(function(f,E){if(function(j,R,P){for(var g=0;g<j.length;g++)if((""+j[g]).toLowerCase().search(R)>=0||(""+obj.records[P][g].innerHTML).toLowerCase().search(R)>=0)return!0;return!1}(f,d,E)){var D=obj.isRowMerged(E);if(D.length)for(var Y=0;Y<D.length;Y++)for(var c=jexcel.getIdFromColumnName(D[Y],!0),a=0;a<obj.options.mergeCells[D[Y]][1];a++)s(c[1]+a);else s(E)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var n,s=0;for(n=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var d=0;d<obj.rows.length;d++)!obj.results||obj.results.indexOf(d)>-1?(s<n&&(obj.tbody.appendChild(obj.rows[d]),s++),obj.rows[d].style.display=""):obj.rows[d].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),n},obj.whichPage=function(n){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=obj.results.indexOf(n)),Math.ceil((parseInt(n)+1)/parseInt(obj.options.pagination))-1},obj.page=function(n){var s=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)d=obj.rows;else var d=obj.results;var f=parseInt(obj.options.pagination);n!=null&&n!=-1||(n=Math.ceil(d.length/f)-1),obj.pageNumber=n;var E=n*f,D=n*f+f;for(D>d.length&&(D=d.length),E<0&&(E=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var Y=E;Y<D;Y++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[Y]):obj.tbody.appendChild(obj.rows[d[Y]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,n,s)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows.length;else var n=obj.results.length;if(n){var s=Math.ceil(n/obj.options.pagination);if(obj.pageNumber<6)var d=1,f=s<10?s:10;else s-obj.pageNumber<5?(f=s,(d=s-9)<1&&(d=1)):(d=obj.pageNumber-4,f=obj.pageNumber+5);d>1&&((D=document.createElement("div")).className="jexcel_page",D.innerHTML="<",D.title=1,obj.pagination.children[1].appendChild(D));for(var E=d;E<=f;E++){var D;(D=document.createElement("div")).className="jexcel_page",D.innerHTML=E,obj.pagination.children[1].appendChild(D),obj.pageNumber==E-1&&D.classList.add("jexcel_page_selected")}f<s&&((D=document.createElement("div")).className="jexcel_page",D.innerHTML=">",D.title=s,obj.pagination.children[1].appendChild(D)),obj.pagination.children[0].innerHTML=function(Y){var c=Array.prototype.slice.call(arguments,1);return Y.replace(/{(\d+)}/g,function(a,j){return c[j]!==void 0?c[j]:a})}(obj.options.text.showingPage,obj.pageNumber+1,s)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(n){if(obj.options.allowExport==0)console.error("Export not allowed");else{var s="";s+=obj.copy(!1,obj.options.csvDelimiter,!0,n,!0);var d=new Blob(["\uFEFF"+s],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(d,obj.options.csvFileName+".csv");else{var f=document.createElement("a"),E=URL.createObjectURL(d);f.href=E,f.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(f),f.click(),f.parentNode.removeChild(f)}}},obj.setHistory=function(n){if(obj.ignoreHistory!=1){var s=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,s+1),obj.history[s]=n}},obj.copy=function(n,s,d,f,E){s||(s="	");for(var D=new RegExp(s,"ig"),Y=[],c=[],a=[],j=[],R=[],P=obj.options.data[0].length,g=obj.options.data.length,u="",m=!1,b="",h="",w=0,T=0,N=0,V=0,H=!0,M=0;M<g;M++)for(var F=0;F<P;F++)n&&!obj.records[M][F].classList.contains("highlight")||(N<=F&&(N=F),V<=M&&(V=M));if(P===N+1&&g===V+1&&(H=!1),E&&obj.options.includeHeadersOnDownload==1||!E&&obj.options.includeHeadersOnCopy==1&&!H||f){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(u=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],M=0;M<u.length;M++){var J=[];for(F=0;F<u[M].length;F++){var q=parseInt(u[M][F].colspan);J.push(u[M][F].title);for(var ae=0;ae<q-1;ae++)J.push("")}h+=J.join(s)+`\r
`}m=!0}for(obj.style=[],M=0;M<g;M++){for(c=[],a=[],F=0;F<P;F++)if(!n||obj.records[M][F].classList.contains("highlight")){m==1&&Y.push(obj.headers[F].textContent);var ge=obj.options.data[M][F];if(ge.match&&(ge.match(D)||ge.match(/,/g)||ge.match(/\n/)||ge.match(/\"/))&&(ge='"'+(ge=ge.replace(new RegExp('"',"g"),'""'))+'"'),c.push(ge),obj.options.columns[F].type=="checkbox"||obj.options.columns[F].type=="radio")var se=ge;else(se=obj.options.stripHTMLOnCopy==1?obj.records[M][F].textContent:obj.records[M][F].innerHTML).match&&(se.match(D)||se.match(/,/g)||se.match(/\n/)||se.match(/\"/))&&(se='"'+(se=se.replace(new RegExp('"',"g"),'""'))+'"');a.push(se),u=(u=obj.records[M][F].getAttribute("style")).replace("display: none;",""),obj.style.push(u||"")}c.length&&(m&&(w=c.length,j.push(Y.join(s))),j.push(c.join(s))),a.length&&(T++,m&&(R.push(Y.join(s)),m=!1),R.push(a.join(s)))}P==w&&g==T&&(b=h);var xe=b+j.join(`\r
`),Le=b+R.join(`\r
`);if(d||(obj.options.copyCompatibility==1?obj.textarea.value=Le:obj.textarea.value=xe,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Le:obj.data=xe,obj.hashString=obj.hash(obj.data),!d){if(obj.removeCopyingSelection(),obj.highlighted)for(F=0;F<obj.highlighted.length;F++)obj.highlighted[F].classList.add("copying"),obj.highlighted[F].classList.contains("highlight-left")&&obj.highlighted[F].classList.add("copying-left"),obj.highlighted[F].classList.contains("highlight-right")&&obj.highlighted[F].classList.add("copying-right"),obj.highlighted[F].classList.contains("highlight-top")&&obj.highlighted[F].classList.add("copying-top"),obj.highlighted[F].classList.contains("highlight-bottom")&&obj.highlighted[F].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?R:j,obj.hashString)}return obj.data},obj.paste=function(n,s,d){var f=obj.dispatch("onbeforepaste",el,d,n,s);if(f===!1)return!1;f&&(d=f);var E=obj.hash(d),D=E==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&E==obj.hashString&&(d=obj.data),d=obj.parseCSV(d,"	"),n!=null&&s!=null&&d){for(var Y=0,c=0,a=[],j={},R={},P=0,g=parseInt(n),u=parseInt(s),m=null;m=d[c];){for(Y=0,g=parseInt(n);m[Y]!=null;){var b=obj.updateCell(g,u,m[Y]);if(a.push(b),obj.updateFormulaChain(g,u,a),D&&D[P]){var h=jexcel.getColumnNameFromId([g,u]);j[h]=D[P],R[h]=obj.getStyle(h),obj.records[u][g].setAttribute("style",D[P]),P++}if(m[++Y]!=null){if(g>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}g=obj.right.get(g,u)}}if(d[++c]){if(u>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}u=obj.down.get(n,u)}}obj.updateSelectionFromCoords(n,s,g,u),obj.setHistory({action:"setValue",records:a,selection:obj.selectedCell,newStyle:j,oldStyle:R}),obj.updateTable(),obj.dispatch("onpaste",el,d),obj.onafterchanges(el,a)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var n=document.querySelectorAll(".jexcel .copying"),s=0;s<n.length;s++)n[s].classList.remove("copying"),n[s].classList.remove("copying-left"),n[s].classList.remove("copying-right"),n[s].classList.remove("copying-top"),n[s].classList.remove("copying-bottom")},obj.historyProcessRow=function(n,s){var d=s.insertBefore?+s.rowNumber:s.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),n==1){for(var f=s.numOfRows,E=d;E<f+d;E++)obj.rows[E].parentNode.removeChild(obj.rows[E]);obj.records.splice(d,f),obj.options.data.splice(d,f),obj.rows.splice(d,f),obj.conditionalSelectionUpdate(1,d,f+d-1)}else{obj.records=jexcel.injectArray(obj.records,d,s.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,d,s.rowData),obj.rows=jexcel.injectArray(obj.rows,d,s.rowNode);var D=0;for(E=d;E<s.numOfRows+d;E++)obj.tbody.insertBefore(s.rowNode[D],obj.tbody.children[E]),D++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(n,s){var d=s.insertBefore?s.columnNumber:s.columnNumber+1;if(n==1){var f=s.numOfColumns;obj.options.columns.splice(d,f);for(var E=d;E<f+d;E++)obj.headers[E].parentNode.removeChild(obj.headers[E]),obj.colgroup[E].parentNode.removeChild(obj.colgroup[E]);obj.headers.splice(d,f),obj.colgroup.splice(d,f);for(var D=0;D<s.data.length;D++){for(E=d;E<f+d;E++)obj.records[D][E].parentNode.removeChild(obj.records[D][E]);obj.records[D].splice(d,f),obj.options.data[D].splice(d,f)}if(obj.options.footers)for(D=0;D<obj.options.footers.length;D++)obj.options.footers[D].splice(d,f)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,d,s.columns),obj.headers=jexcel.injectArray(obj.headers,d,s.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,d,s.colgroup);var Y=0;for(E=d;E<s.numOfColumns+d;E++)obj.headerContainer.insertBefore(s.headers[Y],obj.headerContainer.children[E+1]),obj.colgroupContainer.insertBefore(s.colgroup[Y],obj.colgroupContainer.children[E+1]),Y++;for(D=0;D<s.data.length;D++)for(obj.options.data[D]=jexcel.injectArray(obj.options.data[D],d,s.data[D]),obj.records[D]=jexcel.injectArray(obj.records[D],d,s.records[D]),Y=0,E=d;E<s.numOfColumns+d;E++)obj.rows[D].insertBefore(s.records[D][Y],obj.rows[D].children[E+1]),Y++;if(obj.options.footers)for(D=0;D<obj.options.footers.length;D++)obj.options.footers[D]=jexcel.injectArray(obj.options.footers[D],d,s.footers[D])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(D=0;D<obj.options.nestedHeaders.length;D++){if(n==1)var c=parseInt(obj.options.nestedHeaders[D][obj.options.nestedHeaders[D].length-1].colspan)-s.numOfColumns;else c=parseInt(obj.options.nestedHeaders[D][obj.options.nestedHeaders[D].length-1].colspan)+s.numOfColumns;obj.options.nestedHeaders[D][obj.options.nestedHeaders[D].length-1].colspan=c,obj.thead.children[D].children[obj.thead.children[D].children.length-1].setAttribute("colspan",c)}else c=n==1?parseInt(obj.options.nestedHeaders[0].colspan)-s.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+s.numOfColumns,obj.options.nestedHeaders[0].colspan=c,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",c);obj.updateTableReferences()},obj.undo=function(){var n=!!obj.ignoreEvents,s=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var d=[];if(obj.historyIndex>=0){var f=obj.history[obj.historyIndex--];if(f.action=="insertRow")obj.historyProcessRow(1,f);else if(f.action=="deleteRow")obj.historyProcessRow(0,f);else if(f.action=="insertColumn")obj.historyProcessColumn(1,f);else if(f.action=="deleteColumn")obj.historyProcessColumn(0,f);else if(f.action=="moveRow")obj.moveRow(f.newValue,f.oldValue);else if(f.action=="moveColumn")obj.moveColumn(f.newValue,f.oldValue);else if(f.action=="setMerge")obj.removeMerge(f.column,f.data);else if(f.action=="setStyle")obj.setStyle(f.oldValue,null,null,1);else if(f.action=="setWidth")obj.setWidth(f.column,f.oldValue);else if(f.action=="setHeight")obj.setHeight(f.row,f.oldValue);else if(f.action=="setHeader")obj.setHeader(f.column,f.oldValue);else if(f.action=="setComments")obj.setComments(f.column,f.oldValue[0],f.oldValue[1]);else if(f.action=="orderBy"){for(var E=[],D=0;D<f.rows.length;D++)E[f.rows[D]]=D;obj.updateOrderArrow(f.column,f.order?0:1),obj.updateOrder(E)}else if(f.action=="setValue"){for(var Y=0;Y<f.records.length;Y++)d.push({x:f.records[Y].x,y:f.records[Y].y,newValue:f.records[Y].oldValue}),f.oldStyle&&obj.resetStyle(f.oldStyle);obj.setValue(d),f.selection&&obj.updateSelectionFromCoords(f.selection[0],f.selection[1],f.selection[2],f.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=s,obj.dispatch("onundo",el,f)},obj.redo=function(){var n=!!obj.ignoreEvents,s=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var d=obj.history[++obj.historyIndex];if(d.action=="insertRow")obj.historyProcessRow(0,d);else if(d.action=="deleteRow")obj.historyProcessRow(1,d);else if(d.action=="insertColumn")obj.historyProcessColumn(0,d);else if(d.action=="deleteColumn")obj.historyProcessColumn(1,d);else if(d.action=="moveRow")obj.moveRow(d.oldValue,d.newValue);else if(d.action=="moveColumn")obj.moveColumn(d.oldValue,d.newValue);else if(d.action=="setMerge")obj.setMerge(d.column,d.colspan,d.rowspan,1);else if(d.action=="setStyle")obj.setStyle(d.newValue,null,null,1);else if(d.action=="setWidth")obj.setWidth(d.column,d.newValue);else if(d.action=="setHeight")obj.setHeight(d.row,d.newValue);else if(d.action=="setHeader")obj.setHeader(d.column,d.newValue);else if(d.action=="setComments")obj.setComments(d.column,d.newValue[0],d.newValue[1]);else if(d.action=="orderBy")obj.updateOrderArrow(d.column,d.order),obj.updateOrder(d.rows);else if(d.action=="setValue"){obj.setValue(d.records);for(var f=0;f<d.records.length;f++)d.oldStyle&&obj.resetStyle(d.newStyle);d.selection&&obj.updateSelectionFromCoords(d.selection[0],d.selection[1],d.selection[2],d.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=s,obj.dispatch("onredo",el,d)},obj.getDropDownValue=function(n,s){var d=[];if(obj.options.columns[n]&&obj.options.columns[n].source){for(var f=[],E=obj.options.columns[n].source,D=0;D<E.length;D++)typeof E[D]=="object"?f[E[D].id]=E[D].name:f[E[D]]=E[D];var Y=Array.isArray(s)?s:(""+s).split(";");for(D=0;D<Y.length;D++)typeof Y[D]=="object"?d.push(f[Y[D].id]):f[Y[D]]&&d.push(f[Y[D]])}else console.error("Invalid column");return d.length>0?d.join("; "):""},obj.parseCSV=function(n,s){(n=n.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(n.length-1)==9&&(n+="\0"),s=s||",";for(var d=[],f=!1,E=0,D=0,Y=0;Y<n.length;Y++){var c=n[Y],a=n[Y+1];d[E]=d[E]||[],d[E][D]=d[E][D]||"",c=='"'&&f&&a=='"'?(d[E][D]+=c,++Y):c!='"'?c!=s||f?c!="\r"||a!=`
`||f?c==`
`&&!f||c=="\r"&&!f?(++E,D=0):d[E][D]+=c:(++E,D=0,++Y):++D:f=!f}return d},obj.hash=function(n){var s,d=0;if(n.length===0)return d;for(s=0;s<n.length;s++)d=(d<<5)-d+n.charCodeAt(s),d|=0;return d},obj.onafterchanges=function(n,s){obj.dispatch("onafterchanges",n,s)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(n){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(n){var s=obj.parseCSV(n,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&s.length>0)for(var d=s.shift(),f=0;f<d.length;f++)obj.options.columns[f]||(obj.options.columns[f]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[f].title===void 0&&(obj.options.columns[f].title=d[f]);obj.options.data=s,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(n,s,d,f){var E=[];if(d==null)obj.options.allowInsertColumn==1&&E.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(s),1)}}),obj.options.allowInsertColumn==1&&E.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(s),0)}}),obj.options.allowDeleteColumn==1&&E.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(s))}}),obj.options.allowRenameColumn==1&&E.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(s)}}),obj.options.columnSorting==1&&(E.push({type:"line"}),E.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(s,0)}}),E.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(s,1)}}));else if(obj.options.allowInsertRow==1&&(E.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(d),1)}}),E.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(d))}})),obj.options.allowDeleteRow==1&&E.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(d))}}),s&&obj.options.allowComments==1){E.push({type:"line"});var D=obj.records[d][s].getAttribute("title")||"";E.push({title:D?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var Y=prompt(obj.options.text.comments,D);Y&&obj.setComments([s,d],Y)}}),D&&E.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([s,d],"")}})}return E.push({type:"line"}),E.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&E.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(Y){Y&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],Y)})}}),obj.options.allowExport&&E.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&E.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),E},obj.scrollControls=function(n){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&n.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(n){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var n=0;if(obj.options.freezeColumns>0)for(var s=0;s<obj.options.freezeColumns;s++)n+=parseInt(obj.options.columns[s].width);return n};var scrollLeft=0;return obj.updateFreezePosition=function(){var n=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var s=0;s<obj.options.freezeColumns;s++){s>0&&obj.options.columns[s-1].type!=="hidden"&&(n+=parseInt(obj.options.columns[s-1].width)),obj.headers[s].classList.add("jexcel_freezed"),obj.headers[s].style.left=n+"px";for(var d=0;d<obj.rows.length;d++)if(obj.rows[d]&&obj.records[d][s]){var f=scrollLeft+(s>0?obj.records[d][s-1].style.width:0)-51+"px";obj.records[d][s].classList.add("jexcel_freezed"),obj.records[d][s].style.left=f}}else for(s=0;s<obj.options.freezeColumns;s++)for(obj.headers[s].classList.remove("jexcel_freezed"),obj.headers[s].style.left="",d=0;d<obj.rows.length;d++)obj.records[d][s]&&(obj.records[d][s].classList.remove("jexcel_freezed"),obj.records[d][s].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(n){jSuites.setDictionary(n)},jexcel.setExtensions=function(n){for(var s=Object.keys(n),d=0;d<s.length;d++)typeof n[s[d]]=="function"&&(jexcel[s[d]]=n[s[d]],jexcel.license&&typeof n[s[d]].license=="function"&&n[s[d]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(n){n.removeEventListener("mouseup",jexcel.mouseUpControls),n.removeEventListener("mousedown",jexcel.mouseDownControls),n.removeEventListener("mousemove",jexcel.mouseMoveControls),n.removeEventListener("mouseover",jexcel.mouseOverControls),n.removeEventListener("dblclick",jexcel.doubleClickControls),n.removeEventListener("paste",jexcel.pasteControls),n.removeEventListener("contextmenu",jexcel.contextMenuControls),n.removeEventListener("touchstart",jexcel.touchStartControls),n.removeEventListener("touchend",jexcel.touchEndControls),n.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(n,s){if(n.jexcel){var d=n.jexcel.options.root?n.jexcel.options.root:document;n.removeEventListener("DOMMouseScroll",n.jexcel.scrollControls),n.removeEventListener("mousewheel",n.jexcel.scrollControls),n.jexcel=null,n.innerHTML="",s&&(destroyEvents(d),jexcel=null)}},jexcel.build=function(n){destroyEvents(n),n.addEventListener("mouseup",jexcel.mouseUpControls),n.addEventListener("mousedown",jexcel.mouseDownControls),n.addEventListener("mousemove",jexcel.mouseMoveControls),n.addEventListener("mouseover",jexcel.mouseOverControls),n.addEventListener("dblclick",jexcel.doubleClickControls),n.addEventListener("paste",jexcel.pasteControls),n.addEventListener("contextmenu",jexcel.contextMenuControls),n.addEventListener("touchstart",jexcel.touchStartControls),n.addEventListener("touchend",jexcel.touchEndControls),n.addEventListener("touchcancel",jexcel.touchEndControls),n.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(n){if(jexcel.current){if(jexcel.current.edition)if(n.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&n.altKey){var s=jexcel.current.edition[0].children[0],d=jexcel.current.edition[0].children[0].value,f=s.selectionStart;d=d.slice(0,f)+`
`+d.slice(f),s.value=d,s.focus(),s.selectionStart=f+1,s.selectionEnd=f+1}else jexcel.current.edition[0].children[0].blur()}else n.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(n.which==37)jexcel.current.left(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)jexcel.current.right(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)jexcel.current.up(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)jexcel.current.down(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)jexcel.current.first(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)jexcel.current.last(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(n.which==13)n.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),n.preventDefault();else if(n.which==9)n.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var E=jexcel.current.selectedCell[1],D=jexcel.current.selectedCell[0];jexcel.current.options.columns[D].type!="readonly"&&(n.keyCode==32?(n.preventDefault(),jexcel.current.options.columns[D].type=="checkbox"||jexcel.current.options.columns[D].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[E][D],!0)):n.keyCode==113?jexcel.current.openEditor(jexcel.current.records[E][D],!1):(n.keyCode==8||n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=111||n.keyCode>=187&&n.keyCode<=190||(String.fromCharCode(n.keyCode)==n.key||String.fromCharCode(n.keyCode).toLowerCase()==n.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(n.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[E][D],!0),jexcel.current.options.columns[D].type=="calendar"&&n.preventDefault()))}}else n.which==65?(jexcel.current.selectAll(),n.preventDefault()):n.which==83?(jexcel.current.download(),n.preventDefault()):n.which==89?(jexcel.current.redo(),n.preventDefault()):n.which==90?(jexcel.current.undo(),n.preventDefault()):n.which==67?(jexcel.current.copy(!0),n.preventDefault()):n.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),n.preventDefault()):n.which==86&&jexcel.pasteControls();else n.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(n.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;var d=jexcel.getElement(n.target);if(d[0]?jexcel.current!=d[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=d[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&s==1){if(n.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(n.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(d[1]==1){if(u=n.target.getAttribute("data-x")){var f=n.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&f.width-n.offsetX<6){jexcel.current.resizing={mousePosition:n.pageX,column:u,width:f.width},jexcel.current.headers[u].classList.add("resizing");for(var E=0;E<jexcel.current.records.length;E++)jexcel.current.records[E][u]&&jexcel.current.records[E][u].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&f.height-n.offsetY<6)if(jexcel.current.isColMerged(u).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target,column:u,destination:u},jexcel.current.headers[u].classList.add("dragging"),E=0;E<jexcel.current.records.length;E++)jexcel.current.records[E][u]&&jexcel.current.records[E][u].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(n.shiftKey||n.ctrlKey))var D=jexcel.current.selectedHeader,Y=u;else jexcel.current.selectedHeader==u&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(u)},800)),jexcel.current.selectedHeader=u,D=u,Y=u;jexcel.current.updateSelectionFromCoords(D,0,Y,jexcel.current.options.data.length-1)}}else if(n.target.parentNode.classList.contains("jexcel_nested")){if(n.target.getAttribute("data-column"))var c=n.target.getAttribute("data-column").split(","),a=parseInt(c[0]),j=parseInt(c[c.length-1]);else a=0,j=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(a,0,j,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(d[1]==2){var R=n.target.getAttribute("data-y");if(n.target.classList.contains("jexcel_row"))f=n.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&f.height-n.offsetY<6?(jexcel.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:R,height:f.height},n.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&f.width-n.offsetX<6?jexcel.current.isRowMerged(R).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target.parentNode,row:R,destination:R},n.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(n.shiftKey||n.ctrlKey)?(D=jexcel.current.selectedRow,Y=R):(jexcel.current.selectedRow=R,D=R,Y=R),jexcel.current.updateSelectionFromCoords(0,D,jexcel.current.options.data[0].length-1,Y));else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var P=function(m){var b=m.getAttribute("data-x"),h=m.getAttribute("data-y");return b&&h?[b,h]:m.parentNode?P(m.parentNode):void 0},g=P(n.target);if(g){var u=g[0];R=g[1],jexcel.current.edition&&(jexcel.current.edition[2]==u&&jexcel.current.edition[3]==R||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(n.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],u,R):jexcel.current.updateSelectionFromCoords(u,R)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;n.target.classList.contains("jexcel_page")&&(n.target.textContent=="<"?jexcel.current.page(0):n.target.textContent==">"?jexcel.current.page(n.target.getAttribute("title")-1):jexcel.current.page(n.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(n){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var s=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),d=jexcel.current.getSelectedColumns();if(d.length>1){for(var f=[],E=0;E<d.length;E++)f.push(parseInt(jexcel.current.colgroup[d[E]].getAttribute("width")));f[d.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(d,s,f)}else jexcel.current.setWidth(jexcel.current.resizing.column,s,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var D=0;D<jexcel.current.records.length;D++)jexcel.current.records[D][jexcel.current.resizing.column]&&jexcel.current.records[D][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var Y=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,Y,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var c=n.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),D=0;D<jexcel.current.rows.length;D++)jexcel.current.records[D][jexcel.current.dragging.column]&&jexcel.current.records[D][jexcel.current.dragging.column].classList.remove("dragging");for(E=0;E<jexcel.current.headers.length;E++)jexcel.current.headers[E].classList.remove("dragging-left"),jexcel.current.headers[E].classList.remove("dragging-right");c&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var a=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<a&&(a-=1)}else a=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,a,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;if(s||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var d=n.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+d>0){var f=jexcel.current.resizing.width+d;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",f),jexcel.current.updateCornerPosition()}}else{var E=n.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+E>0){var D=jexcel.current.resizing.height+E;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",D),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var Y=n.target.getAttribute("data-x");if(Y)if(jexcel.current.isColMerged(Y).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var c=0;c<jexcel.current.headers.length;c++)jexcel.current.headers[c].classList.remove("dragging-left"),jexcel.current.headers[c].classList.remove("dragging-right");jexcel.current.dragging.column==Y?jexcel.current.dragging.destination=parseInt(Y):n.target.clientWidth/2>n.offsetX?(jexcel.current.dragging.column<Y?jexcel.current.dragging.destination=parseInt(Y)-1:jexcel.current.dragging.destination=parseInt(Y),jexcel.current.headers[Y].classList.add("dragging-left")):(jexcel.current.dragging.column<Y?jexcel.current.dragging.destination=parseInt(Y):jexcel.current.dragging.destination=parseInt(Y)+1,jexcel.current.headers[Y].classList.add("dragging-right"))}}else{var a=n.target.getAttribute("data-y");if(a)if(jexcel.current.isRowMerged(a).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var j=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;jexcel.current.dragging.element!=j&&(n.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,j),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var R=n.target.getAttribute("data-x"),P=n.target.getAttribute("data-y"),g=n.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&R&&!P&&g.width-(n.clientX-g.left)<6?(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="col-resize"):n.target&&!R&&P&&g.height-(n.clientY-g.top)<6&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!R&&P&&g.width-(n.clientX-g.left)<6||n.target&&R&&!P&&g.height-(n.clientY-g.top)<6)&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;if(s||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var d=jexcel.getElement(n.target);if(d[0]){if(jexcel.current!=d[0].jexcel&&jexcel.current)return!1;var f=n.target.getAttribute("data-x"),E=n.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(d[1]==1&&jexcel.current.selectedHeader){f=n.target.getAttribute("data-x");var D=jexcel.current.selectedHeader,Y=f;jexcel.current.updateSelectionFromCoords(D,0,Y,jexcel.current.options.data.length-1)}d[1]==2&&(n.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(D=jexcel.current.selectedRow,Y=E,jexcel.current.updateSelectionFromCoords(0,D,jexcel.current.options.data[0].length-1,Y)):jexcel.current.edition||f&&E&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(f,E):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],f,E)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(n){if(jexcel.current)if(n.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var s=jexcel.current.highlighted[0].getAttribute("data-x"),d=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,f=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),E=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[d][s],jexcel.current.records[E][f])}}else if(n.target.classList.contains("jexcel_column_filter")){var D=n.target.getAttribute("data-x");jexcel.current.openFilter(D)}else{var Y=jexcel.getElement(n.target);if(Y[1]==1&&jexcel.current.options.columnSorting==1&&(D=n.target.getAttribute("data-x"))&&jexcel.current.orderBy(D),Y[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var c=function(j){if(j.parentNode){var R=j.getAttribute("data-x"),P=j.getAttribute("data-y");return R&&P?j:c(j.parentNode)}},a=c(n.target);a&&a.classList.contains("highlight")&&jexcel.current.openEditor(a)}}},jexcel.copyControls=function(n){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(n){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(n){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(n&&n.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,jexcel.current){if(jexcel.current.edition)n.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var s=n.target.getAttribute("data-x"),d=n.target.getAttribute("data-y");if(s||d){(s<parseInt(jexcel.current.selectedCell[0])||s>parseInt(jexcel.current.selectedCell[2])||d<parseInt(jexcel.current.selectedCell[1])||d>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(s,d,s,d);var f=jexcel.current.options.contextMenu(jexcel.current,s,d,n);jexcel.current.contextMenu.contextmenu.open(n,f),n.preventDefault()}}}},jexcel.touchStartControls=function(n){var s=jexcel.getElement(n.target);if(s[0]?jexcel.current!=s[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=s[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var d=n.target.getAttribute("data-x"),f=n.target.getAttribute("data-y");d&&f&&(jexcel.current.updateSelectionFromCoords(d,f),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[d].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=n.target,jexcel.current.openEditor(n.target,!1,n)},500))}},jexcel.touchEndControls=function(n){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(n,s){var d=[];if(n.classList.contains("jexcel_tabs"))E=n.children[0],D=n.children[1];else{n.innerHTML="",n.classList.add("jexcel_tabs"),n.jexcel=[];var f=document.createElement("div"),E=n.appendChild(f),D=(f=document.createElement("div"),n.appendChild(f))}for(var Y=[],c=[],a=0;a<s.length;a++){Y[a]=document.createElement("div"),Y[a].classList.add("jexcel_tab");var j=jexcel(Y[a],s[a]);D.appendChild(Y[a]),d[a]=n.jexcel.push(j),c[a]=document.createElement("div"),c[a].classList.add("jexcel_tab_link"),c[a].setAttribute("data-spreadsheet",n.jexcel.length-1),c[a].innerHTML=s[a].sheetName,c[a].onclick=function(){for(var P=0;P<E.children.length;P++)E.children[P].classList.remove("selected"),D.children[P].style.display="none";var g=this.getAttribute("data-spreadsheet");D.children[g].style.display="block",E.children[g].classList.add("selected")},E.appendChild(c[a])}for(var R=0;R<E.children.length;R++)E.children[R].classList.remove("selected"),D.children[R].style.display="none";return E.children[E.children.length-1].classList.add("selected"),D.children[E.children.length-1].style.display="block",d},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(n,s){var d,f=function(E){var D=[];return E.SheetNames.forEach(function(Y){var c={rows:[],columns:[],data:[],style:{}};if(c.sheetName=Y,(h=E.Sheets[Y]["!cols"])&&h.length)for(var a=0;a<h.length;a++)c.columns[a]={},h[a]&&h[a].wpx&&(c.columns[a].width=h[a].wpx+"px");if((h=E.Sheets[Y]["!rows"])&&h.length)for(a=0;a<h.length;a++)h[a]&&h[a].hpx&&(c.rows[a]={},c.rows[a].height=h[a].hpx+"px");if((h=E.Sheets[Y]["!merges"])&&h.length>0)for(c.mergeCells=[],a=0;a<h.length;a++){var j=h[a].s.c,R=h[a].s.r,P=h[a].e.c,g=h[a].e.r,u=jexcel.getColumnNameFromId([j,R]);c.mergeCells[u]=[P-j+1,g-R+1]}var m=0,b=0,h=Object.keys(E.Sheets[Y]);for(a=0;a<h.length;a++)if(h[a].substr(0,1)!="!"){var w=E.Sheets[Y][h[a]],T=jexcel.getIdFromColumnName(h[a],!0);c.data[T[1]]||(c.data[T[1]]=[]),c.data[T[1]][T[0]]=w.f?"="+w.f:w.w,m<T[0]&&(m=T[0]),b<T[1]&&(b=T[1]),w.style&&Object.keys(w.style).length>0&&(c.style[h[a]]=w.style),w.s&&w.s.fgColor&&(c.style[h[a]]&&(c.style[h[a]]+=";"),c.style[h[a]]+="background-color:#"+w.s.fgColor.rgb)}for(var N=c.columns,V=0;V<=b;V++)for(a=0;a<=m;a++)c.data[V]||(c.data[V]=[]),c.data[V][a]||N<a&&(c.data[V][a]="");D.push(c)}),D};(d=new XMLHttpRequest).open("GET",n,!0),typeof Uint8Array!="undefined"?(d.responseType="arraybuffer",d.onload=function(E){var D=d.response,Y=new Uint8Array(D),c=XLSX.read(Y,{type:"array",cellFormula:!0,cellStyles:!0});s(f(c))}):(d.setRequestHeader("Accept-Charset","x-user-defined"),d.onreadystatechange=function(){if(d.readyState==4&&d.status==200){var E=convertResponseBodyToText(d.responseBody),D=XLSX.read(E,{type:"binary",cellFormula:!0,cellStyles:!0});s(f(D))}}),d.send()},jexcel.validLetter=function(n){return n.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(n,s,d){return n.slice(0,s).concat(d).concat(n.slice(s))},jexcel.getColumnName=function(n){var s="";return n>701?(s+=String.fromCharCode(64+parseInt(n/676)),s+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(s+=String.fromCharCode(64+parseInt(n/26))),s+String.fromCharCode(65+n%26)},jexcel.getIdFromColumnName=function(n,s){var d=/^[a-zA-Z]+/.exec(n);if(d){for(var f=0,E=0;E<d[0].length;E++)f+=parseInt(d[0].charCodeAt(E)-64)*Math.pow(26,d[0].length-1-E);--f<0&&(f=0);var D=parseInt(/[0-9]+$/.exec(n));D>0&&D--,n=s==1?[f,D]:f+"-"+D}return n},jexcel.getColumnNameFromId=function(n){return Array.isArray(n)||(n=n.split("-")),jexcel.getColumnName(parseInt(n[0]))+(parseInt(n[1])+1)},jexcel.getElement=function(n){var s=0,d=0;return function f(E){E.className&&E.classList.contains("jexcel_container")&&(d=E),E.tagName=="THEAD"?s=1:E.tagName=="TBODY"&&(s=2),E.parentNode&&(d||f(E.parentNode))}(n),[d,s]},jexcel.doubleDigitFormat=function(n){return(n=""+n).length==1&&(n="0"+n),n},jexcel.createFromTable=function(n,s){if(n.tagName=="TABLE"){s||(s={}),s.columns=[],s.data=[];var d=n.querySelectorAll("colgroup > col");if(d.length)for(var f=0;f<d.length;f++){if(!(E=d[f].style.width))var E=d[f].getAttribute("width");E&&(s.columns[f]||(s.columns[f]={}),s.columns[f].width=E)}var D=function(xe){var Le=xe.getBoundingClientRect(),ve=Le.width>50?Le.width:50;s.columns[f]||(s.columns[f]={}),xe.getAttribute("data-celltype")?s.columns[f].type=xe.getAttribute("data-celltype"):s.columns[f].type="text",s.columns[f].width=ve+"px",s.columns[f].title=xe.innerHTML,s.columns[f].align=xe.style.textAlign||"center",(Le=xe.getAttribute("name"))&&(s.columns[f].name=Le),(Le=xe.getAttribute("id"))&&(s.columns[f].id=Le),(Le=xe.getAttribute("data-mask"))&&(s.columns[f].mask=Le)},Y=[],c=n.querySelectorAll(":scope > thead > tr");if(c.length){for(var a=0;a<c.length-1;a++){var j=[];for(f=0;f<c[a].children.length;f++){var R={title:c[a].children[f].textContent,colspan:c[a].children[f].getAttribute("colspan")||1};j.push(R)}Y.push(j)}for(c=c[c.length-1].children,f=0;f<c.length;f++)D(c[f])}var P=0,g={},u={},m={},b={},h=n.querySelectorAll(":scope > tr, :scope > tbody > tr");for(a=0;a<h.length;a++)if(s.data[P]=[],s.parseTableFirstRowAsHeader!=1||c.length||a!=0){for(f=0;f<h[a].children.length;f++){if(w=h[a].children[f].getAttribute("data-formula"))w.substr(0,1)!="="&&(w="="+w);else var w=h[a].children[f].innerHTML;s.data[P].push(w);var T=jexcel.getColumnNameFromId([f,a]),N=h[a].children[f].getAttribute("class");N&&(b[T]=N);var V=parseInt(h[a].children[f].getAttribute("colspan"))||0,H=parseInt(h[a].children[f].getAttribute("rowspan"))||0;(V||H)&&(g[T]=[V||1,H||1]),h[a].children[f].style&&h[a].children[f].style.display=="none"&&(h[a].children[f].style.display="");var M=h[a].children[f].getAttribute("style");M&&(m[T]=M),h[a].children[f].classList.contains("styleBold")&&(m[T]?m[T]+="; font-weight:bold;":m[T]="font-weight:bold;")}h[a].style&&h[a].style.height&&(u[a]={height:h[a].style.height}),P++}else for(f=0;f<h[a].children.length;f++)D(h[a].children[f]);if(Object.keys(Y).length>0&&(s.nestedHeaders=Y),Object.keys(m).length>0&&(s.style=m),Object.keys(g).length>0&&(s.mergeCells=g),Object.keys(u).length>0&&(s.rows=u),Object.keys(b).length>0&&(s.classes=b),(h=n.querySelectorAll("tfoot tr")).length){var F=[];for(a=0;a<h.length;a++){var J=[];for(f=0;f<h[a].children.length;f++)J.push(h[a].children[f].textContent);F.push(J)}Object.keys(F).length>0&&(s.footers=F)}if(s.parseTableAutoCellType==1){var q=[];for(f=0;f<s.columns.length;f++){var ae=!0,ge=!0;for(q[f]=[],a=0;a<s.data.length;a++)w=s.data[a][f],q[f][w]||(q[f][w]=0),q[f][w]++,w.length>25&&(ae=!1),w.length==10&&w.substr(4,1)=="-"&&w.substr(7,1)=="-"||(ge=!1);var se=Object.keys(q[f]).length;ge?s.columns[f].type="calendar":ae==1&&se>1&&se<=parseInt(.1*s.data.length)&&(s.columns[f].type="dropdown",s.columns[f].source=Object.keys(q[f]))}}return s}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(n){if(this.config.root)var s=this.config.root;else s=window;var d=0,f=s.getSelection();if(f&&f.rangeCount!==0){var E=f.getRangeAt(0),D=E.cloneRange();D.selectNodeContents(n),D.setEnd(E.endContainer,E.endOffset),d=D.toString().length}return d},invert:function(n){for(var s=[],d=Object.keys(n),f=0;f<d.length;f++)s[n[d[f]]]=d[f];return s},getColumnName:function(n){var s="";return n>701?(s+=String.fromCharCode(64+parseInt(n/676)),s+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(s+=String.fromCharCode(64+parseInt(n/26))),s+String.fromCharCode(65+n%26)},getColumnNameFromCoords:function(n,s){return component.getColumnName(parseInt(n))+(parseInt(s)+1)},getCoordsFromColumnName:function(n){var s=/^[a-zA-Z]+/.exec(n);if(s){for(var d=0,f=0;f<s[0].length;f++)d+=parseInt(s[0].charCodeAt(f)-64)*Math.pow(26,s[0].length-1-f);--d<0&&(d=0);var E=parseInt(/[0-9]+$/.exec(n))||null;return E>0&&E--,[d,E]}},createFromTable:function(){},injectArray:function(n,s,d){return n.slice(0,s).concat(d).concat(n.slice(s))},parseCSV:function(n,s){s=s||",";for(var d=0,f=0,E=[[]],D=0,Y=null,c=!1,a=!1,j=0;j<n.length;j++)if(E[f]||(E[f]=[]),E[f][d]||(E[f][d]=""),n[j]!="\r")if(n[j]!=`
`&&n[j]!=s||c!=0&&a!=1&&Y){if(n[j]=='"'&&(c=!c),Y===null){if((Y=c)==1)continue}else if(Y===!0&&!a&&n[j]=='"'){n[j+1]=='"'?(c=!0,E[f][d]+=n[j],j++):a=!0;continue}E[f][d]+=n[j]}else{if(Y=null,c=!1,a=!1,E[f][d][0]=='"'){var R=E[f][d].trim();R[R.length-1]=='"'&&(E[f][d]=R.substr(1,R.length-2))}n[j]==`
`?(d=0,f++):++d>D&&(D=d)}for(var P=0;P<E.length;P++)for(j=0;j<=D;j++)E[P][j]===void 0&&(E[P][j]="");return E}},component),typeof jQuery!="undefined"&&function(n){n.fn.jspreadsheet=n.fn.jexcel=function(s){var d=n(this).get(0);return d.jexcel?Array.isArray(d.jexcel)?d.jexcel[s][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):d.jexcel[s].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __nested_webpack_require_281600__(n){var s=__webpack_module_cache__[n];if(s!==void 0)return s.exports;var d=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(d.exports,d,d.exports,__nested_webpack_require_281600__),d.exports}var __nested_webpack_exports__=__nested_webpack_require_281600__(138);return __nested_webpack_exports__}()})},89126:function(n){(function(d,f){n.exports=f()})(this,function(){return function(){var s={195:function(D){(function(Y,c){D.exports=c()})(this,function(){return function(U){function c(Se,De){this.highOrder=Se,this.lowOrder=De}var a=[new c(1779033703,4089235720),new c(3144134277,2227873595),new c(1013904242,4271175723),new c(2773480762,1595750129),new c(1359893119,2917565137),new c(2600822924,725511199),new c(528734635,4215389547),new c(1541459225,327033209)],j=[new c(1116352408,3609767458),new c(1899447441,602891725),new c(3049323471,3964484399),new c(3921009573,2173295548),new c(961987163,4081628472),new c(1508970993,3053834265),new c(2453635748,2937671579),new c(2870763221,3664609560),new c(3624381080,2734883394),new c(310598401,1164996542),new c(607225278,1323610764),new c(1426881987,3590304994),new c(1925078388,4068182383),new c(2162078206,991336113),new c(2614888103,633803317),new c(3248222580,3479774868),new c(3835390401,2666613458),new c(4022224774,944711139),new c(264347078,2341262773),new c(604807628,2007800933),new c(770255983,1495990901),new c(1249150122,1856431235),new c(1555081692,3175218132),new c(1996064986,2198950837),new c(2554220882,3999719339),new c(2821834349,766784016),new c(2952996808,2566594879),new c(3210313671,3203337956),new c(3336571891,1034457026),new c(3584528711,2466948901),new c(113926993,3758326383),new c(338241895,168717936),new c(666307205,1188179964),new c(773529912,1546045734),new c(1294757372,1522805485),new c(1396182291,2643833823),new c(1695183700,2343527390),new c(1986661051,1014477480),new c(2177026350,1206759142),new c(2456956037,344077627),new c(2730485921,1290863460),new c(2820302411,3158454273),new c(3259730800,3505952657),new c(3345764771,106217008),new c(3516065817,3606008344),new c(3600352804,1432725776),new c(4094571909,1467031594),new c(275423344,851169720),new c(430227734,3100823752),new c(506948616,1363258195),new c(659060556,3750685593),new c(883997877,3785050280),new c(958139571,3318307427),new c(1322822218,3812723403),new c(1537002063,2003034995),new c(1747873779,3602036899),new c(1955562222,1575990012),new c(2024104815,1125592928),new c(2227730452,2716904306),new c(2361852424,442776044),new c(2428436474,593698344),new c(2756734187,3733110249),new c(3204031479,2999351573),new c(3329325298,3815920427),new c(3391569614,3928383900),new c(3515267271,566280711),new c(3940187606,3454069534),new c(4118630271,4000239992),new c(116418474,1914138554),new c(174292421,2731055270),new c(289380356,3203993006),new c(460393269,320620315),new c(685471733,587496836),new c(852142971,1086792851),new c(1017036298,365543100),new c(1126000580,2618297676),new c(1288033470,3409855158),new c(1501505948,4234509866),new c(1607167915,987167468),new c(1816402316,1246189591)],R=new Array(64),P,g,u,m,b,h,w,T,N,V,H,M,F=8;function J(Se){return unescape(encodeURIComponent(Se))}function q(Se){for(var De=[],Oe=(1<<F)-1,Pe=Se.length*F,Ke=0;Ke<Pe;Ke+=F)De[Ke>>5]|=(Se.charCodeAt(Ke/F)&Oe)<<32-F-Ke%32;return De}function ae(Se){for(var De="0123456789abcdef",Oe="",Pe=Se.length*4,Ke,Je=0;Je<Pe;Je+=1)Ke=Se[Je>>2]>>(3-Je%4)*8,Oe+=De.charAt(Ke>>4&15)+De.charAt(Ke&15);return Oe}function ge(Se,De){var Oe,Pe,Ke,Je;return Oe=(Se.lowOrder&65535)+(De.lowOrder&65535),Pe=(Se.lowOrder>>>16)+(De.lowOrder>>>16)+(Oe>>>16),Ke=(Pe&65535)<<16|Oe&65535,Oe=(Se.highOrder&65535)+(De.highOrder&65535)+(Pe>>>16),Pe=(Se.highOrder>>>16)+(De.highOrder>>>16)+(Oe>>>16),Je=(Pe&65535)<<16|Oe&65535,new c(Je,Ke)}function se(Se,De,Oe,Pe){var Ke,Je,ut,ft;return Ke=(Se.lowOrder&65535)+(De.lowOrder&65535)+(Oe.lowOrder&65535)+(Pe.lowOrder&65535),Je=(Se.lowOrder>>>16)+(De.lowOrder>>>16)+(Oe.lowOrder>>>16)+(Pe.lowOrder>>>16)+(Ke>>>16),ut=(Je&65535)<<16|Ke&65535,Ke=(Se.highOrder&65535)+(De.highOrder&65535)+(Oe.highOrder&65535)+(Pe.highOrder&65535)+(Je>>>16),Je=(Se.highOrder>>>16)+(De.highOrder>>>16)+(Oe.highOrder>>>16)+(Pe.highOrder>>>16)+(Ke>>>16),ft=(Je&65535)<<16|Ke&65535,new c(ft,ut)}function xe(Se,De,Oe,Pe,Ke){var Je,ut,ft,ct;return Je=(Se.lowOrder&65535)+(De.lowOrder&65535)+(Oe.lowOrder&65535)+(Pe.lowOrder&65535)+(Ke.lowOrder&65535),ut=(Se.lowOrder>>>16)+(De.lowOrder>>>16)+(Oe.lowOrder>>>16)+(Pe.lowOrder>>>16)+(Ke.lowOrder>>>16)+(Je>>>16),ft=(ut&65535)<<16|Je&65535,Je=(Se.highOrder&65535)+(De.highOrder&65535)+(Oe.highOrder&65535)+(Pe.highOrder&65535)+(Ke.highOrder&65535)+(ut>>>16),ut=(Se.highOrder>>>16)+(De.highOrder>>>16)+(Oe.highOrder>>>16)+(Pe.highOrder>>>16)+(Ke.highOrder>>>16)+(Je>>>16),ct=(ut&65535)<<16|Je&65535,new c(ct,ft)}function Le(Se,De,Oe){return new c(Se.highOrder&De.highOrder^Se.highOrder&Oe.highOrder^De.highOrder&Oe.highOrder,Se.lowOrder&De.lowOrder^Se.lowOrder&Oe.lowOrder^De.lowOrder&Oe.lowOrder)}function ve(Se,De,Oe){return new c(Se.highOrder&De.highOrder^~Se.highOrder&Oe.highOrder,Se.lowOrder&De.lowOrder^~Se.lowOrder&Oe.lowOrder)}function ie(Se,De){return De<=32?new c(Se.highOrder>>>De|Se.lowOrder<<32-De,Se.lowOrder>>>De|Se.highOrder<<32-De):new c(Se.lowOrder>>>De|Se.highOrder<<32-De,Se.highOrder>>>De|Se.lowOrder<<32-De)}function Ye(Se){var De=ie(Se,28),Oe=ie(Se,34),Pe=ie(Se,39);return new c(De.highOrder^Oe.highOrder^Pe.highOrder,De.lowOrder^Oe.lowOrder^Pe.lowOrder)}function Ge(Se){var De=ie(Se,14),Oe=ie(Se,18),Pe=ie(Se,41);return new c(De.highOrder^Oe.highOrder^Pe.highOrder,De.lowOrder^Oe.lowOrder^Pe.lowOrder)}function Ue(Se){var De=ie(Se,1),Oe=ie(Se,8),Pe=lt(Se,7);return new c(De.highOrder^Oe.highOrder^Pe.highOrder,De.lowOrder^Oe.lowOrder^Pe.lowOrder)}function Be(Se){var De=ie(Se,19),Oe=ie(Se,61),Pe=lt(Se,6);return new c(De.highOrder^Oe.highOrder^Pe.highOrder,De.lowOrder^Oe.lowOrder^Pe.lowOrder)}function lt(Se,De){return De<=32?new c(Se.highOrder>>>De,Se.lowOrder>>>De|Se.highOrder<<32-De):new c(0,Se.highOrder<<32-De)}var U=J(U),Me=U.length*F;U=q(U),U[Me>>5]|=128<<24-Me%32,U[(Me+128>>10<<5)+31]=Me;for(var N=0;N<U.length;N+=32){P=a[0],g=a[1],u=a[2],m=a[3],b=a[4],h=a[5],w=a[6],T=a[7];for(var V=0;V<80;V++)V<16?R[V]=new c(U[V*2+N],U[V*2+N+1]):R[V]=se(Be(R[V-2]),R[V-7],Ue(R[V-15]),R[V-16]),H=xe(T,Ge(b),ve(b,h,w),j[V],R[V]),M=ge(Ye(P),Le(P,g,u)),T=w,w=h,h=b,b=ge(m,H),m=u,u=g,g=P,P=ge(H,M);a[0]=ge(P,a[0]),a[1]=ge(g,a[1]),a[2]=ge(u,a[2]),a[3]=ge(m,a[3]),a[4]=ge(b,a[4]),a[5]=ge(h,a[5]),a[6]=ge(w,a[6]),a[7]=ge(T,a[7])}for(var ze=[],N=0;N<a.length;N++)ze.push(a[N].highOrder),ze.push(a[N].lowOrder);return ae(ze)}})}},d={};function f(D){var Y=d[D];if(Y!==void 0)return Y.exports;var c=d[D]={exports:{}};return s[D].call(c.exports,c,c.exports,f),c.exports}(function(){f.n=function(D){var Y=D&&D.__esModule?function(){return D.default}:function(){return D};return f.d(Y,{a:Y}),Y}})(),function(){f.d=function(D,Y){for(var c in Y)f.o(Y,c)&&!f.o(D,c)&&Object.defineProperty(D,c,{enumerable:!0,get:Y[c]})}}(),function(){f.o=function(D,Y){return Object.prototype.hasOwnProperty.call(D,Y)}}();var E={};return function(){"use strict";f.d(E,{default:function(){return Ft}});var D={};D.two=function(v){return v=""+v,v.length==1&&(v="0"+v),v},D.focus=function(v){if(v.innerText.length){var C=document.createRange(),l=window.getSelection(),o=v.childNodes[v.childNodes.length-1];C.setStart(o,o.length),C.collapse(!0),l.removeAllRanges(),l.addRange(C),v.scrollLeft=v.scrollWidth}},D.isNumeric=function(v){return typeof v=="string"&&(v=v.trim()),!isNaN(v)&&v!==null&&v!==""},D.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(v){var C=Math.random()*16|0,l=v=="x"?C:C&3|8;return l.toString(16)})},D.getNode=function(){var v=document.getSelection().anchorNode;return v?v.nodeType==3?v.parentNode:v:null},D.hash=function(v){var C=0,l,o;if(v.length===0)return C;for(l=0;l<v.length;l++)o=v.charCodeAt(l),o>32&&(C=(C<<5)-C+o,C|=0);return C},D.randomColor=function(v){var C=-.25,l=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");l.length<6&&(l=l[0]+l[0]+l[1]+l[1]+l[2]+l[2]);var o=[],k,Q;for(Q=0;Q<3;Q++)k=parseInt(l.substr(Q*2,2),16),k=Math.round(Math.min(Math.max(0,k+k*C),255)).toString(16),o.push(("00"+k).substr(k.length));return v==!0?"#"+D.two(o[0].toString(16))+D.two(o[1].toString(16))+D.two(o[2].toString(16)):o},D.getWindowWidth=function(){var v=window,C=document,l=C.documentElement,o=C.getElementsByTagName("body")[0],k=v.innerWidth||l.clientWidth||o.clientWidth;return k},D.getWindowHeight=function(){var v=window,C=document,l=C.documentElement,o=C.getElementsByTagName("body")[0],k=v.innerHeight||l.clientHeight||o.clientHeight;return k},D.getPosition=function(v){if(v.changedTouches&&v.changedTouches[0])var C=v.changedTouches[0].pageX,l=v.changedTouches[0].pageY;else var C=window.Event?v.pageX:v.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),l=window.Event?v.pageY:v.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[C,l]},D.click=function(v){if(v.click)v.click();else{var C=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});v.dispatchEvent(C)}},D.findElement=function(v,C){var l=!1;function o(k){k&&!l&&(typeof C=="function"?l=C(k):typeof C=="string"&&k.classList&&k.classList.contains(C)&&(l=k)),k.parentNode&&!l&&o(k.parentNode)}return o(v),l};var Y=D;function c(){var v={};v.now=function(k,Q){var te=null,O=null,I=null,_=null,W=null,oe=null;return Array.isArray(k)?(te=k[0],O=k[1],I=k[2],_=k[3],W=k[4],oe=k[5]):(k||(k=new Date),te=k.getFullYear(),O=k.getMonth()+1,I=k.getDate(),_=k.getHours(),W=k.getMinutes(),oe=k.getSeconds()),Q==!0?Y.two(te)+"-"+Y.two(O)+"-"+Y.two(I):Y.two(te)+"-"+Y.two(O)+"-"+Y.two(I)+" "+Y.two(_)+":"+Y.two(W)+":"+Y.two(oe)},v.toArray=function(k){var te=k.split(k.indexOf("T")!==-1?"T":" "),Q=te[1],te=te[0].split("-"),O=parseInt(te[0]),I=parseInt(te[1]),_=parseInt(te[2]),W=0,oe=0;return Q&&(Q=Q.split(":"),W=parseInt(Q[0]),oe=parseInt(Q[1])),[O,I,_,W,oe,0]};var C=Date.UTC(1900,0,0),l=Date.UTC(1900,1,29),o=864e5;return v.dateToNum=function(k){typeof k=="string"&&(k=new Date(k+"  GMT+0"));var Q=k.getTime();return Q>=l&&(Q+=o),Q-=C,Q/o},v.numToDate=function(k){var Q=C+k*o;Q>=l&&(Q-=o);const te=new Date(Q);var O=[te.getUTCFullYear(),te.getUTCMonth()+1,te.getUTCDate(),te.getUTCHours(),te.getUTCMinutes(),te.getUTCSeconds()];return v.now(O)},v.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],v.months=["January","February","March","April","May","June","July","August","September","October","November","December"],v.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],v.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],v}var a=c(),j=function(v){document.dictionary||(document.dictionary={});var C=null,l=null,o=Object.keys(v);for(l=0;l<o.length;l++)document.dictionary[o[l]]=v[o[l]];for(l=0;l<a.weekdays.length;l++)C=R(a.weekdays[l]),a.weekdays[l]&&(a.weekdays[l]=C,a.weekdaysShort[l]=C.substr(0,3));for(l=0;l<a.months.length;l++)C=R(a.months[l]),C&&(a.months[l]=C,a.monthsShort[l]=C.substr(0,3))},R=function(v){return typeof document!="undefined"&&document.dictionary&&document.dictionary[v]||v},P={setDictionary:j,translate:R};function g(v,C){if(C==!0)document.jsuitesComponents=document.jsuitesComponents.filter(function(o){return o!==null}),setTimeout(function(){document.jsuitesComponents.push(v)},0);else{var l=document.jsuitesComponents.indexOf(v);l>=0&&document.jsuitesComponents.splice(l,1)}}function u(v,C,l){if(v=v.split("."),v.length){let o=this,k=null;for(;v.length>1;)if(k=v.shift(),o.hasOwnProperty(k))o=o[k];else{if(typeof C=="undefined")return;o[k]={},o=o[k]}if(k=v.shift(),typeof C!="undefined")return l===!0?delete o[k]:o[k]=C,!0;if(o)return o[k]}return!1}function m(v,C){var l={};l.options={};var o={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},k=null;for(var Q in o)C&&C.hasOwnProperty(Q)?l.options[Q]=C[Q]:l.options[Q]=o[Q];v.classList.add("jsorting"),v.addEventListener("dragstart",function(I){var _=Array.prototype.indexOf.call(I.target.parentNode.children,I.target);k={element:I.target,o:_,d:_},I.target.style.opacity="0.25",typeof l.options.ondragstart=="function"&&l.options.ondragstart(v,I.target,I)}),v.addEventListener("dragover",function(I){if(I.preventDefault(),te(I.target)&&k&&I.target.getAttribute("draggable")=="true"&&k.element!=I.target){if(l.options.direction)var _=I.target.clientWidth/2>I.offsetX;else var _=I.target.clientHeight/2>I.offsetY;_?I.target.parentNode.insertBefore(k.element,I.target):I.target.parentNode.insertBefore(k.element,I.target.nextSibling),k.d=Array.prototype.indexOf.call(I.target.parentNode.children,k.element)}}),v.addEventListener("dragleave",function(I){I.preventDefault()}),v.addEventListener("dragend",function(I){I.preventDefault(),k&&(typeof l.options.ondragend=="function"&&l.options.ondragend(v,k.element,I),k.o<k.d?I.target.parentNode.insertBefore(k.element,I.target.parentNode.children[k.o]):I.target.parentNode.insertBefore(k.element,I.target.parentNode.children[k.o].nextSibling),k.element.style.opacity="",k=null)}),v.addEventListener("drop",function(I){I.preventDefault(),k&&k.o!=k.d&&typeof l.options.ondrop=="function"&&l.options.ondrop(v,k.o,k.d,k.element,I.target,I),k.element.style.opacity="",k=null});for(var te=function(I){var _=!1;function W(oe){oe.className&&oe.classList.contains("jsorting")&&(_=!0),_||W(oe.parentNode)}return W(I),_},O=0;O<v.children.length;O++)v.children[O].hasAttribute("draggable")||v.children[O].setAttribute("draggable","true");return v.val=function(){for(var I=null,_=[],W=0;W<v.children.length;W++)(I=v.children[W].getAttribute("data-id"))&&_.push(I);return _},v}function b(v,C){var l={};(!C.loadUp||typeof C.loadUp!="function")&&(C.loadUp=function(){return!1}),(!C.loadDown||typeof C.loadDown!="function")&&(C.loadDown=function(){return!1}),C.timer||(C.timer=100);var o=null,k=function(Q){if(o==null){var te=!1,O=v.scrollTop;v.scrollTop+v.clientHeight*2>=v.scrollHeight?C.loadDown()&&(O==v.scrollTop&&(v.scrollTop=v.scrollTop-v.clientHeight),te=!0):v.scrollTop<=v.clientHeight&&C.loadUp()&&(O==v.scrollTop&&(v.scrollTop=v.scrollTop+v.clientHeight),te=!0),o=setTimeout(function(){o=null},C.timer),te&&typeof C.onupdate=="function"&&C.onupdate()}};return v.onscroll=function(Q){k(Q)},v.onwheel=function(Q){k(Q)},l}function h(){var v=function(C,l){if(Array.isArray(C)){var o={instance:[],complete:l};if(C.length>0)for(var k=0;k<C.length;k++)C[k].multiple=o,o.instance.push(v(C[k]));return o}if(C.data||(C.data={}),C.type&&(C.method=C.type),C.method||(C.method="GET"),C.dataType||(C.dataType="json"),C.data){var Q=function(oe,be){var ue=[];if(oe){var pe=Object.keys(oe);if(pe.length)for(var le=0;le<pe.length;le++){if(be)var je=be+"["+pe[le]+"]";else var je=pe[le];if(oe[je]instanceof FileList)ue[je]=oe[pe[le]];else if(oe[pe[le]]===null||oe[pe[le]]===void 0)ue[je]="";else if(typeof oe[pe[le]]=="object")for(var Ce=Q(oe[pe[le]],je),qe=Object.keys(Ce),Ze=0;Ze<qe.length;Ze++)ue[qe[Ze]]=Ce[qe[Ze]];else ue[je]=oe[pe[le]]}}return ue},te=Q(C.data),O=Object.keys(te);if(C.method=="GET"){if(O.length){for(var I=[],k=0;k<O.length;k++)I.push(O[k]+"="+encodeURIComponent(te[O[k]]));C.url.indexOf("?")<0&&(C.url+="?"),C.url+=I.join("&")}}else for(var I=new FormData,k=0;k<O.length;k++)if(te[O[k]]instanceof FileList){if(te[O[k]].length)for(var _=0;_<te[O[k]].length;_++)I.append(O[k],te[O[k]][_],te[O[k]][_].name)}else I.append(O[k],te[O[k]])}var W=new XMLHttpRequest;return W.open(C.method,C.url,!0),W.setRequestHeader("X-Requested-With","XMLHttpRequest"),C.contentType&&W.setRequestHeader("Content-Type",C.contentType),C.method==="POST"?W.setRequestHeader("Accept","application/json"):C.dataType==="blob"?W.responseType="blob":C.contentType||(C.dataType==="json"?W.setRequestHeader("Content-Type","text/json"):C.dataType==="html"&&W.setRequestHeader("Content-Type","text/html")),C.cache!==!0&&(W.setRequestHeader("pragma","no-cache"),W.setRequestHeader("cache-control","no-cache")),C.withCredentials===!0&&(W.withCredentials=!0),typeof C.beforeSend=="function"&&C.beforeSend(W),typeof v.beforeSend=="function"&&v.beforeSend(W),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(W),W.onload=function(){if(W.status>=200&&W.status<300)if(C.dataType==="json")try{var oe=JSON.parse(W.responseText);C.success&&typeof C.success=="function"&&C.success(oe)}catch(ue){C.error&&typeof C.error=="function"&&C.error(ue,oe)}else{if(C.dataType==="blob")var oe=W.response;else var oe=W.responseText;C.success&&typeof C.success=="function"&&C.success(oe)}else C.error&&typeof C.error=="function"&&C.error(W.responseText,W.status);if(v.queue&&v.queue.length>0&&v.send(v.queue.shift()),v.requests&&v.requests.length){var be=v.requests.indexOf(W);if(v.requests.splice(be,1),v.requests.length||C.complete&&typeof C.complete=="function"&&C.complete(oe),C.group&&v.oncomplete&&typeof v.oncomplete[C.group]=="function"&&(v.pending(C.group)||(v.oncomplete[C.group](),v.oncomplete[C.group]=null)),C.multiple&&C.multiple.instance){var be=C.multiple.instance.indexOf(W);C.multiple.instance.splice(be,1),C.multiple.instance.length||C.multiple.complete&&typeof C.multiple.complete=="function"&&C.multiple.complete(oe)}}},W.options=C,W.data=I,C.queue===!0&&v.requests.length>0?v.queue.push(W):v.send(W),W};return v.send=function(C){C.data?Array.isArray(C.data)?C.send(C.data.join("&")):C.send(C.data):C.send(),v.requests.push(C)},v.exists=function(C,l){var o=new XMLHttpRequest;o.open("HEAD",C,!1),o.send(),o.status&&l(o.status)},v.pending=function(C){var l=0,o=v.requests;if(o&&o.length)for(var k=0;k<o.length;k++)(!C||C==o[k].options.group)&&l++;return l},v.oncomplete={},v.requests=[],v.queue=[],v}var w=h();function T(){const v={loading:{}};return v.loading.show=function(C){v.loading.element||(v.loading.element=document.createElement("div"),v.loading.element.className="jloading"),document.body.appendChild(v.loading.element),C>0&&setTimeout(function(){v.loading.hide()},C*1e3)},v.loading.hide=function(){v.loading.element&&v.loading.element.parentNode&&document.body.removeChild(v.loading.element)},v.slideLeft=function(C,l,o){l==!0?(C.classList.add("slide-left-in"),setTimeout(function(){C.classList.remove("slide-left-in"),typeof o=="function"&&o()},400)):(C.classList.add("slide-left-out"),setTimeout(function(){C.classList.remove("slide-left-out"),typeof o=="function"&&o()},400))},v.slideRight=function(C,l,o){l===!0?(C.classList.add("slide-right-in"),setTimeout(function(){C.classList.remove("slide-right-in"),typeof o=="function"&&o()},400)):(C.classList.add("slide-right-out"),setTimeout(function(){C.classList.remove("slide-right-out"),typeof o=="function"&&o()},400))},v.slideTop=function(C,l,o){l===!0?(C.classList.add("slide-top-in"),setTimeout(function(){C.classList.remove("slide-top-in"),typeof o=="function"&&o()},400)):(C.classList.add("slide-top-out"),setTimeout(function(){C.classList.remove("slide-top-out"),typeof o=="function"&&o()},400))},v.slideBottom=function(C,l,o){l===!0?(C.classList.add("slide-bottom-in"),setTimeout(function(){C.classList.remove("slide-bottom-in"),typeof o=="function"&&o()},400)):(C.classList.add("slide-bottom-out"),setTimeout(function(){C.classList.remove("slide-bottom-out"),typeof o=="function"&&o()},100))},v.fadeIn=function(C,l){C.style.display="",C.classList.add("fade-in"),setTimeout(function(){C.classList.remove("fade-in"),typeof l=="function"&&l()},2e3)},v.fadeOut=function(C,l){C.classList.add("fade-out"),setTimeout(function(){C.style.display="none",C.classList.remove("fade-out"),typeof l=="function"&&l()},1e3)},v}var N=T();function V(){var v={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},C=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var A=0;this.date[4]&&(A=parseFloat(this.date[4]/60));var S=parseInt(this.date[3])+A;S/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?S=Y.two(this.date[3])+":"+Y.two(this.date[4])+":"+Y.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),S=Y.two(this.date[0])+"-"+Y.two(this.date[1])+"-"+Y.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(S+=" "+Y.two(this.date[3])+":"+Y.two(this.date[4])+":"+Y.two(this.date[5])));return S},l=function(){var A="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)A=parseInt(this.date[3]);else{let Z=parseInt(this.date[3]);Z<13&&this.values.indexOf("PM")!==-1?A=(Z+12)%24:A=Z%24}this.date[4]&&(A+=parseFloat(this.date[4]/60)),this.date[5]&&(A+=parseFloat(this.date[5]/3600)),A/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var S=a.now(this.date);A=a.dateToNum(S),this.date[4]&&(A+=parseFloat(this.date[4]/60))}return isNaN(A)&&(A=""),A},o=function(A){return A===null||A===""||A===void 0},k=function(A){var S=(""+A)[0];return S=="="},Q=function(A){return A==="currency"||A==="percentage"||A==="numeric"},te=function(A){if(A&&Number(A)==A)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var S=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=S[1]}else{A||(A=this.mask);var Z=new RegExp("0{1}(.{1})0+","ig"),S=Z.exec(A);if(S&&S[1]&&S[1].length==1)return this.options.decimal=S[1],S[1];var Z=new RegExp("#{1}(.{1})#+","ig"),S=Z.exec(A);S&&S[1]&&S[1].length==1?S[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},O=function(A,S){if(A=="")return"";S||(S=te.call(this)),A=(""+A).split(S);var Z=A[0].match(/[-]+/g);if(Z&&Z.length?Z=!0:Z=!1,A[0]=A[0].match(/[0-9]+/g),A[0]?(Z&&A[0].unshift("-"),A[0]=A[0].join("")):Z&&(A[0]="-"),A[0]||A[1])A[1]!==void 0&&(A[1]=A[1].match(/[0-9]+/g),A[1]?A[1]=A[1].join(""):A[1]="");else return"";return A},I=function(A,S){if(A==="")return"";var Z=te.call(this),ce=this.options;if(A=O.call(this,A),A==="")return"";var de=null;if(A[0]&&(ce.style==="percent"?de=parseFloat(A[0])/100:de=parseFloat(A[0]+".1")),(A[0]==="-"||A[0]==="-00")&&!A[1]&&S&&S.inputType=="deleteContentBackward")return"";var K=new Intl.NumberFormat(this.locale,ce).format(de);if(K=K.split(Z),ce.style==="percent"&&K[0].indexOf("%")!==-1&&(K[0]=K[0].replace("%",""),K[2]="%"),typeof K[1]!="undefined"){var ye=K[1].replace(/[0-9]*/g,"");ye&&(K[2]=ye)}return A[1]!==void 0?K[1]=Z+A[1]:K[1]="",K.join("")},_=function(A,S){var Z=be.call(A);if(Z){var ce=I.call(this,Z,S),de=ce.length-Z.length,K=oe.call(A)+de;be.call(A,ce,K,!0)}},W=function(A){var S=O.call(this,A);return S?(S[0]==="-"&&(S[0]="-0"),parseFloat(S.join("."))):null},oe=function(A,S){if(A===void 0)if(this.tagName=="DIV"){var Z=0,ce=window.getSelection();if(ce&&ce.rangeCount!==0){var de=ce.getRangeAt(0),K=de.cloneRange();K.selectNodeContents(this),K.setEnd(de.endContainer,de.endOffset),Z=K.toString().length}return Z}else return this.selectionStart;else{var ye=be.call(this);if(S){for(var K=null,Ne=0;Ne<ye.length;Ne++)(ye[Ne].match(/[\-0-9]/g)||ye[Ne]==="."||ye[Ne]===",")&&(K=Ne);K===null&&(K=ye.indexOf(" ")),A>=K&&(A=K+1)}if(A>ye.length&&(A=ye.length),A)if(this.tagName=="DIV"){var ce=window.getSelection(),de=document.createRange();this.childNodes[0]&&(de.setStart(this.childNodes[0],A),ce.removeAllRanges(),ce.addRange(de))}else this.selectionStart=A,this.selectionEnd=A}},be=function(A,S,Z){if(this.tagName=="DIV")if(A===void 0){var A=this.innerText;return this.value&&this.value.length>A.length&&(A=this.value),A}else this.innerText!==A&&(this.innerText=A,S&&oe.call(this,S,Z));else{if(A===void 0)return this.value;this.value!==A&&(this.value=A,S&&oe.call(this,S,Z))}},ue=a.weekdays,pe=a.weekdaysShort,le=a.months,je=a.monthsShort,Ce={YEAR:function(A,S){var Z=""+new Date().getFullYear();if(typeof this.values[this.index]=="undefined"&&(this.values[this.index]=""),parseInt(A)>=0&&parseInt(A)<=10&&this.values[this.index].length<S&&(this.values[this.index]+=A),this.values[this.index].length==S){if(S==2)var Z=Z.substr(0,2)+this.values[this.index];else if(S==3)var Z=Z.substr(0,1)+this.values[this.index];else if(S==4)var Z=this.values[this.index];this.date[0]=Z,this.index++}},YYYY:function(A){Ce.YEAR.call(this,A,4)},YYY:function(A){Ce.YEAR.call(this,A,3)},YY:function(A){Ce.YEAR.call(this,A,2)},FIND:function(A,S){if(o(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=A;return}for(var Z=0,ce=0,de=(this.values[this.index]+A).toLowerCase(),K=0;K<S.length;K++)S[K].toLowerCase().indexOf(de)==0&&(Z=K,ce++);if(ce>1)this.values[this.index]+=A;else if(ce==1){var ye=S[Z].length-this.values[this.index].length-1;return this.position+=ye,this.values[this.index]=S[Z],this.index++,Z}},MMM:function(A){var S=Ce.FIND.call(this,A,je);S!==void 0&&(this.date[1]=S+1)},MON:function(A){Ce.MMM.call(this,A)},MMMM:function(A){var S=Ce.FIND.call(this,A,le);S!==void 0&&(this.date[1]=S+1)},MONTH:function(A){Ce.MMMM.call(this,A)},MMMMM:function(A){o(this.values[this.index])&&(this.values[this.index]="");for(var S=0,Z=0,ce=(this.values[this.index]+A).toLowerCase(),de=0;de<le.length;de++)if(le[de][0].toLowerCase().indexOf(ce)==0){this.values[this.index]=le[de][0],this.date[1]=de+1,this.index++;break}},MM:function(A){o(this.values[this.index])?parseInt(A)>1&&parseInt(A)<10?(this.date[1]=this.values[this.index]="0"+A,this.index++):parseInt(A)<2&&(this.values[this.index]=A):this.values[this.index]==1&&parseInt(A)<3?(this.date[1]=this.values[this.index]+=A,this.index++):this.values[this.index]==0&&parseInt(A)>0&&parseInt(A)<10&&(this.date[1]=this.values[this.index]+=A,this.index++)},M:function(A){var S=!1;if(parseInt(A)>=0&&parseInt(A)<10)if(o(this.values[this.index]))this.values[this.index]=A,A>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(A)<3)this.date[1]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==0&&parseInt(A)>0)this.date[1]=this.values[this.index]+=A,this.index++;else var S=!0;else var S=!0;if(S==!0){var Z=parseInt(this.values[this.index]);Z>0&&Z<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(A){var S=!1;if(parseInt(A)>=0&&parseInt(A)<10)if(o(this.values[this.index]))this.values[this.index]=A,parseInt(A)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(A)<2)this.date[2]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==0&&parseInt(A)>0)this.date[2]=this.values[this.index]+=A,this.index++;else var S=!0;else var S=!0;if(S==!0){var Z=parseInt(this.values[this.index]);Z>0&&Z<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(A){o(this.values[this.index])?parseInt(A)>3&&parseInt(A)<10?(this.date[2]=this.values[this.index]="0"+A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==3&&parseInt(A)<2?(this.date[2]=this.values[this.index]+=A,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(A)<10?(this.date[2]=this.values[this.index]+=A,this.index++):this.values[this.index]==0&&parseInt(A)>0&&parseInt(A)<10&&(this.date[2]=this.values[this.index]+=A,this.index++)},DDD:function(A){Ce.FIND.call(this,A,pe)},DY:function(A){Ce.DDD.call(this,A)},DDDD:function(A){Ce.FIND.call(this,A,ue)},DAY:function(A){Ce.DDDD.call(this,A)},HH12:function(A,S){o(this.values[this.index])?parseInt(A)>1&&parseInt(A)<10?(S&&(A=0+A),this.date[3]=this.values[this.index]=A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==1&&parseInt(A)<3?(this.date[3]=this.values[this.index]+=A,this.index++):this.values[this.index]<1&&parseInt(A)<10&&(this.date[3]=this.values[this.index]+=A,this.index++)},HH24:function(A,S){parseInt(A)>=0&&parseInt(A)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(A)>2&&parseInt(A)<10?(S&&(A=0+A),this.date[3]=this.values[this.index]=A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==2&&parseInt(A)<4?(!S&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=A,this.index++):this.values[this.index]<2&&parseInt(A)<10&&(!S&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=A,this.index++))},HH:function(A){Ce.HH24.call(this,A,1)},H:function(A){Ce.HH24.call(this,A,0)},"\\[H\\]":function(A){this.values[this.index]==null&&(this.values[this.index]=""),A.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=A:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(A,S){this.values[this.index]==null||this.values[this.index]==""?parseInt(A)>5&&parseInt(A)<10?(this.date[S]=this.values[this.index]="0"+A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):parseInt(A)<10&&(this.date[S]=this.values[this.index]+=A,this.index++)},MI:function(A){Ce.N60.call(this,A,4)},SS:function(A){Ce.N60.call(this,A,5)},"AM/PM":function(A){typeof this.values[this.index]=="undefined"&&(this.values[this.index]=""),this.values[this.index]===""?A.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":A.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(A){typeof this.values[this.index]=="undefined"&&(this.values[this.index]=""),parseInt(A)>=0&&parseInt(A)<7&&(this.values[this.index]=A),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(A){var S=te.call(this),Z=!1;o(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(Z=!0);var ce=O.call(this,this.values[this.index],S);ce&&(this.values[this.index]=ce.join(S)),parseInt(A)>=0&&parseInt(A)<10?(this.values[this.index]=="0"&&A>0?this.values[this.index]="":this.values[this.index]=="-0"&&A>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||A==S)&&(this.values[this.index]+=A)):S&&A==S?this.values[this.index].indexOf(S)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=A):A=="-"&&(Z=!0),Z===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(A){Ce["0{1}(.{1}0+)?"].call(this,A),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(A){Ce["0{1}(.{1}0+)?"].call(this,A);var S=te.call(this),Z=this.tokens[this.index].substr(1,1),ce=this.values[this.index][0]==="-",de=O.call(this,this.values[this.index],S);if(de!==""){var K=de[0].match(/[0-9]/g);if(K){K=K.join("");for(var ye=[],Ne=0,Ie=K.length-1;Ie>=0;Ie--)ye.push(K[Ie]),Ne++,Ne%3||ye.push(Z);ye=ye.reverse(),de[0]=ye.join(""),de[0].substr(0,1)==Z&&(de[0]=de[0].substr(1))}else de[0]="";this.values[this.index]=de.join(S),ce&&(this.values[this.index]="-"+this.values[this.index])}},0:function(A){A.match(/[0-9]/g)&&(this.values[this.index]=A,this.index++)},"[0-9a-zA-Z$]+":function(A){o(this.values[this.index])&&(this.values[this.index]="");var S=this.tokens[this.index],Z=this.values[this.index],ce=Z.length;S[ce]==A?(this.values[this.index]+=A,this.values[this.index]==S&&this.index++):(this.values[this.index]=S,this.index++,A.match(/[\-0-9]/g)&&this.position--)},A:function(A){A.match(/[a-zA-Z]/gi)&&(this.values[this.index]=A,this.index++)},".":function(A){Ce["[0-9a-zA-Z$]+"].call(this,A)},"@":function(A){o(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=A}},qe=function(A){if(this.type=="general")var S=[].concat(v.general);else var S=[].concat(v.currency,v.datetime,v.percentage,v.numeric,v.text,v.general);var Z=new RegExp(S.join("|"),"gi");return A.match(Z)},Ze=function(A){if(this.type)if(this.type=="text")var S=["text"];else if(this.type=="general")var S=["general"];else if(this.type=="datetime")var S=["numeric","datetime","general"];else var S=["currency","percentage","numeric","general"];else var S=Object.keys(v);for(var Z=0;Z<S.length;Z++)for(var ce=S[Z],de=0;de<v[ce].length;de++){var K=new RegExp(v[ce][de],"gi"),ye=A.match(K);if(ye)return{type:ce,method:v[ce][de]}}},he=function(A){for(var S=[],Z=0;Z<A.length;Z++){var ce=Ze.call(this,A[Z]);ce?S.push(ce.method):S.push(null)}for(var Z=0;Z<S.length;Z++)S[Z]=="MM"&&(S[Z-1]&&S[Z-1].indexOf("H")>=0||S[Z-2]&&S[Z-2].indexOf("H")>=0||S[Z+1]&&S[Z+1].indexOf("S")>=0||S[Z+2]&&S[Z+2].indexOf("S")>=0)&&(S[Z]="MI");return S},Ee=function(A){var S=Ze.call(this,A);if(S)var Z=S.type;if(Z){for(var ce=0,de=qe.call(this,A),K=0;K<de.length;K++)S=Ze.call(this,de[K]),S&&Q(S.type)&&ce++;ce>1&&(Z="general")}return Z},G=function(){typeof Ce[this.methods[this.index]]=="function"?(Ce[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},X=function(A){return(""+ +A).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(S,Z,ce,de,K){return K<0?Z+"0."+Array(1-K-ce.length).join(0)+ce+de:Z+ce+de+Array(K-de.length+1).join(0)})},re=function(A,S,Z){var ce=null,de=null,K={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof A=="object"){if(K.input=A.target,K.value=be.call(A.target),K.caret=oe.call(A.target),(de=A.target.getAttribute("data-mask"))&&(K.mask=de),(de=A.target.getAttribute("data-type"))&&(K.type=de),A.target.mask?(A.target.mask.options&&(K.options=A.target.mask.options),A.target.mask.locale&&(K.locale=A.target.mask.locale)):(de=A.target.getAttribute("data-locale"))&&(K.locale=de,K.mask&&(K.options.style=K.mask)),A.target.attributes&&A.target.attributes.length)for(var ye=0;ye<A.target.attributes.length;ye++){var Ne=A.target.attributes[ye].name,Ie=A.target.attributes[ye].value;Ne.substr(0,4)=="data"&&(K.options[Ne.substr(5)]=Ie)}}else{if(typeof S=="string")K.mask=S;else for(var Ne=Object.keys(S),ye=0;ye<Ne.length;ye++)K[Ne[ye]]=S[Ne[ye]];typeof A=="number"&&(te.call(K,K.mask),A=(""+A).replace(".",K.options.decimal)),K.value=A,K.input&&(be.call(K.input,A),Y.focus(K.input),K.caret=oe.call(K.input))}if(!k(K.value)&&(K.mask||K.locale)){if(K.mask){if(K.mask=K.mask.replace(new RegExp(/\[h]/),"|h|"),K.mask=K.mask.replace(new RegExp(/\[.*?\]/),""),K.mask=K.mask.replace(new RegExp(/\|h\|/),"[h]"),K.mask.indexOf(";")!==-1){var de=K.mask.split(";");K.mask=de[0]}if(K.mask.indexOf("##")!==-1){var Te=K.mask.split(";");Te[0]&&(typeof A=="object"&&(Te[0]=Te[0].replace(new RegExp(/_\)/g),""),Te[0]=Te[0].replace(new RegExp(/_\(/g),"")),Te[0]=Te[0].replace("*","	"),Te[0]=Te[0].replace(new RegExp(/_-/g),""),Te[0]=Te[0].replace(new RegExp(/_/g),""),Te[0]=Te[0].replace("##0.###","##0.000"),Te[0]=Te[0].replace("##0.##","##0.00"),Te[0]=Te[0].replace("##0.#","##0.0"),Te[0]=Te[0].replace("##0,###","##0,000"),Te[0]=Te[0].replace("##0,##","##0,00"),Te[0]=Te[0].replace("##0,#","##0,0")),K.mask=Te[0]}if(K.mask.indexOf("\\")!==-1){var Te=K.mask.split(";");Te[0]=Te[0].replace(new RegExp(/\\/g),""),K.mask=Te[0]}K.type||(K.type=Ee.call(K,K.mask)),K.tokens=qe.call(K,K.mask)}if(typeof A!="object"||!A.inputType||!A.inputType.indexOf("insert")||!A.inputType.indexOf("delete"))if(K.locale)if(K.input)_.call(K,K.input,A);else var _e=I.call(K,K.value);else{for(K.methods=he.call(K,K.tokens),K.event=A;K.position<K.value.length&&typeof K.tokens[K.index]!="undefined";)G.call(K);var _e=K.values.join("");if(Q(K.type)&&_e!==""){for(;typeof K.tokens[K.index]!="undefined";){var de=Ze.call(K,K.tokens[K.index]);de&&de.type=="general"&&(K.values[K.index]=K.tokens[K.index]),K.index++}var $e=!0}else var $e=!1;if(_e=K.values.join(""),K.input){if(de=_e.length-K.value.length,de>0)var nt=K.caret+de;else var nt=K.caret;be.call(K.input,_e,nt,$e)}}if(K.input){var ee=null;if(Q(K.type)){let me=be.call(K.input);K.number=W.call(K,me),K.type=="percentage"&&me.indexOf("%")!==-1?ee=re.adjustPrecision(K.number/100):ee=K.number}else K.type=="datetime"&&(ee=C.call(K),K.date[0]&&K.date[1]&&K.date[2]&&K.input.setAttribute("data-completed",!0));ee&&K.input.setAttribute("data-value",ee)}if(_e!==void 0)return Z?K:_e}};return re.adjustPrecision=function(A){if(typeof A=="number"&&!Number.isInteger(A)){const S=A.toString().split(".");if(S[1]&&S[1].length>10){let Z=0;const ce=S[1][S[1].length-2];if(ce==0||ce==9){for(let de=S[1].length-2;de>0;de--)if(Z>=0&&S[1][de]==ce){if(Z++,Z>6)break}else{Z=0;break}if(Z)return parseFloat(parseFloat(A).toFixed(S[1].length-1))}}}return A},re.getType=Ee,re.prepare=function(A,S){return S||(S={}),qe.call(S,A)},re.apply=function(A){var S=be.call(A.target);A.key.length==1&&(S+=A.key),be.call(A.target,re(S,A.target.getAttribute("data-mask")))},re.run=function(A,S,Z){return re(A,{mask:S,decimal:Z})},re.extract=function(A,S,Z){if(o(A)||typeof S!="object")return A;if(S=Object.assign({},S),S.options||(S.options={}),!S.mask&&S.format&&(S.mask=S.format),S.mask){if(S.mask.indexOf(";")!==-1){var ce=S.mask.split(";");S.mask=ce[0]}S.mask=S.mask.replace(new RegExp(/\[h]/),"|h|"),S.mask=S.mask.replace(new RegExp(/\[.*?\]/),""),S.mask=S.mask.replace(new RegExp(/\|h\|/),"[h]")}te.call(S,S.mask);var de=null,K=null;if(S.type=="percent"||S.options.style=="percent"?de="percentage":S.mask&&(de=Ee.call(S,S.mask)),de==="general"){var ye=re(A,S,!0);K=A}else if(de==="datetime"){A instanceof Date&&(A=re.getDateString(A,S.mask));var ye=re(A,S,!0);Y.isNumeric(A)?K=A:K=l.call(ye)}else{K=W.call(S,A),de==="percentage"&&A.indexOf("%")!==-1&&(K/=100);var ye=S}return ye.value=K,!ye.type&&de&&(ye.type=de),Z?ye:K},re.render=function(A,S,Z){if(o(A)||typeof S!="object")return A;if(S=Object.assign({},S),S.options||(S.options={}),!S.mask&&S.format&&(S.mask=S.format),S.mask){if(S.mask.indexOf(";")!==-1){var ce=S.mask.split(";");Z||(ce[0]=ce[0].replace(new RegExp(/_\)/g),""),ce[0]=ce[0].replace(new RegExp(/_\(/g),"")),S.mask=ce[0]}S.mask=S.mask.replace(new RegExp(/\[h]/),"|h|"),S.mask=S.mask.replace(new RegExp(/\[.*?\]/),""),S.mask=S.mask.replace(new RegExp(/\|h\|/),"[h]")}var de=null;S.type=="percent"||S.options.style=="percent"?de="percentage":S.mask?de=Ee.call(S,S.mask):A instanceof Date&&(de="datetime");var K=!1;if(de=="datetime"||S.type=="calendar"){var ce=re.getDateString(A,S.mask);ce&&(A=ce),S.mask&&Z&&(K=!0)}else if(de==="percentage"&&(A=re.adjustPrecision(A*100)),typeof A=="number"){var ce=null;if(S.mask&&Z&&(""+A).indexOf("e")===-1){var ye=te.call(S,S.mask);S.mask.indexOf(ye)!==-1?(ye=S.mask.split(ye),ye=""+ye[1].match(/[0-9]+/g),ye=ye.length,ce=A.toFixed(ye)):ce=A.toFixed(0)}else if(S.locale&&Z){var ye=(""+A).split(".");if(S.options){typeof ye[1]=="undefined"&&(ye[1]="");var Ie=ye[1].length;if(S.options.minimumFractionDigits>Ie)for(var Ne=0;Ne<S.options.minimumFractionDigits-Ie;Ne++)ye[1]+="0"}ye[1].length?ce=ye.join("."):ce=ye[0];var Ie=ye[1].length;S.options&&S.options.maximumFractionDigits<Ie&&(ce=parseFloat(ce).toFixed(S.options.maximumFractionDigits))}else ce=X(A);ce!==null&&(A=ce,te.call(S,S.mask),S.options.decimal&&(A=A.replace(".",S.options.decimal)))}else S.mask&&Z&&(K=!0);if(K){var Te=S.mask.length-A.length;if(Te>0)for(var Ne=0;Ne<Te;Ne++)A+=" "}if(A=re(A,S),Z&&de==="numeric"){var _e=S.mask.match(new RegExp(/^[0]+$/gm));if(_e&&_e.length===1){var $e=_e[0].length;if($e>3)for(A=""+A;A.length<$e;)A="0"+A}}return A},re.set=function(A,S){if(S){A.setAttribute("data-mask",S);var Z=new Event("input",{bubbles:!0,cancelable:!0});A.dispatchEvent(Z)}},re.extractDateFromString=function(A,S){var Z=re(A,{mask:S},!0);if(A>0&&Number(A)==A&&(Z.values.join("")!==Z.value||Z.type=="numeric")){var ce=new Date(Math.round((A-25569)*86400*1e3));return ce.getFullYear()+"-"+Y.two(ce.getMonth())+"-"+Y.two(ce.getDate())+" 00:00:00"}var de=!1;return Z.values.length===Z.tokens.length&&Z.values[Z.values.length-1].length>=Z.tokens[Z.tokens.length-1].length&&(de=!0),Z.date[0]&&Z.date[1]&&(Z.date[2]||de)?(Z.date[2]||(Z.date[2]=1),Z.date[0]+"-"+Y.two(Z.date[1])+"-"+Y.two(Z.date[2])+" "+Y.two(Z.date[3])+":"+Y.two(Z.date[4])+":"+Y.two(Z.date[5])):""},re.getDateString=function(A,S){if(!S)var S={};if(S&&typeof S=="object")var Z=S.format;else var Z=S;if(Z||(Z="YYYY-MM-DD"),Z.indexOf("[h]")>=0){var ce=0;if(A&&Y.isNumeric(A)&&(ce=parseFloat(24*Number(A)),Z.indexOf("mm")>=0)){var de=(""+ce).split(".");if(de[1]){var K=60*parseFloat("0."+de[1]);K=parseFloat(K.toFixed(2))}else var K=0;ce=parseInt(de[0])+":"+Y.two(K)}return ce}A instanceof Date?A=a.now(A):A&&Y.isNumeric(A)&&(A=a.numToDate(A));for(var ye=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Ne=new RegExp(ye.join("|"),"gi"),Ie=Z.match(Ne),Te=0;Te<Ie.length;Te++)Ie[Te].toUpperCase()=="MM"&&(Ie[Te-1]&&Ie[Te-1].toUpperCase().indexOf("H")>=0||Ie[Te-2]&&Ie[Te-2].toUpperCase().indexOf("H")>=0||Ie[Te+1]&&Ie[Te+1].toUpperCase().indexOf("S")>=0||Ie[Te+2]&&Ie[Te+2].toUpperCase().indexOf("S")>=0)&&(Ie[Te]="mi");var _e={tokens:Ie};if(A){var K=""+A,$e=K.indexOf("T")!==-1?"T":" ";K=K.split($e);var de=0,nt=0,ee=0;if(K[1]&&(de=K[1].split(":"),nt=de[1]?de[1]:0,ee=de[2]?de[2]:0,de=de[0]?de[0]:0),K=K[0].split("-"),K[0]&&K[1]&&K[2]&&K[0]>0&&K[1]>0&&K[1]<13&&K[2]>0&&K[2]<32){_e.data=[K[0],K[1],K[2],de,nt,ee],_e.value=[];for(var me=new Date(_e.data[0],_e.data[1]-1,_e.data[2],_e.data[3],_e.data[4],_e.data[5]),Ae=function(Xe){var Qe=this.tokens[Xe],et=Qe.toUpperCase(),He=null;et==="YYYY"?He=this.data[0]:et==="YYY"?He=this.data[0].substring(1,4):et==="YY"?He=this.data[0].substring(2,4):et==="Y"?He=this.data[0].substring(3,4):Qe==="MON"?He=a.months[me.getMonth()].substr(0,3).toUpperCase():Qe==="mon"?He=a.months[me.getMonth()].substr(0,3).toLowerCase():Qe==="MONTH"?He=a.months[me.getMonth()].toUpperCase():Qe==="month"?He=a.months[me.getMonth()].toLowerCase():et==="MMMMM"?He=a.months[me.getMonth()].substr(0,1):et==="MMMM"||Qe==="Month"?He=a.months[me.getMonth()]:et==="MMM"||Qe=="Mon"?He=a.months[me.getMonth()].substr(0,3):et==="MM"?He=Y.two(this.data[1]):et==="M"?He=me.getMonth()+1:Qe==="DAY"?He=a.weekdays[me.getDay()].toUpperCase():Qe==="day"?He=a.weekdays[me.getDay()].toLowerCase():et==="DDDD"||Qe=="Day"?He=a.weekdays[me.getDay()]:et==="DDD"?He=a.weekdays[me.getDay()].substr(0,3):et==="DD"?He=Y.two(this.data[2]):et==="D"?He=parseInt(this.data[2]):et==="Q"?He=Math.floor((me.getMonth()+3)/3):et==="HH24"||et==="HH"?(He=this.data[3],He>12&&this.tokens.indexOf("am/pm")!==-1&&(He-=12),He=Y.two(He)):et==="HH12"?this.data[3]>12?He=Y.two(this.data[3]-12):He=Y.two(this.data[3]):et==="H"?(He=this.data[3],He>12&&this.tokens.indexOf("am/pm")!==-1&&(He-=12,He=Y.two(He))):et==="MI"?He=Y.two(this.data[4]):et==="SS"?He=Y.two(this.data[5]):et==="MS"?He=me.getMilliseconds():et==="AM/PM"?this.data[3]>=12?He="PM":He="AM":et==="WD"&&(He=a.weekdays[me.getDay()]),He===null?this.value[Xe]=this.tokens[Xe]:this.value[Xe]=He},Te=0;Te<_e.tokens.length;Te++)Ae.call(_e,Te);A=_e.value.join("")}else A=""}return A},re}var H=V();function M(){var v=function(C,l){if(C.calendar)return C.calendar.setOptions(l,!0);var o={type:"calendar"};o.options={},o.date=null,o.setOptions=function(X,re){var A={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:a.monthsShort,monthsFull:a.months,weekdays:a.weekdays,textDone:P.translate("Done"),textReset:P.translate("Reset"),textUpdate:P.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var S in A)X&&X.hasOwnProperty(S)?o.options[S]=X[S]:(typeof o.options[S]=="undefined"||re===!0)&&(o.options[S]=A[S]);if(o.options.resetButton==!1?I.style.display="none":I.style.display="",o.options.readonly?C.setAttribute("readonly","readonly"):C.removeAttribute("readonly"),o.options.placeholder?C.setAttribute("placeholder",o.options.placeholder):C.removeAttribute("placeholder"),Y.isNumeric(o.options.value)&&o.options.value>0&&(o.options.value=v.numToDate(o.options.value),o.options.dataType="numeric"),I.innerHTML=o.options.textReset,_.innerHTML=o.options.textDone,Ze.innerHTML=o.options.textUpdate,C.setAttribute("data-mask",o.options.format.toLowerCase()),!o.options.value&&o.options.today)var Z=v.now();else var Z=o.options.value;return Z&&(o.options.value=null,o.setValue(Z)),o},o.open=function(X){if(!O.classList.contains("jcalendar-focus")&&!O.classList.contains("jcalendar-inline")){if(v.current=o,g(o,!0),o.getDays(),o.options.type=="year-month-picker"&&o.getMonths(),o.options.time&&(he.value=o.date[3],Ee.value=o.date[4]),O.classList.add("jcalendar-focus"),Y.getWindowWidth()<800||o.options.fullscreen)O.classList.add("jcalendar-fullsize"),N.slideBottom(oe,1);else{O.classList.remove("jcalendar-fullsize");var re=C.getBoundingClientRect(),A=oe.getBoundingClientRect();if(o.options.position)W.style.position="fixed",window.innerHeight<re.bottom+A.height?W.style.top=re.top-(A.height+2)+"px":W.style.top=re.top+re.height+2+"px",W.style.left=re.left+"px";else{if(window.innerHeight<re.bottom+A.height){var S=-1*(re.height+A.height+2);S+re.top<0&&(S=-1*(re.top+re.height)),W.style.top=S+"px"}else W.style.top="2px";if(window.innerWidth<re.left+A.width){var S=window.innerWidth-(re.left+A.width+20);W.style.left=S+"px"}else W.style.left="0px"}}typeof o.options.onopen=="function"&&o.options.onopen(C)}},o.close=function(X,re){if(o.options.autoSelect!==!0&&typeof re=="undefined"&&(re=!1),O.classList.contains("jcalendar-focus")){if(re!==!1){var A=O.querySelector(".jcalendar-selected");if(typeof re=="string")var S=re;else if(!A||A.classList.contains("jcalendar-disabled"))var S=o.options.value;else var S=o.getValue();o.setValue(S)}else if(o.options.value){let Z=o.options.value;o.options.value="",o.setValue(Z)}!X&&typeof o.options.onclose=="function"&&o.options.onclose(C),O.classList.remove("jcalendar-focus"),g(o,!1),v.current=null}return o.options.value},o.prev=function(){o.options.mode=="years"?(o.date[0]=o.date[0]-12,o.getYears()):o.options.mode=="months"?(o.date[0]=parseInt(o.date[0])-1,o.getMonths()):(o.date[1]<2?(o.date[0]=o.date[0]-1,o.date[1]=12):o.date[1]=o.date[1]-1,o.getDays())},o.next=function(){o.options.mode=="years"?(o.date[0]=parseInt(o.date[0])+12,o.getYears()):o.options.mode=="months"?(o.date[0]=parseInt(o.date[0])+1,o.getMonths()):(o.date[1]>11?(o.date[0]=parseInt(o.date[0])+1,o.date[1]=1):o.date[1]=parseInt(o.date[1])+1,o.getDays())},o.setToday=function(){var X=new Date().toISOString().substr(0,10);return o.setValue(X),X},o.setValue=function(X){X||(X=""+X);var re=X,A=o.options.value;if(A!=re){if(re){var S=o.setLabel(re,o.options),ce=re.split(" ");ce[1]||(ce[1]="00:00:00");var Z=ce[1].split(":"),ce=ce[0].split("-"),de=parseInt(ce[0]),K=parseInt(ce[1]),ye=parseInt(ce[2]),Ne=parseInt(Z[0]),Ie=parseInt(Z[1]);o.date=[de,K,ye,Ne,Ie,0];var X=o.setLabel(re,o.options),Te=v.now(new Date(de,K-1,ye),!0);if(o.options.validRange){if(!o.options.validRange[0]||Te>=o.options.validRange[0])var _e=!0;else var _e=!1;if(!o.options.validRange[1]||Te<=o.options.validRange[1])var $e=!0;else var $e=!1;_e&&$e?(C.classList.remove("jcalendar_warning"),C.title=""):(C.classList.add("jcalendar_warning"),C.title=P.translate("Date outside the valid range"))}else C.classList.remove("jcalendar_warning"),C.title=""}else{o.date=null;var X="";C.classList.remove("jcalendar_warning"),C.title=""}o.options.value=re,typeof o.options.onchange=="function"&&o.options.onchange(C,re,A),C.value!=X&&(C.value=X,typeof C.oninput=="function"&&C.oninput({type:"input",target:C,value:C.value}))}o.getDays(),o.options.type=="year-month-picker"&&o.getMonths()},o.getValue=function(){return o.date?o.options.time?Y.two(o.date[0])+"-"+Y.two(o.date[1])+"-"+Y.two(o.date[2])+" "+Y.two(o.date[3])+":"+Y.two(o.date[4])+":"+Y.two(0):Y.two(o.date[0])+"-"+Y.two(o.date[1])+"-"+Y.two(o.date[2])+" "+Y.two(0)+":"+Y.two(0)+":"+Y.two(0):""},o.update=function(X,re){if(!X.classList.contains("jcalendar-disabled")){var A=O.querySelector(".jcalendar-selected");A&&A.classList.remove("jcalendar-selected"),X.classList.add("jcalendar-selected"),X.classList.contains("jcalendar-set-month")?(o.date[1]=re,o.date[2]=1):o.date[2]=X.innerText,o.options.time?(o.date[3]=he.value,o.date[4]=Ee.value):o.close(null,!0)}te()},o.reset=function(){o.setValue(""),o.date=null,o.close(!1,!1)},o.getDays=function(){o.options.mode="days";var ye=new Date,X=o.date&&Y.isNumeric(o.date[0])?o.date[0]:parseInt(ye.getFullYear()),re=o.date&&Y.isNumeric(o.date[1])?o.date[1]:parseInt(ye.getMonth())+1,A=o.date&&Y.isNumeric(o.date[2])?o.date[2]:parseInt(ye.getDate()),S=o.date&&Y.isNumeric(o.date[3])?o.date[3]:parseInt(ye.getHours()),Z=o.date&&Y.isNumeric(o.date[4])?o.date[4]:parseInt(ye.getMinutes());o.date=[X,re,A,S,Z,0],be.innerHTML=X,ue.innerHTML=o.options.months[re-1];var ce=ye.getMonth()==re-1&&ye.getFullYear()==X,de=ye.getDate(),ye=new Date(X,re,0,0,0),K=ye.getDate(),ye=new Date(X,re-1,0,0,0),Ne=ye.getDay()+1,$e=o.options.startingDay||0;Ne=Ne-$e,le.innerHTML="";var Ie=document.createElement("tr");Ie.setAttribute("align","center"),le.appendChild(Ie);for(var Te=0;Te<7;Te++){var _e=document.createElement("td");_e.classList.add("jcalendar-weekday"),_e.innerHTML=o.options.weekdays[$e].substr(0,1),Ie.appendChild(_e),$e++,$e>6&&($e=0)}for(var $e=0,nt=0,ee=0;ee<6;ee++){var Ie=document.createElement("tr");Ie.setAttribute("align","center"),Ie.style.height="34px";for(var Te=0;Te<7;Te++){var _e=document.createElement("td");if(_e.classList.add("jcalendar-set-day"),$e>=Ne&&$e<Ne+K){nt++,_e.innerHTML=nt,nt==A&&_e.classList.add("jcalendar-selected"),ce&&de==nt&&(_e.style.fontWeight="bold");var me=v.now(new Date(X,re-1,nt),!0);if(o.options.validRange){if(!o.options.validRange[0]||me>=o.options.validRange[0])var Ae=!0;else var Ae=!1;if(!o.options.validRange[1]||me<=o.options.validRange[1])var ke=!0;else var ke=!1;Ae&&ke||_e.classList.add("jcalendar-disabled")}}Ie.appendChild(_e),$e++}le.appendChild(Ie)}o.options.time?Ce.style.display="":Ce.style.display="none",te()},o.getMonths=function(){o.options.mode="months";var X=o.options.months,re=o.options.value,A=new Date,S=parseInt(A.getFullYear()),Z=parseInt(A.getMonth())+1,ce=o.date&&Y.isNumeric(o.date[0])?o.date[0]:S,de=o.date&&Y.isNumeric(o.date[1])?o.date[1]:Z;be.innerHTML=o.date[0],ue.innerHTML=X[de-1];var K=document.createElement("table");K.setAttribute("width","100%");for(var ye=null,Ne=0;Ne<12;Ne++){if(!(Ne%4)){var ye=document.createElement("tr");ye.setAttribute("align","center"),K.appendChild(ye)}var Ie=document.createElement("td");if(Ie.classList.add("jcalendar-set-month"),Ie.setAttribute("data-value",Ne+1),Ie.innerText=X[Ne],o.options.validRange){var Te=ce+"-"+Y.two(Ne+1);if(!o.options.validRange[0]||Te>=o.options.validRange[0].substr(0,7))var _e=!0;else var _e=!1;if(!o.options.validRange[1]||Te<=o.options.validRange[1].substr(0,7))var $e=!0;else var $e=!1;_e&&$e||Ie.classList.add("jcalendar-disabled")}Ne+1==de&&Ie.classList.add("jcalendar-selected"),S==ce&&Ne+1==Z&&(Ie.style.fontWeight="bold"),ye.appendChild(Ie)}le.innerHTML='<tr><td colspan="7"></td></tr>',le.children[0].children[0].appendChild(K),te()},o.getYears=function(){o.options.mode="years";for(var X=new Date,re=X.getFullYear(),A=o.date&&Y.isNumeric(o.date[0])?o.date[0]:parseInt(X.getFullYear()),S=[],Z=0;Z<25;Z++)S[Z]=parseInt(o.date[0])+(Z-12);var ce=document.createElement("table");ce.setAttribute("width","100%");for(var Z=0;Z<25;Z++){if(!(Z%5)){var de=document.createElement("tr");de.setAttribute("align","center"),ce.appendChild(de)}var K=document.createElement("td");K.classList.add("jcalendar-set-year"),K.innerText=S[Z],A==S[Z]&&K.classList.add("jcalendar-selected"),re==S[Z]&&(K.style.fontWeight="bold"),de.appendChild(K)}le.innerHTML='<tr><td colspan="7"></td></tr>',le.firstChild.firstChild.appendChild(ce),te()},o.setLabel=function(X,re){return v.getDateString(X,re)},o.fromFormatted=function(X,re){return v.extractDateFromString(X,re)};var k=function(X){var re=Y.findElement(X.target,"jcalendar-container");if(re){var A=X.target.className;if(A=="jcalendar-prev")o.prev();else if(A=="jcalendar-next")o.next();else if(A=="jcalendar-month")o.getMonths();else if(A=="jcalendar-year")o.getYears();else if(A=="jcalendar-set-year")o.date[0]=X.target.innerText,o.options.type=="year-month-picker"?o.getMonths():o.getDays();else if(X.target.classList.contains("jcalendar-set-month")){var S=parseInt(X.target.getAttribute("data-value"));o.options.type=="year-month-picker"?o.update(X.target,S):(o.date[1]=S,o.getDays())}else A=="jcalendar-confirm"||A=="jcalendar-update"||A=="jcalendar-close"?o.close(null,!0):A=="jcalendar-backdrop"?o.close(!1,!1):A=="jcalendar-reset"?o.reset():X.target.classList.contains("jcalendar-set-day")&&X.target.innerText&&o.update(X.target)}else o.close(!1,!1)},Q=function(X){if(X.target.value&&X.target.value.length>3){var re=v.extractDateFromString(X.target.value,o.options.format);re&&o.setValue(re)}},te=function(){var X=O.querySelector(".jcalendar-selected");X&&X.classList.contains("jcalendar-disabled")?(Ze.setAttribute("disabled","disabled"),he.setAttribute("disabled","disabled"),Ee.setAttribute("disabled","disabled")):(Ze.removeAttribute("disabled"),he.removeAttribute("disabled"),Ee.removeAttribute("disabled")),typeof o.options.onupdate=="function"&&o.options.onupdate(C,o.getValue())},O=null,I=null,_=null,W=null,oe=null,be=null,ue=null,pe=null,le=null,je=null,Ce=null,qe=null,Ze=null,he=null,Ee=null,G=function(){C.tagName=="INPUT"&&C.value&&(l.value=C.value),I=document.createElement("div"),I.className="jcalendar-reset",_=document.createElement("div"),_.className="jcalendar-confirm",je=document.createElement("div"),je.className="jcalendar-controls",je.style.borderBottom="1px solid #ddd",je.appendChild(I),je.appendChild(_),W=document.createElement("div"),W.className="jcalendar-container",oe=document.createElement("div"),oe.className="jcalendar-content",W.appendChild(oe),C.tagName=="DIV"?(O=C,O.classList.add("jcalendar-inline")):(oe.appendChild(je),O=document.createElement("div"),O.className="jcalendar"),O.classList.add("jcalendar-container"),O.appendChild(W);var X=document.createElement("div");X.className="jcalendar-table",oe.appendChild(X);var re=document.createElement("td");re.setAttribute("colspan","2"),re.className="jcalendar-prev",be=document.createElement("span"),be.className="jcalendar-year",ue=document.createElement("span"),ue.className="jcalendar-month";var A=document.createElement("td");A.className="jcalendar-header",A.setAttribute("colspan","3"),A.appendChild(ue),A.appendChild(be);var S=document.createElement("td");S.setAttribute("colspan","2"),S.className="jcalendar-next";var Z=document.createElement("thead"),ce=document.createElement("tr");ce.appendChild(re),ce.appendChild(A),ce.appendChild(S),Z.appendChild(ce),pe=document.createElement("table"),le=document.createElement("tbody"),pe.setAttribute("cellpadding","0"),pe.setAttribute("cellspacing","0"),pe.appendChild(Z),pe.appendChild(le),X.appendChild(pe),he=document.createElement("select"),he.className="jcalendar-select",he.onchange=function(){o.date[3]=this.value,typeof o.options.onupdate=="function"&&o.options.onupdate(C,o.getValue())};for(var de=0;de<24;de++){var K=document.createElement("option");K.value=de,K.innerHTML=Y.two(de),he.appendChild(K)}Ee=document.createElement("select"),Ee.className="jcalendar-select",Ee.onchange=function(){o.date[4]=this.value,typeof o.options.onupdate=="function"&&o.options.onupdate(C,o.getValue())};for(var de=0;de<60;de++){var K=document.createElement("option");K.value=de,K.innerHTML=Y.two(de),Ee.appendChild(K)}var ye=document.createElement("div");ye.className="jcalendar-controls",Ce=document.createElement("div"),Ce.className="jcalendar-time",Ce.style.maxWidth="140px",Ce.appendChild(he),Ce.appendChild(Ee),Ze=document.createElement("button"),Ze.setAttribute("type","button"),Ze.className="jcalendar-update",qe=document.createElement("div"),qe.style.flexGrow="10",qe.appendChild(Ze),ye.appendChild(Ce),C.tagName=="INPUT"&&ye.appendChild(qe),oe.appendChild(ye);var Ne=document.createElement("div");Ne.className="jcalendar-backdrop",O.appendChild(Ne),C.addEventListener("keyup",Q),O.addEventListener("swipeleft",function(Ie){N.slideLeft(pe,0,function(){o.next(),N.slideRight(pe,1)}),Ie.preventDefault(),Ie.stopPropagation()}),O.addEventListener("swiperight",function(Ie){N.slideRight(pe,0,function(){o.prev(),N.slideLeft(pe,1)}),Ie.preventDefault(),Ie.stopPropagation()}),"ontouchend"in document.documentElement?(O.addEventListener("touchend",k),C.addEventListener("touchend",o.open)):(O.addEventListener("mouseup",k),C.addEventListener("mouseup",o.open)),v.hasEvents||(v.hasEvents=!0,document.addEventListener("keydown",v.keydown)),o.setOptions(l),C.tagName=="INPUT"?(C.parentNode.insertBefore(O,C.nextSibling),C.setAttribute("autocomplete","off"),C.classList.add("jcalendar-input"),C.value=o.setLabel(o.getValue(),o.options)):(o.getDays(),o.options.time&&(he.value=o.date[3],Ee.value=o.date[4])),o.options.opened==!0&&o.open(),o.options.controls==!1&&W.classList.add("jcalendar-hide-controls"),C.change=o.setValue,C.val=function(Ie){if(Ie===void 0)return o.getValue();o.setValue(Ie)},C.calendar=O.calendar=o};return G(),o};return v.keydown=function(C){var l=null;(l=v.current)&&(C.which==13?l.close(!1,!0):C.which==27&&l.close(!1,!1))},v.prettify=function(C,l){if(!l)var l={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};C.indexOf("GMT")===-1&&C.indexOf("Z")===-1&&(C+=" GMT");var o=new Date,k=new Date(C),Q=parseInt((o-k)/1e3/60);if(String.prototype.format=function(O){return this.replace("{0}",O)},Q==0)var te=l.justNow;else if(Q<90)var te=l.xMinutesAgo.format(Q);else if(Q<1440)var te=l.xHoursAgo.format(Math.round(Q/60));else if(Q<20160)var te=l.xDaysAgo.format(Math.round(Q/1440));else if(Q<43200)var te=l.xWeeksAgo.format(Math.round(Q/10080));else if(Q<1036800)var te=l.xMonthsAgo.format(Math.round(Q/43200));else var te=l.xYearsAgo.format(Math.round(Q/525600));return te},v.prettifyAll=function(){for(var C=document.querySelectorAll(".prettydate"),l=0;l<C.length;l++)C[l].getAttribute("data-date")?C[l].innerHTML=v.prettify(C[l].getAttribute("data-date")):C[l].innerHTML&&(C[l].setAttribute("title",C[l].innerHTML),C[l].setAttribute("data-date",C[l].innerHTML),C[l].innerHTML=v.prettify(C[l].innerHTML))},v.now=a.now,v.toArray=a.toArray,v.dateToNum=a.dateToNum,v.numToDate=a.numToDate,v.weekdays=a.weekdays,v.months=a.months,v.weekdaysShort=a.weekdaysShort,v.monthsShort=a.monthsShort,v.extractDateFromString=H.extractDateFromString,v.getDateString=H.getDateString,v}var F=M();function J(){var v={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},C=function(l){return v[l]?v[l]:v.material};return C.get=function(l){return v[l]?v[l]:v},C.set=function(l,o){v[l]=o},C}var q=J();function ae(v,C){var l={};l.options={};var o={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var k in o)C&&C.hasOwnProperty(k)?l.options[k]=C[k]:l.options[k]=o[k];v.classList.add("jtabs");var Q=null,te=null,O=null,I=function(ue){if(l.options.animation){var pe=l.headers.children[ue].getBoundingClientRect();l.options.palette==="modern"?(O.style.width=pe.width-4+"px",O.style.left=l.headers.children[ue].offsetLeft+2+"px"):(O.style.width=pe.width+"px",O.style.left=l.headers.children[ue].offsetLeft+"px"),l.options.position==="bottom"?O.style.top="0px":O.style.bottom="0px"}},_=function(ue){typeof l.headers.scrollTo=="function"?l.headers.scrollTo({left:ue,behavior:"smooth"}):l.headers.scrollLeft=ue,ue<=1?Q.classList.add("disabled"):Q.classList.remove("disabled"),ue>=l.headers.scrollWidth-l.headers.offsetWidth?te.classList.add("disabled"):te.classList.remove("disabled"),l.headers.scrollWidth<=l.headers.offsetWidth?(Q.style.display="none",te.style.display="none"):(Q.style.display="",te.style.display="")};if(l.setBorder=I,l.open=function(ue){for(var pe=null,le=0;le<l.headers.children.length;le++)l.headers.children[le].classList.contains("jtabs-selected")&&(pe=le),l.headers.children[le].classList.remove("jtabs-selected"),l.content.children[le]&&l.content.children[le].classList.remove("jtabs-selected");if(l.headers.children[ue].classList.add("jtabs-selected"),l.content.children[ue]&&l.content.children[ue].classList.add("jtabs-selected"),pe!=ue&&typeof l.options.onchange=="function"&&l.content.children[ue]&&l.options.onchange(v,l,ue,l.headers.children[ue],l.content.children[ue]),l.options.hideHeaders==!0&&l.headers.children.length<3&&l.options.allowCreate==!1)l.headers.parentNode.style.display="none";else{I(ue),l.headers.parentNode.style.display="";var je=l.headers.children[ue].offsetLeft,Ce=je+l.headers.children[ue].offsetWidth,qe=l.headers.scrollLeft,Ze=qe+l.headers.offsetWidth;qe<=je&&Ze>=Ce||_(je-1)}},l.selectIndex=function(ue){var pe=Array.prototype.indexOf.call(l.headers.children,ue);return pe>=0&&l.open(pe),pe},l.rename=function(ue,pe){pe||(pe=prompt("New title",l.headers.children[ue].innerText)),l.headers.children[ue].innerText=pe,l.open(ue)},l.create=function(ue,pe){if(typeof l.options.onbeforecreate=="function"){var le=l.options.onbeforecreate(v);if(le===!1)return!1;ue=le}var je=l.appendElement(ue);return typeof l.options.oncreate=="function"&&l.options.oncreate(v,je),I(),je},l.remove=function(ue){return l.deleteElement(ue)},l.nextNumber=function(){for(var ue=0,pe=0;pe<l.headers.children.length;pe++){var le=l.headers.children[pe].innerText.match(/[0-9].*/);le>ue&&(ue=parseInt(le))}return ue?ue++:ue=1,ue},l.deleteElement=function(ue){if(l.headers.children[ue])l.headers.removeChild(l.headers.children[ue]),l.content.removeChild(l.content.children[ue]);else return!1;l.open(0),typeof l.options.ondelete=="function"&&l.options.ondelete(v,ue)},l.appendElement=function(ue,pe,le){if(!ue)var ue=prompt("Title?","");if(ue){var je=document.createElement("div");l.content.appendChild(je);var Ce=document.createElement("div");return Ce.innerHTML=ue,Ce.content=je,l.headers.insertBefore(Ce,l.headers.lastChild),l.options.allowChangePosition&&Ce.setAttribute("draggable","true"),le!==!1&&l.selectIndex(Ce),typeof pe=="function"&&pe(je,Ce),je}},l.getActive=function(){for(var ue=0;ue<l.headers.children.length;ue++)if(l.headers.children[ue].classList.contains("jtabs-selected"))return ue;return 0},l.updateContent=function(ue,pe){if(typeof pe!="string")var le=pe;else{var le=document.createElement("div");le.innerHTML=pe}l.content.children[ue].classList.contains("jtabs-selected")&&pe.classList.add("jtabs-selected"),l.content.replaceChild(pe,l.content.children[ue]),I()},l.updatePosition=function(ue,pe,le,je){if(ue>pe?l.content.insertBefore(l.content.children[ue],l.content.children[pe]):l.content.insertBefore(l.content.children[ue],l.content.children[pe].nextSibling),je!==!1)l.open(pe);else{const Ce=l.getActive();pe<Ce&&l.setBorder(Ce)}!le&&typeof l.options.onchangeposition=="function"&&l.options.onchangeposition(l.headers,ue,pe)},l.move=function(ue,pe,le,je){ue>pe?l.headers.insertBefore(l.headers.children[ue],l.headers.children[pe]):l.headers.insertBefore(l.headers.children[ue],l.headers.children[pe].nextSibling),l.updatePosition(ue,pe,le,je)},l.setBorder=I,l.init=function(){v.innerHTML="",l.headers=document.createElement("div"),l.content=document.createElement("div"),l.headers.classList.add("jtabs-headers"),l.content.classList.add("jtabs-content"),l.options.palette?v.classList.add("jtabs-modern"):v.classList.remove("jtabs-modern"),l.options.padding&&(l.content.style.padding=parseInt(l.options.padding)+"px");var ue=document.createElement("div");ue.className="jtabs-headers-container",ue.appendChild(l.headers),l.options.maxWidth&&(ue.style.maxWidth=parseInt(l.options.maxWidth)+"px");var pe=document.createElement("div");if(pe.className="jtabs-controls",pe.setAttribute("draggable","false"),ue.appendChild(pe),l.options.position=="bottom"?(v.appendChild(l.content),v.appendChild(ue)):(v.appendChild(ue),v.appendChild(l.content)),l.options.allowCreate==!0){var le=document.createElement("div");le.className="jtabs-add",le.onclick=function(){l.create()},pe.appendChild(le)}Q=document.createElement("div"),Q.className="jtabs-prev",Q.onclick=function(){_(l.headers.scrollLeft-l.headers.offsetWidth)},pe.appendChild(Q),te=document.createElement("div"),te.className="jtabs-next",te.onclick=function(){_(l.headers.scrollLeft+l.headers.offsetWidth)},pe.appendChild(te);for(var je=0;je<l.options.data.length;je++){if(l.options.data[je].titleElement)var Ce=l.options.data[je].titleElement;else var Ce=document.createElement("div");if(l.options.data[je].icon){var qe=document.createElement("div"),Ze=document.createElement("i");Ze.classList.add("material-icons"),Ze.innerHTML=l.options.data[je].icon,qe.appendChild(Ze),Ce.appendChild(qe)}if(l.options.data[je].title){var he=document.createTextNode(l.options.data[je].title);Ce.appendChild(he)}if(l.options.data[je].width&&(Ce.style.width=l.options.data[je].width),l.options.data[je].contentElement)var Ee=l.options.data[je].contentElement;else{var Ee=document.createElement("div");Ee.innerHTML=l.options.data[je].content}l.headers.appendChild(Ce),l.content.appendChild(Ee)}O=document.createElement("div"),O.className="jtabs-border",l.headers.appendChild(O),l.options.animation&&v.classList.add("jtabs-animation"),l.headers.addEventListener("click",function(G){if(G.target.parentNode.classList.contains("jtabs-headers"))var X=G.target;else if(G.target.tagName=="I")var X=G.target.parentNode.parentNode;else var X=G.target.parentNode;var re=l.selectIndex(X);typeof l.options.onclick=="function"&&l.options.onclick(v,l,re,l.headers.children[re],l.content.children[re])}),l.headers.addEventListener("contextmenu",function(G){l.selectIndex(G.target)}),l.headers.children.length&&l.open(0),_(0),l.options.allowChangePosition==!0&&m(l.headers,{direction:1,ondrop:function(G,X,re){l.updatePosition(X,re)}}),typeof l.options.onload=="function"&&l.options.onload(v,l)},v.children[0]&&v.children[0].children.length)for(var W=0;W<v.children[0].children.length;W++){var oe=l.options.data&&l.options.data[W]?l.options.data[W]:{};v.children[1]&&v.children[1].children[W]?(oe.titleElement=v.children[0].children[W],oe.contentElement=v.children[1].children[W]):oe.contentElement=v.children[0].children[W],l.options.data[W]=oe}var be=!1;if(l.options.data)for(var W=0;W<l.options.data.length;W++)l.options.data[W].url&&(w({url:l.options.data[W].url,type:"GET",dataType:"text/html",index:W,success:function(pe){l.options.data[this.index].content=pe},complete:function(){l.init()}}),be=!0);return be||l.init(),v.tabs=l,l}function ge(v,C){if(v.color)return v.color.setOptions(C,!0);var l={type:"color"};l.options={};var o=null,k=null,Q=null,te=null,O=null,I=null,_=null;l.setOptions=function(S,Z){var ce={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};S||(S={}),S&&!S.palette&&(S.palette=q());for(var de in ce)S&&S.hasOwnProperty(de)?l.options[de]=S[de]:(typeof l.options[de]=="undefined"||Z===!0)&&(l.options[de]=ce[de]);return te&&(te.innerHTML=l.options.resetLabel),O&&(O.innerHTML=l.options.doneLabel),l.options.palette&&_&&_.updateContent(0,le()),typeof l.options.value=="string"&&(v.value=l.options.value,v.tagName==="INPUT"&&(v.style.color=v.value,v.style.backgroundColor=v.value)),l.options.placeholder?v.setAttribute("placeholder",l.options.placeholder):v.getAttribute("placeholder")&&v.removeAttribute("placeholder"),l},l.select=function(S){var Z=o.querySelector(".jcolor-selected");Z&&Z.classList.remove("jcolor-selected"),l.values[S]&&l.values[S].classList.add("jcolor-selected"),l.options.value=S},l.open=function(){if(!o.classList.contains("jcolor-focus")){g(l,!0),o.classList.add("jcolor-focus"),l.options.value&&l.select(l.options.value),Q.style.marginTop="",Q.style.marginLeft="";var S=Q.getBoundingClientRect(),Z=Y.getWindowWidth(),ce=Y.getWindowHeight();if(Z<800||l.options.fullscreen==!0?(Q.classList.add("jcolor-fullscreen"),N.slideBottom(Q,1),k.style.display="block"):(Q.classList.contains("jcolor-fullscreen")&&(Q.classList.remove("jcolor-fullscreen"),k.style.display=""),l.options.position?Q.style.position="fixed":Q.style.position="",S.left+S.width>Z&&(Q.style.marginLeft=-1*(S.left+S.width-(Z-20))+"px"),S.top+S.height>ce&&(Q.style.marginTop=-1*(S.top+S.height-(ce-20))+"px")),typeof l.options.onopen=="function"&&l.options.onopen(v,l),_.setBorder(_.getActive()),l.options.value){var de=pe(l.options.value);G.forEach(function(K,ye){K.value=de[ye],K.dispatchEvent(new Event("input"))})}}},l.close=function(S){return o.classList.contains("jcolor-focus")&&(o.classList.remove("jcolor-focus"),k.style.display="",!S&&typeof l.options.onclose=="function"&&l.options.onclose(v,l),g(l,!1)),l.options.value},l.setValue=function(S){S||(S=""),S!=l.options.value&&(l.options.value=S,Ee=S,l.select(S),typeof l.options.onchange=="function"&&l.options.onchange(v,S,l),v.value!=l.options.value&&(v.value=l.options.value,v.tagName==="INPUT"&&(v.style.color=v.value,v.style.backgroundColor=v.value),typeof v.oninput=="function"&&v.oninput({type:"input",target:v,value:v.value})),l.options.closeOnChange==!0&&l.close())},l.getValue=function(){return l.options.value};var W=!1,oe=function(S){var Z=S.toString(16);return Z.length===1?"0"+Z:Z},be=function(S,Z,ce){return"#"+oe(S)+oe(Z)+oe(ce)},ue=function(S){return parseInt("0x"+S)},pe=function(S){return[ue(S.substr(1,2)),ue(S.substr(3,2)),ue(S.substr(5,2))]},le=function(){var S=document.createElement("div");S.className="jcolor-grid",l.values=[];var Z=document.createElement("table");Z.setAttribute("cellpadding","7"),Z.setAttribute("cellspacing","0");for(var ce=0;ce<l.options.palette.length;ce++){for(var de=document.createElement("tr"),K=0;K<l.options.palette[ce].length;K++){var ye=document.createElement("td"),Ne=l.options.palette[ce][K];Ne.length<7&&Ne.substr(0,1)!=="#"&&(Ne="#"+Ne),ye.style.backgroundColor=Ne,ye.setAttribute("data-value",Ne),ye.innerHTML="",de.appendChild(ye),l.options.value==Ne&&ye.classList.add("jcolor-selected"),l.values[Ne]=ye}Z.appendChild(de)}return S.appendChild(Z),S},je=document.createElement("canvas");je.width=200,je.height=160;var Ce=je.getContext("2d"),qe=function(){var S=I.firstChild.getBoundingClientRect();je.width=S.width-14,Ze()},Ze=function(){var S=Ce.createLinearGradient(0,0,je.width,0);S.addColorStop(0,"rgb(255,0,0)"),S.addColorStop(.15,"rgb(255,0,255)"),S.addColorStop(.33,"rgb(0,0,255)"),S.addColorStop(.49,"rgb(0,255,255)"),S.addColorStop(.67,"rgb(0,255,0)"),S.addColorStop(.84,"rgb(255,255,0)"),S.addColorStop(1,"rgb(255,0,0)"),Ce.fillStyle=S,Ce.fillRect(0,0,je.width,je.height),S=Ce.createLinearGradient(0,0,0,je.height),S.addColorStop(0,"rgba(255,255,255,1)"),S.addColorStop(.5,"rgba(255,255,255,0)"),S.addColorStop(.5,"rgba(0,0,0,0)"),S.addColorStop(1,"rgba(0,0,0,1)"),Ce.fillStyle=S,Ce.fillRect(0,0,je.width,je.height)},he=function(){var S=document.createElement("div");S.className="jcolor-hsl";var Z=document.createElement("div");Z.className="jcolor-point";var ce=document.createElement("div");ce.appendChild(je),ce.appendChild(Z),S.appendChild(ce);var de=function(K,ye,Ne){if(K===1){var Ie=S.getBoundingClientRect(),Te=ye-Ie.left,_e=Ne-Ie.top;Te<0&&(Te=0),_e<0&&(_e=0),Te>Ie.width&&(Te=Ie.width),_e>Ie.height&&(_e=Ie.height),Z.style.left=Te+"px",Z.style.top=_e+"px";var $e=Ce.getImageData(Te,_e,1,1).data;Ee=be($e[0],$e[1],$e[2])}};return S.addEventListener("mousedown",function(K){de(K.buttons,K.clientX,K.clientY)}),S.addEventListener("mousemove",function(K){de(K.buttons,K.clientX,K.clientY)}),S.addEventListener("touchmove",function(K){de(1,K.changedTouches[0].clientX,K.changedTouches[0].clientY)}),S},Ee="",G=[],X=function(){if(Ee!=="")for(var S=0;S<G.length;S++){var Z=pe(Ee);Z[S]=0;var ce="linear-gradient(90deg, rgb(";ce+=Z.join(", "),ce+="), rgb(",Z[S]=255,ce+=Z.join(", "),ce+="))",G[S].style.backgroundImage=ce}},re=function(){var S=document.createElement("div");S.className="jcolor-sliders";var Z=document.createElement("div"),ce=function(Ne){var Ie=document.createElement("div");Ie.className="jcolor-sliders-input-container";var Te=document.createElement("label");Te.innerText=Ne;var _e=document.createElement("div");_e.className="jcolor-sliders-input-subcontainer";var $e=document.createElement("input");$e.type="range",$e.min=0,$e.max=255,$e.value=0,Ie.appendChild(Te),_e.appendChild($e);var nt=document.createElement("div");return nt.innerText=$e.value,$e.addEventListener("input",function(){nt.innerText=$e.value}),_e.appendChild(nt),Ie.appendChild(_e),Z.appendChild(Ie),$e};G=[ce("Red"),ce("Green"),ce("Blue")],S.appendChild(Z);var de=document.createElement("div");de.className="jcolor-sliders-final-color";var K=document.createElement("div");K.style.visibility="hidden",K.innerText="a",de.appendChild(K);var ye=function(){var Ne=be(parseInt(G[0].value),parseInt(G[1].value),parseInt(G[2].value));K.innerText=Ne,K.style.color=Ne,K.style.removeProperty("visibility"),Ee=Ne};return G.forEach(function(Ne){Ne.addEventListener("input",function(){ye(),X()})}),S.appendChild(de),S},A=function(){l.setOptions(C),v.tagName=="INPUT"&&(v.classList.add("jcolor-input"),v.readOnly=!0),o=document.createElement("div"),o.className="jcolor",k=document.createElement("div"),k.className="jcolor-backdrop",o.appendChild(k),Q=document.createElement("div"),Q.className="jcolor-content";var S=document.createElement("div");S.className="jcolor-controls",Q.appendChild(S),te=document.createElement("div"),te.className="jcolor-reset",te.innerHTML=l.options.resetLabel,S.appendChild(te),O=document.createElement("div"),O.className="jcolor-close",O.innerHTML=l.options.doneLabel,S.appendChild(O),I=document.createElement("div"),Q.appendChild(I),_=ae(I,{animation:!0,data:[{title:"Grid",contentElement:le()},{title:"Spectrum",contentElement:he()},{title:"Sliders",contentElement:re()}],onchange:function(Z,ce,de){if(de===1)qe();else{var K=Ee!==""?Ee:l.getValue();if(de===2&&K){var ye=pe(K);G.forEach(function(Ne,Ie){Ne.value=ye[Ie],Ne.dispatchEvent(new Event("input"))})}}},palette:"modern"}),o.appendChild(Q),v.tagName=="INPUT"?v.parentNode.insertBefore(o,v.nextSibling):v.appendChild(o),o.addEventListener("click",function(Z){if(Z.target.tagName=="TD"){var ce=Z.target.getAttribute("data-value");ce&&l.setValue(ce)}else Z.target.classList.contains("jcolor-reset")?(l.setValue(""),l.close()):Z.target.classList.contains("jcolor-close")?(_.getActive()>0&&l.setValue(Ee),l.close()):Z.target.classList.contains("jcolor-backdrop")?l.close():l.open()}),v.addEventListener("mouseup",function(Z){l.open()}),window.addEventListener("resize",function(){o.classList.contains("jcolor-focus")&&_.getActive()==1&&qe()}),l.options.opened==!0&&l.open(),v.change=l.setValue,v.val=function(Z){if(Z===void 0)return l.getValue();l.setValue(Z)},v.color=l,o.color=l};return l.toHex=function(S){var Z=function(ce){return("0"+parseInt(ce).toString(16)).slice(-2)};if(S)return/^#[0-9A-F]{6}$/i.test(S)?S:(S=S.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),S&&S.length?"#"+Z(S[1])+Z(S[2])+Z(S[3]):"")},A(),l}function se(){var v=function(C,l){var o={type:"contextmenu"};o.options={};var k={items:null,onclick:null};for(var Q in k)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=k[Q];C.classList.add("jcontextmenu"),o.open=function(I,_){if(_&&(o.options.items=_,o.create(_)),v.current&&v.current.close(),g(o,!0),C.classList.add("jcontextmenu-focus"),v.current=o,o.options.items&&o.options.items.length>0||C.children.length){if(I.target)if(I.changedTouches&&I.changedTouches[0])W=I.changedTouches[0].clientX,oe=I.changedTouches[0].clientY;else var W=I.clientX,oe=I.clientY;else var W=I.x,oe=I.y;var be=C.getBoundingClientRect();if(window.innerHeight<oe+be.height){var ue=oe-be.height;ue<0&&(ue=0),C.style.top=ue+"px"}else C.style.top=oe+"px";window.innerWidth<W+be.width?W-be.width>0?C.style.left=W-be.width+"px":C.style.left="10px":C.style.left=W+"px"}},o.isOpened=function(){return!!C.classList.contains("jcontextmenu-focus")},o.close=function(){C.classList.contains("jcontextmenu-focus")&&C.classList.remove("jcontextmenu-focus"),g(o,!1)},o.create=function(I){C.innerHTML="";var _=te();C.appendChild(_);for(var W=0;W<I.length;W++){var oe=O(I[W]);C.appendChild(oe)}};function te(){var I=document.createElement("div");I.classList.add("header"),I.addEventListener("click",function(oe){oe.preventDefault(),oe.stopPropagation()});var _=document.createElement("a");_.classList.add("title"),_.innerHTML=P.translate("Menu"),I.appendChild(_);var W=document.createElement("a");return W.classList.add("close"),W.innerHTML=P.translate("close"),W.addEventListener("click",function(oe){o.close()}),I.appendChild(W),I}function O(I){if(I.type&&(I.type=="line"||I.type=="divisor"))var _=document.createElement("hr");else{var _=document.createElement("div"),W=document.createElement("a");if(W.innerHTML=I.title,I.tooltip&&_.setAttribute("title",I.tooltip),I.icon&&_.setAttribute("data-icon",I.icon),I.id&&(_.id=I.id),I.disabled?_.className="jcontextmenu-disabled":I.onclick&&(_.method=I.onclick,_.addEventListener("mousedown",function(qe){qe.preventDefault()}),_.addEventListener("mouseup",function(qe){this.method(this,qe)})),_.appendChild(W),I.submenu){var oe=document.createElement("span");oe.innerHTML="&#9658;",_.appendChild(oe),_.classList.add("jcontexthassubmenu");var be=document.createElement("div");be.classList.add("jcontextmenu"),be.setAttribute("tabindex","900");for(var ue=I.submenu,pe=0;pe<ue.length;pe++){var le=O(ue[pe]);be.appendChild(le)}_.appendChild(be)}else if(I.shortcut){var je=document.createElement("span");je.innerHTML=I.shortcut,_.appendChild(je)}}return _}return typeof o.options.onclick=="function"&&C.addEventListener("click",function(I){o.options.onclick(o,I)}),o.options.items&&o.create(o.options.items),window.addEventListener("mousewheel",function(){o.close()}),C.contextmenu=o,o};return v}var xe=se();function Le(){var v=function(C,l){if(C.dropdown)return C.dropdown.setOptions(l,!0);var o={type:"dropdown"};o.options={};var k=function(G,X){G&&G.length&&(o.options.sortResults!==!1&&(typeof o.options.sortResults=="function"?G.sort(o.options.sortResults):G.sort(Q)),o.setData(G)),typeof o.options.onload=="function"&&o.options.onload(C,o,G,X),X&&O(X),X==null&&(o.options.value=""),C.value=o.options.value,o.options.opened==!0&&o.open()},Q=function(G,X){var re,A;return typeof G=="string"?re=G:G.text?re=G.text:G.name&&(re=G.name),typeof X=="string"?A=X:X.text?A=X.text:X.name&&(A=X.name),typeof re=="string"||typeof A=="string"?(typeof re!="string"&&(re=""+re),typeof A!="string"&&(A=""+A),re.localeCompare(A)):re-A},te=function(){o.value={};for(var G=0;G<o.items.length;G++)o.items[G].selected==!0&&(o.items[G].element&&o.items[G].element.classList.remove("jdropdown-selected"),o.items[G].selected=null);o.options.value="",C.value=""},O=function(G){if(te(),G!==null)if(!G)typeof o.value[""]!="undefined"&&(o.value[""]="");else{Array.isArray(G)||(G=(""+G).split(";"));for(var X=0;X<G.length;X++)o.value[G[X]]=""}for(var X=0;X<o.items.length;X++)typeof o.value[I(X)]!="undefined"&&(o.items[X].element&&o.items[X].element.classList.add("jdropdown-selected"),o.items[X].selected=!0,o.value[I(X)]=_(X));o.options.value=Object.keys(o.value).join(";"),o.header.value=o.getText()},I=function(G,X){if(o.options.format)var re="id";else var re="value";return o.items[G]?X!==void 0?o.items[G].data[re]=X:o.items[G].data[re]:""},_=function(G,X){if(o.options.format)var re="name";else var re="text";return o.items[G]?X!==void 0?o.items[G].data[re]=X:o.items[G].data[re]:""},W=function(){return Object.keys(o.value)},oe=function(){for(var G=[],X=Object.keys(o.value),re=0;re<X.length;re++)G.push(o.value[X[re]]);return G};o.setOptions=function(G,X){G||(G={});var re={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1};for(var A in re)G&&G.hasOwnProperty(A)?o.options[A]=G[A]:(typeof o.options[A]=="undefined"||X===!0)&&(o.options[A]=re[A]);return(o.options.remoteSearch==!0||o.options.type==="searchbar")&&(o.options.autocomplete=!0),o.options.newOptions==!0?o.header.classList.add("jdropdown-add"):o.header.classList.remove("jdropdown-add"),o.options.autocomplete==!0?o.header.removeAttribute("readonly"):o.header.setAttribute("readonly","readonly"),o.options.placeholder?o.header.setAttribute("placeholder",o.options.placeholder):o.header.removeAttribute("placeholder"),C.classList.remove("jdropdown-searchbar"),C.classList.remove("jdropdown-picker"),C.classList.remove("jdropdown-list"),o.options.type=="searchbar"?C.classList.add("jdropdown-searchbar"):o.options.type=="list"?C.classList.add("jdropdown-list"):o.options.type=="picker"?C.classList.add("jdropdown-picker"):Y.getWindowWidth()<800?o.options.autocomplete?(C.classList.add("jdropdown-searchbar"),o.options.type="searchbar"):(C.classList.add("jdropdown-picker"),o.options.type="picker"):(o.options.width?(C.style.width=o.options.width,C.style.minWidth=o.options.width):(C.style.removeProperty("width"),C.style.removeProperty("min-width")),C.classList.add("jdropdown-default"),o.options.type="default"),o.options.type=="searchbar"?be.appendChild(le):ue.insertBefore(le,ue.firstChild),o.options.url&&!G.data?w({url:o.options.url,method:"GET",dataType:"json",success:function(S){S&&k(S,o.options.value)}}):k(o.options.data,o.options.value),o};var be=null,ue=null,pe=null,le=null,je=null,Ce=null,qe=null,Ze=function(){if(l||(l={}),C.tagName=="SELECT"){var G=v.extractFromDom(C,l);C=G.el,l=G.options}!l.placeholder&&C.getAttribute("placeholder")&&(l.placeholder=C.getAttribute("placeholder")),o.value={},o.items=[],o.groups=[],o.search="",o.results=null,C.classList.add("jdropdown"),be=document.createElement("div"),be.className="jdropdown-container-header",o.header=document.createElement("input"),o.header.className="jdropdown-header jss_object",o.header.type="text",o.header.setAttribute("autocomplete","off"),o.header.onfocus=function(){typeof o.options.onfocus=="function"&&o.options.onfocus(C)},o.header.onblur=function(){typeof o.options.onblur=="function"&&o.options.onblur(C)},o.header.onkeyup=function(X){o.options.autocomplete==!0&&!qe?(o.search!=o.header.value.trim()&&(qe=setTimeout(function(){o.find(o.header.value.trim()),qe=null},400)),C.classList.contains("jdropdown-focus")||o.open()):o.options.autocomplete||o.next(X.key)},v.hasEvents||(v.hasEvents=!0,document.addEventListener("keydown",v.keydown)),ue=document.createElement("div"),ue.className="jdropdown-container",pe=document.createElement("div"),pe.className="jdropdown-content",le=document.createElement("div"),le.className="jdropdown-close",le.textContent="Done",je=document.createElement("div"),je.className="jdropdown-reset",je.textContent="x",je.onclick=function(){o.reset(),o.close()},Ce=document.createElement("div"),Ce.className="jdropdown-backdrop",be.appendChild(o.header),ue.appendChild(pe),C.appendChild(be),C.appendChild(ue),C.appendChild(Ce),o.setOptions(l),"ontouchsend"in document.documentElement?C.addEventListener("touchsend",v.mouseup):C.addEventListener("mouseup",v.mouseup),o.options.lazyLoading==!0&&b(pe,{loadUp:o.loadUp,loadDown:o.loadDown}),pe.onwheel=function(X){X.stopPropagation()},C.change=o.setValue,C.val=function(X){if(X===void 0)return o.getValue(!!o.options.multiple);o.setValue(X)},C.dropdown=o};o.getUrl=function(){return o.options.url},o.setUrl=function(G,X){o.options.url=G,w({url:o.options.url,method:"GET",dataType:"json",success:function(re){o.setData(re),typeof X=="function"&&X(o)}})},o.setId=function(G,X){if(o.options.format)var re="id";else var re="value";typeof G=="object"?G[re]=X:o.items[G].data[re]=X},o.add=function(G,X){if(!G){var re=o.options.autocomplete==!0?o.header.value:"",G=prompt(P.translate("Add A New Option"),re);if(!G)return!1}if(X||(X=Y.guid()),o.options.format)var A={id:X,name:G};else var A={value:X,text:G};if(typeof o.options.onbeforeinsert=="function"){var S=o.options.onbeforeinsert(o,A);if(S===!1)return!1;S&&(A=S)}o.options.data.push(A);var Z=o.createItem(A);return pe.appendChild(Z.element),typeof o.options.oninsert=="function"&&o.options.oninsert(o,A,Z),pe.style.display=="none"&&(pe.style.display=""),o.results&&o.results.push(Z),A},o.createItem=function(G,X,re){o.options.format?(!G.id&&G.value!==void 0&&(G.id=G.value),!G.name&&G.text!==void 0&&(G.name=G.text)):(!G.value&&G.id!==void 0&&(G.value=G.id),!G.text&&G.name!==void 0&&(G.text=G.name));var A={};if(A.element=document.createElement("div"),A.element.className="jdropdown-item",A.element.indexValue=o.items.length,A.data=G,X&&(A.group=X),G.id&&A.element.setAttribute("id",G.id),G.disabled==!0&&A.element.setAttribute("data-disabled",!0),G.tooltip&&A.element.setAttribute("title",G.tooltip),G.image){var S=document.createElement("img");S.className="jdropdown-image",S.src=G.image,G.title||S.classList.add("jdropdown-image-small"),A.element.appendChild(S)}else if(G.icon){var Z=document.createElement("span");Z.className="jdropdown-icon material-icons",Z.innerText=G.icon,G.title||Z.classList.add("jdropdown-icon-small"),G.color&&(Z.style.color=G.color),A.element.appendChild(Z)}else if(G.color){var ce=document.createElement("div");ce.className="jdropdown-color",ce.style.backgroundColor=G.color,A.element.appendChild(ce)}if(o.options.format)var de=G.name;else var de=G.text;var K=document.createElement("div");if(K.className="jdropdown-description",K.textContent=de||"&nbsp;",G.title){var ye=document.createElement("div");ye.className="jdropdown-title",ye.innerText=G.title,K.appendChild(ye)}if(o.options.format)var Ne=G.id;else var Ne=G.value;return o.value[Ne]&&(A.element.classList.add("jdropdown-selected"),A.selected=!0),o.items.push(A),A.element.appendChild(K),A},o.appendData=function(G){if(G.length){for(var X=[],re=[],A=0;A<G.length;A++)G[A].group?(re[G[A].group]||(re[G[A].group]=[]),re[G[A].group].push(A)):X.push(A);var S=0,Z=Object.keys(re);if(Z.length>0)for(var A=0;A<Z.length;A++){var ce=document.createElement("div");ce.className="jdropdown-group";var de=document.createElement("div");de.className="jdropdown-group-name",de.textContent=Z[A];var K=document.createElement("i");K.className="jdropdown-group-arrow jdropdown-group-arrow-down",de.appendChild(K);var ye=document.createElement("div");ye.className="jdropdown-group-items";for(var Ne=0;Ne<re[Z[A]].length;Ne++){var Ie=o.createItem(G[re[Z[A]][Ne]],ce,Z[A]);(o.options.lazyLoading==!1||S<200)&&(ye.appendChild(Ie.element),S++)}ce.appendChild(de),ce.appendChild(ye),o.groups.push(ce),ye.children.length>0&&pe.appendChild(ce)}if(X.length)for(var A=0;A<X.length;A++){var Ie=o.createItem(G[X[A]]);(o.options.lazyLoading==!1||S<200)&&(pe.appendChild(Ie.element),S++)}}},o.setData=function(G){if(te(),pe.textContent="",o.header.value="",o.items=[],G&&G.length){for(var X=0;X<G.length;X++)typeof G[X]!="object"&&(o.options.format?G[X]={id:G[X],name:G[X]}:G[X]={value:G[X],text:G[X]});o.appendData(G),o.options.data=G}else o.options.data=[];o.close()},o.getData=function(){return o.options.data},o.getPosition=function(G){for(var X=0;X<o.items.length;X++)if(I(X)==G)return X;return!1},o.getText=function(G){var X=oe();return G?X:X.join("; ")},o.getValue=function(G){var X=W();return G?X:X.join(";")};var he=function(G){C.value!=o.options.value&&(C.value=o.options.value,typeof C.oninput=="function"&&C.oninput({type:"input",target:C,value:C.value})),typeof o.options.onchange=="function"&&o.options.onchange(C,o,G,o.options.value)};o.setValue=function(G){var X=o.getValue();Array.isArray(G)&&(G=G.join(";")),X!==G&&(O(G),he(X))},o.resetSelected=function(){o.setValue(null)},o.selectIndex=function(re,X){var re=parseInt(re);if(o.items&&o.items[re]&&(X===!0||o.items[re].data.disabled!==!0))if(o.setCursor(re,!1),!o.options.multiple)o.items[re].selected?o.setValue(null):o.setValue(I(re)),o.close();else{var A=o.options.value;o.items[re].selected?(o.items[re].element.classList.remove("jdropdown-selected"),o.items[re].selected=!1,delete o.value[I(re)]):(o.items[re].element.classList.add("jdropdown-selected"),o.items[re].selected=!0,o.value[I(re)]=_(re)),o.options.value=Object.keys(o.value).join(";"),o.options.autocomplete==!1&&(o.header.value=oe().join("; ")),he(A)}},o.selectItem=function(G){o.selectIndex(G.indexValue)};var Ee=function(G,X){for(var re=0;re<X.length;re++)if(o.options.format){if(X[re].id==G)return!0}else if(X[re].value==G)return!0;return!1};return o.find=function(G){if(o.search==G.trim())return!1;if(o.search=G,o.setCursor(),o.groups.length)for(var X=0;X<o.groups.length;X++)o.groups[X].lastChild.textContent="";if(pe.textContent="",o.options.remoteSearch==!0){o.results=null;var re=o.options.url;let ye={url:re,method:"GET",data:{q:G},dataType:"json",success:function(Ne){o.items=[];var Ie=Object.keys(o.value);if(Ie.length)for(var Te=0;Te<Ie.length;Te++)Ee(Ie[Te],Ne)||(o.options.format?Ne.unshift({id:Ie[Te],name:o.value[Ie[Te]]}):Ne.unshift({value:Ie[Te],text:o.value[Ie[Te]]}));o.appendData(Ne),Ne.length?pe.style.display="":pe.style.display="none",typeof o.options.onsearch=="function"&&o.options.onsearch(o,Ne)}};if(typeof o.options.onbeforesearch=="function"){let Ne=o.options.onbeforesearch(o,ye);if(Ne===!1)return;typeof Ne=="object"&&(ye=Ne)}w(ye)}else{G=new RegExp(G,"gi");for(var A=[],X=0;X<o.items.length;X++){var S=_(X),Z=o.items[X].data.title||"",ce=o.items[X].data.group||"",de=o.items[X].data.synonym||"";de&&(de=de.join(" ")),(G==null||o.items[X].selected==!0||S.match(G)||Z.match(G)||ce.match(G)||de.match(G))&&A.push(o.items[X])}if(!A.length)pe.style.display="none",o.results=null;else{pe.style.display="",o.results=A;var K=A.length||0;o.options.lazyLoading==!0&&K>200&&(K=200);for(var X=0;X<K;X++)o.results[X].group?(o.results[X].group.parentNode||pe.appendChild(o.results[X].group),o.results[X].group.lastChild.appendChild(o.results[X].element)):pe.appendChild(o.results[X].element)}}o.options.autofocus==!0&&o.first()},o.open=function(){if(!C.classList.contains("jdropdown-focus")){v.current=o,g(o,!0),C.classList.add("jdropdown-focus"),Y.getWindowWidth()<800&&(o.options.type==null||o.options.type=="picker")&&N.slideBottom(ue,1),o.options.autocomplete==!0&&(o.header.value=o.search,o.header.focus());var G=W();if(G[0]){var X=o.getPosition(G[0]);X!==!1&&o.setCursor(X)}if(!o.options.type||o.options.type=="default"){var re=C.getBoundingClientRect(),A=ue.getBoundingClientRect();o.options.position?(ue.style.position="fixed",window.innerHeight<re.bottom+A.height?(ue.style.top="",ue.style.bottom=window.innerHeight-re.top+1+"px"):(ue.style.top=re.bottom+"px",ue.style.bottom=""),ue.style.left=re.left+"px"):window.innerHeight<re.bottom+A.height?(ue.style.top="",ue.style.bottom=re.height+1+"px"):(ue.style.top="",ue.style.bottom=""),ue.style.minWidth=re.width+"px",o.options.maxWidth&&(ue.style.maxWidth=o.options.maxWidth),!o.items.length&&o.options.autocomplete==!0?pe.style.display="none":pe.style.display=""}}typeof o.options.onopen=="function"&&o.options.onopen(C)},o.close=function(G){return C.classList.contains("jdropdown-focus")&&(o.header.value=o.getText(),o.setCursor(),!G&&typeof o.options.onclose=="function"&&o.options.onclose(C),o.header.blur&&o.header.blur(),C.classList.remove("jdropdown-focus"),g(o,!1),v.current=null),o.getValue()},o.setCursor=function(G,X){if(o.currentIndex!=null&&o.items&&o.items[o.currentIndex]&&o.items[o.currentIndex].element.classList.remove("jdropdown-cursor"),G==null)o.currentIndex=null;else if(G=parseInt(G),o.items[G].element.parentNode&&(o.items[G].element.classList.add("jdropdown-cursor"),o.currentIndex=G,X!==!1&&o.items[o.currentIndex].element)){var re=pe.scrollTop,A=o.items[o.currentIndex].element;pe.scrollTop=A.offsetTop-A.scrollTop+A.clientTop-95}},o.resetCursor=o.setCursor,o.updateCursor=o.setCursor,o.reset=function(){o.setCursor(),o.setValue(null)},o.first=function(){o.options.lazyLoading===!0&&o.loadFirst();var G=pe.querySelectorAll(".jdropdown-item");if(G.length){var X=G[0].indexValue;o.setCursor(X)}},o.last=function(){o.options.lazyLoading===!0&&o.loadLast();var G=pe.querySelectorAll(".jdropdown-item");if(G.length){var X=G[G.length-1].indexValue;o.setCursor(X)}},o.next=function(G){var X=null;if(G){if(G.length==1){var re=o.currentIndex||-1;G=G.toLowerCase();var A=null,S=null,Z=pe.querySelectorAll(".jdropdown-item");if(Z.length){for(var ce=0;ce<Z.length;ce++)if(Z[ce].indexValue>re&&(A=o.items[Z[ce].indexValue])&&(S=A.element.innerText[0])&&(S=S.toLowerCase(),G==S)){X=Z[ce].indexValue;break}o.setCursor(X)}}}else if(o.currentIndex==null||o.currentIndex==null)o.first();else{var de=o.items[o.currentIndex].element,K=de.nextElementSibling;K?(K.classList.contains("jdropdown-group")&&(K=K.lastChild.firstChild),X=K.indexValue):de.parentNode.classList.contains("jdropdown-group-items")&&((K=de.parentNode.parentNode.nextElementSibling)&&(K.classList.contains("jdropdown-group")?K=K.lastChild.firstChild:K.classList.contains("jdropdown-item")?X=K.indexValue:K=null),K&&(X=K.indexValue)),X!==null&&o.setCursor(X)}},o.prev=function(){var G=null;if(o.currentIndex===null)o.first();else{var X=o.items[o.currentIndex].element,re=X.previousElementSibling;re?(re.classList.contains("jdropdown-group")&&(re=re.lastChild.lastChild),G=re.indexValue):X.parentNode.classList.contains("jdropdown-group-items")&&((re=X.parentNode.parentNode.previousElementSibling)&&(re.classList.contains("jdropdown-group")?re=re.lastChild.lastChild:re.classList.contains("jdropdown-item")?G=re.indexValue:re=null),re&&(G=re.indexValue))}G!==null&&o.setCursor(G)},o.loadFirst=function(){if(o.results)var G=o.results;else var G=o.items;var X=G.length||0;o.options.lazyLoading==!0&&X>200&&(X=200),pe.textContent="";for(var re=0;re<X;re++)G[re].group?(G[re].group.parentNode||pe.appendChild(G[re].group),G[re].group.lastChild.appendChild(G[re].element)):pe.appendChild(G[re].element);pe.scrollTop=0},o.loadLast=function(){if(o.results)var G=o.results;else var G=o.items;var X=G.length;if(X>200){X=X-200,pe.textContent="";for(var re=X;re<G.length;re++)G[re].group?(G[re].group.parentNode||pe.appendChild(G[re].group),G[re].group.lastChild.appendChild(G[re].element)):pe.appendChild(G[re].element);pe.scrollTop=pe.scrollHeight}},o.loadUp=function(){var G=!1;if(o.results)var X=o.results;else var X=o.items;var re=pe.querySelectorAll(".jdropdown-item"),A=re[0].indexValue;A=o.items[A];var S=X.indexOf(A)-1;if(S>0){for(var Z=0;S>0&&X[S]&&Z<200;)X[S].group?(X[S].group.parentNode||pe.insertBefore(X[S].group,pe.firstChild),X[S].group.lastChild.insertBefore(X[S].element,X[S].group.lastChild.firstChild)):pe.insertBefore(X[S].element,pe.firstChild),S--,Z++;G=!0}return G},o.loadDown=function(){var G=!1;if(o.results)var X=o.results;else var X=o.items;var re=pe.querySelectorAll(".jdropdown-item"),A=re[re.length-1].indexValue;A=o.items[A];var S=X.indexOf(A)+1;if(S<X.length){for(var Z=0;S<X.length&&X[S]&&Z<200;)X[S].group?(X[S].group.parentNode||pe.appendChild(X[S].group),X[S].group.lastChild.appendChild(X[S].element)):pe.appendChild(X[S].element),S++,Z++;G=!0}return G},Ze(),o};return v.keydown=function(C){var l=null;if(l=v.current){if(C.which==13||C.which==9)l.header.value&&l.currentIndex==null&&l.options.newOptions?l.add():(l.currentIndex==null&&l.options.autocomplete==!0&&l.header.value!=""&&l.find(l.header.value),l.selectIndex(l.currentIndex));else if(C.which==38)l.currentIndex==null?l.first():l.currentIndex>0&&l.prev(),C.preventDefault();else if(C.which==40)l.currentIndex==null?l.first():l.currentIndex+1<l.items.length&&l.next(),C.preventDefault();else if(C.which==36)l.first(),C.target.classList.contains("jdropdown-header")||C.preventDefault();else if(C.which==35)l.last(),C.target.classList.contains("jdropdown-header")||C.preventDefault();else if(C.which==27)l.close();else if(C.which==33){if(l.currentIndex==null)l.first();else if(l.currentIndex>0)for(var o=0;o<7;o++)l.prev();C.preventDefault()}else if(C.which==34){if(l.currentIndex==null)l.first();else if(l.currentIndex+1<l.items.length)for(var o=0;o<7;o++)l.next();C.preventDefault()}}},v.mouseup=function(C){var l=Y.findElement(C.target,"jdropdown");if(l){var o=l.dropdown;if(C.target.classList.contains("jdropdown-header"))if(l.classList.contains("jdropdown-focus")&&l.classList.contains("jdropdown-default")){var k=l.getBoundingClientRect();if(C.changedTouches&&C.changedTouches[0])var Q=C.changedTouches[0].clientX,te=C.changedTouches[0].clientY;else var Q=C.clientX,te=C.clientY;k.width-(Q-k.left)<30?C.target.classList.contains("jdropdown-add")?o.add():o.close():o.options.autocomplete==!1&&o.close()}else o.open();else if(C.target.classList.contains("jdropdown-group-name")){var O=C.target.nextSibling.children;if(C.target.nextSibling.style.display!="none")for(var I=0;I<O.length;I++)O[I].style.display!="none"&&o.selectItem(O[I])}else C.target.classList.contains("jdropdown-group-arrow")?C.target.classList.contains("jdropdown-group-arrow-down")?(C.target.classList.remove("jdropdown-group-arrow-down"),C.target.classList.add("jdropdown-group-arrow-up"),C.target.parentNode.nextSibling.style.display="none"):(C.target.classList.remove("jdropdown-group-arrow-up"),C.target.classList.add("jdropdown-group-arrow-down"),C.target.parentNode.nextSibling.style.display=""):C.target.classList.contains("jdropdown-item")?o.selectItem(C.target):C.target.classList.contains("jdropdown-image")||C.target.classList.contains("jdropdown-description")?o.selectItem(C.target.parentNode):C.target.classList.contains("jdropdown-title")?o.selectItem(C.target.parentNode.parentNode):(C.target.classList.contains("jdropdown-close")||C.target.classList.contains("jdropdown-backdrop"))&&o.close()}},v.extractFromDom=function(C,l){var o=C;if(l||(l={}),C.getAttribute("multiple")&&(!l||l.multiple==null)&&(l.multiple=!0),C.getAttribute("placeholder")&&(!l||l.placeholder==null)&&(l.placeholder=C.getAttribute("placeholder")),C.getAttribute("data-autocomplete")&&(!l||l.autocomplete==null)&&(l.autocomplete=!0),(!l||l.width==null)&&(l.width=C.offsetWidth),C.value&&(!l||l.value==null)&&(l.value=C.value),!l||l.data==null){l.data=[];for(var k=0;k<C.children.length;k++)if(C.children[k].tagName=="OPTGROUP")for(var Q=0;Q<C.children[k].children.length;Q++)l.data.push({value:C.children[k].children[Q].value,text:C.children[k].children[Q].textContent,group:C.children[k].getAttribute("label")});else l.data.push({value:C.children[k].value,text:C.children[k].textContent})}(!l||l.onchange==null)&&(l.onchange=function(O,I,_,W){l.multiple==!0?obj.items[I].classList.contains("jdropdown-selected")?o.options[I].setAttribute("selected","selected"):o.options[I].removeAttribute("selected"):o.value=W});var te=document.createElement("div");return C.parentNode.insertBefore(te,C),C.style.display="none",C=te,{el:C,options:l}},v}var ve=Le();function ie(v,C){if(v.picker)return v.picker.setOptions(C,!0);var l={type:"picker"};l.options={};var o=null,k=null,Q=function(I){return I instanceof Element||I instanceof HTMLDocument},te=function(){k.innerHTML="";for(var I=Object.keys(l.options.data),_=0;_<I.length;_++){var W=document.createElement("div");W.classList.add("jpicker-item"),W.k=I[_],W.v=l.options.data[I[_]];var oe=l.getLabel(I[_],W);Q(oe)?W.appendChild(oe):W.innerHTML=oe,k.appendChild(W)}};l.setOptions=function(I,_){var W={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};I&&I.options&&(I.data=I.options);for(var oe in W)I&&I.hasOwnProperty(oe)?l.options[oe]=I[oe]:(typeof l.options[oe]=="undefined"||_===!0)&&(l.options[oe]=W[oe]);return l.options.header===!1?o.style.display="none":o.style.display="",l.options.width?o.style.width=parseInt(l.options.width)+"px":o.style.width="",l.options.height?(k.style.maxHeight=l.options.height+"px",k.style.overflow="scroll"):k.style.overflow="",l.options.columns>0&&(l.options.grid?(k.classList.add("jpicker-grid"),k.style.gridTemplateColumns="repeat("+l.options.grid+", 1fr)"):(k.classList.add("jpicker-columns"),k.style.width=l.options.width?l.options.width:36*l.options.columns+"px")),isNaN(parseInt(l.options.value))&&(l.options.value=0),te(),l.setValue(l.options.value),l},l.getValue=function(){return l.options.value},l.setValue=function(I,_){if(l.setLabel(I),l.options.value=String(I),v.value!=l.options.value&&(v.value=l.options.value,typeof v.oninput=="function"&&v.oninput({type:"input",target:v,value:v.value})),k.children[I]&&k.children[I].getAttribute("type")!=="generic"&&l.close(),_&&typeof l.options.onchange=="function"){var W=l.options.data[I];l.options.onchange(v,l,W,W,I,_)}},l.getLabel=function(I,_){var W=l.options.data[I]||null;return typeof l.options.render=="function"&&(W=l.options.render(W,_)),W},l.setLabel=function(I){var _;l.options.content?_='<i class="material-icons">'+l.options.content+"</i>":_=l.getLabel(I,null),Q(_)?(o.innerHTML="",o.appendChild(_)):o.innerHTML=_},l.open=function(){if(!v.classList.contains("jpicker-focus")){g(l,!0),v.classList.add("jpicker-focus"),v.focus();var I=0,_=0;k.style.marginLeft="";var W=o.getBoundingClientRect(),oe=k.getBoundingClientRect();window.innerHeight<W.bottom+oe.height||l.options.bottom?I=-1*(oe.height+4):I=W.height+4,l.options.right===!0&&(_=-1*oe.width+W.width),oe.left+_<0&&(_=_+oe.left+10),oe.left+oe.width>window.innerWidth&&(_=-1*(10+oe.left+oe.width-window.innerWidth)),k.style.marginTop=parseInt(I)+"px",k.style.marginLeft=parseInt(_)+"px",typeof l.options.onopen=="function"&&l.options.onopen(v,l)}},l.close=function(){v.classList.contains("jpicker-focus")&&(v.classList.remove("jpicker-focus"),g(l,!1),typeof l.options.onclose=="function"&&l.options.onclose(v,l))};var O=function(){v.classList.add("jpicker"),v.setAttribute("tabindex","900"),v.onmousedown=function(I){v.classList.contains("jpicker-focus")||l.open()},o=document.createElement("div"),o.classList.add("jpicker-header"),k=document.createElement("div"),k.classList.add("jpicker-content"),k.onclick=function(I){var _=Y.findElement(I.target,"jpicker-item");_&&_.parentNode===k&&l.setValue(_.k,I)},v.appendChild(o),v.appendChild(k),v.value=C.value||0,l.setOptions(C),typeof l.options.onload=="function"&&l.options.onload(v,l),v.change=l.setValue,v.val=function(I){if(I===void 0)return l.getValue();l.setValue(I)},v.picker=l};return O(),l}function Ye(v,C){var l={type:"toolbar"};l.options={};var o={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var k in o)C&&C.hasOwnProperty(k)?l.options[k]=C[k]:l.options[k]=o[k];!v&&C.app&&C.app.el&&(v=document.createElement("div"),C.app.el.appendChild(v));var Q=document.createElement("div");Q.classList.add("jtoolbar-item"),Q.classList.add("jtoolbar-arrow");var te=document.createElement("div");te.classList.add("jtoolbar-floating"),Q.appendChild(te),l.selectItem=function(I){for(var _=O.children,W=0;W<_.length;W++)I!=_[W]&&_[W].classList.remove("jtoolbar-selected");I.classList.add("jtoolbar-selected")},l.hide=function(){N.slideBottom(v,0,function(){v.style.display="none"})},l.show=function(){v.style.display="",N.slideBottom(v,1)},l.get=function(){return v},l.setBadge=function(I,_){O.children[I].children[1].firstChild.innerHTML=_},l.destroy=function(){toolbar.remove(),v.innerHTML=""},l.update=function(I,_){for(var W=0;W<O.children.length;W++){var oe=O.children[W];typeof oe.updateState=="function"&&oe.updateState(v,l,oe,I,_)}for(var W=0;W<te.children.length;W++){var oe=te.children[W];typeof oe.updateState=="function"&&oe.updateState(v,l,oe,I,_)}},l.create=function(I){O.innerHTML="";for(var _=0;_<I.length;_++){var W=document.createElement("div");if(W.classList.add("jtoolbar-item"),I[_].width&&(W.style.width=parseInt(I[_].width)+"px"),I[_].k&&(W.k=I[_].k),I[_].tooltip&&W.setAttribute("title",I[_].tooltip),I[_].id&&W.setAttribute("id",I[_].id),I[_].updateState&&(W.updateState=I[_].updateState),I[_].active&&W.classList.add("jtoolbar-active"),I[_].disabled&&W.classList.add("jtoolbar-disabled"),I[_].type=="select"||I[_].type=="dropdown")ie(W,I[_]);else if(I[_].type=="divisor")W.classList.add("jtoolbar-divisor");else if(I[_].type=="label")W.classList.add("jtoolbar-label"),W.innerHTML=I[_].content;else{var oe=document.createElement("i");if(typeof I[_].class=="undefined")oe.classList.add("material-icons");else for(var be=I[_].class.split(" "),ue=0;ue<be.length;ue++)oe.classList.add(be[ue]);if(oe.innerHTML=I[_].content?I[_].content:"",W.appendChild(oe),l.options.badge==!0){var pe=document.createElement("div");pe.classList.add("jbadge");var le=document.createElement("div");le.innerHTML=I[_].badge?I[_].badge:"",pe.appendChild(le),W.appendChild(pe)}if(I[_].title)if(l.options.title==!0){var je=document.createElement("span");je.innerHTML=I[_].title,W.appendChild(je)}else W.setAttribute("title",I[_].title);l.options.app&&I[_].route&&(W.route=I[_].route,W.onclick=function(){l.options.app.pages(this.route)},l.options.app.pages(I[_].route,{toolbarItem:W,closed:!0})),typeof I[_].render=="function"&&I[_].render(W,I[_])}I[_].onclick&&(W.onclick=I[_].onclick.bind(I[_],v,l,W)),O.appendChild(W)}setTimeout(function(){l.refresh()},0)},l.open=function(){Q.classList.add("jtoolbar-arrow-selected");var I=v.getBoundingClientRect(),_=te.getBoundingClientRect();_.bottom>window.innerHeight||l.options.bottom?te.style.bottom="0":te.style.removeProperty("bottom"),te.style.right="0",Q.children[0].focus(),g(l,!0)},l.close=function(){Q.classList.remove("jtoolbar-arrow-selected"),g(l,!1)},l.refresh=function(){if(l.options.responsive==!0){var I=v.parentNode.getBoundingClientRect();l.options.maxWidth||(l.options.maxWidth=I.width);var _=parseInt(l.options.maxWidth);for(Q.parentNode&&Q.parentNode.removeChild(Q);te.firstChild;)O.appendChild(te.firstChild);if(_<O.offsetWidth)for(_-=50;O.lastChild&&_<O.offsetWidth;)te.insertBefore(O.lastChild,te.firstChild);te.children.length>0&&O.appendChild(Q)}},l.setReadonly=function(I){I=I?"add":"remove",v.classList[I]("jtoolbar-disabled")},v.onclick=function(I){var _=Y.findElement(I.target,"jtoolbar-item");_&&l.selectItem(_),I.target.classList.contains("jtoolbar-arrow")&&l.open()},window.addEventListener("resize",function(){l.refresh()}),v.classList.add("jtoolbar"),v.innerHTML="",l.options.container==!0&&v.classList.add("jtoolbar-container");var O=document.createElement("div");return v.appendChild(O),l.options.app&&v.classList.add("jtoolbar-mobile"),l.create(l.options.items),v.toolbar=l,l}function Ge(){var v=function(C,l){var o={type:"editor"};o.options={};var k={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var Q in k)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=k[Q];var te=null,O=null,I=[];o.el=C,typeof o.options.onclick=="function"&&(C.onclick=function(ee){o.options.onclick(C,o,ee)}),C.classList.add("jeditor-container");var _=document.createElement("div");_.className="jsnippet",_.setAttribute("contenteditable",!1);var W=document.createElement("div");if(W.className="jeditor-toolbar",o.editor=document.createElement("div"),o.editor.setAttribute("contenteditable",!0),o.editor.setAttribute("spellcheck",!1),o.editor.classList.add("jeditor"),o.options.placeholder&&o.editor.setAttribute("data-placeholder",o.options.placeholder),(o.options.maxHeight||o.options.height)&&(o.editor.style.overflowY="auto",o.options.maxHeight&&(o.editor.style.maxHeight=o.options.maxHeight),o.options.height&&(o.editor.style.height=o.options.height)),o.options.url)w({url:o.options.url,dataType:"html",success:function(ee){o.editor.innerHTML=ee,v.setCursor(o.editor,o.options.focus=="initial")}});else if(o.options.value)o.editor.innerHTML=o.options.value;else for(var oe=0;oe<C.children.length;oe++)o.editor.appendChild(C.children[oe]);C.innerHTML="";var be=function(ee){typeof o.options.onchange=="function"&&o.options.onchange(C,o,ee),o.options.value=o.getData(),C.value!=o.options.value&&(C.value=o.options.value,typeof C.oninput=="function"&&C.oninput({type:"input",target:C,value:C.value}))},ue=function(ee){var me=document.createElement("div");me.innerHTML=ee;var Ae=me.querySelectorAll("img");if(Ae.length)for(var ke=0;ke<Ae.length;ke++)o.addImage(Ae[ke].src)},pe=function(ee){var me,Ae;if(window.getSelection&&(me=window.getSelection(),me.rangeCount)){Ae=me.getRangeAt(0);var ke=Ae.toString();Ae.deleteContents(),Ae.insertNode(ee),Ae.setStartAfter(ee),Ae.setEndAfter(ee),me.removeAllRanges(),me.addRange(Ae)}},le=function(){var ee=null;if(ee=_.children[0]){ee.classList.contains("jslider-grid")||ee.classList.add("jslider-grid");var me=ee.children.length;ee.setAttribute("data-number",me>4?4:me),me>4?ee.setAttribute("data-total",me-4):ee.removeAttribute("data-total")}},je=function(ee){_.innerHTML||o.appendSnippet({}),_.children[0].appendChild(ee),le()};o.appendSnippet=function(ee){_.innerHTML="";for(var me=["image","title","description","host","url"],Ae=0;Ae<me.length;Ae++){var ke=document.createElement("div");if(ke.className="jsnippet-"+me[Ae],ke.setAttribute("data-k",me[Ae]),_.appendChild(ke),ee[me[Ae]])if(me[Ae]=="image"){Array.isArray(ee.image)||(ee.image=[ee.image]);for(var rt=0;rt<ee.image.length;rt++){var Xe=document.createElement("img");Xe.src=ee.image[rt],ke.appendChild(Xe)}}else ke.innerHTML=ee[me[Ae]]}o.editor.appendChild(document.createElement("br")),o.editor.appendChild(_)},o.setData=function(ee){typeof ee=="object"?o.editor.innerHTML=ee.content:o.editor.innerHTML=ee,o.options.focus&&v.setCursor(o.editor,!0),I=[]},o.getFiles=function(){for(var ee=o.editor.querySelectorAll(".jfile"),me=[],Ae=0;Ae<ee.length;Ae++)I[ee[Ae].src]&&me.push(I[ee[Ae].src]);return me},o.getText=function(){return o.editor.innerText},o.getData=function(ee){if(ee){var me={content:""};if(_.innerHTML){var Ae=0;me.snippet={};for(var ke=0;ke<_.children.length;ke++){var rt=_.children[ke].getAttribute("data-k");if(rt)if(rt=="image"){me.snippet.image||(me.snippet.image=[]);for(var Xe=0;Xe<_.children[ke].children.length;Xe++)me.snippet.image.push(_.children[ke].children[Xe].getAttribute("src"))}else me.snippet[rt]=_.children[ke].innerHTML}}var Qe=Object.keys(I);if(Qe.length){me.files=[];for(var ke=0;ke<Qe.length;ke++)me.files.push(I[Qe[ke]])}var et=document.createElement("div");et.innerHTML=o.editor.innerHTML;var He=et.querySelector(".jsnippet");He&&He.remove();var st=et.innerHTML;st=st.replace(/<br>/g,`
`),st=st.replace(/<\/div>/g,`</div>
`),st=st.replace(/<(?:.|\n)*?>/gm,""),me.content=st.trim(),_e("getData",me)}else var me=o.editor.innerHTML;return me},o.reset=function(){o.editor.innerHTML="",_.innerHTML="",I=[]},o.addPdf=function(ee){if(ee.result.substr(0,4)!="data")console.error("Invalid source");else{var me=document.createElement("canvas");me.width=60,me.height=60;var Ae=new Image,ke=me.getContext("2d");ke.drawImage(Ae,0,0,me.width,me.height),me.toBlob(function(rt){var Xe=document.createElement("img");Xe.src=window.URL.createObjectURL(rt),Xe.title=ee.name,Xe.className="jfile pdf",I[Xe.src]={file:Xe.src,extension:"pdf",content:ee.result},document.execCommand("insertHtml",!1,Xe.outerHTML)})}},o.addImage=function(ee,me){if(ee||(ee=""),ee.substr(0,4)!="data"&&!o.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(ee.substr(0,4)=="data"){var Ae=ee.split(";");Ae=Ae[0].split("/"),Ae=Ae[1]}else{var Ae=ee.substr(ee.lastIndexOf(".")+1);ee=o.options.remoteParser+ee}var ke=new Image;ke.onload=function(){var Xe=document.createElement("canvas");Xe.width=ke.width,Xe.height=ke.height;var Qe=Xe.getContext("2d");Qe.drawImage(ke,0,0,Xe.width,Xe.height),Xe.toBlob(function(et){var He=document.createElement("img");He.src=window.URL.createObjectURL(et),He.classList.add("jfile"),He.setAttribute("tabindex","900"),He.setAttribute("width",ke.width),He.setAttribute("height",ke.height),I[He.src]={file:He.src,extension:Ae,content:Xe.toDataURL()},o.options.dropAsSnippet||me?(je(He),I[He.src].snippet=!0):document.execCommand("insertHtml",!1,He.outerHTML),be()})},ke.src=ee}},o.addFile=function(ee){for(var me=[],Ae=0;Ae<ee.length;Ae++)if(ee[Ae].size>o.options.maxFileSize)alert("The file is too big");else{var ke=ee[Ae].type.split("/");ke[0]=="image"?ke=1:ke[1]=="pdf"?ke=2:ke=0,ke?(me[Ae]=new FileReader,me[Ae].index=Ae,me[Ae].type=ke,me[Ae].name=ee[Ae].name,me[Ae].date=ee[Ae].lastModified,me[Ae].size=ee[Ae].size,me[Ae].addEventListener("load",function(rt){rt.target.type==2?o.options.acceptFiles==!0&&o.addPdf(rt.target):o.addImage(rt.target.result)},!1),me[Ae].readAsDataURL(ee[Ae])):alert("The extension is not allowed")}},o.destroy=function(){o.editor.removeEventListener("mouseup",Ne),o.editor.removeEventListener("mousedown",Ie),o.editor.removeEventListener("mousemove",Te),o.editor.removeEventListener("keyup",K),o.editor.removeEventListener("keydown",ye),o.editor.removeEventListener("dragstart",re),o.editor.removeEventListener("dragenter",A),o.editor.removeEventListener("dragover",S),o.editor.removeEventListener("drop",Z),o.editor.removeEventListener("paste",X),o.editor.removeEventListener("blur",ce),o.editor.removeEventListener("focus",de),C.editor=null,C.classList.remove("jeditor-container"),W.remove(),_.remove(),o.editor.remove()},o.upload=function(){Y.click(o.file)};var Ce=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],qe=["width","height","align","border","src","tabindex"],Ze=["color","font-weight","font-size","background","background-color","margin"],he=function(ee){if(ee.attributes&&ee.attributes.length){var me=null,Ae=null,ke=ee.getAttribute("style");if(ke){Ae=[];for(var rt=ke.split(";"),Xe=0;Xe<rt.length;Xe++){var Qe=rt[Xe].trim().split(":");if(Ze.indexOf(Qe[0].trim())>=0){var et=Qe.shift(),Qe=Qe.join(":");Ae.push(et+":"+Qe)}}}ee.tagName.toUpperCase()=="IMG"&&(!o.options.acceptImages||!ee.src?ee.parentNode.removeChild(ee):(ee.setAttribute("tabindex","900"),o.addImage(ee.src)));for(var He=[],st=0;st<ee.attributes.length;st++)He.push(ee.attributes[st].name);He.length&&He.forEach(function(xt){qe.indexOf(xt)==-1?ee.removeAttribute(xt):ee.attributes[st].value.indexOf("<")!==-1&&ee.attributes[st].value.replace("<","&#60;")}),ee.style="",Ae&&Ae.length&&ee.setAttribute("style",Ae.join(";"))}if(ee.children.length)for(var st=0;st<ee.children.length;st++)he(ee.children[st]);Ce.indexOf(ee.constructor)>=0&&ee.remove()},Ee=function(ee){var me=window.getSelection(),Ae=document.createRange();Ae.selectNode(ee),me.addRange(Ae)},G=function(ee){ee&&(ee=ee.replace(new RegExp("<!--(.*?)-->","gsi"),""));var me=new DOMParser,Ae=me.parseFromString(ee,"text/html");he(Ae);var ke=document.createElement("span");return ke.innerHTML=Ae.firstChild.innerHTML,ke},X=function(ee){if(o.options.filterPaste==!0){if(ee.clipboardData||ee.originalEvent.clipboardData)var me=(ee.originalEvent||ee).clipboardData.getData("text/html"),Ae=(ee.originalEvent||ee).clipboardData.getData("text/plain"),ke=(ee.originalEvent||ee).clipboardData.files;else if(window.clipboardData)var me=window.clipboardData.getData("Html"),Ae=window.clipboardData.getData("Text"),ke=window.clipboardData.files;if(ke.length)o.addFile(ke);else if(!me)me=Ae.split(`\r
`),ee.target.innerText?(me=me.map(function(Xe){return"<div>"+Xe+"</div>"}),document.execCommand("insertHtml",!1,me.join(""))):me.map(function(Xe){var Qe=document.createElement("div");Qe.innerText=Xe,o.editor.appendChild(Qe)});else{var rt=G(me);document.execCommand("insertHtml",!1,rt.innerHTML)}ee.preventDefault()}},re=function(ee){O&&O.e&&ee.preventDefault()},A=function(ee){O||o.options.dropZone==!1||(C.classList.add("jeditor-dragging"),ee.preventDefault())},S=function(ee){O||o.options.dropZone==!1||(te&&clearTimeout(te),te=setTimeout(function(){C.classList.remove("jeditor-dragging")},100),ee.preventDefault())},Z=function(ee){if(!(O||o.options.dropZone==!1)){var me=null;document.caretRangeFromPoint?me=document.caretRangeFromPoint(ee.clientX,ee.clientY):ee.rangeParent&&(me=document.createRange(),me.setStart(ee.rangeParent,ee.rangeOffset));var Ae=window.getSelection();Ae.removeAllRanges(),Ae.addRange(me),Ae.anchorNode.parentNode.focus();var ke=(ee.originalEvent||ee).dataTransfer.getData("text/html"),rt=(ee.originalEvent||ee).dataTransfer.getData("text/plain"),Xe=(ee.originalEvent||ee).dataTransfer.files;Xe.length?o.addFile(Xe):rt&&ue(ke),C.classList.remove("jeditor-dragging"),ee.preventDefault()}},ce=function(ee){_e("onevent",ee),be(ee),typeof o.options.onblur=="function"&&o.options.onblur(C,o,ee)},de=function(ee){typeof o.options.onfocus=="function"&&o.options.onfocus(C,o,ee)},K=function(ee){o.editor.innerHTML||(o.editor.innerHTML="<div><br></div>"),typeof o.options.onkeyup=="function"&&o.options.onkeyup(C,o,ee)},ye=function(ee){if(_e("onevent",ee),ee.key=="Delete"&&ee.target.tagName=="IMG"){var me=ee.target.parentNode;Ee(ee.target),me.classList.contains("jsnippet-image")&&le()}typeof o.options.onkeydown=="function"&&o.options.onkeydown(C,o,ee)},Ne=function(ee){if(O&&O.e&&(O.e.classList.remove("resizing"),O.e.changed==!0)){var me=O.e.cloneNode();me.width=parseInt(O.e.style.width)||O.e.getAttribute("width"),me.height=parseInt(O.e.style.height)||O.e.getAttribute("height"),O.e.style.width="",O.e.style.height="",Ee(O.e),document.execCommand("insertHtml",!1,me.outerHTML)}O=!1},Ie=function(ee){var me=function(Xe){var Qe=Xe.getBoundingClientRect();Qe.width-(ee.clientX-Qe.left)<40&&ee.clientY-Qe.top<40&&(Xe.innerHTML="",Xe.remove())};if(ee.target.tagName=="IMG")if(ee.target.style.cursor){var Ae=ee.target.getBoundingClientRect();O={e:ee.target,x:ee.clientX,y:ee.clientY,w:Ae.width,h:Ae.height,d:ee.target.style.cursor},ee.target.getAttribute("width")||ee.target.setAttribute("width",Ae.width),ee.target.getAttribute("height")||ee.target.setAttribute("height",Ae.height);var ke=window.getSelection();if(ke.rangeCount)for(var rt=0;rt<ke.rangeCount;rt++)ke.removeRange(ke.getRangeAt(rt));ee.target.classList.add("resizing")}else O=!0;else ee.target.classList.contains("jsnippet")?me(ee.target):ee.target.parentNode.classList.contains("jsnippet")&&me(ee.target.parentNode),O=!0},Te=function(ee){if(ee.target.tagName=="IMG"&&!ee.target.parentNode.classList.contains("jsnippet-image")&&o.options.allowImageResize==!0&&ee.target.getAttribute("tabindex")){var me=ee.target.getBoundingClientRect();ee.clientY-me.top<5?me.width-(ee.clientX-me.left)<5?ee.target.style.cursor="ne-resize":ee.clientX-me.left<5?ee.target.style.cursor="nw-resize":ee.target.style.cursor="n-resize":me.height-(ee.clientY-me.top)<5?me.width-(ee.clientX-me.left)<5?ee.target.style.cursor="se-resize":ee.clientX-me.left<5?ee.target.style.cursor="sw-resize":ee.target.style.cursor="s-resize":me.width-(ee.clientX-me.left)<5?ee.target.style.cursor="e-resize":ee.clientX-me.left<5?ee.target.style.cursor="w-resize":ee.target.style.cursor=""}if(ee.which==1&&O&&O.d){if(O.d=="e-resize"||O.d=="ne-resize"||O.d=="se-resize")if(O.e.style.width=O.w+(ee.clientX-O.x),ee.shiftKey){var Ae=(ee.clientX-O.x)*(O.h/O.w);O.e.style.height=O.h+Ae}else var Ae=null;Ae||(O.d=="s-resize"||O.d=="se-resize"||O.d=="sw-resize")&&(ee.shiftKey||(O.e.style.height=O.h+(ee.clientY-O.y))),O.e.changed=!0}},_e=function(ee,me){if(o.options.extensions){var Ae=Object.keys(o.options.extensions);if(Ae.length)for(var ke=0;ke<Ae.length;ke++)o.options.extensions[Ae[ke]]&&typeof o.options.extensions[Ae[ke]][ee]=="function"&&o.options.extensions[Ae[ke]][ee].call(o,me)}},$e=function(){if(o.options.extensions){var ee=Object.keys(o.options.extensions);if(ee.length)for(var me=0;me<ee.length;me++)o.options.extensions[ee[me]]&&typeof o.options.extensions[ee[me]]=="function"&&(o.options.extensions[ee[me]]=o.options.extensions[ee[me]](C,o))}};if(document.addEventListener("mouseup",Ne),document.addEventListener("mousemove",Te),o.editor.addEventListener("mousedown",Ie),o.editor.addEventListener("keyup",K),o.editor.addEventListener("keydown",ye),o.editor.addEventListener("dragstart",re),o.editor.addEventListener("dragenter",A),o.editor.addEventListener("dragover",S),o.editor.addEventListener("drop",Z),o.editor.addEventListener("paste",X),o.editor.addEventListener("focus",de),o.editor.addEventListener("blur",ce),C.appendChild(o.editor),o.options.snippet&&o.appendSnippet(o.options.snippet),o.options.toolbar){if(Array.isArray(o.options.toolbar))var nt={container:!0,responsive:!0,items:o.options.toolbar};else if(o.options.toolbar===!0)var nt={container:!0,responsive:!0,items:[]};else var nt=o.options.toolbar;nt.items&&nt.items.length||(nt.items=v.getDefaultToolbar(o)),o.options.toolbarOnTop?(C.classList.add("toolbar-on-top"),C.insertBefore(W,C.firstChild)):(o.editor.style.padding="15px",C.appendChild(W)),Ye(W,nt),W.addEventListener("click",function(){o.editor.focus()})}return o.file=document.createElement("input"),o.file.style.display="none",o.file.type="file",o.file.setAttribute("accept","image/*"),o.file.onchange=function(){o.addFile(this.files)},C.appendChild(o.file),o.options.focus&&v.setCursor(o.editor,o.options.focus=="initial"),C.change=o.setData,C.val=function(ee){if(ee===void 0){var me=C.getAttribute("data-html")!=="true";return o.getData(me)}else o.setData(ee)},$e(),C.editor=o,typeof o.options.onload=="function"&&o.options.onload(C,o,o.editor),o};return v.setCursor=function(C,l){C.focus(),document.execCommand("selectAll");var o=window.getSelection(),k=o.getRangeAt(0);if(l==!0)var Q=k.startContainer,te=0;else var Q=k.endContainer,te=Q.length;k.setStart(Q,te),k.setEnd(Q,te),o.removeAllRanges(),o.addRange(k)},v.getDefaultToolbar=function(C){var l=function(k,Q,te){if(!te.color){var O=null,I=ge(te,{onchange:function(_,W){te.k==="color"?document.execCommand("foreColor",!1,W):document.execCommand("backColor",!1,W)}});te.color.open()}},o=[];return o.push({content:"undo",onclick:function(){document.execCommand("undo")}}),o.push({content:"redo",onclick:function(){document.execCommand("redo")}}),o.push({type:"divisor"}),C.options.toolbarOnTop&&(o.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(k){return'<span style="font-family:'+k+'">'+k+"</span>"},onchange:function(k,Q,te,O,I){document.execCommand("fontName",!1,O)}}),o.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(k){return'<span style="font-size:'+k+'">'+k+"</span>"},onchange:function(k,Q,te,O,I){document.execCommand("fontSize",!1,parseInt(I)+1)}}),o.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(k){return'<i class="material-icons">'+k+"</i>"},onchange:function(k,Q,te,O,I){var _=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(_[I])}}),o.push({type:"divisor"}),o.push({content:"format_color_text",k:"color",onclick:l}),o.push({content:"format_color_fill",k:"background-color",onclick:l})),o.push({content:"format_bold",onclick:function(k,Q,te){document.execCommand("bold"),document.queryCommandState("bold")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({content:"format_italic",onclick:function(k,Q,te){document.execCommand("italic"),document.queryCommandState("italic")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({content:"format_underline",onclick:function(k,Q,te){document.execCommand("underline"),document.queryCommandState("underline")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({type:"divisor"}),o.push({content:"format_list_bulleted",onclick:function(k,Q,te){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({content:"format_list_numbered",onclick:function(k,Q,te){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({content:"format_indent_increase",onclick:function(k,Q,te){document.execCommand("indent",!0,null),document.queryCommandState("indent")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),C.options.toolbarOnTop&&(o.push({type:"divisor"}),o.push({content:"photo",onclick:function(){C.upload()}}),o.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(k,Q){Q&&(Q.onmouseover=this.onmouseover,k=k.split("x"),Q.setAttribute("data-x",k[0]),Q.setAttribute("data-y",k[1]));var te=document.createElement("div");return Q.style.margin="1px",Q.style.border="1px solid #ddd",te},onmouseover:function(k){for(var Q=parseInt(k.target.getAttribute("data-x")),te=parseInt(k.target.getAttribute("data-y")),O=0;O<k.target.parentNode.children.length;O++){var I=k.target.parentNode.children[O],_=parseInt(I.getAttribute("data-x")),W=parseInt(I.getAttribute("data-y"));_<=Q&&W<=te?(I.style.backgroundColor="#cae1fc",I.style.borderColor="#2977ff"):(I.style.backgroundColor="",I.style.borderColor="#ddd")}},onchange:function(k,Q,te){te=te.split("x");for(var O=document.createElement("table"),I=document.createElement("tbody"),_=0;_<=te[1];_++){for(var W=document.createElement("tr"),oe=0;oe<=te[0];oe++){var be=document.createElement("td");be.innerHTML="",W.appendChild(be)}I.appendChild(W)}O.appendChild(I),O.setAttribute("width","100%"),O.setAttribute("cellpadding","6"),O.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,O.outerHTML)}})),o},v}var Ue=Ge();function Be(){var v=function(C,l){var o={};o.options={};var k={type:"big",title:"Untitled",width:510,height:472};for(var Q in k)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=k[Q];var te=function(){for(var _=document.createElement("div");C.children[0];)_.appendChild(C.children[0]);for(o.content=document.createElement("div"),o.content.className="jfloating_content",o.content.innerHTML=C.innerHTML;_.children[0];)o.content.appendChild(_.children[0]);o.container=document.createElement("div"),o.container.className="jfloating",o.container.appendChild(o.content),o.options.title?o.container.setAttribute("title",o.options.title):o.container.classList.add("no-title"),o.options.width&&(o.container.style.width=parseInt(o.options.width)+"px"),o.options.height&&(o.container.style.height=parseInt(o.options.height)+"px"),C.innerHTML="",C.appendChild(o.container)},O=function(){o.container&&o.container.addEventListener("click",function(_){var W=_.target.getBoundingClientRect();if(_.target.classList.contains("jfloating")){if(_.changedTouches&&_.changedTouches[0])var oe=_.changedTouches[0].clientX,be=_.changedTouches[0].clientY;else var oe=_.clientX,be=_.clientY;W.width-(oe-W.left)<50&&be-W.top<50?setTimeout(function(){o.close()},100):o.setState()}})},I=function(){o.container.classList.add("jfloating-"+o.options.type)};return o.state={isMinized:!1},o.setState=function(){o.state.isMinized?o.container.classList.remove("jfloating-minimized"):o.container.classList.add("jfloating-minimized"),o.state.isMinized=!o.state.isMinized},o.close=function(){Components.elements.splice(v.elements.indexOf(o.container),1),o.updatePosition(),C.remove()},o.updatePosition=function(){for(var _=0;_<v.elements.length;_++){var W=v.elements[_],oe=v.elements[_-1];W.style.right=_*(oe?oe.offsetWidth:W.offsetWidth)*1.01+"px"}},o.init=function(){te(),O(),I(),v.elements.push(o.container),o.updatePosition(),C.floating=o},o.init(),o};return v.elements=[],v}var lt=Be();function U(){const v=function(O){return!isNaN(O)&&O!==null&&O!==""},C={between:function(O,I){return O>=I[0]&&O<=I[1]},"not between":function(O,I){return O<I[0]||O>I[1]},"<":function(O,I){return O<I[0]},"<=":function(O,I){return O<=I[0]},">":function(O,I){return O>I[0]},">=":function(O,I){return O>=I[0]},"=":function(O,I){return O==I[0]},"!=":function(O,I){return O!=I[0]}},l={"valid date":function(){return!0},"=":function(O,I){return O===I[0]},"!=":function(O,I){return O!==I[0]},"<":function(O,I){return O<I[0]},"<=":function(O,I){return O<=I[0]},">":function(O,I){return O>I[0]},">=":function(O,I){return O>=I[0]},between:function(O,I){return O>=I[0]&&O<=I[1]},"not between":function(O,I){return O<I[0]||O>I[1]}},o={contains:function(O,I){return O.includes(I[0])},"not contains":function(O,I){return!O.includes(I[0])},"begins with":function(O,I){return O.startsWith(I[0])},"ends with":function(O,I){return O.endsWith(I[0])},"=":function(O,I){return O===I[0]},"!=":function(O,I){return O!==I[0]},"valid email":function(O){var I=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return I.test(O)},"valid url":function(O){var I=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return I.test(O)}},k=function(O,I){return typeof k[I.type]=="function"?I.allowBlank&&O===""?!0:k[I.type](O,I):null};k.url=function(O){var I=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!I.test(O)},k.email=function(O){var I=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(O&&I.test(O))},k.required=function(O){return!!(O&&O.trim())},k.exist=function(O,I){return!!O.toString().trim()},k["not exist"]=function(O,I){return!O.toString().trim()},k.empty=function(O){return!O.toString().trim()},k.notEmpty=function(O){return!!O.toString().trim()},k.number=function(O,I){if(!v(O))return!1;if(!I||!I.criteria)return!0;if(!C[I.criteria])return!1;let _=I.value.map(function(W){return parseFloat(W)});return C[I.criteria](O,_)},k.login=function(O){let I=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(O&&I.test(O))},k.list=function(O,I){let _=typeof O;if(_!=="string"&&_!=="number")return!1;let W;return typeof I.value[0]=="string"?W=I.value[0].split(","):W=I.value[0],Array.isArray(W)?W.findIndex(function(be){return be==O})>-1:!1};const Q=function(){let O=new Date;return O.setHours(0,0,0,0),O},te={"one year ago":function(){let O=Q();return O.setFullYear(O.getFullYear()-1),O},"one month ago":function(){let O=Q();return O.setMonth(O.getMonth()-1),O},"one week ago":function(){let O=Q();return O.setDate(O.getDate()-7),O},yesterday:function(){let O=Q();return O.setDate(O.getDate()-1),O},today:Q,tomorrow:function(){let O=Q();return O.setDate(O.getDate()+1),O}};return k.date=function(O,I){if(v(O)&&O>0&&O<1e6&&(O=a.numToDate(O)),new Date(O)=="Invalid Date")return!1;if(!I||!I.criteria)return!0;if(!l[I.criteria])return!1;let _=I.value.map(function(W){return typeof W=="string"&&te[W]?te[W]().getTime():new Date(W).getTime()});return l[I.criteria](new Date(O).getTime(),_)},k.text=function(O,I){return typeof O!="string"?!1:!I||!I.criteria?!0:o[I.criteria]?o[I.criteria](O,I.value):!1},k.textLength=function(O,I){return O=O.toString(),k.number(O.length,I)},k}var Me=U();function ze(){var v=function(C,l){var o={};o.options={};var k={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(I,_){alert(_)}};for(var Q in k)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=k[Q];o.options.validations||(o.options.validations={}),o.options.submitButton||(o.options.submitButton=C.querySelector("input[type=submit]")),o.options.submitButton&&o.options.url&&(o.options.submitButton.onclick=function(){o.save()}),o.options.validations.email||(o.options.validations.email=Me.email),o.options.validations.length||(o.options.validations.length=Me.length),o.options.validations.required||(o.options.validations.required=Me.required),o.setUrl=function(I){o.options.url=I},o.load=function(){w({url:o.options.url,method:"GET",dataType:"json",queue:!0,success:function(I){if(typeof o.options.onbeforeload=="function"){var _=o.options.onbeforeload(C,I);_&&(I=_)}v.setElements(C,I),typeof o.options.onload=="function"&&o.options.onload(C,I)}})},o.save=function(){var I=o.validate();if(I)o.options.onerror(C,I);else{var _=v.getElements(C,!0);if(typeof o.options.onbeforesave=="function"){var _=o.options.onbeforesave(C,_);if(_===!1)return}w({url:o.options.url,method:"POST",dataType:"json",data:_,success:function(W){typeof o.options.onsave=="function"&&o.options.onsave(C,_,W)}})}},o.remove=function(){if(typeof o.options.onbeforeremove=="function"){var I=o.options.onbeforeremove(C,o);if(I===!1)return!1}w({url:o.options.url,method:"DELETE",dataType:"json",success:function(_){typeof o.options.onremove=="function"&&o.options.onremove(C,o,_),o.reset()}})};var te=function(I){I.classList.add("error"),o.options.submitButton&&o.options.submitButton.setAttribute("disabled",!0);var _=I.getAttribute("data-error")||"There is an error in the form";return I.setAttribute("title",_),_},O=function(I){var _=!1;I.classList.remove("error"),I.removeAttribute("title");for(var W=C.querySelectorAll("input, select, textarea, div[name]"),oe=0;oe<W.length;oe++)W[oe].getAttribute("data-validation")&&W[oe].classList.contains("error")&&(_=!0);o.options.submitButton&&(_?o.options.submitButton.setAttribute("disabled",!0):o.options.submitButton.removeAttribute("disabled"))};return o.validateElement=function(I){var _=!1,W=v.getValue(I),oe=I.getAttribute("data-validation");return typeof o.options.validations[oe]=="function"&&!o.options.validations[oe](W,I)?_=te(I):I.classList.contains("error")&&O(I),_},o.reset=function(){for(var I=null,_=C.querySelectorAll("input, select, textarea, div[name]"),W=0;W<_.length;W++)(I=_[W].getAttribute("name"))&&(_[W].type=="checkbox"||_[W].type=="radio"?_[W].checked=!1:typeof _[W].val=="function"?_[W].val(""):_[W].value="")},o.validate=function(){for(var I=[],_=C.querySelectorAll("input, select, textarea, div[name]"),W=0;W<_.length;W++)if(_[W].getAttribute("data-validation")){var oe=o.validateElement(_[W]);oe&&I.push(oe)}return I.length>0?I.join("<br>"):!1},o.getError=function(){return!!o.validation()},o.setHash=function(){return o.getHash(v.getElements(C))},o.getHash=function(I){var _=0,W,oe;if(I.length===0)return _;for(W=0;W<I.length;W++)oe=I.charCodeAt(W),_=(_<<5)-_+oe,_|=0;return _},o.isChanged=function(){var I=o.setHash();return o.options.currentHash!=I},o.resetTracker=function(){o.options.currentHash=o.setHash(),o.options.ignore=!1},o.setIgnore=function(I){o.options.ignore=!!I},setTimeout(function(){o.options.currentHash=o.setHash()},1e3),C.addEventListener("keyup",function(I){I.target.getAttribute("data-validation")&&o.validateElement(I.target)}),v.hasEvents||(window.addEventListener("beforeunload",function(I){if(o.isChanged()&&o.options.ignore==!1){var _=o.options.message?o.options.message:"o/";return _?(typeof I=="undefined"&&(I=window.event),I&&(I.returnValue=_),_):void 0}}),v.hasEvents=!0),C.form=o,o};return v.getValue=function(C){var l=null;if(C.type=="checkbox")C.checked==!0&&(l=C.value||!0);else if(C.type=="radio")C.checked==!0&&(l=C.value);else if(C.type=="file")l=C.files;else if(C.tagName=="select"&&C.multiple==!0){l=[];for(var o=C.querySelectorAll("options[selected]"),k=0;k<o.length;k++)l.push(o[k].value)}else typeof C.val=="function"?l=C.val():l=C.value||"";return l},v.getElements=function(C,l){for(var o={},k=null,Q=C.querySelectorAll("input, select, textarea, div[name]"),te=0;te<Q.length;te++)(k=Q[te].getAttribute("name"))&&(o[k]=v.getValue(Q[te])||"");return l==!0?o:JSON.stringify(o)},v.setElements=function(C,l){for(var o=null,k=null,Q=C.querySelectorAll("input, select, textarea, div[name]"),te=0;te<Q.length;te++){var O=Q[te].getAttribute("type");if(o=Q[te].getAttribute("name")){if(o=o.replace(new RegExp(/\[(.*?)\]/ig),".$1"),k=null,o.match(/\./)){var I=u.call(l,o)||"";typeof I!="undefined"&&(k=I)}else typeof l[o]!="undefined"&&(k=l[o]);k!==null&&(O=="checkbox"||O=="radio"?Q[te].checked=!!k:O=="file"||(typeof Q[te].val=="function"?Q[te].val(k):Q[te].value=k))}}},v}var Se=ze();function De(){var v=function(){var l=null,o=function(O){if(O.which==27)for(var I=document.querySelectorAll(".jmodal"),_=0;_<I.length;_++)I[_].parentNode.modal.close()},k=function(O){let I=O.composedPath();var _=Y.findElement(I[0],"jmodal");if(_){var W=_.getBoundingClientRect();if(O.changedTouches&&O.changedTouches[0])var oe=O.changedTouches[0].clientX,be=O.changedTouches[0].clientY;else var oe=O.clientX,be=O.clientY;W.width-(oe-W.left)<50&&be-W.top<50&&_.parentNode.modal.close()}l&&(l.element.style.cursor="auto",l=null)},Q=function(O){let I=O.composedPath();var _=Y.findElement(I[0],"jmodal");if(_){var W=_.getBoundingClientRect();if(O.changedTouches&&O.changedTouches[0])var oe=O.changedTouches[0].clientX,be=O.changedTouches[0].clientY;else var oe=O.clientX,be=O.clientY;W.width-(oe-W.left)<50&&be-W.top<50||be-W.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),l={left:W.left,top:W.top,x:O.clientX,y:O.clientY,width:W.width,height:W.height,element:_})}},te=function(O){if(l){if(O=O||window.event,O.buttons)var I=O.buttons;else if(O.button)var I=O.button;else var I=O.which;I?(l.element.style.top=l.top+(O.clientY-l.y)+l.height/2+"px",l.element.style.left=l.left+(O.clientX-l.x)+l.width/2+"px",l.element.style.cursor="move"):l.element.style.cursor="auto"}};document.addEventListener("keydown",o),document.addEventListener("mouseup",k),document.addEventListener("mousedown",Q),document.addEventListener("mousemove",te)},C=function(l,o){var k={};k.options={};var Q={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var te in Q)o&&o.hasOwnProperty(te)?k.options[te]=o[te]:k.options[te]=Q[te];!k.options.title&&l.getAttribute("title")&&(k.options.title=l.getAttribute("title"));for(var O=document.createElement("div");l.children[0];)O.appendChild(l.children[0]);for(k.title=document.createElement("div"),k.title.className="jmodal_title",k.options.icon&&k.title.setAttribute("data-icon",k.options.icon),k.content=document.createElement("div"),k.content.className="jmodal_content",k.content.innerHTML=l.innerHTML;O.children[0];)k.content.appendChild(O.children[0]);if(k.container=document.createElement("div"),k.container.className="jmodal",k.container.appendChild(k.title),k.container.appendChild(k.content),k.options.padding&&(k.content.style.padding=k.options.padding),k.options.width&&(k.container.style.width=k.options.width),k.options.height&&(k.container.style.height=k.options.height),k.options.title){var I=document.createElement("h4");I.innerText=k.options.title,k.title.appendChild(I)}if(l.innerHTML="",l.style.display="none",l.appendChild(k.container),k.options.backdrop){var _=document.createElement("div");_.className="jmodal_backdrop",_.onclick=function(){k.close()},l.appendChild(_)}return k.open=function(){l.style.display="block";var W=k.container.getBoundingClientRect();Y.getWindowWidth()<W.width?(k.container.style.top="",k.container.style.left="",k.container.classList.add("jmodal_fullscreen"),N.slideBottom(k.container,1)):k.options.backdrop&&(_.style.display="block"),typeof k.options.onopen=="function"&&k.options.onopen(l,k)},k.resetPosition=function(){k.container.style.top="",k.container.style.left=""},k.isOpen=function(){return l.style.display!="none"},k.close=function(){k.isOpen()&&(l.style.display="none",k.options.backdrop&&(_.style.display=""),k.container.classList.remove("jmodal_fullscreen"),typeof k.options.onclose=="function"&&k.options.onclose(l,k))},k.options.url?w({url:k.options.url,method:"GET",dataType:"text/html",success:function(W){k.content.innerHTML=W,k.options.closed||k.open(),typeof k.options.onload=="function"&&k.options.onload(k)}}):(k.options.closed||k.open(),typeof k.options.onload=="function"&&k.options.onload(k)),l.modal=k,v(),v=function(){},k};return C}var Oe=De();function Pe(){var v=function(C){var l={};l.options={};var o={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var k in o)C&&C.hasOwnProperty(k)?l.options[k]=C[k]:l.options[k]=o[k];var Q=document.createElement("div");Q.className="jnotification",l.options.error&&Q.classList.add("jnotification-error");var te=document.createElement("div");te.className="jnotification-container",Q.appendChild(te);var O=document.createElement("div");O.className="jnotification-header",te.appendChild(O);var I=document.createElement("div");if(I.className="jnotification-image",O.appendChild(I),l.options.icon){var _=document.createElement("img");_.src=l.options.icon,I.appendChild(_)}var W=document.createElement("div");if(W.className="jnotification-name",W.innerHTML=l.options.name,O.appendChild(W),l.options.closeable==!0){var oe=document.createElement("div");oe.className="jnotification-close",oe.onclick=function(){l.hide()},O.appendChild(oe)}var be=document.createElement("div");be.className="jnotification-date",O.appendChild(be);var ue=document.createElement("div");if(ue.className="jnotification-content",te.appendChild(ue),l.options.title){var pe=document.createElement("div");pe.className="jnotification-title",pe.innerHTML=l.options.title,ue.appendChild(pe)}var le=document.createElement("div");if(le.className="jnotification-message",le.innerHTML=l.options.message,ue.appendChild(le),l.show=function(){document.body.appendChild(Q),Y.getWindowWidth()>800?N.fadeIn(Q):N.slideTop(Q,1)},l.hide=function(){Y.getWindowWidth()>800?N.fadeOut(Q,function(){Q.parentNode&&(Q.parentNode.removeChild(Q),je&&clearTimeout(je))}):N.slideTop(Q,0,function(){Q.parentNode&&(Q.parentNode.removeChild(Q),je&&clearTimeout(je))})},l.show(),l.options.autoHide==!0)var je=setTimeout(function(){l.hide()},l.options.timeout);return Y.getWindowWidth()<800&&Q.addEventListener("swipeup",function(Ce){l.hide(),Ce.preventDefault(),Ce.stopPropagation()}),l};return v.isVisible=function(){var C=document.querySelector(".jnotification");return!!(C&&C.parentNode)},v}var Ke=Pe();function Je(v,C){var l={};l.options={};var o={value:0,onchange:null,width:null};for(var k in o)C&&C.hasOwnProperty(k)?l.options[k]=C[k]:l.options[k]=o[k];v.classList.add("jprogressbar"),v.setAttribute("tabindex",1),v.setAttribute("data-value",l.options.value);var Q=document.createElement("div");Q.style.width=l.options.value+"%",Q.style.color="#fff",v.appendChild(Q),l.options.width&&(v.style.width=l.options.width),l.setValue=function(O){O=parseInt(O),l.options.value=O,Q.style.width=O+"%",v.setAttribute("data-value",O+"%"),O<6?v.style.color="#000":v.style.color="#fff",l.options.value=O,typeof l.options.onchange=="function"&&l.options.onchange(v,O),v.value!=l.options.value&&(v.value=l.options.value,typeof v.oninput=="function"&&v.oninput({type:"input",target:v,value:v.value}))},l.getValue=function(){return l.options.value};var te=function(O){if(O.which){var I=v.getBoundingClientRect();if(O.changedTouches&&O.changedTouches[0])var _=O.changedTouches[0].clientX,W=O.changedTouches[0].clientY;else var _=O.clientX,W=O.clientY;l.setValue(Math.round((_-I.left)/I.width*100))}};return"touchstart"in document.documentElement?(v.addEventListener("touchstart",te),v.addEventListener("touchend",te)):(v.addEventListener("mousedown",te),v.addEventListener("mousemove",te)),v.change=l.setValue,v.val=function(O){if(O===void 0)return l.getValue();l.setValue(O)},v.progressbar=l,l}function ut(v,C){if(v.rating)return v.rating.setOptions(C,!0);var l={};l.options={},l.setOptions=function(k,Q){var te={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var O in te)k&&k.hasOwnProperty(O)?l.options[O]=k[O]:(typeof l.options[O]=="undefined"||Q===!0)&&(l.options[O]=te[O]);v.innerHTML="";for(var I=0;I<l.options.number;I++){var _=document.createElement("div");_.setAttribute("data-index",I+1),_.setAttribute("title",l.options.tooltip[I]),v.appendChild(_)}if(l.options.value)for(var I=0;I<l.options.number;I++)I<l.options.value&&v.children[I].classList.add("jrating-selected");return l},l.setValue=function(k){for(var Q=0;Q<l.options.number;Q++)Q<k?v.children[Q].classList.add("jrating-selected"):(v.children[Q].classList.remove("jrating-over"),v.children[Q].classList.remove("jrating-selected"));l.options.value=k,typeof l.options.onchange=="function"&&l.options.onchange(v,k),v.value!=l.options.value&&(v.value=l.options.value,typeof v.oninput=="function"&&v.oninput({type:"input",target:v,value:v.value}))},l.getValue=function(){return l.options.value};var o=function(){l.setOptions(C),v.classList.add("jrating"),v.addEventListener("click",function(k){var Q=k.target.getAttribute("data-index");Q!=null&&(Q==l.options.value?l.setValue(0):l.setValue(Q))}),v.addEventListener("mouseover",function(k){for(var Q=k.target.getAttribute("data-index"),te=0;te<l.options.number;te++)te<Q?v.children[te].classList.add("jrating-over"):v.children[te].classList.remove("jrating-over")}),v.addEventListener("mouseout",function(k){for(var Q=0;Q<l.options.number;Q++)v.children[Q].classList.remove("jrating-over")}),v.change=l.setValue,v.val=function(k){if(k===void 0)return l.getValue();l.setValue(k)},v.rating=l};return o(),l}function ft(v,C){if(v.search)return v.search;var l=null,o=function(_){if(_.target.classList.contains("jsearch_item"))var W=_.target;else var W=_.target.parentNode;O.selectIndex(W),_.preventDefault()},k=function(_){if(typeof O.options.onsearch=="function"){var W=O.options.onsearch(O,_);W&&(_=W)}if(I.innerHTML="",!_.length)v.style.display="";else{v.style.display="block";for(var oe=_.length<11?_.length:10,be=0;be<oe;be++){if(typeof _[be]=="string")var ue=_[be],pe=_[be];else{var ue=_[be].text;!ue&&_[be].name&&(ue=_[be].name);var pe=_[be].value;!pe&&_[be].id&&(pe=_[be].id)}var le=document.createElement("div");le.setAttribute("data-value",pe),le.setAttribute("data-text",ue),le.className="jsearch_item",_[be].id&&le.setAttribute("id",_[be].id),O.options.forceSelect&&be==0&&le.classList.add("selected");var je=document.createElement("img");_[be].image?je.src=_[be].image:je.style.display="none",le.appendChild(je);var Ce=document.createElement("div");Ce.innerHTML=ue,le.appendChild(Ce),I.appendChild(le)}}},Q=function(_){if(_!=O.terms)if(O.terms=_,O.options.forceSelect?l=0:l=null,Array.isArray(O.options.data)){var W=function(be){if(typeof be=="string"){if((""+be).toLowerCase().search(_.toLowerCase())>=0)return!0}else for(var ue in be){var pe=be[ue];if((""+pe).toLowerCase().search(_.toLowerCase())>=0)return!0}return!1},oe=O.options.data.filter(function(be){return W(be)});k(oe)}else w({url:O.options.data+_,method:"GET",dataType:"json",success:function(be){k(be)}})},te=null,O=function(_){te&&clearTimeout(te),te=setTimeout(function(){Q(_)},500)};C.forceSelect===null&&(C.forceSelect=!0),O.options={data:C.data||null,input:C.input||null,searchByNode:C.searchByNode||null,onselect:C.onselect||null,forceSelect:C.forceSelect,onsearch:C.onsearch||null,onbeforesearch:C.onbeforesearch||null},O.selectIndex=function(_){var W=_.getAttribute("id"),oe=_.getAttribute("data-text"),be=_.getAttribute("data-value"),ue=_.children[0].src||"";typeof O.options.onselect=="function"&&O.options.onselect(O,oe,be,W,ue),O.close()},O.open=function(){v.style.display="block"},O.close=function(){te&&clearTimeout(te),O.terms="",I.innerHTML="",v.style.display=""},O.isOpened=function(){return!!v.style.display},O.keydown=function(_){O.isOpened()&&(_.key=="Enter"?l!==null&&I.children[l]?(O.selectIndex(I.children[l]),_.preventDefault()):O.close():_.key==="ArrowUp"?(l!==null&&I.children[0]&&(I.children[l].classList.remove("selected"),!O.options.forceSelect&&l===0?l=null:(l=Math.max(0,l-1),I.children[l].classList.add("selected"))),_.preventDefault()):_.key==="ArrowDown"&&(l==null?l=-1:I.children[l].classList.remove("selected"),l<9&&I.children[l+1]&&l++,I.children[l].classList.add("selected"),_.preventDefault()))},O.keyup=function(_){if(!O.options.searchByNode&&O.options.input)if(O.options.input.tagName==="DIV")var W=O.options.input.innerText;else var W=O.options.input.value;else{var oe=Y.getNode();if(oe)var W=oe.innerText}if(typeof O.options.onbeforesearch=="function"){var be=O.options.onbeforesearch(O,W);if(be)W=be;else if(be===!1)return}O(W)},O.blur=function(_){O.close()},O.options.input&&(O.options.input.addEventListener("keyup",O.keyup),O.options.input.addEventListener("keydown",O.keydown),O.options.input.addEventListener("blur",O.blur));var I=document.createElement("div");return I.classList.add("jsearch_container"),I.onmousedown=o,v.appendChild(I),v.classList.add("jsearch"),v.search=O,O}function ct(v,C){var l={};if(l.options={},l.currentImage=null,C&&(l.options=C),v.setAttribute("tabindex","900"),l.options.items=[],!v.classList.contains("jslider")){if(v.classList.add("jslider"),v.classList.add("unselectable"),l.options.height&&(v.style.minHeight=parseInt(l.options.height)+"px"),l.options.width&&(v.style.width=parseInt(l.options.width)+"px"),l.options.grid){v.classList.add("jslider-grid");var o=v.children.length;o>4&&v.setAttribute("data-total",o-4),v.setAttribute("data-number",o>4?4:o)}var k=document.createElement("div");if(k.classList.add("jslider-counter"),v.children.length>0)for(var Q=0;Q<v.children.length;Q++){l.options.items.push(v.children[Q]);var te=document.createElement("div");te.onclick=function(){var oe=Array.prototype.slice.call(k.children).indexOf(this);l.show(l.currentImage=l.options.items[oe])},k.appendChild(te)}var O=document.createElement("div");O.className="jslider-caption";var I=document.createElement("div"),_=document.createElement("div");_.className="jslider-close",_.innerHTML="",_.onclick=function(){l.close()},I.appendChild(O),I.appendChild(_)}l.updateCounter=function(oe){for(var be=0;be<k.children.length;be++)if(k.children[be].classList.contains("jslider-counter-focus")){k.children[be].classList.remove("jslider-counter-focus");break}k.children[oe].classList.add("jslider-counter-focus")},l.show=function(oe){if(!oe)var oe=v.children[0];v.classList.add("jslider-focus"),v.classList.remove("jslider-grid"),v.appendChild(I),v.appendChild(k);var be=l.options.items.indexOf(oe);l.updateCounter(be);for(var ue=0;ue<v.children.length;ue++)v.children[ue].style.display="";oe.style.display="block",oe.previousElementSibling?v.classList.add("jslider-left"):v.classList.remove("jslider-left"),oe.nextElementSibling&&oe.nextElementSibling.tagName=="IMG"?v.classList.add("jslider-right"):v.classList.remove("jslider-right"),l.currentImage=oe,l.currentImage.offsetHeight>l.currentImage.offsetWidth&&l.currentImage.classList.add("jslider-vertical"),I.children[0].innerText=l.currentImage.getAttribute("title")},l.open=function(){l.show(),typeof l.options.onopen=="function"&&l.options.onopen(v)},l.close=function(){v.classList.remove("jslider-focus"),v.classList.remove("jslider-left"),v.classList.remove("jslider-right"),l.options.grid&&v.classList.add("jslider-grid");for(var oe=0;oe<v.children.length;oe++)v.children[oe].style.display="";k.remove(),I.remove(),l.currentImage=null,typeof l.options.onclose=="function"&&l.options.onclose(v)},l.reset=function(){v.innerHTML=""},l.next=function(){var oe=l.currentImage.nextElementSibling;oe&&oe.tagName==="IMG"&&l.show(l.currentImage.nextElementSibling)},l.prev=function(){l.currentImage.previousElementSibling&&l.show(l.currentImage.previousElementSibling)};var W=function(oe){if(oe.target.tagName=="IMG")l.show(oe.target);else if(!oe.target.classList.contains("jslider-close")&&!(oe.target.parentNode.classList.contains("jslider-counter")||oe.target.classList.contains("jslider-counter"))){var be=oe.offsetX||oe.changedTouches[0].clientX;oe.target.clientWidth-be<40?l.next():be<40&&l.prev()}};return"ontouchend"in document.documentElement?v.addEventListener("touchend",W):v.addEventListener("mouseup",W),v.addEventListener("swipeleft",function(oe){l.next(),oe.preventDefault(),oe.stopPropagation()}),v.addEventListener("swiperight",function(oe){l.prev(),oe.preventDefault(),oe.stopPropagation()}),v.addEventListener("keydown",function(oe){oe.which==27&&l.close()}),v.slider=l,l}function ht(v,C){if(v.tags)return v.tags.setOptions(C,!0);var l={type:"tags"};l.options={};var o=function(){return!!(l.options.limit&&v.children.length>=l.options.limit)},k=null,Q=null;l.setOptions=function(he,Ee){var G={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var X in G)he&&he.hasOwnProperty(X)?l.options[X]=he[X]:(typeof l.options[X]=="undefined"||Ee===!0)&&(l.options[X]=G[X]);return l.options.placeholder?v.setAttribute("data-placeholder",l.options.placeholder):v.removeAttribute("data-placeholder"),v.placeholder=l.options.placeholder,l.setValue(l.options.value),_(),l.options.search?Q||(Q=document.createElement("div"),v.parentNode.insertBefore(Q,v.nextSibling),k=ft(Q,{data:l.options.search,onselect:function(re,A,S){l.selectIndex(A,S)}})):Q&&(k=null,Q.remove(),Q=null),l},l.add=function(he,Ee){if(typeof l.options.onbeforechange=="function"){var G=l.options.onbeforechange(v,l,l.options.value,he);if(G===!1)return!1;G!=null&&(he=G)}if(k&&k.close(),o())typeof l.options.onlimit=="function"?l.options.onlimit(l,l.options.limit):alert(P.translate("You reach the limit number of entries")+" "+l.options.limit);else{var X=Y.getNode();if(X&&X.parentNode&&X.parentNode.classList.contains("jtags")&&X.nextSibling&&!(X.nextSibling.innerText&&X.nextSibling.innerText.trim()))re=X.nextSibling;else{if(v.lastChild&&(v.lastChild.innerText.trim()||v.removeChild(v.lastChild)),!he||typeof he=="string")var re=O(he,he,X);else for(var A=0;A<=he.length;A++)if(!o()){if(!he[A]||typeof he[A]=="string")var S=he[A]||"",Z=null;else var S=he[A].text,Z=he[A].value;var re=O(S,Z)}I()}Ee&&te(re)}},l.setLimit=function(he){l.options.limit=he;for(var Ee=v.children.length-he;v.children.length>he;)v.removeChild(v.lastChild)},l.remove=function(he){he.parentNode.removeChild(he),v.children.length?I():l.add("",!0)},l.getData=function(){for(var he=[],Ee=0;Ee<v.children.length;Ee++){var G=v.children[Ee].innerText.replace(`
`,""),X=v.children[Ee].getAttribute("data-value");X||(X=G),(G||X)&&he.push({text:G,value:X})}return he},l.getValue=function(he){var Ee=null;if(he!=null)Ee=v.children[he].getAttribute("data-value"),Ee||(Ee=v.children[he].innerText.replace(`
`,""));else{for(var G=[],X=0;X<v.children.length;X++)Ee=v.children[X].innerText.replace(`
`,""),Ee&&G.push(l.getValue(X));Ee=G.join(",")}return Ee},l.setValue=function(he){if(!he)l.reset();else if(v.value!=he)if(Array.isArray(he))l.add(he);else{var Ee=(""+he).trim(),G=oe(Ee);v.innerHTML="",l.add(G)}},l.reset=function(){v.classList.add("jtags-empty"),v.innerHTML="<div></div>",I()},l.isValid=function(){for(var he=0,Ee=0;Ee<v.children.length;Ee++)v.children[Ee].classList.contains("jtags_error")&&he++;return he==0},l.selectIndex=function(he,Ee){var G=Y.getNode();G&&(G.innerText=he,Ee&&G.setAttribute("data-value",Ee),G.classList.remove("jtags_error"),o()||l.add("",!0))},l.search=function(he){var Ee=he.innerText},l.destroy=function(){v.removeEventListener("mouseup",je),v.removeEventListener("keydown",ue),v.removeEventListener("keyup",pe),v.removeEventListener("paste",le),v.removeEventListener("focus",Ce),v.removeEventListener("blur",qe),v.parentNode.removeChild(v)};var te=function(he){if(v.children.length){var Ee=document.createRange(),G=window.getSelection();if(!he)var he=v.childNodes[v.childNodes.length-1];Ee.setStart(he,he.length),Ee.collapse(!0),G.removeAllRanges(),G.addRange(Ee),v.scrollLeft=v.scrollWidth}},O=function(he,Ee,G){var X=document.createElement("div");return X.innerHTML=he||"",Ee&&X.setAttribute("data-value",Ee),G&&G.parentNode.classList.contains("jtags")?v.insertBefore(X,G.nextSibling):v.appendChild(X),X},I=function(){var he=l.getValue();he!=l.options.value&&(l.options.value=he,typeof l.options.onchange=="function"&&l.options.onchange(v,l,l.options.value),v.value!=l.options.value&&(v.value=l.options.value,typeof v.oninput=="function"&&v.oninput({type:"input",target:v,value:v.value}))),_()},_=function(){for(var he=0;he<v.children.length;he++)v.children[he].tagName==="DIV"&&(l.getValue(he)?(v.children[he].classList.add("jtags_label"),typeof l.options.validation=="function"&&l.getValue(he)?l.options.validation(v.children[he],v.children[he].innerText,v.children[he].getAttribute("data-value"))?v.children[he].classList.remove("jtags_error"):v.children[he].classList.add("jtags_error"):v.children[he].classList.remove("jtags_error")):v.children[he].classList.remove("jtags_label"));W()},W=function(){v.innerText.trim()?v.classList.remove("jtags-empty"):(!v.children.length||v.children[0].tagName==="BR")&&(v.innerHTML="",te(O()))},oe=function(he){var Ee=[],G="";if(he=he.trim(),he){for(var X=0;X<he.length;X++)he[X]==","||he[X]==";"||he[X]==`
`?G&&(Ee.push(G.trim()),G=""):G+=he[X];G&&Ee.push(G)}return Ee},be=0,ue=function(he){if(be=window.getSelection().anchorOffset,W(),he.key==="Tab"||he.key===";"||he.key===","){var Ee=window.getSelection().anchorOffset;Ee>1&&(o()?typeof l.options.onlimit=="function"&&l.options.onlimit(l,l.options.limit):l.add("",!0)),he.preventDefault()}else if(he.key=="Enter"){if(!k||!k.isOpened()){var Ee=window.getSelection().anchorOffset;Ee>1&&(o()||l.add("",!0)),he.preventDefault()}}else he.key=="Backspace"&&v.children.length==1&&window.getSelection().anchorOffset<1&&he.preventDefault();k&&k.keydown(he),W()},pe=function(he){if(he.which==39){var Ee=window.getSelection().anchorOffset;Ee>1&&Ee==be&&l.add("",!0)}else he.which==13||he.which==38||he.which==40?he.preventDefault():k&&k.keyup(he);_()},le=function(he){if(he.clipboardData||he.originalEvent.clipboardData)var Ee=(he.originalEvent||he).clipboardData.getData("text/plain");else if(window.clipboardData)var Ee=window.clipboardData.getData("Text");var G=oe(Ee);if(typeof l.options.onbeforepaste=="function"){var X=l.options.onbeforepaste(v,l,G);if(X===!1)return he.preventDefault(),!1;X&&(G=X)}G.length>1?(l.add(G,!0),he.preventDefault()):G[0]&&(document.execCommand("insertText",!1,G[0]),he.preventDefault())},je=function(he){if(he.target.parentNode&&he.target.parentNode.classList.contains("jtags")&&(he.target.classList.contains("jtags_label")||he.target.classList.contains("jtags_error"))){var Ee=he.target.getBoundingClientRect();Ee.width-(he.clientX-Ee.left)<16&&l.remove(he.target)}he.target==v&&te()},Ce=function(){v.classList.contains("jtags-focus")||((!v.children.length||l.getValue(v.children.length-1))&&(o()||O("")),typeof l.options.onfocus=="function"&&l.options.onfocus(v,l,l.getValue()),v.classList.add("jtags-focus"))},qe=function(){if(v.classList.contains("jtags-focus")){k&&k.close();for(var he=0;he<v.children.length-1;he++)l.getValue(he)||v.removeChild(v.children[he]);I(),v.classList.remove("jtags-focus"),typeof l.options.onblur=="function"&&l.options.onblur(v,l,l.getValue())}},Ze=function(){"touchend"in document.documentElement?v.addEventListener("touchend",je):v.addEventListener("mouseup",je),v.addEventListener("keydown",ue),v.addEventListener("keyup",pe),v.addEventListener("paste",le),v.addEventListener("focus",Ce),v.addEventListener("blur",qe),v.setAttribute("contenteditable",!0),v.classList.add("jtags"),l.setOptions(C),typeof l.options.onload=="function"&&l.options.onload(v,l),v.change=l.setValue,v.val=function(he){if(he===void 0)return l.getValue();l.setValue(he)},v.tags=l};return Ze(),l}function vt(v,C){var l={};l.options={};var o={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var k in o)C&&C.hasOwnProperty(k)?l.options[k]=C[k]:l.options[k]=o[k];l.options.multiple==!0&&v.setAttribute("data-multiple",!0),v.content=[],v.classList.add("jupload"),l.options.input==!0&&v.classList.add("input"),l.add=function(_){if(l.options.multiple==!1&&(v.content=[],v.innerText=""),l.options.type=="image"){var W=document.createElement("img");W.setAttribute("src",_.file),W.setAttribute("tabindex",-1),v.getAttribute("name")||(W.className="jfile",W.content=_),v.appendChild(W)}else{if(_.name)var oe=_.name;else var oe=_.file;var be=document.createElement("div");be.innerText=oe||l.options.type,be.classList.add("jupload-item"),be.setAttribute("tabindex",-1),v.appendChild(be)}_.content&&(_.file=Y.guid()),v.content.push(_),typeof l.options.onchange=="function"&&l.options.onchange(v,_)},l.addFromFile=function(_){var W=_.type.split("/");if(W[0]==l.options.type){var oe=new FileReader;oe.addEventListener("load",function(be){var ue={file:be.srcElement.result,extension:_.name.substr(_.name.lastIndexOf(".")+1),name:_.name,size:_.size,lastmodified:_.lastModified,content:be.srcElement.result};l.add(ue)}),oe.readAsDataURL(_)}else alert(P.translate("This extension is not allowed"))},l.addFromUrl=function(_){if(_.substr(0,4)!="data"&&!l.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(_.substr(0,4)=="data"){var W=_.split(";");W=W[0].split("/");var oe=W[0].replace("data:","");if(oe==l.options.type){var be={file:_,name:"",extension:W[1],content:_};l.add(be)}else alert(l.options.text.extensionNotAllowed)}else{var W=_.substr(_.lastIndexOf(".")+1);_=l.options.remoteParser+_,w({url:_,type:"GET",dataType:"blob",success:function(pe){}})}};var Q=function(_,W){for(var oe=.92,be=null,ue=_.toDataURL(W,oe);l.options.maxJpegSizeBytes&&W==="image/jpeg"&&ue.length>l.options.maxJpegSizeBytes&&ue.length!==be;)oe*=.9,be=ue.length,ue=_.toDataURL(W,oe);return ue},te=l.options.type+"/"+l.options.extension,O=document.createElement("input");O.type="file",O.setAttribute("accept",te),O.onchange=function(){for(var _=0;_<this.files.length;_++)l.addFromFile(this.files[_])},l.options.multiple==!0&&O.setAttribute("multiple",!0);var I=null;return v.addEventListener("click",function(_){I=null,!v.children.length||_.target===v?Y.click(O):_.target.parentNode==v&&(I=_.target)}),v.addEventListener("dblclick",function(_){Y.click(O)}),v.addEventListener("dragenter",function(_){v.style.border="1px dashed #000"}),v.addEventListener("dragleave",function(_){v.style.border="1px solid #eee"}),v.addEventListener("dragstop",function(_){v.style.border="1px solid #eee"}),v.addEventListener("dragover",function(_){_.preventDefault()}),v.addEventListener("keydown",function(_){if(I&&_.which==46){var W=Array.prototype.indexOf.call(v.children,I);W>=0&&(v.content.splice(W,1),I.remove(),I=null)}}),v.addEventListener("drop",function(_){_.preventDefault(),_.stopPropagation();var W=(_.originalEvent||_).dataTransfer.getData("text/html"),oe=(_.originalEvent||_).dataTransfer.files;if(oe.length)for(var be=0;be<_.dataTransfer.files.length;be++)l.addFromFile(_.dataTransfer.files[be]);else if(W){l.options.multiple==!1&&(v.innerText="");var ue=document.createElement("div");ue.innerHTML=W;var pe=ue.querySelectorAll("img");if(pe.length)for(var be=0;be<pe.length;be++)l.addFromUrl(pe[be].src)}return v.style.border="1px solid #eee",!1}),v.val=function(_){if(_===void 0)return v.content&&v.content.length?v.content:null;if(v.innerText="",v.content=[],_)if(Array.isArray(_))for(var W=0;W<_.length;W++)typeof _[W]=="string"?l.add({file:_[W]}):l.add(_[W]);else typeof _=="string"&&l.add({file:_})},v.upload=v.image=l,l}var mt=f(195),St=f.n(mt),gt=pn(Qt(Qt({},P),Y),{version:"5.0.27",setExtensions:function(v){if(typeof v=="object")for(var C=Object.keys(v),l=0;l<C.length;l++)gt[C[l]]=v[C[l]]},tracking:g,path:u,sorting:m,lazyLoading:b,ajax:w,animation:N,calendar:F,color:ge,contextmenu:xe,dropdown:ve,editor:Ue,floating:lt,form:Se,mask:H,modal:Oe,notification:Ke,palette:q,picker:ie,progressbar:Je,rating:ut,search:ft,slider:ct,tabs:ae,tags:ht,toolbar:Ye,upload:vt,validations:Me});gt.image=vt,gt.image.create=function(v){var C=document.createElement("img");return C.setAttribute("src",v.file),C.className="jfile",C.setAttribute("tabindex",-1),C.content=v,C},gt.tracker=Se,gt.loading=N.loading,gt.sha512=St();const Nt=function(){document.jsuitesComponents=[];const v=function(le,je){return le[je.type]&&le[je.type]==je||le.component&&le.component==je?!0:le.parentNode?v(le.parentNode,je):!1},C=function(le){if(document.jsuitesComponents&&document.jsuitesComponents.length>0)for(var je=0;je<document.jsuitesComponents.length;je++)document.jsuitesComponents[je]&&!v(le,document.jsuitesComponents[je])&&document.jsuitesComponents[je].close()};let l=15,o=null,k=!1,Q={x:null,y:null},te=document.createElement("div");te.classList.add("jtooltip");const O=function(le){var je=gt.findElement(le.target,"jpanel");if(je&&!je.classList.contains("readonly")){je.focus();var Ce=le.target.getBoundingClientRect();k={e:je,x:le.clientX,y:le.clientY,w:Ce.width,h:Ce.height,d:je.style.cursor,resizing:!!je.style.cursor,actioned:!1},je.style.width||(je.style.width=Ce.width+"px"),je.style.height||(je.style.height=Ce.height+"px");var qe=window.getSelection();if(qe.rangeCount)for(var Ze=0;Ze<qe.rangeCount;Ze++)qe.removeRange(qe.getRangeAt(Ze));le.preventDefault(),le.stopPropagation()}else k=!1;if(le.changedTouches&&le.changedTouches[0])var he=le.changedTouches[0].clientX,Ee=le.changedTouches[0].clientY;else var he=le.clientX,Ee=le.clientY;var G=le.path||le.composedPath&&le.composedPath();if(G)o=G[0];else{if(le.target&&le.target.shadowRoot)var X=le.target.shadowRoot;else var X=document;o=X.elementFromPoint(he,Ee)}C(o)},I=function(le){k&&k.e&&(typeof k.e.refresh=="function"&&Q.actioned&&k.e.refresh(),k.e.style.cursor=""),Q={x:null,y:null},k=!1},_=function(le){if(k){var je=le.clientX||le.pageX,Ce=le.clientY||le.pageY;if(k.resizing){var G=null,X=null;if(k.d=="e-resize"||k.d=="ne-resize"||k.d=="se-resize")if(G=k.w+(je-k.x),k.e.style.width=G+"px",le.shiftKey){var re=(je-k.x)*(k.h/k.w);X=k.h+re,k.e.style.height=X+"px"}else var re=!1;re||(k.d=="s-resize"||k.d=="se-resize"||k.d=="sw-resize")&&(X=k.h+(Ce-k.y),k.e.style.height=X+"px"),typeof k.e.refresh=="function"&&(Q.actioned=!0,k.e.refresh("dimensions",G,X))}else{Q.x==null&&Q.y==null&&(Q.x=je,Q.y=Ce);var qe=je-Q.x,Ze=Ce-Q.y,he=k.e.offsetTop+Ze,Ee=k.e.offsetLeft+qe;k.e.style.top=he+"px",k.e.style.left=Ee+"px",k.e.style.cursor="move",Q.x=je,Q.y=Ce,typeof k.e.refresh=="function"&&(Q.actioned=!0,k.e.refresh("position",he,Ee))}}else{var A=gt.findElement(le.target,"jpanel");if(A&&A.getAttribute("tabindex")){var S=A.getBoundingClientRect();le.clientY-S.top<l?S.width-(le.clientX-S.left)<l?A.style.cursor="ne-resize":le.clientX-S.left<l?A.style.cursor="nw-resize":A.style.cursor="n-resize":S.height-(le.clientY-S.top)<l?S.width-(le.clientX-S.left)<l?A.style.cursor="se-resize":le.clientX-S.left<l?A.style.cursor="sw-resize":A.style.cursor="s-resize":S.width-(le.clientX-S.left)<l?A.style.cursor="e-resize":le.clientX-S.left<l?A.style.cursor="w-resize":A.style.cursor=""}}},W=function(le){var je=le.target.getAttribute("data-tooltip");if(je){if(te.innerText=je,le.changedTouches&&le.changedTouches[0])var Ce=le.changedTouches[0].clientX,qe=le.changedTouches[0].clientY;else var Ce=le.clientX,qe=le.clientY;te.style.top=qe+"px",te.style.left=Ce+"px",document.body.appendChild(te)}else te.innerText&&(te.innerText="",document.body.removeChild(te))},oe=function(le){var je=gt.findElement(le.target,"jpanel");je&&typeof je.dblclick=="function"&&je.dblclick(le)},be=function(le){var je=document.activeElement;if(je&&typeof je.contextmenu=="function")je.contextmenu(le),le.preventDefault(),le.stopImmediatePropagation();else if(je=gt.findElement(le.target,function(qe){return qe.tagName&&qe.getAttribute("aria-contextmenu-id")}),je){var Ce=document.querySelector("#"+je);Ce?(Ce.contextmenu.open(le),le.preventDefault(),le.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+je)}},ue=function(le){let je=document.activeElement;je&&le.key==="Delete"&&typeof je.delete=="function"&&(je.delete(),le.preventDefault(),le.stopImmediatePropagation()),document.jsuitesComponents&&document.jsuitesComponents.length&&(je=document.jsuitesComponents[document.jsuitesComponents.length-1],je&&le.key==="Escape"&&typeof je.isOpened=="function"&&typeof je.close=="function"&&je.isOpened()&&(je.close(),le.preventDefault(),le.stopImmediatePropagation()))},pe=function(le){(le.target.getAttribute("data-mask")||le.target.mask)&&gt.mask(le)};document.addEventListener("mouseup",I),document.addEventListener("mousedown",O),document.addEventListener("mousemove",_),document.addEventListener("mouseover",W),document.addEventListener("dblclick",oe),document.addEventListener("keydown",ue),document.addEventListener("contextmenu",be),document.addEventListener("input",pe)};typeof document!="undefined"&&!document.jsuitesComponents&&Nt();var Ft=gt}(),E=E.default,E}()})}}]);
}());