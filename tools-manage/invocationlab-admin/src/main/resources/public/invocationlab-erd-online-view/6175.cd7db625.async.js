var Io=Object.defineProperty,Do=Object.defineProperties;var So=Object.getOwnPropertyDescriptors;var dn=Object.getOwnPropertySymbols;var Fo=Object.prototype.hasOwnProperty,Oo=Object.prototype.propertyIsEnumerable;var fn=(n,s,d)=>s in n?Io(n,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):n[s]=d,Qt=(n,s)=>{for(var d in s||(s={}))Fo.call(s,d)&&fn(n,d,s[d]);if(dn)for(var d of dn(s))Oo.call(s,d)&&fn(n,d,s[d]);return n},pn=(n,s)=>Do(n,So(s));(self.webpackChunkInvocationlab_ERD_Online=self.webpackChunkInvocationlab_ERD_Online||[]).push([[6175],{23744:function(){"use strict"},41929:function(){"use strict"},85455:function(){"use strict"},4444:function(module,__unused_webpack_exports,__webpack_require__){if(!jSuites)var jSuites=__webpack_require__(2699);(function(n,s){module.exports=s()})(self,function(){return function(){var __webpack_modules__={243:function(n){var s;n.exports=(function(){var d={765:function(P,c){var a;a=function(j){j.version="1.0.2";var O=Math;function B(be,ae){for(var Ve=0,Ge=0;Ve<be.length;++Ve)Ge=ae*Ge+be[Ve];return Ge}function g(be,ae,Ve,Ge,Ye){if(ae===0)return Ve;if(ae===1)return Ge;for(var He=2/be,lt=Ge,U=1;U<ae;++U)lt=Ge*U*He+Ye*Ve,Ve=Ge,Ge=lt;return lt}function u(be,ae,Ve,Ge,Ye){return function(He,lt){if(Ge){if(He===0)return Ge==1?-1/0:1/0;if(He<0)return NaN}return lt===0?be(He):lt===1?ae(He):lt<0?NaN:g(He,lt|=0,be(He),ae(He),Ye)}}var m,b,h,w,N,T,_,k,M,D,Z,Y,se,he=function(){var be=.636619772,ae=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Ve=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),Ge=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Ye=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function He(Te){var Fe=0,_e=0,Ke=0,Je=Te*Te;if(Te<8)Fe=(_e=B(ae,Je))/(Ke=B(Ve,Je));else{var ut=Te-.785398164;_e=B(Ge,Je=64/Je),Ke=B(Ye,Je),Fe=O.sqrt(be/Te)*(O.cos(ut)*_e-O.sin(ut)*Ke*8/Te)}return Fe}var lt=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),U=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Le=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),qe=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function De(Te){var Fe=0,_e=0,Ke=0,Je=Te*Te,ut=O.abs(Te)-2.356194491;return Math.abs(Te)<8?Fe=(_e=Te*B(lt,Je))/(Ke=B(U,Je)):(_e=B(Le,Je=64/Je),Ke=B(qe,Je),Fe=O.sqrt(be/O.abs(Te))*(O.cos(ut)*_e-O.sin(ut)*Ke*8/O.abs(Te)),Te<0&&(Fe=-Fe)),Fe}return function Te(Fe,_e){if(_e=Math.round(_e),!isFinite(Fe))return isNaN(Fe)?Fe:0;if(_e<0)return(_e%2?-1:1)*Te(Fe,-_e);if(Fe<0)return(_e%2?-1:1)*Te(-Fe,_e);if(_e===0)return He(Fe);if(_e===1)return De(Fe);if(Fe===0)return 0;var Ke=0;if(Fe>_e)Ke=g(Fe,_e,He(Fe),De(Fe),-1);else{for(var Je=!1,ut=0,ft=0,ct=1,ht=0,vt=2/Fe,gt=2*O.floor((_e+O.floor(O.sqrt(40*_e)))/2);gt>0;gt--)ht=gt*vt*ct-ut,ut=ct,ct=ht,O.abs(ct)>1e10&&(ct*=1e-10,ut*=1e-10,Ke*=1e-10,ft*=1e-10),Je&&(ft+=ct),Je=!Je,gt==_e&&(Ke=ut);Ke/=ft=2*ft-ct}return Ke}}(),le=(m=.636619772,b=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),h=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),w=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),N=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),T=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),_=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),k=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),M=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),u(function(be){var ae=0,Ve=0,Ge=0,Ye=be*be,He=be-.785398164;return be<8?ae=(Ve=B(b,Ye))/(Ge=B(h,Ye))+m*he(be,0)*O.log(be):(Ve=B(w,Ye=64/Ye),Ge=B(N,Ye),ae=O.sqrt(m/be)*(O.sin(He)*Ve+O.cos(He)*Ge*8/be)),ae},function(be){var ae=0,Ve=0,Ge=0,Ye=be*be,He=be-2.356194491;return be<8?ae=(Ve=be*B(T,Ye))/(Ge=B(_,Ye))+m*(he(be,1)*O.log(be)-1/be):(Ve=B(k,Ye=64/Ye),Ge=B(M,Ye),ae=O.sqrt(m/be)*(O.sin(He)*Ve+O.cos(He)*Ge*8/be)),ae},0,1,-1)),xe=(D=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),Z=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),Y=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),se=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function be(ae,Ve){if((Ve=Math.round(Ve))===0)return function(qe){return qe<=3.75?B(D,qe*qe/14.0625):O.exp(O.abs(qe))/O.sqrt(O.abs(qe))*B(Z,3.75/O.abs(qe))}(ae);if(Ve===1)return function(qe){return qe<3.75?qe*B(Y,qe*qe/14.0625):(qe<0?-1:1)*O.exp(O.abs(qe))/O.sqrt(O.abs(qe))*B(se,3.75/O.abs(qe))}(ae);if(Ve<0)return NaN;if(O.abs(ae)===0)return 0;if(ae==1/0)return 1/0;var Ge,Ye=0,He=2/O.abs(ae),lt=0,U=1,Le=0;for(Ge=2*O.round((Ve+O.round(O.sqrt(40*Ve)))/2);Ge>0;Ge--)Le=Ge*He*U+lt,lt=U,U=Le,O.abs(U)>1e10&&(U*=1e-10,lt*=1e-10,Ye*=1e-10),Ge==Ve&&(Ye=lt);return Ye*=be(ae,0)/U,ae<0&&Ve%2?-Ye:Ye}),Ae=function(){var be=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),ae=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Ve=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),Ge=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return u(function(Ye){return Ye<=2?-O.log(Ye/2)*xe(Ye,0)+B(be,Ye*Ye/4):O.exp(-Ye)/O.sqrt(Ye)*B(ae,2/Ye)},function(Ye){return Ye<=2?O.log(Ye/2)*xe(Ye,1)+1/Ye*B(Ve,Ye*Ye/4):O.exp(-Ye)/O.sqrt(Ye)*B(Ge,2/Ye)},0,2,1)}();j.besselj=he,j.bessely=le,j.besseli=xe,j.besselk=Ae},a(typeof DO_NOT_EXPORT_BESSEL=="undefined"?c:{})},162:function(P){var c;P.exports=(c=function(a,j){var O=Array.prototype.concat,B=Array.prototype.slice,g=Object.prototype.toString;function u(M,D){var Z=M>D?M:D;return a.pow(10,17-~~(a.log(Z>0?Z:-Z)*a.LOG10E))}var m=Array.isArray||function(M){return g.call(M)==="[object Array]"};function b(M){return g.call(M)==="[object Function]"}function h(M){return typeof M=="number"&&M-M==0}function w(){return new w._init(arguments)}function N(){return 0}function T(){return 1}function _(M,D){return M===D?1:0}w.fn=w.prototype,w._init=function(M){if(m(M[0]))if(m(M[0][0])){b(M[1])&&(M[0]=w.map(M[0],M[1]));for(var D=0;D<M[0].length;D++)this[D]=M[0][D];this.length=M[0].length}else this[0]=b(M[1])?w.map(M[0],M[1]):M[0],this.length=1;else if(h(M[0]))this[0]=w.seq.apply(null,M),this.length=1;else{if(M[0]instanceof w)return w(M[0].toArray());this[0]=[],this.length=1}return this},w._init.prototype=w.prototype,w._init.constructor=w,w.utils={calcRdx:u,isArray:m,isFunction:b,isNumber:h,toVector:function(M){return O.apply([],M)}},w._random_fn=a.random,w.setRandom=function(M){if(typeof M!="function")throw new TypeError("fn is not a function");w._random_fn=M},w.extend=function(M){var D,Z;if(arguments.length===1){for(Z in M)w[Z]=M[Z];return this}for(D=1;D<arguments.length;D++)for(Z in arguments[D])M[Z]=arguments[D][Z];return M},w.rows=function(M){return M.length||1},w.cols=function(M){return M[0].length||1},w.dimensions=function(M){return{rows:w.rows(M),cols:w.cols(M)}},w.row=function(M,D){return m(D)?D.map(function(Z){return w.row(M,Z)}):M[D]},w.rowa=function(M,D){return w.row(M,D)},w.col=function(M,D){if(m(D)){var Z=w.arange(M.length).map(function(){return new Array(D.length)});return D.forEach(function(he,le){w.arange(M.length).forEach(function(xe){Z[xe][le]=M[xe][he]})}),Z}for(var Y=new Array(M.length),se=0;se<M.length;se++)Y[se]=[M[se][D]];return Y},w.cola=function(M,D){return w.col(M,D).map(function(Z){return Z[0]})},w.diag=function(M){for(var D=w.rows(M),Z=new Array(D),Y=0;Y<D;Y++)Z[Y]=[M[Y][Y]];return Z},w.antidiag=function(M){for(var D=w.rows(M)-1,Z=new Array(D),Y=0;D>=0;D--,Y++)Z[Y]=[M[Y][D]];return Z},w.transpose=function(M){var D,Z,Y,se,he,le=[];for(m(M[0])||(M=[M]),Z=M.length,Y=M[0].length,he=0;he<Y;he++){for(D=new Array(Z),se=0;se<Z;se++)D[se]=M[se][he];le.push(D)}return le.length===1?le[0]:le},w.map=function(M,D,Z){var Y,se,he,le,xe;for(m(M[0])||(M=[M]),se=M.length,he=M[0].length,le=Z?M:new Array(se),Y=0;Y<se;Y++)for(le[Y]||(le[Y]=new Array(he)),xe=0;xe<he;xe++)le[Y][xe]=D(M[Y][xe],Y,xe);return le.length===1?le[0]:le},w.cumreduce=function(M,D,Z){var Y,se,he,le,xe;for(m(M[0])||(M=[M]),se=M.length,he=M[0].length,le=Z?M:new Array(se),Y=0;Y<se;Y++)for(le[Y]||(le[Y]=new Array(he)),he>0&&(le[Y][0]=M[Y][0]),xe=1;xe<he;xe++)le[Y][xe]=D(le[Y][xe-1],M[Y][xe]);return le.length===1?le[0]:le},w.alter=function(M,D){return w.map(M,D,!0)},w.create=function(M,D,Z){var Y,se,he=new Array(M);for(b(D)&&(Z=D,D=M),Y=0;Y<M;Y++)for(he[Y]=new Array(D),se=0;se<D;se++)he[Y][se]=Z(Y,se);return he},w.zeros=function(M,D){return h(D)||(D=M),w.create(M,D,N)},w.ones=function(M,D){return h(D)||(D=M),w.create(M,D,T)},w.rand=function(M,D){return h(D)||(D=M),w.create(M,D,w._random_fn)},w.identity=function(M,D){return h(D)||(D=M),w.create(M,D,_)},w.symmetric=function(M){var D,Z,Y=M.length;if(M.length!==M[0].length)return!1;for(D=0;D<Y;D++)for(Z=0;Z<Y;Z++)if(M[Z][D]!==M[D][Z])return!1;return!0},w.clear=function(M){return w.alter(M,N)},w.seq=function(M,D,Z,Y){b(Y)||(Y=!1);var se,he=[],le=u(M,D),xe=(D*le-M*le)/((Z-1)*le),Ae=M;for(se=0;Ae<=D&&se<Z;Ae=(M*le+xe*le*++se)/le)he.push(Y?Y(Ae,se):Ae);return he},w.arange=function(M,D,Z){var Y,se=[];if(Z=Z||1,D===j&&(D=M,M=0),M===D||Z===0)return[];if(M<D&&Z<0)return[];if(M>D&&Z>0)return[];if(Z>0)for(Y=M;Y<D;Y+=Z)se.push(Y);else for(Y=M;Y>D;Y+=Z)se.push(Y);return se},w.slice=function(){function M(D,Z,Y,se){var he,le=[],xe=D.length;if(Z===j&&Y===j&&se===j)return w.copy(D);if(se=se||1,(Z=(Z=Z||0)>=0?Z:xe+Z)===(Y=(Y=Y||D.length)>=0?Y:xe+Y)||se===0)return[];if(Z<Y&&se<0)return[];if(Z>Y&&se>0)return[];if(se>0)for(he=Z;he<Y;he+=se)le.push(D[he]);else for(he=Z;he>Y;he+=se)le.push(D[he]);return le}return function(D,Z){var Y,se;return h((Z=Z||{}).row)?h(Z.col)?D[Z.row][Z.col]:M(w.rowa(D,Z.row),(Y=Z.col||{}).start,Y.end,Y.step):h(Z.col)?M(w.cola(D,Z.col),(se=Z.row||{}).start,se.end,se.step):(se=Z.row||{},Y=Z.col||{},M(D,se.start,se.end,se.step).map(function(he){return M(he,Y.start,Y.end,Y.step)}))}}(),w.sliceAssign=function(M,D,Z){var Y,se;if(h(D.row)){if(h(D.col))return M[D.row][D.col]=Z;D.col=D.col||{},D.col.start=D.col.start||0,D.col.end=D.col.end||M[0].length,D.col.step=D.col.step||1,Y=w.arange(D.col.start,a.min(M.length,D.col.end),D.col.step);var he=D.row;return Y.forEach(function(xe,Ae){M[he][xe]=Z[Ae]}),M}if(h(D.col)){D.row=D.row||{},D.row.start=D.row.start||0,D.row.end=D.row.end||M.length,D.row.step=D.row.step||1,se=w.arange(D.row.start,a.min(M[0].length,D.row.end),D.row.step);var le=D.col;return se.forEach(function(xe,Ae){M[xe][le]=Z[Ae]}),M}return Z[0].length===j&&(Z=[Z]),D.row.start=D.row.start||0,D.row.end=D.row.end||M.length,D.row.step=D.row.step||1,D.col.start=D.col.start||0,D.col.end=D.col.end||M[0].length,D.col.step=D.col.step||1,se=w.arange(D.row.start,a.min(M.length,D.row.end),D.row.step),Y=w.arange(D.col.start,a.min(M[0].length,D.col.end),D.col.step),se.forEach(function(xe,Ae){Y.forEach(function(be,ae){M[xe][be]=Z[Ae][ae]})}),M},w.diagonal=function(M){var D=w.zeros(M.length,M.length);return M.forEach(function(Z,Y){D[Y][Y]=Z}),D},w.copy=function(M){return M.map(function(D){return h(D)?D:D.map(function(Z){return Z})})};var k=w.prototype;return k.length=0,k.push=Array.prototype.push,k.sort=Array.prototype.sort,k.splice=Array.prototype.splice,k.slice=Array.prototype.slice,k.toArray=function(){return this.length>1?B.call(this):B.call(this)[0]},k.map=function(M,D){return w(w.map(this,M,D))},k.cumreduce=function(M,D){return w(w.cumreduce(this,M,D))},k.alter=function(M){return w.alter(this,M),this},function(M){for(var D=0;D<M.length;D++)(function(Z){k[Z]=function(Y){var se,he=this;return Y?(setTimeout(function(){Y.call(he,k[Z].call(he))}),this):(se=w[Z](this),m(se)?w(se):se)}})(M[D])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(M){for(var D=0;D<M.length;D++)(function(Z){k[Z]=function(Y,se){var he=this;return se?(setTimeout(function(){se.call(he,k[Z].call(he,Y))}),this):w(w[Z](this,Y))}})(M[D])}("row col".split(" ")),function(M){for(var D=0;D<M.length;D++)(function(Z){k[Z]=function(){return w(w[Z].apply(null,arguments))}})(M[D])}("create zeros ones rand identity".split(" ")),w}(Math),function(a,j){var O=a.utils.isFunction;function B(m,b){return m-b}function g(m,b,h){return j.max(b,j.min(m,h))}a.sum=function(m){for(var b=0,h=m.length;--h>=0;)b+=m[h];return b},a.sumsqrd=function(m){for(var b=0,h=m.length;--h>=0;)b+=m[h]*m[h];return b},a.sumsqerr=function(m){for(var b,h=a.mean(m),w=0,N=m.length;--N>=0;)w+=(b=m[N]-h)*b;return w},a.sumrow=function(m){for(var b=0,h=m.length;--h>=0;)b+=m[h];return b},a.product=function(m){for(var b=1,h=m.length;--h>=0;)b*=m[h];return b},a.min=function(m){for(var b=m[0],h=0;++h<m.length;)m[h]<b&&(b=m[h]);return b},a.max=function(m){for(var b=m[0],h=0;++h<m.length;)m[h]>b&&(b=m[h]);return b},a.unique=function(m){for(var b={},h=[],w=0;w<m.length;w++)b[m[w]]||(b[m[w]]=!0,h.push(m[w]));return h},a.mean=function(m){return a.sum(m)/m.length},a.meansqerr=function(m){return a.sumsqerr(m)/m.length},a.geomean=function(m){var b=m.map(j.log),h=a.mean(b);return j.exp(h)},a.median=function(m){var b=m.length,h=m.slice().sort(B);return 1&b?h[b/2|0]:(h[b/2-1]+h[b/2])/2},a.cumsum=function(m){return a.cumreduce(m,function(b,h){return b+h})},a.cumprod=function(m){return a.cumreduce(m,function(b,h){return b*h})},a.diff=function(m){var b,h=[],w=m.length;for(b=1;b<w;b++)h.push(m[b]-m[b-1]);return h},a.rank=function(m){var b,h=[],w={};for(b=0;b<m.length;b++)w[k=m[b]]?w[k]++:(w[k]=1,h.push(k));var N=h.sort(B),T={},_=1;for(b=0;b<N.length;b++){var k,M=w[k=N[b]],D=(_+(_+M-1))/2;T[k]=D,_+=M}return m.map(function(Z){return T[Z]})},a.mode=function(m){var b,h=m.length,w=m.slice().sort(B),N=1,T=0,_=0,k=[];for(b=0;b<h;b++)w[b]===w[b+1]?N++:(N>T?(k=[w[b]],T=N,_=0):N===T&&(k.push(w[b]),_++),N=1);return _===0?k[0]:k},a.range=function(m){return a.max(m)-a.min(m)},a.variance=function(m,b){return a.sumsqerr(m)/(m.length-(b?1:0))},a.pooledvariance=function(m){return m.reduce(function(b,h){return b+a.sumsqerr(h)},0)/(m.reduce(function(b,h){return b+h.length},0)-m.length)},a.deviation=function(m){for(var b=a.mean(m),h=m.length,w=new Array(h),N=0;N<h;N++)w[N]=m[N]-b;return w},a.stdev=function(m,b){return j.sqrt(a.variance(m,b))},a.pooledstdev=function(m){return j.sqrt(a.pooledvariance(m))},a.meandev=function(m){for(var b=a.mean(m),h=[],w=m.length-1;w>=0;w--)h.push(j.abs(m[w]-b));return a.mean(h)},a.meddev=function(m){for(var b=a.median(m),h=[],w=m.length-1;w>=0;w--)h.push(j.abs(m[w]-b));return a.median(h)},a.coeffvar=function(m){return a.stdev(m)/a.mean(m)},a.quartiles=function(m){var b=m.length,h=m.slice().sort(B);return[h[j.round(b/4)-1],h[j.round(b/2)-1],h[j.round(3*b/4)-1]]},a.quantiles=function(m,b,h,w){var N,T,_,k,M,D=m.slice().sort(B),Z=[b.length],Y=m.length;for(h===void 0&&(h=.375),w===void 0&&(w=.375),N=0;N<b.length;N++)_=Y*(T=b[N])+(h+T*(1-h-w)),k=j.floor(g(_,1,Y-1)),M=g(_-k,0,1),Z[N]=(1-M)*D[k-1]+M*D[k];return Z},a.percentile=function(m,b,h){var w=m.slice().sort(B),N=b*(w.length+(h?1:-1))+(h?0:1),T=parseInt(N),_=N-T;return T+1<w.length?w[T-1]+_*(w[T]-w[T-1]):w[T-1]},a.percentileOfScore=function(m,b,h){var w,N,T=0,_=m.length,k=!1;for(h==="strict"&&(k=!0),N=0;N<_;N++)w=m[N],(k&&w<b||!k&&w<=b)&&T++;return T/_},a.histogram=function(m,b){b=b||4;var h,w=a.min(m),N=(a.max(m)-w)/b,T=m.length,_=[];for(h=0;h<b;h++)_[h]=0;for(h=0;h<T;h++)_[j.min(j.floor((m[h]-w)/N),b-1)]+=1;return _},a.covariance=function(m,b){var h,w=a.mean(m),N=a.mean(b),T=m.length,_=new Array(T);for(h=0;h<T;h++)_[h]=(m[h]-w)*(b[h]-N);return a.sum(_)/(T-1)},a.corrcoeff=function(m,b){return a.covariance(m,b)/a.stdev(m,1)/a.stdev(b,1)},a.spearmancoeff=function(m,b){return m=a.rank(m),b=a.rank(b),a.corrcoeff(m,b)},a.stanMoment=function(m,b){for(var h=a.mean(m),w=a.stdev(m),N=m.length,T=0,_=0;_<N;_++)T+=j.pow((m[_]-h)/w,b);return T/m.length},a.skewness=function(m){return a.stanMoment(m,3)},a.kurtosis=function(m){return a.stanMoment(m,4)-3};var u=a.prototype;(function(m){for(var b=0;b<m.length;b++)(function(h){u[h]=function(w,N){var T=[],_=0,k=this;if(O(w)&&(N=w,w=!1),N)return setTimeout(function(){N.call(k,u[h].call(k,w))}),this;if(this.length>1){for(k=w===!0?this:this.transpose();_<k.length;_++)T[_]=a[h](k[_]);return T}return a[h](this[0],w)}})(m[b])})("cumsum cumprod".split(" ")),function(m){for(var b=0;b<m.length;b++)(function(h){u[h]=function(w,N){var T=[],_=0,k=this;if(O(w)&&(N=w,w=!1),N)return setTimeout(function(){N.call(k,u[h].call(k,w))}),this;if(this.length>1){for(h!=="sumrow"&&(k=w===!0?this:this.transpose());_<k.length;_++)T[_]=a[h](k[_]);return w===!0?a[h](a.utils.toVector(T)):T}return a[h](this[0],w)}})(m[b])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(m){for(var b=0;b<m.length;b++)(function(h){u[h]=function(){var w,N=[],T=0,_=this,k=Array.prototype.slice.call(arguments);if(O(k[k.length-1])){w=k[k.length-1];var M=k.slice(0,k.length-1);return setTimeout(function(){w.call(_,u[h].apply(_,M))}),this}w=void 0;var D=function(Z){return a[h].apply(_,[Z].concat(k))};if(this.length>1){for(_=_.transpose();T<_.length;T++)N[T]=D(_[T]);return N}return D(this[0])}})(m[b])}("quantiles percentileOfScore".split(" "))}(c,Math),function(a,j){a.gammaln=function(O){var B,g,u,m=0,b=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],h=1.000000000190015;for(u=(g=B=O)+5.5,u-=(B+.5)*j.log(u);m<6;m++)h+=b[m]/++g;return j.log(2.5066282746310007*h/B)-u},a.loggam=function(O){var B,g,u,m,b,h,w,N=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(B=O,w=0,O==1||O==2)return 0;for(O<=7&&(B=O+(w=j.floor(7-O))),g=1/(B*B),u=2*j.PI,b=N[9],h=8;h>=0;h--)b*=g,b+=N[h];if(m=b/B+.5*j.log(u)+(B-.5)*j.log(B)-B,O<=7)for(h=1;h<=w;h++)m-=j.log(B-1),B-=1;return m},a.gammafn=function(O){var B,g,u,m,b=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],w=!1,N=0,T=0,_=0,k=O;if(O>171.6243769536076)return 1/0;if(k<=0){if(!(m=k%1+36e-17))return 1/0;w=(1&k?-1:1)*j.PI/j.sin(j.PI*m),k=1-k}for(u=k,g=k<1?k++:(k-=N=(0|k)-1)-1,B=0;B<8;++B)_=(_+b[B])*g,T=T*g+h[B];if(m=_/T+1,u<k)m/=u;else if(u>k)for(B=0;B<N;++B)m*=k,k++;return w&&(m=w/m),m},a.gammap=function(O,B){return a.lowRegGamma(O,B)*a.gammafn(O)},a.lowRegGamma=function(O,B){var g,u=a.gammaln(O),m=O,b=1/O,h=b,w=B+1-O,N=1/1e-30,T=1/w,_=T,k=1,M=-~(8.5*j.log(O>=1?O:1/O)+.4*O+17);if(B<0||O<=0)return NaN;if(B<O+1){for(;k<=M;k++)b+=h*=B/++m;return b*j.exp(-B+O*j.log(B)-u)}for(;k<=M;k++)_*=(T=1/(T=(g=-k*(k-O))*T+(w+=2)))*(N=w+g/N);return 1-_*j.exp(-B+O*j.log(B)-u)},a.factorialln=function(O){return O<0?NaN:a.gammaln(O+1)},a.factorial=function(O){return O<0?NaN:a.gammafn(O+1)},a.combination=function(O,B){return O>170||B>170?j.exp(a.combinationln(O,B)):a.factorial(O)/a.factorial(B)/a.factorial(O-B)},a.combinationln=function(O,B){return a.factorialln(O)-a.factorialln(B)-a.factorialln(O-B)},a.permutation=function(O,B){return a.factorial(O)/a.factorial(O-B)},a.betafn=function(O,B){if(!(O<=0||B<=0))return O+B>170?j.exp(a.betaln(O,B)):a.gammafn(O)*a.gammafn(B)/a.gammafn(O+B)},a.betaln=function(O,B){return a.gammaln(O)+a.gammaln(B)-a.gammaln(O+B)},a.betacf=function(O,B,g){var u,m,b,h,w=1e-30,N=1,T=B+g,_=B+1,k=B-1,M=1,D=1-T*O/_;for(j.abs(D)<w&&(D=w),h=D=1/D;N<=100&&(D=1+(m=N*(g-N)*O/((k+(u=2*N))*(B+u)))*D,j.abs(D)<w&&(D=w),M=1+m/M,j.abs(M)<w&&(M=w),h*=(D=1/D)*M,D=1+(m=-(B+N)*(T+N)*O/((B+u)*(_+u)))*D,j.abs(D)<w&&(D=w),M=1+m/M,j.abs(M)<w&&(M=w),h*=b=(D=1/D)*M,!(j.abs(b-1)<3e-7));N++);return h},a.gammapinv=function(O,B){var g,u,m,b,h,w,N=0,T=B-1,_=a.gammaln(B);if(O>=1)return j.max(100,B+100*j.sqrt(B));if(O<=0)return 0;for(B>1?(h=j.log(T),w=j.exp(T*(h-1)-_),b=O<.5?O:1-O,g=(2.30753+.27061*(u=j.sqrt(-2*j.log(b))))/(1+u*(.99229+.04481*u))-u,O<.5&&(g=-g),g=j.max(.001,B*j.pow(1-1/(9*B)-g/(3*j.sqrt(B)),3))):g=O<(u=1-B*(.253+.12*B))?j.pow(O/u,1/B):1-j.log(1-(O-u)/(1-u));N<12;N++){if(g<=0)return 0;if((g-=u=(m=(a.lowRegGamma(B,g)-O)/(u=B>1?w*j.exp(-(g-T)+T*(j.log(g)-h)):j.exp(-g+T*j.log(g)-_)))/(1-.5*j.min(1,m*((B-1)/g-1))))<=0&&(g=.5*(g+u)),j.abs(u)<1e-8*g)break}return g},a.erf=function(O){var B,g,u,m,b=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=b.length-1,w=!1,N=0,T=0;for(O<0&&(O=-O,w=!0),g=4*(B=2/(2+O))-2;h>0;h--)u=N,N=g*N-T+b[h],T=u;return m=B*j.exp(-O*O+.5*(b[0]+g*N)-T),w?m-1:1-m},a.erfc=function(O){return 1-a.erf(O)},a.erfcinv=function(O){var B,g,u,m,b=0;if(O>=2)return-100;if(O<=0)return 100;for(m=O<1?O:2-O,B=-.70711*((2.30753+.27061*(u=j.sqrt(-2*j.log(m/2))))/(1+u*(.99229+.04481*u))-u);b<2;b++)B+=(g=a.erfc(B)-m)/(1.1283791670955126*j.exp(-B*B)-B*g);return O<1?B:-B},a.ibetainv=function(O,B,g){var u,m,b,h,w,N,T,_,k,M,D=B-1,Z=g-1,Y=0;if(O<=0)return 0;if(O>=1)return 1;for(B>=1&&g>=1?(b=O<.5?O:1-O,N=(2.30753+.27061*(h=j.sqrt(-2*j.log(b))))/(1+h*(.99229+.04481*h))-h,O<.5&&(N=-N),T=(N*N-3)/6,_=2/(1/(2*B-1)+1/(2*g-1)),k=N*j.sqrt(T+_)/_-(1/(2*g-1)-1/(2*B-1))*(T+.8333333333333334-2/(3*_)),N=B/(B+g*j.exp(2*k))):(u=j.log(B/(B+g)),m=j.log(g/(B+g)),N=O<(h=j.exp(B*u)/B)/(k=h+(w=j.exp(g*m)/g))?j.pow(B*k*O,1/B):1-j.pow(g*k*(1-O),1/g)),M=-a.gammaln(B)-a.gammaln(g)+a.gammaln(B+g);Y<10;Y++){if(N===0||N===1)return N;if((N-=h=(w=(a.ibeta(N,B,g)-O)/(h=j.exp(D*j.log(N)+Z*j.log(1-N)+M)))/(1-.5*j.min(1,w*(D/N-Z/(1-N)))))<=0&&(N=.5*(N+h)),N>=1&&(N=.5*(N+h+1)),j.abs(h)<1e-8*N&&Y>0)break}return N},a.ibeta=function(O,B,g){var u=O===0||O===1?0:j.exp(a.gammaln(B+g)-a.gammaln(B)-a.gammaln(g)+B*j.log(O)+g*j.log(1-O));return!(O<0||O>1)&&(O<(B+1)/(B+g+2)?u*a.betacf(O,B,g)/B:1-u*a.betacf(1-O,g,B)/g)},a.randn=function(O,B){var g,u,m,b,h;if(B||(B=O),O)return a.create(O,B,function(){return a.randn()});do g=a._random_fn(),u=1.7156*(a._random_fn()-.5),h=(m=g-.449871)*m+(b=j.abs(u)+.386595)*(.196*b-.25472*m);while(h>.27597&&(h>.27846||u*u>-4*j.log(g)*g*g));return u/g},a.randg=function(O,B,g){var u,m,b,h,w,N,T=O;if(g||(g=B),O||(O=1),B)return(N=a.zeros(B,g)).alter(function(){return a.randg(O)}),N;O<1&&(O+=1),u=O-.3333333333333333,m=1/j.sqrt(9*u);do{do h=1+m*(w=a.randn());while(h<=0);h*=h*h,b=a._random_fn()}while(b>1-.331*j.pow(w,4)&&j.log(b)>.5*w*w+u*(1-h+j.log(h)));if(O==T)return u*h;do b=a._random_fn();while(b===0);return j.pow(b,1/T)*u*h},function(O){for(var B=0;B<O.length;B++)(function(g){a.fn[g]=function(){return a(a.map(this,function(u){return a[g](u)}))}})(O[B])}("gammaln gammafn factorial factorialln".split(" ")),function(O){for(var B=0;B<O.length;B++)(function(g){a.fn[g]=function(){return a(a[g].apply(null,arguments))}})(O[B])}("randn".split(" "))}(c,Math),function(a,j){function O(g,u,m,b){for(var h,w=0,N=1,T=1,_=1,k=0,M=0;j.abs((T-M)/T)>b;)M=T,N=_+(h=-(u+k)*(u+m+k)*g/(u+2*k)/(u+2*k+1))*N,T=(w=T+h*w)+(h=(k+=1)*(m-k)*g/(u+2*k-1)/(u+2*k))*T,w/=_=N+h*_,N/=_,T/=_,_=1;return T/u}function B(g,u,m){var b=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],h=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],w=.5*g;if(w>=8)return 1;var N,T=2*a.normal.cdf(w,0,1,1,0)-1;T=T>=j.exp(-50/m)?j.pow(T,m):0;for(var _=w,k=(8-w)/(N=g>3?2:3),M=_+k,D=0,Z=m-1,Y=1;Y<=N;Y++){for(var se=0,he=.5*(M+_),le=.5*(M-_),xe=1;xe<=12;xe++){var Ae,be=he+le*(6<xe?b[(Ae=12-xe+1)-1]:-b[(Ae=xe)-1]),ae=be*be;if(ae>60)break;var Ve=2*a.normal.cdf(be,0,1,1,0)*.5-2*a.normal.cdf(be,g,1,1,0)*.5;Ve>=j.exp(-30/Z)&&(se+=Ve=h[Ae-1]*j.exp(-.5*ae)*j.pow(Ve,Z))}D+=se*=2*le*m/j.sqrt(2*j.PI),_=M,M+=k}return(T+=D)<=j.exp(-30/u)?0:(T=j.pow(T,u))>=1?1:T}(function(g){for(var u=0;u<g.length;u++)(function(m){a[m]=function b(h,w,N){return this instanceof b?(this._a=h,this._b=w,this._c=N,this):new b(h,w,N)},a.fn[m]=function(b,h,w){var N=a[m](b,h,w);return N.data=this,N},a[m].prototype.sample=function(b){var h=this._a,w=this._b,N=this._c;return b?a.alter(b,function(){return a[m].sample(h,w,N)}):a[m].sample(h,w,N)},function(b){for(var h=0;h<b.length;h++)(function(w){a[m].prototype[w]=function(N){var T=this._a,_=this._b,k=this._c;return N||N===0||(N=this.data),typeof N!="number"?a.fn.map.call(N,function(M){return a[m][w](M,T,_,k)}):a[m][w](N,T,_,k)}})(b[h])}("pdf cdf inv".split(" ")),function(b){for(var h=0;h<b.length;h++)(function(w){a[m].prototype[w]=function(){return a[m][w](this._a,this._b,this._c)}})(b[h])}("mean median mode variance".split(" "))})(g[u])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),a.extend(a.beta,{pdf:function(g,u,m){return g>1||g<0?0:u==1&&m==1?1:u<512&&m<512?j.pow(g,u-1)*j.pow(1-g,m-1)/a.betafn(u,m):j.exp((u-1)*j.log(g)+(m-1)*j.log(1-g)-a.betaln(u,m))},cdf:function(g,u,m){return g>1||g<0?1*(g>1):a.ibeta(g,u,m)},inv:function(g,u,m){return a.ibetainv(g,u,m)},mean:function(g,u){return g/(g+u)},median:function(g,u){return a.ibetainv(.5,g,u)},mode:function(g,u){return(g-1)/(g+u-2)},sample:function(g,u){var m=a.randg(g);return m/(m+a.randg(u))},variance:function(g,u){return g*u/(j.pow(g+u,2)*(g+u+1))}}),a.extend(a.centralF,{pdf:function(g,u,m){var b;return g<0?0:u<=2?g===0&&u<2?1/0:g===0&&u===2?1:1/a.betafn(u/2,m/2)*j.pow(u/m,u/2)*j.pow(g,u/2-1)*j.pow(1+u/m*g,-(u+m)/2):(b=u*g/(m+g*u),u*(m/(m+g*u))/2*a.binomial.pdf((u-2)/2,(u+m-2)/2,b))},cdf:function(g,u,m){return g<0?0:a.ibeta(u*g/(u*g+m),u/2,m/2)},inv:function(g,u,m){return m/(u*(1/a.ibetainv(g,u/2,m/2)-1))},mean:function(g,u){return u>2?u/(u-2):void 0},mode:function(g,u){return g>2?u*(g-2)/(g*(u+2)):void 0},sample:function(g,u){return 2*a.randg(g/2)/g/(2*a.randg(u/2)/u)},variance:function(g,u){if(!(u<=4))return 2*u*u*(g+u-2)/(g*(u-2)*(u-2)*(u-4))}}),a.extend(a.cauchy,{pdf:function(g,u,m){return m<0?0:m/(j.pow(g-u,2)+j.pow(m,2))/j.PI},cdf:function(g,u,m){return j.atan((g-u)/m)/j.PI+.5},inv:function(g,u,m){return u+m*j.tan(j.PI*(g-.5))},median:function(g){return g},mode:function(g){return g},sample:function(g,u){return a.randn()*j.sqrt(1/(2*a.randg(.5)))*u+g}}),a.extend(a.chisquare,{pdf:function(g,u){return g<0?0:g===0&&u===2?.5:j.exp((u/2-1)*j.log(g)-g/2-u/2*j.log(2)-a.gammaln(u/2))},cdf:function(g,u){return g<0?0:a.lowRegGamma(u/2,g/2)},inv:function(g,u){return 2*a.gammapinv(g,.5*u)},mean:function(g){return g},median:function(g){return g*j.pow(1-2/(9*g),3)},mode:function(g){return g-2>0?g-2:0},sample:function(g){return 2*a.randg(g/2)},variance:function(g){return 2*g}}),a.extend(a.exponential,{pdf:function(g,u){return g<0?0:u*j.exp(-u*g)},cdf:function(g,u){return g<0?0:1-j.exp(-u*g)},inv:function(g,u){return-j.log(1-g)/u},mean:function(g){return 1/g},median:function(g){return 1/g*j.log(2)},mode:function(){return 0},sample:function(g){return-1/g*j.log(a._random_fn())},variance:function(g){return j.pow(g,-2)}}),a.extend(a.gamma,{pdf:function(g,u,m){return g<0?0:g===0&&u===1?1/m:j.exp((u-1)*j.log(g)-g/m-a.gammaln(u)-u*j.log(m))},cdf:function(g,u,m){return g<0?0:a.lowRegGamma(u,g/m)},inv:function(g,u,m){return a.gammapinv(g,u)*m},mean:function(g,u){return g*u},mode:function(g,u){if(g>1)return(g-1)*u},sample:function(g,u){return a.randg(g)*u},variance:function(g,u){return g*u*u}}),a.extend(a.invgamma,{pdf:function(g,u,m){return g<=0?0:j.exp(-(u+1)*j.log(g)-m/g-a.gammaln(u)+u*j.log(m))},cdf:function(g,u,m){return g<=0?0:1-a.lowRegGamma(u,m/g)},inv:function(g,u,m){return m/a.gammapinv(1-g,u)},mean:function(g,u){return g>1?u/(g-1):void 0},mode:function(g,u){return u/(g+1)},sample:function(g,u){return u/a.randg(g)},variance:function(g,u){if(!(g<=2))return u*u/((g-1)*(g-1)*(g-2))}}),a.extend(a.kumaraswamy,{pdf:function(g,u,m){return g===0&&u===1?m:g===1&&m===1?u:j.exp(j.log(u)+j.log(m)+(u-1)*j.log(g)+(m-1)*j.log(1-j.pow(g,u)))},cdf:function(g,u,m){return g<0?0:g>1?1:1-j.pow(1-j.pow(g,u),m)},inv:function(g,u,m){return j.pow(1-j.pow(1-g,1/m),1/u)},mean:function(g,u){return u*a.gammafn(1+1/g)*a.gammafn(u)/a.gammafn(1+1/g+u)},median:function(g,u){return j.pow(1-j.pow(2,-1/u),1/g)},mode:function(g,u){if(g>=1&&u>=1&&g!==1&&u!==1)return j.pow((g-1)/(g*u-1),1/g)},variance:function(){throw new Error("variance not yet implemented")}}),a.extend(a.lognormal,{pdf:function(g,u,m){return g<=0?0:j.exp(-j.log(g)-.5*j.log(2*j.PI)-j.log(m)-j.pow(j.log(g)-u,2)/(2*m*m))},cdf:function(g,u,m){return g<0?0:.5+.5*a.erf((j.log(g)-u)/j.sqrt(2*m*m))},inv:function(g,u,m){return j.exp(-1.4142135623730951*m*a.erfcinv(2*g)+u)},mean:function(g,u){return j.exp(g+u*u/2)},median:function(g){return j.exp(g)},mode:function(g,u){return j.exp(g-u*u)},sample:function(g,u){return j.exp(a.randn()*u+g)},variance:function(g,u){return(j.exp(u*u)-1)*j.exp(2*g+u*u)}}),a.extend(a.noncentralt,{pdf:function(g,u,m){return j.abs(m)<1e-14?a.studentt.pdf(g,u):j.abs(g)<1e-14?j.exp(a.gammaln((u+1)/2)-m*m/2-.5*j.log(j.PI*u)-a.gammaln(u/2)):u/g*(a.noncentralt.cdf(g*j.sqrt(1+2/u),u+2,m)-a.noncentralt.cdf(g,u,m))},cdf:function(g,u,m){var b=1e-14;if(j.abs(m)<b)return a.studentt.cdf(g,u);var h=!1;g<0&&(h=!0,m=-m);for(var w=a.normal.cdf(-m,0,1),N=b+1,T=N,_=g*g/(g*g+u),k=0,M=j.exp(-m*m/2),D=j.exp(-m*m/2-.5*j.log(2)-a.gammaln(1.5))*m;k<200||T>b||N>b;)T=N,k>0&&(M*=m*m/(2*k),D*=m*m/(2*(k+.5))),w+=.5*(N=M*a.beta.cdf(_,k+.5,u/2)+D*a.beta.cdf(_,k+1,u/2)),k++;return h?1-w:w}}),a.extend(a.normal,{pdf:function(g,u,m){return j.exp(-.5*j.log(2*j.PI)-j.log(m)-j.pow(g-u,2)/(2*m*m))},cdf:function(g,u,m){return .5*(1+a.erf((g-u)/j.sqrt(2*m*m)))},inv:function(g,u,m){return-1.4142135623730951*m*a.erfcinv(2*g)+u},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},sample:function(g,u){return a.randn()*u+g},variance:function(g,u){return u*u}}),a.extend(a.pareto,{pdf:function(g,u,m){return g<u?0:m*j.pow(u,m)/j.pow(g,m+1)},cdf:function(g,u,m){return g<u?0:1-j.pow(u/g,m)},inv:function(g,u,m){return u/j.pow(1-g,1/m)},mean:function(g,u){if(!(u<=1))return u*j.pow(g,u)/(u-1)},median:function(g,u){return g*(u*j.SQRT2)},mode:function(g){return g},variance:function(g,u){if(!(u<=2))return g*g*u/(j.pow(u-1,2)*(u-2))}}),a.extend(a.studentt,{pdf:function(g,u){return u=u>1e100?1e100:u,1/(j.sqrt(u)*a.betafn(.5,u/2))*j.pow(1+g*g/u,-(u+1)/2)},cdf:function(g,u){var m=u/2;return a.ibeta((g+j.sqrt(g*g+u))/(2*j.sqrt(g*g+u)),m,m)},inv:function(g,u){var m=a.ibetainv(2*j.min(g,1-g),.5*u,.5);return m=j.sqrt(u*(1-m)/m),g>.5?m:-m},mean:function(g){return g>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(g){return a.randn()*j.sqrt(g/(2*a.randg(g/2)))},variance:function(g){return g>2?g/(g-2):g>1?1/0:void 0}}),a.extend(a.weibull,{pdf:function(g,u,m){return g<0||u<0||m<0?0:m/u*j.pow(g/u,m-1)*j.exp(-j.pow(g/u,m))},cdf:function(g,u,m){return g<0?0:1-j.exp(-j.pow(g/u,m))},inv:function(g,u,m){return u*j.pow(-j.log(1-g),1/m)},mean:function(g,u){return g*a.gammafn(1+1/u)},median:function(g,u){return g*j.pow(j.log(2),1/u)},mode:function(g,u){return u<=1?0:g*j.pow((u-1)/u,1/u)},sample:function(g,u){return g*j.pow(-j.log(a._random_fn()),1/u)},variance:function(g,u){return g*g*a.gammafn(1+2/u)-j.pow(a.weibull.mean(g,u),2)}}),a.extend(a.uniform,{pdf:function(g,u,m){return g<u||g>m?0:1/(m-u)},cdf:function(g,u,m){return g<u?0:g<m?(g-u)/(m-u):1},inv:function(g,u,m){return u+g*(m-u)},mean:function(g,u){return .5*(g+u)},median:function(g,u){return a.mean(g,u)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,u){return g/2+u/2+(u/2-g/2)*(2*a._random_fn()-1)},variance:function(g,u){return j.pow(u-g,2)/12}}),a.extend(a.binomial,{pdf:function(g,u,m){return m===0||m===1?u*m===g?1:0:a.combination(u,g)*j.pow(m,g)*j.pow(1-m,u-g)},cdf:function(g,u,m){var b,h=1e-10;if(g<0)return 0;if(g>=u)return 1;if(m<0||m>1||u<=0)return NaN;var w=m,N=(g=j.floor(g))+1,T=u-g,_=N+T,k=j.exp(a.gammaln(_)-a.gammaln(T)-a.gammaln(N)+N*j.log(w)+T*j.log(1-w));return b=w<(N+1)/(_+2)?k*O(w,N,T,h):1-k*O(1-w,T,N,h),j.round(1/h*(1-b))/(1/h)}}),a.extend(a.negbin,{pdf:function(g,u,m){return g===g>>>0&&(g<0?0:a.combination(g+u-1,u-1)*j.pow(1-m,g)*j.pow(m,u))},cdf:function(g,u,m){var b=0,h=0;if(g<0)return 0;for(;h<=g;h++)b+=a.negbin.pdf(h,u,m);return b}}),a.extend(a.hypgeom,{pdf:function(g,u,m,b){if(g!=g|0)return!1;if(g<0||g<m-(u-b)||g>b||g>m)return 0;if(2*m>u)return 2*b>u?a.hypgeom.pdf(u-m-b+g,u,u-m,u-b):a.hypgeom.pdf(b-g,u,u-m,b);if(2*b>u)return a.hypgeom.pdf(m-g,u,m,u-b);if(m<b)return a.hypgeom.pdf(g,u,b,m);for(var h=1,w=0,N=0;N<g;N++){for(;h>1&&w<b;)h*=1-m/(u-w),w++;h*=(b-N)*(m-N)/((N+1)*(u-m-b+N+1))}for(;w<b;w++)h*=1-m/(u-w);return j.min(1,j.max(0,h))},cdf:function(g,u,m,b){if(g<0||g<m-(u-b))return 0;if(g>=b||g>=m)return 1;if(2*m>u)return 2*b>u?a.hypgeom.cdf(u-m-b+g,u,u-m,u-b):1-a.hypgeom.cdf(b-g-1,u,u-m,b);if(2*b>u)return 1-a.hypgeom.cdf(m-g-1,u,m,u-b);if(m<b)return a.hypgeom.cdf(g,u,b,m);for(var h=1,w=1,N=0,T=0;T<g;T++){for(;h>1&&N<b;){var _=1-m/(u-N);w*=_,h*=_,N++}h+=w*=(b-T)*(m-T)/((T+1)*(u-m-b+T+1))}for(;N<b;N++)h*=1-m/(u-N);return j.min(1,j.max(0,h))}}),a.extend(a.poisson,{pdf:function(g,u){return u<0||g%1!=0||g<0?0:j.pow(u,g)*j.exp(-u)/a.factorial(g)},cdf:function(g,u){var m=[],b=0;if(g<0)return 0;for(;b<=g;b++)m.push(a.poisson.pdf(b,u));return a.sum(m)},mean:function(g){return g},variance:function(g){return g},sampleSmall:function(g){var u=1,m=0,b=j.exp(-g);do m++,u*=a._random_fn();while(u>b);return m-1},sampleLarge:function(g){var u,m,b,h,w,N,T,_,k,M,D=g;for(h=j.sqrt(D),w=j.log(D),N=.02483*(T=.931+2.53*h)-.059,_=1.1239+1.1328/(T-3.4),k=.9277-3.6224/(T-2);;)if(m=j.random()-.5,b=j.random(),M=.5-j.abs(m),u=j.floor((2*N/M+T)*m+D+.43),M>=.07&&b<=k||!(u<0||M<.013&&b>M)&&j.log(b)+j.log(_)-j.log(N/(M*M)+T)<=u*w-D-a.loggam(u+1))return u},sample:function(g){return g<10?this.sampleSmall(g):this.sampleLarge(g)}}),a.extend(a.triangular,{pdf:function(g,u,m,b){return m<=u||b<u||b>m?NaN:g<u||g>m?0:g<b?2*(g-u)/((m-u)*(b-u)):g===b?2/(m-u):2*(m-g)/((m-u)*(m-b))},cdf:function(g,u,m,b){return m<=u||b<u||b>m?NaN:g<=u?0:g>=m?1:g<=b?j.pow(g-u,2)/((m-u)*(b-u)):1-j.pow(m-g,2)/((m-u)*(m-b))},inv:function(g,u,m,b){return m<=u||b<u||b>m?NaN:g<=(b-u)/(m-u)?u+(m-u)*j.sqrt(g*((b-u)/(m-u))):u+(m-u)*(1-j.sqrt((1-g)*(1-(b-u)/(m-u))))},mean:function(g,u,m){return(g+u+m)/3},median:function(g,u,m){return m<=(g+u)/2?u-j.sqrt((u-g)*(u-m))/j.sqrt(2):m>(g+u)/2?g+j.sqrt((u-g)*(m-g))/j.sqrt(2):void 0},mode:function(g,u,m){return m},sample:function(g,u,m){var b=a._random_fn();return b<(m-g)/(u-g)?g+j.sqrt(b*(u-g)*(m-g)):u-j.sqrt((1-b)*(u-g)*(u-m))},variance:function(g,u,m){return(g*g+u*u+m*m-g*u-g*m-u*m)/18}}),a.extend(a.arcsine,{pdf:function(g,u,m){return m<=u?NaN:g<=u||g>=m?0:2/j.PI*j.pow(j.pow(m-u,2)-j.pow(2*g-u-m,2),-.5)},cdf:function(g,u,m){return g<u?0:g<m?2/j.PI*j.asin(j.sqrt((g-u)/(m-u))):1},inv:function(g,u,m){return u+(.5-.5*j.cos(j.PI*g))*(m-u)},mean:function(g,u){return u<=g?NaN:(g+u)/2},median:function(g,u){return u<=g?NaN:(g+u)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,u){return(g+u)/2+(u-g)/2*j.sin(2*j.PI*a.uniform.sample(0,1))},variance:function(g,u){return u<=g?NaN:j.pow(u-g,2)/8}}),a.extend(a.laplace,{pdf:function(g,u,m){return m<=0?0:j.exp(-j.abs(g-u)/m)/(2*m)},cdf:function(g,u,m){return m<=0?0:g<u?.5*j.exp((g-u)/m):1-.5*j.exp(-(g-u)/m)},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},variance:function(g,u){return 2*u*u},sample:function(g,u){var m,b=a._random_fn()-.5;return g-u*((m=b)/j.abs(m))*j.log(1-2*j.abs(b))}}),a.extend(a.tukey,{cdf:function(g,u,m){var b=u,h=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],w=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(g<=0)return 0;if(m<2||b<2)return NaN;if(!Number.isFinite(g))return 1;if(m>25e3)return B(g,1,b);var N,T=.5*m,_=T*j.log(m)-m*j.log(2)-a.gammaln(T),k=T-1,M=.25*m;N=m<=100?1:m<=800?.5:m<=5e3?.25:.125,_+=j.log(N);for(var D=0,Z=1;Z<=50;Z++){for(var Y=0,se=(2*Z-1)*N,he=1;he<=16;he++){var le,xe;8<he?(le=he-8-1,xe=_+k*j.log(se+h[le]*N)-(h[le]*N+se)*M):(le=he-1,xe=_+k*j.log(se-h[le]*N)+(h[le]*N-se)*M),xe>=-30&&(Y+=B(8<he?g*j.sqrt(.5*(h[le]*N+se)):g*j.sqrt(.5*(-h[le]*N+se)),1,b)*w[le]*j.exp(xe))}if(Z*N>=1&&Y<=1e-14)break;D+=Y}if(Y>1e-14)throw new Error("tukey.cdf failed to converge");return D>1&&(D=1),D},inv:function(g,u,m){if(m<2||u<2)return NaN;if(g<0||g>1)return NaN;if(g===0)return 0;if(g===1)return 1/0;var b,h=function(k,M,D){var Z=.5-.5*k,Y=j.sqrt(j.log(1/(Z*Z))),se=Y+((((-453642210148e-16*Y-.204231210125)*Y-.342242088547)*Y-1)*Y+.322232421088)/((((.0038560700634*Y+.10353775285)*Y+.531103462366)*Y+.588581570495)*Y+.099348462606);D<120&&(se+=(se*se*se+se)/D/4);var he=.8832-.2368*se;return D<120&&(he+=-1.214/D+1.208*se/D),se*(he*j.log(M-1)+1.4142)}(g,u,m),w=a.tukey.cdf(h,u,m)-g;b=w>0?j.max(0,h-1):h+1;for(var N,T=a.tukey.cdf(b,u,m)-g,_=1;_<50;_++)if(N=b-T*(b-h)/(T-w),w=T,h=b,N<0&&(N=0,T=-g),T=a.tukey.cdf(N,u,m)-g,b=N,j.abs(b-h)<1e-4)return N;throw new Error("tukey.inv failed to converge")}})}(c,Math),function(a,j){var O,B,g=Array.prototype.push,u=a.utils.isArray;function m(b){return u(b)||b instanceof a}a.extend({add:function(b,h){return m(h)?(m(h[0])||(h=[h]),a.map(b,function(w,N,T){return w+h[N][T]})):a.map(b,function(w){return w+h})},subtract:function(b,h){return m(h)?(m(h[0])||(h=[h]),a.map(b,function(w,N,T){return w-h[N][T]||0})):a.map(b,function(w){return w-h})},divide:function(b,h){return m(h)?(m(h[0])||(h=[h]),a.multiply(b,a.inv(h))):a.map(b,function(w){return w/h})},multiply:function(b,h){var w,N,T,_,k,M,D,Z;if(b.length===void 0&&h.length===void 0)return b*h;if(k=b.length,M=b[0].length,D=a.zeros(k,T=m(h)?h[0].length:M),Z=0,m(h)){for(;Z<T;Z++)for(w=0;w<k;w++){for(_=0,N=0;N<M;N++)_+=b[w][N]*h[N][Z];D[w][Z]=_}return k===1&&Z===1?D[0][0]:D}return a.map(b,function(Y){return Y*h})},outer:function(b,h){return a.multiply(b.map(function(w){return[w]}),[h])},dot:function(b,h){m(b[0])||(b=[b]),m(h[0])||(h=[h]);for(var w,N,T=b[0].length===1&&b.length!==1?a.transpose(b):b,_=h[0].length===1&&h.length!==1?a.transpose(h):h,k=[],M=0,D=T.length,Z=T[0].length;M<D;M++){for(k[M]=[],w=0,N=0;N<Z;N++)w+=T[M][N]*_[M][N];k[M]=w}return k.length===1?k[0]:k},pow:function(b,h){return a.map(b,function(w){return j.pow(w,h)})},exp:function(b){return a.map(b,function(h){return j.exp(h)})},log:function(b){return a.map(b,function(h){return j.log(h)})},abs:function(b){return a.map(b,function(h){return j.abs(h)})},norm:function(b,h){var w=0,N=0;for(isNaN(h)&&(h=2),m(b[0])&&(b=b[0]);N<b.length;N++)w+=j.pow(j.abs(b[N]),h);return j.pow(w,1/h)},angle:function(b,h){return j.acos(a.dot(b,h)/(a.norm(b)*a.norm(h)))},aug:function(b,h){var w,N=[];for(w=0;w<b.length;w++)N.push(b[w].slice());for(w=0;w<N.length;w++)g.apply(N[w],h[w]);return N},inv:function(b){for(var h,w=b.length,N=b[0].length,T=a.identity(w,N),_=a.gauss_jordan(b,T),k=[],M=0;M<w;M++)for(k[M]=[],h=N;h<_[0].length;h++)k[M][h-N]=_[M][h];return k},det:function b(h){if(h.length===2)return h[0][0]*h[1][1]-h[0][1]*h[1][0];for(var w=0,N=0;N<h.length;N++){for(var T=[],_=1;_<h.length;_++){T[_-1]=[];for(var k=0;k<h.length;k++)k<N?T[_-1][k]=h[_][k]:k>N&&(T[_-1][k-1]=h[_][k])}var M=N%2?-1:1;w+=b(T)*h[0][N]*M}return w},gauss_elimination:function(b,h){var w,N,T,_,k=0,M=0,D=b.length,Z=b[0].length,Y=1,se=0,he=[];for(w=(b=a.aug(b,h))[0].length,k=0;k<D;k++){for(N=b[k][k],M=k,_=k+1;_<Z;_++)N<j.abs(b[_][k])&&(N=b[_][k],M=_);if(M!=k)for(_=0;_<w;_++)T=b[k][_],b[k][_]=b[M][_],b[M][_]=T;for(M=k+1;M<D;M++)for(Y=b[M][k]/b[k][k],_=k;_<w;_++)b[M][_]=b[M][_]-Y*b[k][_]}for(k=D-1;k>=0;k--){for(se=0,M=k+1;M<=D-1;M++)se+=he[M]*b[k][M];he[k]=(b[k][w-1]-se)/b[k][k]}return he},gauss_jordan:function(b,h){var w,N,T,_=a.aug(b,h),k=_.length,M=_[0].length,D=0;for(N=0;N<k;N++){var Z=N;for(T=N+1;T<k;T++)j.abs(_[T][N])>j.abs(_[Z][N])&&(Z=T);var Y=_[N];for(_[N]=_[Z],_[Z]=Y,T=N+1;T<k;T++)for(D=_[T][N]/_[N][N],w=N;w<M;w++)_[T][w]-=_[N][w]*D}for(N=k-1;N>=0;N--){for(D=_[N][N],T=0;T<N;T++)for(w=M-1;w>N-1;w--)_[T][w]-=_[N][w]*_[T][N]/D;for(_[N][N]/=D,w=k;w<M;w++)_[N][w]/=D}return _},triaUpSolve:function(b,h){var w,N=b[0].length,T=a.zeros(1,N)[0],_=!1;return h[0].length!=null&&(h=h.map(function(k){return k[0]}),_=!0),a.arange(N-1,-1,-1).forEach(function(k){w=a.arange(k+1,N).map(function(M){return T[M]*b[k][M]}),T[k]=(h[k]-a.sum(w))/b[k][k]}),_?T.map(function(k){return[k]}):T},triaLowSolve:function(b,h){var w,N=b[0].length,T=a.zeros(1,N)[0],_=!1;return h[0].length!=null&&(h=h.map(function(k){return k[0]}),_=!0),a.arange(N).forEach(function(k){w=a.arange(k).map(function(M){return b[k][M]*T[M]}),T[k]=(h[k]-a.sum(w))/b[k][k]}),_?T.map(function(k){return[k]}):T},lu:function(b){var h,w=b.length,N=a.identity(w),T=a.zeros(b.length,b[0].length);return a.arange(w).forEach(function(_){T[0][_]=b[0][_]}),a.arange(1,w).forEach(function(_){a.arange(_).forEach(function(k){h=a.arange(k).map(function(M){return N[_][M]*T[M][k]}),N[_][k]=(b[_][k]-a.sum(h))/T[k][k]}),a.arange(_,w).forEach(function(k){h=a.arange(_).map(function(M){return N[_][M]*T[M][k]}),T[_][k]=b[h.length][k]-a.sum(h)})}),[N,T]},cholesky:function(b){var h,w=b.length,N=a.zeros(b.length,b[0].length);return a.arange(w).forEach(function(T){h=a.arange(T).map(function(_){return j.pow(N[T][_],2)}),N[T][T]=j.sqrt(b[T][T]-a.sum(h)),a.arange(T+1,w).forEach(function(_){h=a.arange(T).map(function(k){return N[T][k]*N[_][k]}),N[_][T]=(b[T][_]-a.sum(h))/N[T][T]})}),N},gauss_jacobi:function(b,h,w,N){for(var T,_,k,M,D=0,Z=0,Y=b.length,se=[],he=[],le=[];D<Y;D++)for(se[D]=[],he[D]=[],le[D]=[],Z=0;Z<Y;Z++)D>Z?(se[D][Z]=b[D][Z],he[D][Z]=le[D][Z]=0):D<Z?(he[D][Z]=b[D][Z],se[D][Z]=le[D][Z]=0):(le[D][Z]=b[D][Z],se[D][Z]=he[D][Z]=0);for(k=a.multiply(a.multiply(a.inv(le),a.add(se,he)),-1),_=a.multiply(a.inv(le),h),T=w,M=a.add(a.multiply(k,w),_),D=2;j.abs(a.norm(a.subtract(M,T)))>N;)T=M,M=a.add(a.multiply(k,T),_),D++;return M},gauss_seidel:function(b,h,w,N){for(var T,_,k,M,D,Z=0,Y=b.length,se=[],he=[],le=[];Z<Y;Z++)for(se[Z]=[],he[Z]=[],le[Z]=[],T=0;T<Y;T++)Z>T?(se[Z][T]=b[Z][T],he[Z][T]=le[Z][T]=0):Z<T?(he[Z][T]=b[Z][T],se[Z][T]=le[Z][T]=0):(le[Z][T]=b[Z][T],se[Z][T]=he[Z][T]=0);for(M=a.multiply(a.multiply(a.inv(a.add(le,se)),he),-1),k=a.multiply(a.inv(a.add(le,se)),h),_=w,D=a.add(a.multiply(M,w),k),Z=2;j.abs(a.norm(a.subtract(D,_)))>N;)_=D,D=a.add(a.multiply(M,_),k),Z+=1;return D},SOR:function(b,h,w,N,T){for(var _,k,M,D,Z,Y=0,se=b.length,he=[],le=[],xe=[];Y<se;Y++)for(he[Y]=[],le[Y]=[],xe[Y]=[],_=0;_<se;_++)Y>_?(he[Y][_]=b[Y][_],le[Y][_]=xe[Y][_]=0):Y<_?(le[Y][_]=b[Y][_],he[Y][_]=xe[Y][_]=0):(xe[Y][_]=b[Y][_],he[Y][_]=le[Y][_]=0);for(D=a.multiply(a.inv(a.add(xe,a.multiply(he,T))),a.subtract(a.multiply(xe,1-T),a.multiply(le,T))),M=a.multiply(a.multiply(a.inv(a.add(xe,a.multiply(he,T))),h),T),k=w,Z=a.add(a.multiply(D,w),M),Y=2;j.abs(a.norm(a.subtract(Z,k)))>N;)k=Z,Z=a.add(a.multiply(D,k),M),Y++;return Z},householder:function(b){for(var h,w,N,T,_=b.length,k=b[0].length,M=0,D=[],Z=[];M<_-1;M++){for(h=0,T=M+1;T<k;T++)h+=b[T][M]*b[T][M];for(h=(b[M+1][M]>0?-1:1)*j.sqrt(h),w=j.sqrt((h*h-b[M+1][M]*h)/2),(D=a.zeros(_,1))[M+1][0]=(b[M+1][M]-h)/(2*w),N=M+2;N<_;N++)D[N][0]=b[N][M]/(2*w);Z=a.subtract(a.identity(_,k),a.multiply(a.multiply(D,a.transpose(D)),2)),b=a.multiply(Z,a.multiply(b,Z))}return b},QR:(O=a.sum,B=a.arange,function(b){var h,w,N,T=b.length,_=b[0].length,k=a.zeros(_,_);for(b=a.copy(b),w=0;w<_;w++){for(k[w][w]=j.sqrt(O(B(T).map(function(M){return b[M][w]*b[M][w]}))),h=0;h<T;h++)b[h][w]=b[h][w]/k[w][w];for(N=w+1;N<_;N++)for(k[w][N]=O(B(T).map(function(M){return b[M][w]*b[M][N]})),h=0;h<T;h++)b[h][N]=b[h][N]-b[h][w]*k[w][N]}return[b,k]}),lstsq:function(b,h){var w=!1;h[0].length===void 0&&(h=h.map(function(se){return[se]}),w=!0);var N=a.QR(b),T=N[0],_=N[1],k=b[0].length,M=a.slice(T,{col:{end:k}}),D=function(se){var he=(se=a.copy(se)).length,le=a.identity(he);return a.arange(he-1,-1,-1).forEach(function(xe){a.sliceAssign(le,{row:xe},a.divide(a.slice(le,{row:xe}),se[xe][xe])),a.sliceAssign(se,{row:xe},a.divide(a.slice(se,{row:xe}),se[xe][xe])),a.arange(xe).forEach(function(Ae){var be=a.multiply(se[Ae][xe],-1),ae=a.slice(se,{row:Ae}),Ve=a.multiply(a.slice(se,{row:xe}),be);a.sliceAssign(se,{row:Ae},a.add(ae,Ve));var Ge=a.slice(le,{row:Ae}),Ye=a.multiply(a.slice(le,{row:xe}),be);a.sliceAssign(le,{row:Ae},a.add(Ge,Ye))})}),le}(a.slice(_,{row:{end:k}})),Z=a.transpose(M);Z[0].length===void 0&&(Z=[Z]);var Y=a.multiply(a.multiply(D,Z),h);return Y.length===void 0&&(Y=[[Y]]),w?Y.map(function(se){return se[0]}):Y},jacobi:function(b){for(var h,w,N,T,_,k,M,D=1,Z=b.length,Y=a.identity(Z,Z),se=[];D===1;){for(_=b[0][1],N=0,T=1,h=0;h<Z;h++)for(w=0;w<Z;w++)h!=w&&_<j.abs(b[h][w])&&(_=j.abs(b[h][w]),N=h,T=w);for(k=b[N][N]===b[T][T]?b[N][T]>0?j.PI/4:-j.PI/4:j.atan(2*b[N][T]/(b[N][N]-b[T][T]))/2,(M=a.identity(Z,Z))[N][N]=j.cos(k),M[N][T]=-j.sin(k),M[T][N]=j.sin(k),M[T][T]=j.cos(k),Y=a.multiply(Y,M),b=a.multiply(a.multiply(a.inv(M),b),M),D=0,h=1;h<Z;h++)for(w=1;w<Z;w++)h!=w&&j.abs(b[h][w])>.001&&(D=1)}for(h=0;h<Z;h++)se.push(b[h][h]);return[Y,se]},rungekutta:function(b,h,w,N,T,_){var k,M,D;if(_===2)for(;N<=w;)T+=((k=h*b(N,T))+(M=h*b(N+h,T+k)))/2,N+=h;if(_===4)for(;N<=w;)T+=((k=h*b(N,T))+2*(M=h*b(N+h/2,T+k/2))+2*(D=h*b(N+h/2,T+M/2))+h*b(N+h,T+D))/6,N+=h;return T},romberg:function(b,h,w,N){for(var T,_,k,M,D,Z=0,Y=(w-h)/2,se=[],he=[],le=[];Z<N/2;){for(D=b(h),k=h,M=0;k<=w;k+=Y,M++)se[M]=k;for(T=se.length,k=1;k<T-1;k++)D+=(k%2!=0?4:2)*b(se[k]);D=Y/3*(D+b(w)),le[Z]=D,Y/=2,Z++}for(_=le.length,T=1;_!==1;){for(k=0;k<_-1;k++)he[k]=(j.pow(4,T)*le[k+1]-le[k])/(j.pow(4,T)-1);_=he.length,le=he,he=[],T++}return le},richardson:function(b,h,w,N){function T(xe,Ae){for(var be,ae=0,Ve=xe.length;ae<Ve;ae++)xe[ae]===Ae&&(be=ae);return be}for(var _,k,M,D,Z,Y=j.abs(w-b[T(b,w)+1]),se=0,he=[],le=[];N>=Y;)_=T(b,w+N),k=T(b,w),he[se]=(h[_]-2*h[k]+h[2*k-_])/(N*N),N/=2,se++;for(D=he.length,M=1;D!=1;){for(Z=0;Z<D-1;Z++)le[Z]=(j.pow(4,M)*he[Z+1]-he[Z])/(j.pow(4,M)-1);D=le.length,he=le,le=[],M++}return he},simpson:function(b,h,w,N){for(var T,_=(w-h)/N,k=b(h),M=[],D=h,Z=0,Y=1;D<=w;D+=_,Z++)M[Z]=D;for(T=M.length;Y<T-1;Y++)k+=(Y%2!=0?4:2)*b(M[Y]);return _/3*(k+b(w))},hermite:function(b,h,w,N){for(var T,_=b.length,k=0,M=0,D=[],Z=[],Y=[],se=[];M<_;M++){for(D[M]=1,T=0;T<_;T++)M!=T&&(D[M]*=(N-b[T])/(b[M]-b[T]));for(Z[M]=0,T=0;T<_;T++)M!=T&&(Z[M]+=1/(b[M]-b[T]));Y[M]=(1-2*(N-b[M])*Z[M])*(D[M]*D[M]),se[M]=(N-b[M])*(D[M]*D[M]),k+=Y[M]*h[M]+se[M]*w[M]}return k},lagrange:function(b,h,w){for(var N,T,_=0,k=0,M=b.length;k<M;k++){for(T=h[k],N=0;N<M;N++)k!=N&&(T*=(w-b[N])/(b[k]-b[N]));_+=T}return _},cubic_spline:function(b,h,w){for(var N,T,_=b.length,k=0,M=[],D=[],Z=[],Y=[],se=[],he=[];k<_-1;k++)Y[k]=b[k+1]-b[k];for(Z[0]=0,k=1;k<_-1;k++)Z[k]=3/Y[k]*(h[k+1]-h[k])-3/Y[k-1]*(h[k]-h[k-1]);for(k=1;k<_-1;k++)M[k]=[],D[k]=[],M[k][k-1]=Y[k-1],M[k][k]=2*(Y[k-1]+Y[k]),M[k][k+1]=Y[k],D[k][0]=Z[k];for(T=a.multiply(a.inv(M),D),N=0;N<_-1;N++)se[N]=(h[N+1]-h[N])/Y[N]-Y[N]*(T[N+1][0]+2*T[N][0])/3,he[N]=(T[N+1][0]-T[N][0])/(3*Y[N]);for(N=0;N<_&&!(b[N]>w);N++);return h[N-=1]+(w-b[N])*se[N]+a.sq(w-b[N])*T[N]+(w-b[N])*a.sq(w-b[N])*he[N]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(b){var h,w,N,T,_,k=b.length,M=b[0].length,D=0,Z=[],Y=[],se=[],he=[],le=[],xe=[],Ae=[];for(D=0;D<k;D++)Z[D]=a.sum(b[D])/M;for(D=0;D<M;D++)for(le[D]=[],h=0;h<k;h++)le[D][h]=b[h][D]-Z[h];for(le=a.transpose(le),D=0;D<k;D++)for(xe[D]=[],h=0;h<k;h++)xe[D][h]=a.dot([le[D]],[le[h]])/(M-1);for(_=(N=a.jacobi(xe))[0],Y=N[1],Ae=a.transpose(_),D=0;D<Y.length;D++)for(h=D;h<Y.length;h++)Y[D]<Y[h]&&(w=Y[D],Y[D]=Y[h],Y[h]=w,se=Ae[D],Ae[D]=Ae[h],Ae[h]=se);for(T=a.transpose(le),D=0;D<k;D++)for(he[D]=[],h=0;h<T.length;h++)he[D][h]=a.dot([Ae[D]],[T[h]]);return[b,Y,Ae,he]}}),function(b){for(var h=0;h<b.length;h++)(function(w){a.fn[w]=function(N,T){var _=this;return T?(setTimeout(function(){T.call(_,a.fn[w].call(_,N))},15),this):typeof a[w](this,N)=="number"?a[w](this,N):a(a[w](this,N))}})(b[h])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(c,Math),function(a,j){var O=[].slice,B=a.utils.isNumber,g=a.utils.isArray;function u(m,b,h,w){if(m>1||h>1||m<=0||h<=0)throw new Error("Proportions should be greater than 0 and less than 1");var N=(m*b+h*w)/(b+w);return(m-h)/j.sqrt(N*(1-N)*(1/b+1/w))}a.extend({zscore:function(){var m=O.call(arguments);return B(m[1])?(m[0]-m[1])/m[2]:(m[0]-a.mean(m[1]))/a.stdev(m[1],m[2])},ztest:function(){var m,b=O.call(arguments);return g(b[1])?(m=a.zscore(b[0],b[1],b[3]),b[2]===1?a.normal.cdf(-j.abs(m),0,1):2*a.normal.cdf(-j.abs(m),0,1)):b.length>2?(m=a.zscore(b[0],b[1],b[2]),b[3]===1?a.normal.cdf(-j.abs(m),0,1):2*a.normal.cdf(-j.abs(m),0,1)):(m=b[0],b[1]===1?a.normal.cdf(-j.abs(m),0,1):2*a.normal.cdf(-j.abs(m),0,1))}}),a.extend(a.fn,{zscore:function(m,b){return(m-this.mean())/this.stdev(b)},ztest:function(m,b,h){var w=j.abs(this.zscore(m,h));return b===1?a.normal.cdf(-w,0,1):2*a.normal.cdf(-w,0,1)}}),a.extend({tscore:function(){var m=O.call(arguments);return m.length===4?(m[0]-m[1])/(m[2]/j.sqrt(m[3])):(m[0]-a.mean(m[1]))/(a.stdev(m[1],!0)/j.sqrt(m[1].length))},ttest:function(){var m,b=O.call(arguments);return b.length===5?(m=j.abs(a.tscore(b[0],b[1],b[2],b[3])),b[4]===1?a.studentt.cdf(-m,b[3]-1):2*a.studentt.cdf(-m,b[3]-1)):B(b[1])?(m=j.abs(b[0]),b[2]==1?a.studentt.cdf(-m,b[1]-1):2*a.studentt.cdf(-m,b[1]-1)):(m=j.abs(a.tscore(b[0],b[1])),b[2]==1?a.studentt.cdf(-m,b[1].length-1):2*a.studentt.cdf(-m,b[1].length-1))}}),a.extend(a.fn,{tscore:function(m){return(m-this.mean())/(this.stdev(!0)/j.sqrt(this.cols()))},ttest:function(m,b){return b===1?1-a.studentt.cdf(j.abs(this.tscore(m)),this.cols()-1):2*a.studentt.cdf(-j.abs(this.tscore(m)),this.cols()-1)}}),a.extend({anovafscore:function(){var m,b,h,w,N,T,_,k,M=O.call(arguments);if(M.length===1){for(N=new Array(M[0].length),_=0;_<M[0].length;_++)N[_]=M[0][_];M=N}for(b=new Array,_=0;_<M.length;_++)b=b.concat(M[_]);for(h=a.mean(b),m=0,_=0;_<M.length;_++)m+=M[_].length*j.pow(a.mean(M[_])-h,2);for(m/=M.length-1,T=0,_=0;_<M.length;_++)for(w=a.mean(M[_]),k=0;k<M[_].length;k++)T+=j.pow(M[_][k]-w,2);return m/(T/(b.length-M.length))},anovaftest:function(){var m,b,h,w,N=O.call(arguments);if(B(N[0]))return 1-a.centralF.cdf(N[0],N[1],N[2]);var T=a.anovafscore(N);for(m=N.length-1,h=0,w=0;w<N.length;w++)h+=N[w].length;return b=h-m-1,1-a.centralF.cdf(T,m,b)},ftest:function(m,b,h){return 1-a.centralF.cdf(m,b,h)}}),a.extend(a.fn,{anovafscore:function(){return a.anovafscore(this.toArray())},anovaftes:function(){var m,b=0;for(m=0;m<this.length;m++)b+=this[m].length;return a.ftest(this.anovafscore(),this.length-1,b-this.length)}}),a.extend({qscore:function(){var m,b,h,w,N,T=O.call(arguments);return B(T[0])?(m=T[0],b=T[1],h=T[2],w=T[3],N=T[4]):(m=a.mean(T[0]),b=a.mean(T[1]),h=T[0].length,w=T[1].length,N=T[2]),j.abs(m-b)/(N*j.sqrt((1/h+1/w)/2))},qtest:function(){var m,b=O.call(arguments);b.length===3?(m=b[0],b=b.slice(1)):b.length===7?(m=a.qscore(b[0],b[1],b[2],b[3],b[4]),b=b.slice(5)):(m=a.qscore(b[0],b[1],b[2]),b=b.slice(3));var h=b[0],w=b[1];return 1-a.tukey.cdf(m,w,h-w)},tukeyhsd:function(m){for(var b=a.pooledstdev(m),h=m.map(function(M){return a.mean(M)}),w=m.reduce(function(M,D){return M+D.length},0),N=[],T=0;T<m.length;++T)for(var _=T+1;_<m.length;++_){var k=a.qtest(h[T],h[_],m[T].length,m[_].length,b,w,m.length);N.push([[T,_],k])}return N}}),a.extend({normalci:function(){var m,b=O.call(arguments),h=new Array(2);return m=b.length===4?j.abs(a.normal.inv(b[1]/2,0,1)*b[2]/j.sqrt(b[3])):j.abs(a.normal.inv(b[1]/2,0,1)*a.stdev(b[2])/j.sqrt(b[2].length)),h[0]=b[0]-m,h[1]=b[0]+m,h},tci:function(){var m,b=O.call(arguments),h=new Array(2);return m=b.length===4?j.abs(a.studentt.inv(b[1]/2,b[3]-1)*b[2]/j.sqrt(b[3])):j.abs(a.studentt.inv(b[1]/2,b[2].length-1)*a.stdev(b[2],!0)/j.sqrt(b[2].length)),h[0]=b[0]-m,h[1]=b[0]+m,h},significant:function(m,b){return m<b}}),a.extend(a.fn,{normalci:function(m,b){return a.normalci(m,b,this.toArray())},tci:function(m,b){return a.tci(m,b,this.toArray())}}),a.extend(a.fn,{oneSidedDifferenceOfProportions:function(m,b,h,w){var N=u(m,b,h,w);return a.ztest(N,1)},twoSidedDifferenceOfProportions:function(m,b,h,w){var N=u(m,b,h,w);return a.ztest(N,2)}})}(c,Math),c.models=function(){function a(j,O){var B=j.length,g=O[0].length-1,u=B-g-1,m=c.lstsq(O,j),b=c.multiply(O,m.map(function(k){return[k]})).map(function(k){return k[0]}),h=c.subtract(j,b),w=c.mean(j),N=c.sum(b.map(function(k){return Math.pow(k-w,2)})),T=c.sum(j.map(function(k,M){return Math.pow(k-b[M],2)})),_=N+T;return{exog:O,endog:j,nobs:B,df_model:g,df_resid:u,coef:m,predict:b,resid:h,ybar:w,SST:_,SSE:N,SSR:T,R2:N/_}}return{ols:function(j,O){var B=a(j,O),g=function(b){var h,w,N=(h=b.exog,w=h[0].length,c.arange(w).map(function(Y){var se=c.arange(w).filter(function(he){return he!==Y});return a(c.col(h,Y).map(function(he){return he[0]}),c.col(h,se))})),T=Math.sqrt(b.SSR/b.df_resid),_=N.map(function(Y){var se=Y.SST,he=Y.R2;return T/Math.sqrt(se*(1-he))}),k=b.coef.map(function(Y,se){return(Y-0)/_[se]}),M=k.map(function(Y){var se=c.studentt.cdf(Y,b.df_resid);return 2*(se>.5?1-se:se)}),D=c.studentt.inv(.975,b.df_resid),Z=b.coef.map(function(Y,se){var he=D*_[se];return[Y-he,Y+he]});return{se:_,t:k,p:M,sigmaHat:T,interval95:Z}}(B),u=function(b){var h,w,N,T=b.R2/b.df_model/((1-b.R2)/b.df_resid);return{F_statistic:T,pvalue:1-(h=T,w=b.df_model,N=b.df_resid,c.beta.cdf(h/(N/w+h),w/2,N/2))}}(B),m=1-(1-B.R2)*((B.nobs-1)/B.df_resid);return B.t=g,B.f=u,B.adjust_R2=m,B}}}(),c.extend({buildxmatrix:function(){for(var a=new Array(arguments.length),j=0;j<arguments.length;j++)a[j]=[1].concat(arguments[j]);return c(a)},builddxmatrix:function(){for(var a=new Array(arguments[0].length),j=0;j<arguments[0].length;j++)a[j]=[1].concat(arguments[0][j]);return c(a)},buildjxmatrix:function(a){for(var j=new Array(a.length),O=0;O<a.length;O++)j[O]=a[O];return c.builddxmatrix(j)},buildymatrix:function(a){return c(a).transpose()},buildjymatrix:function(a){return a.transpose()},matrixmult:function(a,j){var O,B,g,u,m;if(a.cols()==j.rows()){if(j.rows()>1){for(u=[],O=0;O<a.rows();O++)for(u[O]=[],B=0;B<j.cols();B++){for(m=0,g=0;g<a.cols();g++)m+=a.toArray()[O][g]*j.toArray()[g][B];u[O][B]=m}return c(u)}for(u=[],O=0;O<a.rows();O++)for(u[O]=[],B=0;B<j.cols();B++){for(m=0,g=0;g<a.cols();g++)m+=a.toArray()[O][g]*j.toArray()[B];u[O][B]=m}return c(u)}},regress:function(a,j){var O=c.xtranspxinv(a),B=a.transpose(),g=c.matrixmult(c(O),B);return c.matrixmult(g,j)},regresst:function(a,j,O){var B=c.regress(a,j),g={anova:{}},u=c.jMatYBar(a,B);g.yBar=u;var m=j.mean();g.anova.residuals=c.residuals(j,u),g.anova.ssr=c.ssr(u,m),g.anova.msr=g.anova.ssr/(a[0].length-1),g.anova.sse=c.sse(j,u),g.anova.mse=g.anova.sse/(j.length-(a[0].length-1)-1),g.anova.sst=c.sst(j,m),g.anova.mst=g.anova.sst/(j.length-1),g.anova.r2=1-g.anova.sse/g.anova.sst,g.anova.r2<0&&(g.anova.r2=0),g.anova.fratio=g.anova.msr/g.anova.mse,g.anova.pvalue=c.anovaftest(g.anova.fratio,a[0].length-1,j.length-(a[0].length-1)-1),g.anova.rmse=Math.sqrt(g.anova.mse),g.anova.r2adj=1-g.anova.mse/g.anova.mst,g.anova.r2adj<0&&(g.anova.r2adj=0),g.stats=new Array(a[0].length);for(var b,h,w,N=c.xtranspxinv(a),T=0;T<B.length;T++)b=Math.sqrt(g.anova.mse*Math.abs(N[T][T])),h=Math.abs(B[T]/b),w=c.ttest(h,j.length-a[0].length-1,O),g.stats[T]=[B[T],b,h,w];return g.regress=B,g},xtranspx:function(a){return c.matrixmult(a.transpose(),a)},xtranspxinv:function(a){var j=c.matrixmult(a.transpose(),a);return c.inv(j)},jMatYBar:function(a,j){var O=c.matrixmult(a,j);return new c(O)},residuals:function(a,j){return c.matrixsubtract(a,j)},ssr:function(a,j){for(var O=0,B=0;B<a.length;B++)O+=Math.pow(a[B]-j,2);return O},sse:function(a,j){for(var O=0,B=0;B<a.length;B++)O+=Math.pow(a[B]-j[B],2);return O},sst:function(a,j){for(var O=0,B=0;B<a.length;B++)O+=Math.pow(a[B]-j,2);return O},matrixsubtract:function(a,j){for(var O=new Array(a.length),B=0;B<a.length;B++){O[B]=new Array(a[B].length);for(var g=0;g<a[B].length;g++)O[B][g]=a[B][g]-j[B][g]}return c(O)}}),c.jStat=c,c)},960:function(P,c,a){const j=a(592);P.exports=function(O){function B(T,_){const k=_.split(".");let M=T;for(const D of k){if(M==null)return;M=M[D]}return M}for(let T=0;T<Object.keys(j).length;T++){let _,k=Object.keys(j)[T],M=[];if(typeof j[k]=="object"){M=Object.keys(j[k]),_=Object.values(j[k]);for(let D=0;D<_.length;D++)if(typeof _[D]=="object"){let Z=M[D];j[k][Z]&&(M=[...M,...Object.keys(j[k][Z]).map(Y=>Z+"."+Y)],M.splice(M.indexOf(Z),1))}}if(M.length<1)O[k]=j[k];else for(let D=0;D<M.length;D++)typeof B(j[k],M[D])=="function"&&(O[k]=B(j[k],M[D]))}let g=function(T){return typeof T=="number"&&(T=parseInt(T)),T},u=null,m=null,b=null;O.TABLE=function(){return b},O.COLUMN=O.COL=function(){return b.tracking&&b.tracking.push(N.getColumnNameFromCoords(g(u),g(m))),g(u)+1},O.ROW=function(){return b.tracking&&b.tracking.push(N.getColumnNameFromCoords(g(u),g(m))),g(m)+1},O.CELL=function(){return N.getColumnNameFromCoords(u,m)},O.VALUE=function(T,_,k){return b.getValueFromCoords(g(T)-1,g(_)-1,k)},O.THISROWCELL=function(T){return b.getValueFromCoords(g(T)-1,g(m))};const h=function(T,_){for(let k=0;k<T.length;k++){let M=N.getTokensFromRange(T[k]);_=_.replace(T[k],"["+M.join(",")+"]")}return _},w=function(T){return typeof T=="string"&&(T=T.trim()),!isNaN(T)&&T!==null&&T!==""},N=function(T,_,k,M,D){b=D,u=k,m=M;let Z="",Y={};if(_)if(_.size){let le,xe=null;_.forEach(function(Ae,be){le=be.replace(/!/g,"."),le.indexOf(".")!==-1&&(le=le.split("."),Y[le[0]]=!0)}),le=Object.keys(Y);for(let Ae=0;Ae<le.length;Ae++)Z+="var "+le[Ae]+" = {};";_.forEach(function(Ae,be){le=be.replace(/!/g,"."),Ae===null||w(Ae)||(xe=Ae.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),xe&&xe.length&&(Ae=updateRanges(xe,Ae))),le.indexOf(".")>0?Z+=le+" = "+_.get(be)+`;
`:Z+="var "+le+" = "+Ae+`;
`})}else{let le=Object.keys(_);if(le.length){let xe,Ae={};for(let be=0;be<le.length;be++)if(xe=le[be].replace(/\!/g,"."),xe.indexOf(".")>0){let ae=ae.split(".");Ae[ae[0]]={}}xe=Object.keys(Ae);for(let be=0;be<xe.length;be++)Z+="var "+xe[be]+" = {};";for(let be=0;be<le.length;be++){if(xe=le[be].replace(/!/g,"."),_[le[be]]!==null&&!w(_[le[be]])){let ae=_[le[be]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ae&&ae.length&&(_[le[be]]=h(ae,_[le[be]]))}xe.indexOf(".")>0?Z+=xe+" = "+_[le[be]]+`;
`:Z+="var "+xe+" = "+_[le[be]]+`;
`}}}let se=(T=function(le,xe){let Ae="",be=0,ae=["=","!",">","<"];for(let Ve=0;Ve<le.length;Ve++)le[Ve]==='"'&&(be=be===0?1:0),be===1?Ae+=le[Ve]:(Ae+=le[Ve].toUpperCase(),Ve>0&&le[Ve]==="="&&ae.indexOf(le[Ve-1])===-1&&ae.indexOf(le[Ve+1])===-1&&(Ae+="="));return Ae=Ae.replace(/\^/g,"**"),Ae=Ae.replace(/<>/g,"!="),Ae=Ae.replace(/&/g,"+"),Ae=Ae.replace(/\$/g,""),Ae}(T=(T=T.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);se&&se.length&&(T=h(se,T));let he=new Function(Z+"; return "+T)();return he===null&&(he=0),he};return N.getColumnNameFromCoords=function(T,_){return M="",(k=parseInt(T))>701?(M+=String.fromCharCode(64+parseInt(k/676)),M+=String.fromCharCode(64+parseInt(k%676/26))):k>25&&(M+=String.fromCharCode(64+parseInt(k/26))),M+String.fromCharCode(65+k%26)+(parseInt(_)+1);var k,M},N.getCoordsFromColumnName=function(T){var _=/^[a-zA-Z]+/.exec(T);if(_){for(var k=0,M=0;M<_[0].length;M++)k+=parseInt(_[0].charCodeAt(M)-64)*Math.pow(26,_[0].length-1-M);--k<0&&(k=0);var D=parseInt(/[0-9]+$/.exec(T))||null;return D>0&&D--,[k,D]}},N.getRangeFromTokens=function(T){T=T.filter(function(D){return D!="#REF!"});for(var _="",k="",M=0;M<T.length;M++)T[M].indexOf(".")>=0?_=".":T[M].indexOf("!")>=0&&(_="!"),_&&(k=T[M].split(_),T[M]=k[1],k=k[0]+_);return T.sort(function(D,Z){var Y=Helpers.getCoordsFromColumnName(D),se=Helpers.getCoordsFromColumnName(Z);return Y[1]>se[1]?1:Y[1]<se[1]?-1:Y[0]>se[0]?1:Y[0]<se[0]?-1:0}),T.length?k+(T[0]+":")+T[T.length-1]:"#REF!"},N.getTokensFromRange=function(T){if(T.indexOf(".")>0){var _=T.split(".");T=_[1],_=_[0]+"."}else T.indexOf("!")>0?(_=T.split("!"),T=_[1],_=_[0]+"!"):_="";T=T.split(":");var k=N.getCoordsFromColumnName(T[0]),M=N.getCoordsFromColumnName(T[1]);if(k[0]<=M[0])var D=k[0],Z=M[0];else D=M[0],Z=k[0];if(k[1]===null&&M[1]==null)for(var Y=null,se=null,he=Object.keys(vars),le=0;le<he.length;le++){var xe=N.getCoordsFromColumnName(he[le]);xe[0]===k[0]&&(Y===null||xe[1]<Y)&&(Y=xe[1]),xe[0]===M[0]&&(se===null||xe[1]>se)&&(se=xe[1])}else k[1]<=M[1]?(Y=k[1],se=M[1]):(Y=M[1],se=k[1]);for(var Ae=[],be=Y;be<=se;be++){var ae=[];for(le=D;le<=Z;le++)ae.push(_+N.getColumnNameFromCoords(le,be));Ae.push(ae)}return Ae},N.setFormula=function(T){let _=Object.keys(T);for(let k=0;k<_.length;k++)typeof T[_[k]]=="function"&&(O[_[k]]=T[_[k]])},N.basic=!0,N}(typeof window=="undefined"?a.g:window)},592:function(P,c,a){"use strict";var j=a(162),O=a(765);const B=new Error("#NULL!"),g=new Error("#DIV/0!"),u=new Error("#VALUE!"),m=new Error("#REF!"),b=new Error("#NAME?"),h=new Error("#NUM!"),w=new Error("#N/A"),N=new Error("#ERROR!"),T=new Error("#GETTING_DATA");var _=Object.freeze({__proto__:null,data:T,div0:g,error:N,na:w,name:b,nil:B,num:h,ref:m,value:u});function k(e){const t=[];return M(e,r=>{t.push(r)}),t}function M(e,t){let r=-1;const p=e.length;for(;++r<p&&t(e[r],r,e)!==!1;);return e}function D(e){let t,r=e.length;for(;r--;)if(t=e[r],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const p=U(t);e[r]=p instanceof Error?0:p}}else e[r]=0;else e[r]=1;return e}function Z(e,t){if(!e)return u;e.every(L=>Array.isArray(L))&&e.length!==0||(e=[[...e]]),e.map((L,R)=>{L.map((W,ie)=>{W||(e[R][ie]=0)})});const r=e.reduce((L,R,W)=>R.length>e[L].length?W:L,0),p=e[r].length;return e.map(L=>[...L,...Array(p-L.length).fill(t||0)])}function Y(){let e;if(arguments.length===1){const r=arguments[0];e=(t=r)!=null&&typeof t.length=="number"&&typeof t!="string"?k.apply(null,arguments):[r]}else e=Array.from(arguments);for(var t;!he(e);)e=se(e);return e}function se(e){return e&&e.reduce?e.reduce((t,r)=>{const p=Array.isArray(t),L=Array.isArray(r);return p&&L?t.concat(r):p?(t.push(r),t):L?[t].concat(r):[t,r]}):[e]}function he(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function le(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function xe(e){return e?e[0].map((t,r)=>e.map(p=>p[r])):u}function Ae(e,t){let r=null;return M(e,(p,L)=>{if(p[0]===t)return r=L,!1}),r==null?u:r}function be(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function ae(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function Ve(e){return Math.round(e*1e14)/1e14}function Ge(){return Y.apply(null,arguments).filter(e=>typeof e=="number")}function Ye(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||u}function He(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?h:function(r){r<60&&(r+=1);const p=Math.floor(r-25569),L=new Date(86400*p*1e3),R=r-Math.floor(r)+1e-7;let W=Math.floor(86400*R);const ie=W%60;W-=ie;const de=Math.floor(W/3600),we=Math.floor(W/60)%60;let Se=L.getUTCDate(),Pe=L.getUTCMonth();return r>=60&&r<61&&(Se=29,Pe=1),new Date(L.getUTCFullYear(),Pe,Se,de,we,ie)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?u:e}function lt(e){let t,r=e.length;for(;r--;){if(t=He(e[r]),t===u)return t;e[r]=t}return e}function U(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?u:parseFloat(e))}function Le(e){let t,r;if(!e||(t=e.length)===0)return u;for(;t--;){if(e[t]instanceof Error)return e[t];if(r=U(e[t]),r instanceof Error)return r;e[t]=r}return e}function qe(e){return e instanceof Error?e:e==null?"":e.toString()}function De(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function Te(e){return e!=null}const Fe="=",_e=[">",">=","<","<=","=","<>"],Ke="operator",Je="literal",ut=[Ke,Je],ft=Ke,ct=Je;function ht(e,t){if(ut.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function vt(e){return function(t){let r="";const p=[];for(let L=0;L<t.length;L++){const R=t[L];L===0&&_e.indexOf(R)>=0?p.push(ht(R,ft)):r+=R}return r.length>0&&p.push(ht(function(L){return typeof L!="string"||/^\d+(\.\d+)?$/.test(L)&&(L=L.indexOf(".")===-1?parseInt(L,10):parseFloat(L)),L}(r),ct)),p.length>0&&p[0].type!==ft&&p.unshift(ht(Fe,ft)),p}(function(t){const r=t.length,p=[];let L=0,R="",W="";for(;L<r;){const ie=t.charAt(L);switch(ie){case">":case"<":case"=":W+=ie,R.length>0&&(p.push(R),R="");break;default:W.length>0&&(p.push(W),W=""),R+=ie}L++}return R.length>0&&p.push(R),W.length>0&&p.push(W),p}(e))}const gt=function(e){const t=[];let r;for(let p=0;p<e.length;p++){const L=e[p];switch(L.type){case ft:r=L.value;break;case ct:t.push(L.value)}}return function(p,L){let R=!1;switch(L){case">":R=p[0]>p[1];break;case">=":R=p[0]>=p[1];break;case"<":R=p[0]<p[1];break;case"<=":R=p[0]<=p[1];break;case"=":R=p[0]==p[1];break;case"<>":R=p[0]!=p[1]}return R}(t,r)},St={};function mt(e){return[u,m,g,h,b,B].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function Tt(e){return mt(e)||e===w}function Ft(e){return e===!0||e===!1}function v(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function C(e){return typeof e=="string"}function l(){const e=[];for(let t=0;t<arguments.length;++t){let r=!1;const p=arguments[t];for(let L=0;L<e.length&&(r=e[L]===p,!r);++L);r||e.push(p)}return e}function o(e,t,r,p){if(!t||!r)return w;p=!(p===0||p===!1);let L=w;const R=typeof e=="number";let W=!1;for(let ie=0;ie<t.length;ie++){const de=t[ie];if(de[0]===e){L=r<de.length+1?de[r-1]:m;break}!W&&(R&&p&&de[0]<=e||p&&typeof de[0]=="string"&&de[0].localeCompare(e)<0)&&(L=r<de.length+1?de[r-1]:m),R&&de[0]>e&&(W=!0)}return L}function S(){const e=Y(arguments).filter(Te);if(e.length===0)return g;const t=be.apply(void 0,e);if(t)return t;const r=Ge(e),p=r.length;let L,R=0,W=0;for(let ie=0;ie<p;ie++)R+=r[ie],W+=1;return L=R/W,isNaN(L)&&(L=h),L}function q(){const e=Y(arguments).filter(Te);if(e.length===0)return g;const t=be.apply(void 0,e);if(t)return t;const r=e,p=r.length;let L,R=0,W=0;for(let ie=0;ie<p;ie++){const de=r[ie];typeof de=="number"&&(R+=de),de===!0&&R++,de!==null&&W++}return L=R/W,isNaN(L)&&(L=h),L}St.TYPE=e=>{switch(e){case B:return 1;case g:return 2;case u:return 3;case m:return 4;case b:return 5;case h:return 6;case w:return 7;case T:return 8}return w};const G={DIST:function(e,t,r,p,L,R){return arguments.length<4?u:(L=L===void 0?0:L,R=R===void 0?1:R,ae(e=U(e),t=U(t),r=U(r),L=U(L),R=U(R))?u:(e=(e-L)/(R-L),p?j.beta.cdf(e,t,r):j.beta.pdf(e,t,r)))},INV:(e,t,r,p,L)=>(p=p===void 0?0:p,L=L===void 0?1:L,ae(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L))?u:j.beta.inv(e,t,r)*(L-p)+p)},z={DIST:(e,t,r,p)=>ae(e=U(e),t=U(t),r=U(r),p=U(p))?u:p?j.binomial.cdf(e,t,r):j.binomial.pdf(e,t,r)};z.DIST.RANGE=(e,t,r,p)=>{if(p=p===void 0?r:p,ae(e=U(e),t=U(t),r=U(r),p=U(p)))return u;let L=0;for(let R=r;R<=p;R++)L+=et(e,R)*Math.pow(t,R)*Math.pow(1-t,e-R);return L},z.INV=(e,t,r)=>{if(ae(e=U(e),t=U(t),r=U(r)))return u;let p=0;for(;p<=e;){if(j.binomial.cdf(p,e,t)>=r)return p;p++}};const V={DIST:(e,t,r)=>ae(e=U(e),t=U(t))?u:r?j.chisquare.cdf(e,t):j.chisquare.pdf(e,t)};V.DIST.RT=(e,t)=>!e|!t?w:e<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?u:1-j.chisquare.cdf(e,t),V.INV=(e,t)=>ae(e=U(e),t=U(t))?u:j.chisquare.inv(e,t),V.INV.RT=(e,t)=>!e|!t?w:e<0||e>1||t<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?u:j.chisquare.inv(1-e,t),V.TEST=function(e,t){if(arguments.length!==2)return w;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return u;const r=e.length;let p,L,R;for(L=0;L<r;L++)e[L]instanceof Array||(p=e[L],e[L]=[],e[L].push(p)),t[L]instanceof Array||(p=t[L],t[L]=[],t[L].push(p));const W=e[0].length,ie=W===1?r-1:(r-1)*(W-1);let de=0;const we=Math.PI;for(L=0;L<r;L++)for(R=0;R<W;R++)de+=Math.pow(e[L][R]-t[L][R],2)/t[L][R];return Math.round(1e6*function(Se,Pe){let Re=Math.exp(-.5*Se);Pe%2==1&&(Re*=Math.sqrt(2*Se/we));let ze=Pe;for(;ze>=2;)Re=Re*Se/ze,ze-=2;let tt=Re,ot=Pe;for(;tt>1e-10*Re;)ot+=2,tt=tt*Se/ot,Re+=tt;return 1-Re}(de,ie))/1e6};const H={};function J(){return Ge(Y(arguments)).length}function oe(){const e=Y(arguments);return e.length-je(e)}function je(){const e=Y(arguments);let t,r=0;for(let p=0;p<e.length;p++)t=e[p],t!=null&&t!==""||r++;return r}H.NORM=(e,t,r)=>ae(e=U(e),t=U(t),r=U(r))?u:j.normalci(1,e,t,r)[1]-1,H.T=(e,t,r)=>ae(e=U(e),t=U(t),r=U(r))?u:j.tci(1,e,t,r)[1]-1;const ue={P:(e,t)=>{if(ae(e=Le(Y(e)),t=Le(Y(t))))return u;const r=j.mean(e),p=j.mean(t);let L=0;const R=e.length;for(let W=0;W<R;W++)L+=(e[W]-r)*(t[W]-p);return L/R},S:(e,t)=>ae(e=Le(Y(e)),t=Le(Y(t)))?u:j.covariance(e,t)},te={DIST:(e,t,r)=>ae(e=U(e),t=U(t))?u:r?j.exponential.cdf(e,t):j.exponential.pdf(e,t)},ge={};function ye(e,t,r){if(ae(e=U(e),t=Le(Y(t)),r=Le(Y(r))))return u;const p=j.mean(r),L=j.mean(t),R=r.length;let W=0,ie=0;for(let we=0;we<R;we++)W+=(r[we]-p)*(t[we]-L),ie+=Math.pow(r[we]-p,2);const de=W/ie;return L-de*p+de*e}function ke(e){return(e=U(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?h:j.gammafn(e)}function We(e){return(e=U(e))instanceof Error?e:j.gammaln(e)}ge.DIST=(e,t,r,p)=>ae(e=U(e),t=U(t),r=U(r))?u:p?j.centralF.cdf(e,t,r):j.centralF.pdf(e,t,r),ge.DIST.RT=function(e,t,r){return arguments.length!==3?w:e<0||t<1||r<1?h:typeof e!="number"||typeof t!="number"||typeof r!="number"?u:1-j.centralF.cdf(e,t,r)},ge.INV=(e,t,r)=>ae(e=U(e),t=U(t),r=U(r))?u:e<=0||e>1?h:j.centralF.inv(e,t,r),ge.INV.RT=function(e,t,r){return arguments.length!==3?w:e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"||typeof r!="number"?u:j.centralF.inv(1-e,t,r)},ge.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return w;if(e.length<2||t.length<2)return g;const r=(R,W)=>{let ie=0;for(let de=0;de<R.length;de++)ie+=Math.pow(R[de]-W,2);return ie},p=At(e)/e.length,L=At(t)/t.length;return r(e,p)/(e.length-1)/(r(t,L)/(t.length-1))},ke.DIST=function(e,t,r,p){return arguments.length!==4?w:e<0||t<=0||r<=0||typeof e!="number"||typeof t!="number"||typeof r!="number"?u:p?j.gamma.cdf(e,t,r,!0):j.gamma.pdf(e,t,r,!1)},ke.INV=function(e,t,r){return arguments.length!==3?w:e<0||e>1||t<=0||r<=0?h:typeof e!="number"||typeof t!="number"||typeof r!="number"?u:j.gamma.inv(e,t,r)},We.PRECISE=function(e){return arguments.length!==1?w:e<=0?h:typeof e!="number"?u:j.gammaln(e)};const Qe={};function fe(e,t){return ae(e=Le(Y(e)),t=U(t))?e:t<0||e.length<t?u:e.sort((r,p)=>p-r)[t-1]}function Ee(e,t){if(ae(e=Le(Y(e)),t=Le(Y(t))))return u;const r=j.mean(e),p=j.mean(t),L=t.length;let R=0,W=0;for(let de=0;de<L;de++)R+=(t[de]-p)*(e[de]-r),W+=Math.pow(t[de]-p,2);const ie=R/W;return[ie,r-ie*p]}Qe.DIST=(e,t,r,p,L)=>{if(ae(e=U(e),t=U(t),r=U(r),p=U(p)))return u;function R(W,ie,de,we){return et(de,W)*et(we-de,ie-W)/et(we,ie)}return L?function(W,ie,de,we){let Se=0;for(let Pe=0;Pe<=W;Pe++)Se+=R(Pe,ie,de,we);return Se}(e,t,r,p):R(e,t,r,p)};const K={};function X(){const e=Y(arguments),t=be.apply(void 0,e);if(t)return t;const r=Ge(e);return r.length===0?0:Math.max.apply(Math,r)}function re(){const e=Y(arguments),t=be.apply(void 0,e);if(t)return t;const r=D(e);let p=j.median(r);return isNaN(p)&&(p=h),p}function A(){const e=Y(arguments),t=be.apply(void 0,e);if(t)return t;const r=Ge(e);return r.length===0?0:Math.min.apply(Math,r)}K.DIST=(e,t,r,p)=>ae(e=U(e),t=U(t),r=U(r))?u:p?j.lognormal.cdf(e,t,r):j.lognormal.pdf(e,t,r),K.INV=(e,t,r)=>ae(e=U(e),t=U(t),r=U(r))?u:j.lognormal.inv(e,t,r);const F={MULT:function(){const e=Le(Y(arguments));if(e instanceof Error)return e;const t=e.length,r={};let p,L=[],R=0;for(let W=0;W<t;W++)p=e[W],r[p]=r[p]?r[p]+1:1,r[p]>R&&(R=r[p],L=[]),r[p]===R&&(L[L.length]=p);return L},SNGL:function(){const e=Le(Y(arguments));return e instanceof Error?e:F.MULT(e).sort((t,r)=>t-r)[0]}},ee={DIST:(e,t,r,p)=>ae(e=U(e),t=U(t),r=U(r))?u:p?j.negbin.cdf(e,t,r):j.negbin.pdf(e,t,r)},pe={};function ce(e,t){if(ae(t=Le(Y(t)),e=Le(Y(e))))return u;const r=j.mean(e),p=j.mean(t),L=e.length;let R=0,W=0,ie=0;for(let de=0;de<L;de++)R+=(e[de]-r)*(t[de]-p),W+=Math.pow(e[de]-r,2),ie+=Math.pow(t[de]-p,2);return R/Math.sqrt(W*ie)}pe.DIST=(e,t,r,p)=>ae(e=U(e),t=U(t),r=U(r))?u:r<=0?h:p?j.normal.cdf(e,t,r):j.normal.pdf(e,t,r),pe.INV=(e,t,r)=>ae(e=U(e),t=U(t),r=U(r))?u:j.normal.inv(e,t,r),pe.S={},pe.S.DIST=(e,t)=>(e=U(e))instanceof Error?u:t?j.normal.cdf(e,0,1):j.normal.pdf(e,0,1),pe.S.INV=e=>(e=U(e))instanceof Error?u:j.normal.inv(e,0,1);const Q={EXC:(e,t)=>{if(ae(e=Le(Y(e)),t=U(t)))return u;const r=(e=e.sort((R,W)=>R-W)).length;if(t<1/(r+1)||t>1-1/(r+1))return h;const p=t*(r+1)-1,L=Math.floor(p);return Ve(p===L?e[p]:e[L]+(p-L)*(e[L+1]-e[L]))},INC:(e,t)=>{if(ae(e=Le(Y(e)),t=U(t)))return u;const r=t*((e=e.sort((L,R)=>L-R)).length-1),p=Math.floor(r);return Ve(r===p?e[r]:e[p]+(r-p)*(e[p+1]-e[p]))}},ve={EXC:(e,t,r)=>{if(r=r===void 0?3:r,ae(e=Le(Y(e)),t=U(t),r=U(r)))return u;e=e.sort((Se,Pe)=>Se-Pe);const p=l.apply(null,e),L=e.length,R=p.length,W=Math.pow(10,r);let ie=0,de=!1,we=0;for(;!de&&we<R;)t===p[we]?(ie=(e.indexOf(p[we])+1)/(L+1),de=!0):t>=p[we]&&(t<p[we+1]||we===R-1)&&(ie=(e.indexOf(p[we])+1+(t-p[we])/(p[we+1]-p[we]))/(L+1),de=!0),we++;return Math.floor(ie*W)/W},INC:(e,t,r)=>{if(r=r===void 0?3:r,ae(e=Le(Y(e)),t=U(t),r=U(r)))return u;e=e.sort((Se,Pe)=>Se-Pe);const p=l.apply(null,e),L=e.length,R=p.length,W=Math.pow(10,r);let ie=0,de=!1,we=0;for(;!de&&we<R;)t===p[we]?(ie=e.indexOf(p[we])/(L-1),de=!0):t>=p[we]&&(t<p[we+1]||we===R-1)&&(ie=(e.indexOf(p[we])+(t-p[we])/(p[we+1]-p[we]))/(L-1),de=!0),we++;return Math.floor(ie*W)/W}},Me={DIST:(e,t,r)=>ae(e=U(e),t=U(t))?u:r?j.poisson.cdf(e,t):j.poisson.pdf(e,t)},Ne={EXC:(e,t)=>{if(ae(e=Le(Y(e)),t=U(t)))return u;switch(t){case 1:return Q.EXC(e,.25);case 2:return Q.EXC(e,.5);case 3:return Q.EXC(e,.75);default:return h}},INC:(e,t)=>{if(ae(e=Le(Y(e)),t=U(t)))return u;switch(t){case 1:return Q.INC(e,.25);case 2:return Q.INC(e,.5);case 3:return Q.INC(e,.75);default:return h}}},Ie={};function Be(){const e=Le(Y(arguments));if(e instanceof Error)return e;const t=j.mean(e),r=e.length;let p=0;for(let L=0;L<r;L++)p+=Math.pow(e[L]-t,3);return r*p/((r-1)*(r-2)*Math.pow(j.stdev(e,!0),3))}function $e(e,t){return ae(e=Le(Y(e)),t=U(t))?e:e.sort((r,p)=>r-p)[t-1]}Ie.AVG=(e,t,r)=>{if(ae(e=U(e),t=Le(Y(t))))return u;const p=(r=r||!1)?(W,ie)=>W-ie:(W,ie)=>ie-W,L=(t=(t=Y(t)).sort(p)).length;let R=0;for(let W=0;W<L;W++)t[W]===e&&R++;return R>1?(2*t.indexOf(e)+R+1)/2:t.indexOf(e)+1},Ie.EQ=(e,t,r)=>{if(ae(e=U(e),t=Le(Y(t))))return u;const p=(r=r||!1)?(L,R)=>L-R:(L,R)=>R-L;return(t=t.sort(p)).indexOf(e)+1},Be.P=function(){const e=Le(Y(arguments));if(e instanceof Error)return e;const t=j.mean(e),r=e.length;let p=0,L=0;for(let R=0;R<r;R++)L+=Math.pow(e[R]-t,3),p+=Math.pow(e[R]-t,2);return L/=r,p/=r,L/Math.pow(p,1.5)};const nt={P:function(){const e=me.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},S:function(){const e=me.S.apply(this,arguments);return Math.sqrt(e)}},ne={DIST:(e,t,r)=>r!==1&&r!==2?h:r===1?ne.DIST.RT(e,t):ne.DIST["2T"](e,t)};ne.DIST["2T"]=function(e,t){return arguments.length!==2?w:e<0||t<1?h:typeof e!="number"||typeof t!="number"?u:2*(1-j.studentt.cdf(e,t))},ne.DIST.RT=function(e,t){return arguments.length!==2?w:e<0||t<1?h:typeof e!="number"||typeof t!="number"?u:1-j.studentt.cdf(e,t)},ne.INV=(e,t)=>ae(e=U(e),t=U(t))?u:j.studentt.inv(e,t),ne.INV["2T"]=(e,t)=>(e=U(e),t=U(t),e<=0||e>1||t<1?h:ae(e,t)?u:Math.abs(j.studentt.inv(e/2,t))),ne.TEST=(e,t)=>{if(ae(e=Le(Y(e)),t=Le(Y(t))))return u;const r=j.mean(e),p=j.mean(t);let L,R=0,W=0;for(L=0;L<e.length;L++)R+=Math.pow(e[L]-r,2);for(L=0;L<t.length;L++)W+=Math.pow(t[L]-p,2);R/=e.length-1,W/=t.length-1;const ie=Math.abs(r-p)/Math.sqrt(R/e.length+W/t.length);return ne.DIST["2T"](ie,e.length+t.length-2)};const me={};function Ce(){const e=Y(arguments),t=e.length;let r=0,p=0;const L=q(e);for(let R=0;R<t;R++){const W=e[R];r+=Math.pow(typeof W=="number"?W-L:W===!0?1-L:0-L,2),W!==null&&p++}return r/(p-1)}function Oe(){const e=Y(arguments),t=e.length;let r=0,p=0;const L=q(e);let R;for(let W=0;W<t;W++){const ie=e[W];r+=Math.pow(typeof ie=="number"?ie-L:ie===!0?1-L:0-L,2),ie!==null&&p++}return R=r/p,isNaN(R)&&(R=h),R}me.P=function(){const e=Ge(Y(arguments)),t=e.length;let r=0;const p=S(e);let L;for(let R=0;R<t;R++)r+=Math.pow(e[R]-p,2);return L=r/t,isNaN(L)&&(L=h),L},me.S=function(){const e=Ge(Y(arguments)),t=e.length;let r=0;const p=S(e);for(let L=0;L<t;L++)r+=Math.pow(e[L]-p,2);return r/(t-1)};const rt={DIST:(e,t,r,p)=>ae(e=U(e),t=U(t),r=U(r))?u:p?1-Math.exp(-Math.pow(e/r,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/r,t))*t/Math.pow(r,t)},Xe={};function Ze(e,t,r){const p=be(e=U(e),t=U(t),r=U(r));if(p)return p;if(t===0)return 0;t=Math.abs(t);const L=-Math.floor(Math.log(t)/Math.log(10));return e>=0?wt(Math.ceil(e/t)*t,L):r===0?-wt(Math.floor(Math.abs(e)/t)*t,L):-wt(Math.ceil(Math.abs(e)/t)*t,L)}function et(e,t){return be(e=U(e),t=U(t))||(e<t?h:st(e)/(st(t)*st(e-t)))}Xe.TEST=(e,t,r)=>{if(ae(e=Le(Y(e)),t=U(t)))return u;r=r||nt.S(e);const p=e.length;return 1-pe.S.DIST((S(e)-t)/(r/Math.sqrt(p)),!0)},Ze.MATH=Ze,Ze.PRECISE=Ze;const Ue=[];function st(e){if((e=U(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(Ue[t]>0||(Ue[t]=st(t-1)*t),Ue[t])}function xt(e,t){const r=be(e=U(e),t=U(t));if(r)return r;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return h;t=Math.abs(t);const p=-Math.floor(Math.log(t)/Math.log(10));return e>=0?wt(Math.floor(e/t)*t,p):-wt(Math.ceil(Math.abs(e)/t),p)}xt.MATH=(e,t,r)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const p=be(e=U(e),t=U(t),r=U(r));if(p)return p;if(t===0)return 0;t=t?Math.abs(t):1;const L=-Math.floor(Math.log(t)/Math.log(10));return e>=0?wt(Math.floor(e/t)*t,L):r===0||r===void 0?-wt(Math.ceil(Math.abs(e)/t)*t,L):-wt(Math.floor(Math.abs(e)/t)*t,L)},xt.PRECISE=xt.MATH;const hn={CEILING:Ze};function en(e,t){const r=be(e=U(e),t=U(t));if(r)return r;if(e===0&&t===0)return h;const p=Math.pow(e,t);return isNaN(p)?h:p}function Vt(){const e=Y(arguments).filter(p=>p!=null);if(e.length===0)return 0;const t=Le(e);if(t instanceof Error)return t;let r=1;for(let p=0;p<t.length;p++)r*=t[p];return r}function wt(e,t){return be(e=U(e),t=U(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function At(){let e=0;return M(k(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const r=parseFloat(t);!isNaN(r)&&(e+=r)}else if(Array.isArray(t)){const r=At.apply(null,t);r instanceof Error?e=r:e+=r}}),e}var gn=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?w:be(e=U(e),t=U(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?w:be(e=U(e),t=U(t))||(t===0?g:e/t)},EQ:function(e,t){return arguments.length!==2?w:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?w:e instanceof Error?e:t instanceof Error?t:(De(e,t)?(e=qe(e),t=qe(t)):(e=U(e),t=U(t)),be(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?w:(De(e,t)?(e=qe(e),t=qe(t)):(e=U(e),t=U(t)),be(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?w:(De(e,t)?(e=qe(e),t=qe(t)):(e=U(e),t=U(t)),be(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?w:(De(e,t)?(e=qe(e),t=qe(t)):(e=U(e),t=U(t)),be(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?w:be(e=U(e),t=U(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?w:be(e=U(e),t=U(t))||e*t},NE:function(e,t){return arguments.length!==2?w:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?w:en(e,t)}});const mn=new Date(Date.UTC(1900,0,1)),bn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],jn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Ot=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function It(e,t,r){r=r.toUpperCase(),e=He(e),t=He(t);const p=e.getFullYear(),L=e.getMonth(),R=e.getDate(),W=t.getFullYear(),ie=t.getMonth(),de=t.getDate();let we;switch(r){case"Y":we=Math.floor(Yt(e,t));break;case"D":we=Lt(t,e);break;case"M":we=ie-L+12*(W-p),de<R&&we--;break;case"MD":R<=de?we=de-R:(ie===0?(e.setFullYear(W-1),e.setMonth(12)):(e.setFullYear(W),e.setMonth(ie-1)),we=Lt(t,e));break;case"YM":we=ie-L+12*(W-p),de<R&&we--,we%=12;break;case"YD":ie>L||ie===L&&de<R?e.setFullYear(W):e.setFullYear(W-1),we=Lt(t,e)}return we}function kt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Lt(e,t){return e=He(e),t=He(t),e instanceof Error?e:t instanceof Error?t:nn(kt(e))-nn(kt(t))}function Ct(e,t,r){if(r=Ye(r||"false"),e=He(e),t=He(t),e instanceof Error)return e;if(t instanceof Error)return t;if(r instanceof Error)return r;const p=e.getMonth();let L,R,W=t.getMonth();if(r)L=e.getDate()===31?30:e.getDate(),R=t.getDate()===31?30:t.getDate();else{const ie=new Date(e.getFullYear(),p+1,0).getDate(),de=new Date(t.getFullYear(),W+1,0).getDate();L=e.getDate()===ie?30:e.getDate(),t.getDate()===de?L<30?(W++,R=1):R=30:R=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(W-p)+(R-L)}function tn(e){if((e=He(e))instanceof Error)return e;(e=kt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function Rt(e,t,r){return Rt.INTL(e,t,1,r)}function Ht(e,t,r){return Ht.INTL(e,t,1,r)}function Ut(e){return new Date(e,1,29).getMonth()===1}function Bt(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function Yt(e,t,r){if((e=He(e))instanceof Error)return e;if((t=He(t))instanceof Error)return t;r=r||0;let p=e.getDate();const L=e.getMonth()+1,R=e.getFullYear();let W=t.getDate();const ie=t.getMonth()+1,de=t.getFullYear();switch(r){case 0:return p===31&&W===31?(p=30,W=30):p===31?p=30:p===30&&W===31&&(W=30),(W+30*ie+360*de-(p+30*L+360*R))/360;case 1:{const we=(ze,tt)=>{const ot=ze.getFullYear(),bt=new Date(ot,2,1);if(Ut(ot)&&ze<bt&&tt>=bt)return!0;const dt=tt.getFullYear(),Et=new Date(dt,2,1);return Ut(dt)&&tt>=Et&&ze<Et};let Se=365;if(R===de||R+1===de&&(L>ie||L===ie&&p>=W))return(R===de&&Ut(R)||we(e,t)||ie===1&&W===29)&&(Se=366),Bt(e,t)/Se;const Pe=de-R+1,Re=(new Date(de+1,0,1)-new Date(R,0,1))/1e3/60/60/24/Pe;return Bt(e,t)/Re}case 2:return Bt(e,t)/360;case 3:return Bt(e,t)/365;case 4:return(W+30*ie+360*de-(p+30*L+360*R))/360}}function nn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-mn)/864e5)+t}function on(e){return(e=U(e))===0?u:e instanceof Error?e:String.fromCharCode(e)}function rn(e){if(ae(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=u),t}function an(){const e=Y(arguments),t=be.apply(void 0,e);if(t)return t;let r=0;for(;(r=e.indexOf(!0))>-1;)e[r]="TRUE";let p=0;for(;(p=e.indexOf(!1))>-1;)e[p]="FALSE";return e.join("")}Rt.INTL=(e,t,r,p)=>{if((e=He(e))instanceof Error)return e;if((t=He(t))instanceof Error)return t;let L=!1;const R=[],W=[1,2,3,4,5,6,0],ie=new RegExp("^[0|1]{7}$");if(r===void 0)r=Ot[1];else if(typeof r=="string"&&ie.test(r)){L=!0,r=r.split("");for(let Pe=0;Pe<r.length;Pe++)r[Pe]==="1"&&R.push(W[Pe])}else r=Ot[r];if(!(r instanceof Array))return u;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let Pe=0;Pe<p.length;Pe++){const Re=He(p[Pe]);if(Re instanceof Error)return Re;p[Pe]=Re}const de=Math.round((t-e)/864e5)+1;let we=de;const Se=e;for(let Pe=0;Pe<de;Pe++){const Re=new Date().getTimezoneOffset()>0?Se.getUTCDay():Se.getDay();let ze=L?R.includes(Re):Re===r[0]||Re===r[1];for(let tt=0;tt<p.length;tt++){const ot=p[tt];if(ot.getDate()===Se.getDate()&&ot.getMonth()===Se.getMonth()&&ot.getFullYear()===Se.getFullYear()){ze=!0;break}}ze&&we--,Se.setDate(Se.getDate()+1)}return we},Ht.INTL=(e,t,r,p)=>{if((e=He(e))instanceof Error)return e;if((t=U(t))instanceof Error)return t;if(t<0)return h;if(!((r=r===void 0?Ot[1]:Ot[r])instanceof Array))return u;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let R=0;R<p.length;R++){const W=He(p[R]);if(W instanceof Error)return W;p[R]=W}let L=0;for(;L<t;){e.setDate(e.getDate()+1);const R=e.getDay();if(R!==r[0]&&R!==r[1]){for(let W=0;W<p.length;W++){const ie=p[W];if(ie.getDate()===e.getDate()&&ie.getMonth()===e.getMonth()&&ie.getFullYear()===e.getFullYear()){L--;break}}L++}}return e};const vn=an;function sn(e,t=2,r=!1){if(e=U(e),isNaN(e)||(t=U(t),isNaN(t)))return u;if(t<0){const p=Math.pow(10,-t);e=Math.round(e/p)*p}else e=e.toFixed(t);if(r)e=e.toString().replace(/,/g,"");else{const p=e.toString().split(".");p[0]=p[0].replace(/\B(?=(\d{3})+$)/g,","),e=p.join(".")}return e}function jt(e,t){return be(e,t)||(e=qe(e),(t=U(t))instanceof Error?t:new Array(t+1).join(e))}const yn=on,xn=rn;function qt(e){return/^[01]{1,10}$/.test(e)}function pt(e,t,r){if(ae(e=U(e),t=U(t)))return e;if((r=r===void 0?"i":r)!=="i"&&r!=="j")return u;if(e===0&&t===0)return 0;if(e===0)return t===1?r:t.toString()+r;if(t===0)return e.toString();{const p=t>0?"+":"";return e.toString()+p+(t===1?r:t.toString()+r)}}function zt(e,t){return t=t===void 0?0:t,ae(e=U(e),t=U(t))?u:j.erf(e)}function Wt(e){return isNaN(e)?u:j.erfc(e)}function Xt(e){const t=at(e),r=it(e);return ae(t,r)?u:Math.sqrt(Math.pow(t,2)+Math.pow(r,2))}function it(e){if(e===void 0||e===!0||e===!1)return u;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),r=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),r===0&&(r=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),L=p==="i"||p==="j";return t>=0||r>=0?L?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?h:-Number(e.substring(r+1,e.length-1)):h:L?isNaN(e.substring(0,e.length-1))?h:e.substring(0,e.length-1):isNaN(e)?h:0}function Gt(e){const t=at(e),r=it(e);return ae(t,r)?u:t===0&&r===0?g:t===0&&r>0?Math.PI/2:t===0&&r<0?-Math.PI/2:r===0&&t>0?0:r===0&&t<0?-Math.PI:t>0?Math.atan(r/t):t<0&&r>=0?Math.atan(r/t)+Math.PI:Math.atan(r/t)-Math.PI}function _t(e){const t=at(e),r=it(e);if(ae(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(t)*(Math.exp(r)+Math.exp(-r))/2,-Math.sin(t)*(Math.exp(r)-Math.exp(-r))/2,p)}function ln(e){const t=at(e),r=it(e);if(ae(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2,p)}function Mt(e,t){const r=at(e),p=it(e),L=at(t),R=it(t);if(ae(r,p,L,R))return u;const W=e.substring(e.length-1),ie=t.substring(t.length-1);let de="i";if((W==="j"||ie==="j")&&(de="j"),L===0&&R===0)return h;const we=L*L+R*R;return pt((r*L+p*R)/we,(p*L-r*R)/we,de)}function at(e){if(e===void 0||e===!0||e===!1)return u;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),r=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),r===0&&(r=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),L=p==="i"||p==="j";return t>=0||r>=0?L?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(0,t)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?h:Number(e.substring(0,r)):h:L?isNaN(e.substring(0,e.length-1))?h:0:isNaN(e)?h:e}function Pt(e){const t=at(e),r=it(e);if(ae(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.sin(t)*(Math.exp(r)+Math.exp(-r))/2,Math.cos(t)*(Math.exp(r)-Math.exp(-r))/2,p)}function un(e){const t=at(e),r=it(e);if(ae(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2,p)}zt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Wt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const wn=G.DIST,Cn=G.INV,En=z.DIST,An=Ze.MATH,Ln=Ze.PRECISE,Mn=V.DIST,Nn=V.DIST.RT,Tn=V.INV,In=V.INV.RT,Dn=V.TEST,Sn=ue.P,Fn=ue.P,On=ue.S,kn=z.INV,Rn=Wt.PRECISE,Hn=zt.PRECISE,Bn=te.DIST,_n=ge.DIST,Pn=ge.DIST.RT,Vn=ge.INV,Un=ge.INV.RT,Yn=xt.MATH,qn=xt.PRECISE,zn=ge.TEST,Wn=ke.DIST,Xn=ke.INV,Gn=We.PRECISE,Kn=Qe.DIST,$n=K.INV,Jn=K.DIST,Zn=K.INV,Qn=F.MULT,eo=F.SNGL,to=ee.DIST,no=Rt.INTL,oo=pe.DIST,ro=pe.INV,io=pe.S.DIST,ao=pe.S.INV,so=Q.EXC,lo=Q.INC,uo=ve.EXC,co=ve.INC,fo=Me.DIST,po=Ne.EXC,ho=Ne.INC,go=Ie.AVG,mo=Ie.EQ,bo=Be.P,jo=nt.P,vo=nt.S,yo=ne.DIST,xo=ne.DIST.RT,wo=ne.INV,Co=ne.TEST,Eo=me.P,Ao=me.S,Lo=rt.DIST,Mo=Ht.INTL,No=Xe.TEST;function Kt(e){const t=[];return M(e,r=>{r&&t.push(r)}),t}function yt(e,t){const r={};for(let R=1;R<e[0].length;++R)r[R]=!0;let p=t[0].length;for(let R=1;R<t.length;++R)t[R].length>p&&(p=t[R].length);for(let R=1;R<e.length;++R)for(let W=1;W<e[R].length;++W){let ie=!1,de=!1;for(let we=0;we<t.length;++we){const Se=t[we];if(Se.length<p)continue;const Pe=Se[0];if(e[R][0]===Pe){de=!0;for(let Re=1;Re<Se.length;++Re)if(!ie)if(Se[Re]===void 0||Se[Re]==="*")ie=!0;else{const ze=vt(Se[Re]+""),tt=[ht(e[R][W],ct)].concat(ze);ie=gt(tt)}}}de&&(r[W]=r[W]&&ie)}const L=[];for(let R=0;R<e[0].length;++R)r[R]&&L.push(R-1);return L}function $t(e){return e&&e.getTime&&!isNaN(e.getTime())}function Jt(e){return e instanceof Date?e:new Date(e)}function Nt(e,t,r,p,L){if(p=p||0,L=L||0,ae(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L)))return u;let R;if(e===0)R=p+r*t;else{const W=Math.pow(1+e,t);R=L===1?p*W+r*(1+e)*(W-1)/e:p*W+r*(W-1)/e}return-R}function cn(e,t,r,p,L,R){if(L=L||0,R=R||0,ae(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L),R=U(R)))return u;const W=Dt(e,r,p,L,R);return(t===1?R===1?0:-p:R===1?Nt(e,t-2,W,p,1)-W:Nt(e,t-1,W,p,0))*e}function Zt(){const e=Le(Y(arguments));if(e instanceof Error)return e;const t=e[0];let r=0;for(let p=1;p<e.length;p++)r+=e[p]/Math.pow(1+t,p);return r}function Dt(e,t,r,p,L){if(p=p||0,L=L||0,ae(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L)))return u;let R;if(e===0)R=(r+p)/t;else{const W=Math.pow(1+e,t);R=L===1?(p*e/(W-1)+r*e/(1-1/W))/(1+e):p*e/(W-1)+r*e/(1-1/W)}return-R}const To={errors:_,symbols:gn};c.ABS=function(e){return(e=U(e))instanceof Error?e:Math.abs(e)},c.ACCRINT=function(e,t,r,p,L,R,W){return e=Jt(e),t=Jt(t),r=Jt(r),$t(e)&&$t(t)&&$t(r)?p<=0||L<=0||[1,2,4].indexOf(R)===-1||[0,1,2,3,4].indexOf(W)===-1||r<=e?h:(L=L||0)*p*Yt(e,r,W=W||0):u},c.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},c.ACOS=function(e){if((e=U(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=h),t},c.ACOSH=function(e){if((e=U(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=h),t},c.ACOT=function(e){return(e=U(e))instanceof Error?e:Math.atan(1/e)},c.ACOTH=function(e){if((e=U(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=h),t},c.AGGREGATE=function(e,t,r,p){if(ae(e=U(e),U(e)))return u;switch(e){case 1:return S(r);case 2:return J(r);case 3:return oe(r);case 4:return X(r);case 5:return A(r);case 6:return Vt(r);case 7:return nt.S(r);case 8:return nt.P(r);case 9:return At(r);case 10:return me.S(r);case 11:return me.P(r);case 12:return re(r);case 13:return F.SNGL(r);case 14:return fe(r,p);case 15:return $e(r,p);case 16:return Q.INC(r,p);case 17:return Ne.INC(r,p);case 18:return Q.EXC(r,p);case 19:return Ne.EXC(r,p)}},c.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},c.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},c.AND=function(){const e=Y(arguments);let t=u;for(let r=0;r<e.length;r++){if(e[r]instanceof Error)return e[r];e[r]!==void 0&&e[r]!==null&&typeof e[r]!="string"&&(t===u&&(t=!0),e[r]||(t=!1))}return t},c.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return u;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,r=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),t},c.ASC=function(){throw new Error("ASC is not implemented")},c.ASIN=function(e){if((e=U(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=h),t},c.ASINH=function(e){return(e=U(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},c.ATAN=function(e){return(e=U(e))instanceof Error?e:Math.atan(e)},c.ATAN2=function(e,t){return be(e=U(e),t=U(t))||Math.atan2(e,t)},c.ATANH=function(e){if((e=U(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=h),t},c.AVEDEV=function(){const e=Y(arguments).filter(Te);if(e.length===0)return h;const t=Le(e);return t instanceof Error?t:j.sum(j(t).subtract(j.mean(t)).abs()[0])/t.length},c.AVERAGE=S,c.AVERAGEA=q,c.AVERAGEIF=function(e,t,r){if(arguments.length<=1)return w;if(r=Le(Y(r=r||e).filter(Te)),e=Y(e),r instanceof Error)return r;let p=0,L=0;const R=t===void 0||t==="*",W=R?null:vt(t+"");for(let ie=0;ie<e.length;ie++){const de=e[ie];if(R)L+=r[ie],p++;else{const we=[ht(de,ct)].concat(W);gt(we)&&(L+=r[ie],p++)}}return L/p},c.AVERAGEIFS=function(){const e=k(arguments),t=(e.length-1)/2,r=Y(e[0]);let p=0,L=0;for(let W=0;W<r.length;W++){let ie=!1;for(let de=0;de<t;de++){const we=e[2*de+1][W],Se=e[2*de+2];let Pe=!1;if(Se===void 0||Se==="*")Pe=!0;else{const Re=vt(Se+""),ze=[ht(we,ct)].concat(Re);Pe=gt(ze)}if(!Pe){ie=!1;break}ie=!0}ie&&(L+=r[W],p++)}const R=L/p;return isNaN(R)?0:R},c.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},c.BASE=function(e,t,r){const p=be(e=U(e),t=U(t),r=U(r));if(p)return p;if(t===0)return h;const L=e.toString(t);return new Array(Math.max(r+1-L.length,0)).join("0")+L},c.BESSELI=function(e,t){return ae(e=U(e),t=U(t))?u:O.besseli(e,t)},c.BESSELJ=function(e,t){return ae(e=U(e),t=U(t))?u:O.besselj(e,t)},c.BESSELK=function(e,t){return ae(e=U(e),t=U(t))?u:O.besselk(e,t)},c.BESSELY=function(e,t){return ae(e=U(e),t=U(t))?u:O.bessely(e,t)},c.BETA=G,c.BETADIST=wn,c.BETAINV=Cn,c.BIN2DEC=function(e){if(!qt(e))return h;const t=parseInt(e,2),r=e.toString();return r.length===10&&r.substring(0,1)==="1"?parseInt(r.substring(1),2)-512:t},c.BIN2HEX=function(e,t){if(!qt(e))return h;const r=e.toString();if(r.length===10&&r.substring(0,1)==="1")return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16);const p=parseInt(e,2).toString(16);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?jt("0",t-p.length)+p:h},c.BIN2OCT=function(e,t){if(!qt(e))return h;const r=e.toString();if(r.length===10&&r.substring(0,1)==="1")return(1073741312+parseInt(r.substring(1),2)).toString(8);const p=parseInt(e,2).toString(8);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?jt("0",t-p.length)+p:h},c.BINOM=z,c.BINOMDIST=En,c.BITAND=function(e,t){return ae(e=U(e),t=U(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e&t},c.BITLSHIFT=function(e,t){return ae(e=U(e),t=U(t))?u:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e<<t:e>>-t},c.BITOR=function(e,t){return ae(e=U(e),t=U(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e|t},c.BITRSHIFT=function(e,t){return ae(e=U(e),t=U(t))?u:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e>>t:e<<-t},c.BITXOR=function(e,t){return ae(e=U(e),t=U(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e^t},c.CEILING=Ze,c.CEILINGMATH=An,c.CEILINGPRECISE=Ln,c.CELL=function(){throw new Error("CELL is not implemented")},c.CHAR=on,c.CHIDIST=Mn,c.CHIDISTRT=Nn,c.CHIINV=Tn,c.CHIINVRT=In,c.CHISQ=V,c.CHITEST=Dn,c.CHOOSE=function(){if(arguments.length<2)return w;const e=arguments[0];return e<1||e>254||arguments.length<e+1?u:arguments[e]},c.CLEAN=function(e){return ae(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},c.CODE=rn,c.COLUMN=function(e,t){return arguments.length!==2?w:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?j.col(e,t):void 0:u},c.COLUMNS=function(e){return arguments.length!==1?w:e instanceof Array?e.length===0?0:j.cols(e):u},c.COMBIN=et,c.COMBINA=function(e,t){return be(e=U(e),t=U(t))||(e<t?h:e===0&&t===0?1:et(e+t-1,e-1))},c.COMPLEX=pt,c.CONCAT=vn,c.CONCATENATE=an,c.CONFIDENCE=H,c.CONVERT=function(e,t,r){if((e=U(e))instanceof Error)return e;const p=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],L={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},R={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let W,ie=null,de=null,we=t,Se=r,Pe=1,Re=1;for(let ze=0;ze<p.length;ze++)W=p[ze][2]===null?[]:p[ze][2],(p[ze][1]===we||W.indexOf(we)>=0)&&(ie=p[ze]),(p[ze][1]===Se||W.indexOf(Se)>=0)&&(de=p[ze]);if(ie===null){const ze=L[t.substring(0,2)];let tt=R[t.substring(0,1)];t.substring(0,2)==="da"&&(tt=["dekao",10,"da"]),ze?(Pe=ze[2],we=t.substring(2)):tt&&(Pe=tt[1],we=t.substring(tt[2].length));for(let ot=0;ot<p.length;ot++)W=p[ot][2]===null?[]:p[ot][2],(p[ot][1]===we||W.indexOf(we)>=0)&&(ie=p[ot])}if(de===null){const ze=L[r.substring(0,2)];let tt=R[r.substring(0,1)];r.substring(0,2)==="da"&&(tt=["dekao",10,"da"]),ze?(Re=ze[2],Se=r.substring(2)):tt&&(Re=tt[1],Se=r.substring(tt[2].length));for(let ot=0;ot<p.length;ot++)W=p[ot][2]===null?[]:p[ot][2],(p[ot][1]===Se||W.indexOf(Se)>=0)&&(de=p[ot])}return ie===null||de===null||ie[3]!==de[3]?w:e*ie[6]*Pe/(de[6]*Re)},c.CORREL=function(e,t){return ae(e=Le(Y(e)),t=Le(Y(t)))?u:j.corrcoeff(e,t)},c.COS=function(e){return(e=U(e))instanceof Error?e:Math.cos(e)},c.COSH=function(e){return(e=U(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},c.COT=function(e){return(e=U(e))instanceof Error?e:e===0?g:1/Math.tan(e)},c.COTH=function(e){if((e=U(e))instanceof Error)return e;if(e===0)return g;const t=Math.exp(2*e);return(t+1)/(t-1)},c.COUNT=J,c.COUNTA=oe,c.COUNTBLANK=je,c.COUNTIF=function(e,t){if(e=Y(e),t===void 0||t==="*")return e.length;let r=0;const p=vt(t+"");for(let L=0;L<e.length;L++){const R=[ht(e[L],ct)].concat(p);gt(R)&&r++}return r},c.COUNTIFS=function(){const e=k(arguments),t=new Array(Y(e[0]).length);for(let p=0;p<t.length;p++)t[p]=!0;for(let p=0;p<e.length;p+=2){const L=Y(e[p]),R=e[p+1];if(R!==void 0&&R!=="*"){const W=vt(R+"");for(let ie=0;ie<L.length;ie++){const de=[ht(L[ie],ct)].concat(W);t[ie]=t[ie]&&gt(de)}}}let r=0;for(let p=0;p<t.length;p++)t[p]&&r++;return r},c.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},c.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},c.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},c.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},c.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},c.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},c.COVAR=Sn,c.COVARIANCE=ue,c.COVARIANCEP=Fn,c.COVARIANCES=On,c.CRITBINOM=kn,c.CSC=function(e){return(e=U(e))instanceof Error?e:e===0?g:1/Math.sin(e)},c.CSCH=function(e){return(e=U(e))instanceof Error?e:e===0?g:2/(Math.exp(e)-Math.exp(-e))},c.CUMIPMT=function(e,t,r,p,L,R){if(ae(e=U(e),t=U(t),r=U(r)))return u;if(e<=0||t<=0||r<=0||p<1||L<1||p>L||R!==0&&R!==1)return h;const W=Dt(e,t,r,0,R);let ie=0;p===1&&(R===0&&(ie=-r),p++);for(let de=p;de<=L;de++)ie+=R===1?Nt(e,de-2,W,r,1)-W:Nt(e,de-1,W,r,0);return ie*=e,ie},c.CUMPRINC=function(e,t,r,p,L,R){if(ae(e=U(e),t=U(t),r=U(r)))return u;if(e<=0||t<=0||r<=0||p<1||L<1||p>L||R!==0&&R!==1)return h;const W=Dt(e,t,r,0,R);let ie=0;p===1&&(ie=R===0?W+r*e:W,p++);for(let de=p;de<=L;de++)ie+=R>0?W-(Nt(e,de-2,W,r,1)-W)*e:W-Nt(e,de-1,W,r,0)*e;return ie},c.DATE=function(e,t,r){let p;return ae(e=U(e),t=U(t),r=U(r))?p=u:(p=new Date(e,t-1,r),p.getFullYear()<0&&(p=h)),p},c.DATEDIF=It,c.DATEVALUE=function(e){if(typeof e!="string")return u;const t=Date.parse(e);return isNaN(t)?u:new Date(e)},c.DAVERAGE=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const W=Ae(e,t);L=le(e[W])}else L=le(e[t]);let R=0;return M(p,W=>{R+=L[W]}),p.length===0?g:R/p.length},c.DAY=function(e){const t=He(e);return t instanceof Error?t:t.getDate()},c.DAYS=Lt,c.DAYS360=Ct,c.DB=function(e,t,r,p,L){if(L=L===void 0?12:L,ae(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L)))return u;if(e<0||t<0||r<0||p<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(L)===-1||p>r)return h;if(t>=e)return 0;const R=(1-Math.pow(t/e,1/r)).toFixed(3),W=e*R*L/12;let ie=W,de=0;const we=p===r?r-1:p;for(let Se=2;Se<=we;Se++)de=(e-ie)*R,ie+=de;return p===1?W:p===r?(e-ie)*R:de},c.DBCS=function(){throw new Error("DBCS is not implemented")},c.DCOUNT=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const W=Ae(e,t);L=le(e[W])}else L=le(e[t]);const R=[];return M(p,W=>{R.push(L[W])}),J(R)},c.DCOUNTA=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const W=Ae(e,t);L=le(e[W])}else L=le(e[t]);const R=[];return M(p,W=>{R.push(L[W])}),oe(R)},c.DDB=function(e,t,r,p,L){if(L=L===void 0?2:L,ae(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L)))return u;if(e<0||t<0||r<0||p<0||L<=0||p>r)return h;if(t>=e)return 0;let R=0,W=0;for(let ie=1;ie<=p;ie++)W=Math.min(L/r*(e-R),e-t-R),R+=W;return W},c.DEC2BIN=function(e,t){if((e=U(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return h;if(e<0)return"1"+jt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const r=parseInt(e,10).toString(2);return t===void 0?r:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=r.length?jt("0",t-r.length)+r:h},c.DEC2HEX=function(e,t){if((e=U(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return h;if(e<0)return(1099511627776+e).toString(16);const r=parseInt(e,10).toString(16);return t===void 0?r:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=r.length?jt("0",t-r.length)+r:h},c.DEC2OCT=function(e,t){if((e=U(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return h;if(e<0)return(1073741824+e).toString(8);const r=parseInt(e,10).toString(8);return t===void 0?r:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=r.length?jt("0",t-r.length)+r:h},c.DECIMAL=function(e,t){return arguments.length<1?u:be(e=U(e),t=U(t))||(t===0?h:parseInt(e,t))},c.DEGREES=function(e){return(e=U(e))instanceof Error?e:180*e/Math.PI},c.DELTA=function(e,t){return t=t===void 0?0:t,ae(e=U(e),t=U(t))?u:e===t?1:0},c.DEVSQ=function(){const e=Le(Y(arguments));if(e instanceof Error)return e;const t=j.mean(e);let r=0;for(let p=0;p<e.length;p++)r+=Math.pow(e[p]-t,2);return r},c.DGET=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];return L=le(typeof t=="string"?e[Ae(e,t)]:e[t]),p.length===0?u:p.length>1?h:L[p[0]]},c.DISC=function(e,t,r,p,L){if(ae(e=He(e),t=He(t),r=U(r),p=U(p),L=(L=U(L))||0))return u;if(r<=0||p<=0)return h;if(e>=t)return u;let R,W;switch(L){case 0:R=360,W=Ct(e,t,!1);break;case 1:case 3:R=365,W=It(e,t,"D");break;case 2:R=360,W=It(e,t,"D");break;case 4:R=360,W=Ct(e,t,!0);break;default:return h}return(p-r)/p*R/W},c.DMAX=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const W=Ae(e,t);L=le(e[W])}else L=le(e[t]);let R=L[p[0]];return M(p,W=>{R<L[W]&&(R=L[W])}),R},c.DMIN=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const W=Ae(e,t);L=le(e[W])}else L=le(e[t]);let R=L[p[0]];return M(p,W=>{R>L[W]&&(R=L[W])}),R},c.DOLLAR=function(e,t=2){if(e=U(e),isNaN(e))return u;const r={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},p=(e=wt(e,t)).toLocaleString("en-US",r);return e<0?"$("+p.slice(2)+")":p},c.DOLLARDE=function(e,t){if(ae(e=U(e),t=U(t)))return u;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let r=parseInt(e,10);r+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const p=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return r=Math.round(r*p)/p,r},c.DOLLARFR=function(e,t){if(ae(e=U(e),t=U(t)))return u;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let r=parseInt(e,10);return r+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,r},c.DPRODUCT=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const ie=Ae(e,t);L=le(e[ie])}else L=le(e[t]);let R=[];M(p,ie=>{R.push(L[ie])}),R=Kt(R);let W=1;return M(R,ie=>{W*=ie}),W},c.DSTDEV=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const W=Ae(e,t);L=le(e[W])}else L=le(e[t]);let R=[];return M(p,W=>{R.push(L[W])}),R=Kt(R),nt.S(R)},c.DSTDEVP=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const W=Ae(e,t);L=le(e[W])}else L=le(e[t]);let R=[];return M(p,W=>{R.push(L[W])}),R=Kt(R),nt.P(R)},c.DSUM=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const W=Ae(e,t);L=le(e[W])}else L=le(e[t]);const R=[];return M(p,W=>{R.push(L[W])}),At(R)},c.DURATION=function(){throw new Error("DURATION is not implemented")},c.DVAR=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const W=Ae(e,t);L=le(e[W])}else L=le(e[t]);const R=[];return M(p,W=>{R.push(L[W])}),me.S(R)},c.DVARP=function(e,t,r){if(isNaN(t)&&typeof t!="string")return u;const p=yt(e,r);let L=[];if(typeof t=="string"){const W=Ae(e,t);L=le(e[W])}else L=le(e[t]);const R=[];return M(p,W=>{R.push(L[W])}),me.P(R)},c.EDATE=function(e,t){return(e=He(e))instanceof Error?e:isNaN(t)?u:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},c.EFFECT=function(e,t){return ae(e=U(e),t=U(t))?u:e<=0||t<1?h:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},c.EOMONTH=function(e,t){return(e=He(e))instanceof Error?e:isNaN(t)?u:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},c.ERF=zt,c.ERFC=Wt,c.ERFCPRECISE=Rn,c.ERFPRECISE=Hn,c.ERROR=St,c.EVEN=function(e){return(e=U(e))instanceof Error?e:Ze(e,-2,-1)},c.EXACT=function(e,t){return arguments.length!==2?w:be(e,t)||(e=qe(e))===qe(t)},c.EXP=function(e){return arguments.length<1?w:arguments.length>1?N:(e=U(e))instanceof Error?e:e=Math.exp(e)},c.EXPON=te,c.EXPONDIST=Bn,c.F=ge,c.FACT=st,c.FACTDOUBLE=function e(t){if((t=U(t))instanceof Error)return t;const r=Math.floor(t);return r<=0?1:r*e(r-2)},c.FALSE=function(){return!1},c.FDIST=_n,c.FDISTRT=Pn,c.FIND=function(e,t,r){if(arguments.length<2)return w;e=qe(e),r=r===void 0?0:r;const p=(t=qe(t)).indexOf(e,r-1);return p===-1?u:p+1},c.FINV=Vn,c.FINVRT=Un,c.FISHER=function(e){return(e=U(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},c.FISHERINV=function(e){if((e=U(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},c.FIXED=sn,c.FLOOR=xt,c.FLOORMATH=Yn,c.FLOORPRECISE=qn,c.FORECAST=ye,c.FREQUENCY=function(e,t){if(ae(e=Le(Y(e)),t=Le(Y(t))))return u;const r=e.length,p=t.length,L=[];for(let R=0;R<=p;R++){L[R]=0;for(let W=0;W<r;W++)R===0?e[W]<=t[0]&&(L[0]+=1):R<p?e[W]>t[R-1]&&e[W]<=t[R]&&(L[R]+=1):R===p&&e[W]>t[p-1]&&(L[p]+=1)}return L},c.FTEST=zn,c.FV=Nt,c.FVSCHEDULE=function(e,t){if(ae(e=U(e),t=Le(Y(t))))return u;const r=t.length;let p=e;for(let L=0;L<r;L++)p*=1+t[L];return p},c.GAMMA=ke,c.GAMMADIST=Wn,c.GAMMAINV=Xn,c.GAMMALN=We,c.GAMMALNPRECISE=Gn,c.GAUSS=function(e){return(e=U(e))instanceof Error?e:j.normal.cdf(e,0,1)-.5},c.GCD=function(){const e=Le(Y(arguments));if(e instanceof Error)return e;const t=e.length,r=e[0];let p=r<0?-r:r;for(let L=1;L<t;L++){const R=e[L];let W=R<0?-R:R;for(;p&&W;)p>W?p%=W:W%=p;p+=W}return p},c.GEOMEAN=function(){const e=Le(Y(arguments));return e instanceof Error?e:j.geomean(e)},c.GESTEP=function(e,t){return ae(t=t||0,e=U(e))?e:e>=t?1:0},c.GROWTH=function(e,t,r,p){if((e=Le(e))instanceof Error)return e;let L;if(t===void 0)for(t=[],L=1;L<=e.length;L++)t.push(L);if(r===void 0)for(r=[],L=1;L<=e.length;L++)r.push(L);if(ae(t=Le(t),r=Le(r)))return u;p===void 0&&(p=!0);const R=e.length;let W,ie,de=0,we=0,Se=0,Pe=0;for(L=0;L<R;L++){const ze=t[L],tt=Math.log(e[L]);de+=ze,we+=tt,Se+=ze*tt,Pe+=ze*ze}de/=R,we/=R,Se/=R,Pe/=R,p?(W=(Se-de*we)/(Pe-de*de),ie=we-W*de):(W=Se/Pe,ie=0);const Re=[];for(L=0;L<r.length;L++)Re.push(Math.exp(ie+W*r[L]));return Re},c.HARMEAN=function(){const e=Le(Y(arguments));if(e instanceof Error)return e;const t=e.length;let r=0;for(let p=0;p<t;p++)r+=1/e[p];return t/r},c.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const r=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),p=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(p<-512||p>511)return h;if(r)return"1"+jt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const L=p.toString(2);return t===void 0?L:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=L.length?jt("0",t-L.length)+L:h},c.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},c.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const r=parseInt(e,16);if(r>536870911&&r<0xffe0000000)return h;if(r>=0xffe0000000)return(r-0xffc0000000).toString(8);const p=r.toString(8);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?jt("0",t-p.length)+p:h},c.HLOOKUP=function(e,t,r,p){return o(e,xe(t),r,p)},c.HOUR=function(e){return(e=He(e))instanceof Error?e:e.getHours()},c.HYPGEOM=Qe,c.HYPGEOMDIST=Kn,c.IF=function(e,t,r){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(r=arguments.length===3&&r)==null&&(r=0),e?t:r)},c.IFERROR=function(e,t){return Tt(e)?t:e},c.IFNA=function(e,t){return e===w?t:e},c.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return w},c.IMABS=Xt,c.IMAGINARY=it,c.IMARGUMENT=Gt,c.IMCONJUGATE=function(e){const t=at(e),r=it(e);if(ae(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",r!==0?pt(t,-r,p):e},c.IMCOS=_t,c.IMCOSH=ln,c.IMCOT=function(e){return ae(at(e),it(e))?u:Mt(_t(e),Pt(e))},c.IMCSC=function(e){return e===!0||e===!1?u:ae(at(e),it(e))?h:Mt("1",Pt(e))},c.IMCSCH=function(e){return e===!0||e===!1?u:ae(at(e),it(e))?h:Mt("1",un(e))},c.IMDIV=Mt,c.IMEXP=function(e){const t=at(e),r=it(e);if(ae(t,r))return u;let p=e.substring(e.length-1);p=p==="i"||p==="j"?p:"i";const L=Math.exp(t);return pt(L*Math.cos(r),L*Math.sin(r),p)},c.IMLN=function(e){const t=at(e),r=it(e);if(ae(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+r*r)),Math.atan(r/t),p)},c.IMLOG10=function(e){const t=at(e),r=it(e);if(ae(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+r*r))/Math.log(10),Math.atan(r/t)/Math.log(10),p)},c.IMLOG2=function(e){const t=at(e),r=it(e);if(ae(t,r))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+r*r))/Math.log(2),Math.atan(r/t)/Math.log(2),p)},c.IMPOWER=function(e,t){if(ae(t=U(t),at(e),it(e)))return u;let r=e.substring(e.length-1);r=r==="i"||r==="j"?r:"i";const p=Math.pow(Xt(e),t),L=Gt(e);return pt(p*Math.cos(t*L),p*Math.sin(t*L),r)},c.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return u;for(let t=1;t<arguments.length;t++){const r=at(e),p=it(e),L=at(arguments[t]),R=it(arguments[t]);if(ae(r,p,L,R))return u;e=pt(r*L-p*R,r*R+p*L)}return e},c.IMREAL=at,c.IMSEC=function(e){return e===!0||e===!1||ae(at(e),it(e))?u:Mt("1",_t(e))},c.IMSECH=function(e){return ae(at(e),it(e))?u:Mt("1",ln(e))},c.IMSIN=Pt,c.IMSINH=un,c.IMSQRT=function(e){if(ae(at(e),it(e)))return u;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const r=Math.sqrt(Xt(e)),p=Gt(e);return pt(r*Math.cos(p/2),r*Math.sin(p/2),t)},c.IMSUB=function(e,t){const r=at(e),p=it(e),L=at(t),R=it(t);if(ae(r,p,L,R))return u;const W=e.substring(e.length-1),ie=t.substring(t.length-1);let de="i";return(W==="j"||ie==="j")&&(de="j"),pt(r-L,p-R,de)},c.IMSUM=function(){if(!arguments.length)return u;const e=Y(arguments);let t=e[0];for(let r=1;r<e.length;r++){const p=at(t),L=it(t),R=at(e[r]),W=it(e[r]);if(ae(p,L,R,W))return u;t=pt(p+R,L+W)}return t},c.IMTAN=function(e){return e===!0||e===!1||ae(at(e),it(e))?u:Mt(Pt(e),_t(e))},c.INDEX=function(e,t,r){const p=be(e,t,r);if(p)return p;if(!Array.isArray(e))return u;const L=e.length>0&&!Array.isArray(e[0]);return L&&!r?(r=t,t=1):(r=r||1,t=t||1),r<0||t<0?u:L&&t===1&&r<=e.length?e[r-1]:t<=e.length&&r<=e[t-1].length?e[t-1][r-1]:m},c.INFO=function(){throw new Error("INFO is not implemented")},c.INT=function(e){return(e=U(e))instanceof Error?e:Math.floor(e)},c.INTERCEPT=function(e,t){return ae(e=Le(e),t=Le(t))?u:e.length!==t.length?w:ye(0,e,t)},c.INTRATE=function(){throw new Error("INTRATE is not implemented")},c.IPMT=cn,c.IRR=function(e,t){if(t=t||0,ae(e=Le(Y(e)),t=U(t)))return u;const r=(Re,ze,tt)=>{const ot=tt+1;let bt=Re[0];for(let dt=1;dt<Re.length;dt++)bt+=Re[dt]/Math.pow(ot,(ze[dt]-ze[0])/365);return bt},p=(Re,ze,tt)=>{const ot=tt+1;let bt=0;for(let dt=1;dt<Re.length;dt++){const Et=(ze[dt]-ze[0])/365;bt-=Et*Re[dt]/Math.pow(ot,Et+1)}return bt},L=[];let R=!1,W=!1;for(let Re=0;Re<e.length;Re++)L[Re]=Re===0?0:L[Re-1]+365,e[Re]>0&&(R=!0),e[Re]<0&&(W=!0);if(!R||!W)return h;let ie,de,we,Se=t=t===void 0?.1:t,Pe=!0;do we=r(e,L,Se),ie=Se-we/p(e,L,Se),de=Math.abs(ie-Se),Se=ie,Pe=de>1e-10&&Math.abs(we)>1e-10;while(Pe);return Se},c.ISBLANK=function(e){return e===null},c.ISERR=mt,c.ISERROR=Tt,c.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},c.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},c.ISLOGICAL=Ft,c.ISNA=function(e){return e===w},c.ISNONTEXT=function(e){return typeof e!="string"},c.ISNUMBER=v,c.ISO=hn,c.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},c.ISOWEEKNUM=tn,c.ISPMT=function(e,t,r,p){return ae(e=U(e),t=U(t),r=U(r),p=U(p))?u:p*e*(t/r-1)},c.ISREF=function(){throw new Error("ISREF is not implemented")},c.ISTEXT=C,c.KURT=function(){const e=Le(Y(arguments));if(e instanceof Error)return e;const t=j.mean(e),r=e.length;let p=0;for(let L=0;L<r;L++)p+=Math.pow(e[L]-t,4);return p/=Math.pow(j.stdev(e,!0),4),r*(r+1)/((r-1)*(r-2)*(r-3))*p-3*(r-1)*(r-1)/((r-2)*(r-3))},c.LARGE=fe,c.LCM=function(){const e=Le(Y(arguments));if(e instanceof Error)return e;for(var t,r,p,L,R=1;(p=e.pop())!==void 0;){if(p===0)return 0;for(;p>1;){if(p%2){for(t=3,r=Math.floor(Math.sqrt(p));t<=r&&p%t;t+=2);L=t<=r?t:p}else L=2;for(p/=L,R*=L,t=e.length;t;e[--t]%L==0&&(e[t]/=L)==1&&e.splice(t,1));}}return R},c.LEFT=function(e,t){return be(e,t)||(e=qe(e),(t=U(t=t===void 0?1:t))instanceof Error||typeof e!="string"?u:e.substring(0,t))},c.LEN=function(e){return arguments.length===0?N:e instanceof Error?e:Array.isArray(e)?u:qe(e).length},c.LINEST=Ee,c.LN=function(e){return(e=U(e))instanceof Error?e:e===0?h:Math.log(e)},c.LOG=function(e,t){return be(e=U(e),t=U(t))||(e===0||t===0?h:Math.log(e)/Math.log(t))},c.LOG10=function(e){return(e=U(e))instanceof Error?e:e===0?h:Math.log(e)/Math.log(10)},c.LOGEST=function(e,t){if(ae(e=Le(Y(e)),t=Le(Y(t)))||e.length!==t.length)return u;for(let p=0;p<e.length;p++)e[p]=Math.log(e[p]);const r=Ee(e,t);return r[0]=Math.round(1e6*Math.exp(r[0]))/1e6,r[1]=Math.round(1e6*Math.exp(r[1]))/1e6,r},c.LOGINV=$n,c.LOGNORM=K,c.LOGNORMDIST=Jn,c.LOGNORMINV=Zn,c.LOOKUP=function(e,t,r){t=Y(t),r=r?Y(r):t;const p=typeof e=="number";let L=w;for(let R=0;R<t.length;R++){if(t[R]===e)return r[R];if(p&&t[R]<=e||typeof t[R]=="string"&&t[R].localeCompare(e)<0)L=r[R];else if(p&&t[R]>e)return L}return L},c.LOWER=function(e){return arguments.length!==1?u:ae(e=qe(e))?e:e.toLowerCase()},c.MATCH=function(e,t,r){if(!e||!t||(arguments.length===2&&(r=1),!((t=Y(t))instanceof Array))||r!==-1&&r!==0&&r!==1)return w;let p,L;for(let R=0;R<t.length;R++)if(r===1){if(t[R]===e)return R+1;t[R]<e&&(L?t[R]>L&&(p=R+1,L=t[R]):(p=R+1,L=t[R]))}else if(r===0){if(typeof e=="string"&&typeof t[R]=="string"){const W=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+W+"$").test(t[R].toLowerCase()))return R+1}else if(t[R]===e)return R+1}else if(r===-1){if(t[R]===e)return R+1;t[R]>e&&(L?t[R]<L&&(p=R+1,L=t[R]):(p=R+1,L=t[R]))}return p||w},c.MAX=X,c.MAXA=function(){const e=Y(arguments),t=be.apply(void 0,e);if(t)return t;let r=D(e);return r=r.map(p=>p==null?0:p),r.length===0?0:Math.max.apply(Math,r)},c.MDURATION=function(){throw new Error("MDURATION is not implemented")},c.MEDIAN=re,c.MID=function(e,t,r){if(t==null)return u;if(ae(t=U(t),r=U(r))||typeof e!="string")return r;const p=t-1,L=p+r;return e.substring(p,L)},c.MIN=A,c.MINA=function(){const e=Y(arguments),t=be.apply(void 0,e);if(t)return t;let r=D(e);return r=r.map(p=>p==null?0:p),r.length===0?0:Math.min.apply(Math,r)},c.MINUTE=function(e){return(e=He(e))instanceof Error?e:e.getMinutes()},c.MIRR=function(e,t,r){if(ae(e=Le(Y(e)),t=U(t),r=U(r)))return u;const p=e.length,L=[],R=[];for(let de=0;de<p;de++)e[de]<0?L.push(e[de]):R.push(e[de]);const W=-Zt(r,R)*Math.pow(1+r,p-1),ie=Zt(t,L)*(1+t);return Math.pow(W/ie,1/(p-1))-1},c.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(r=>!r.length)||t.some(r=>!r.length)||se(e).some(r=>typeof r!="number")||se(t).some(r=>typeof r!="number")||e[0].length!==t.length?u:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((r,p)=>r.map((L,R)=>e[p].reduce((W,ie,de)=>W+ie*t[de][R],0)))},c.MOD=function(e,t){const r=be(e=U(e),t=U(t));if(r)return r;if(t===0)return g;let p=Math.abs(e%t);return p=e<0?t-p:p,t>0?p:-p},c.MODE=F,c.MODEMULT=Qn,c.MODESNGL=eo,c.MONTH=function(e){return(e=He(e))instanceof Error?e:e.getMonth()+1},c.MROUND=function(e,t){return be(e=U(e),t=U(t))||(e*t==0?0:e*t<0?h:Math.round(e/t)*t)},c.MULTINOMIAL=function(){const e=Le(Y(arguments));if(e instanceof Error)return e;let t=0,r=1;for(let p=0;p<e.length;p++)t+=e[p],r*=st(e[p]);return st(t)/r},c.MUNIT=function(e){return arguments.length>1?w:!(e=parseInt(e))||e<=0?u:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,r)=>(t[r]=1,t))},c.N=function(e){return v(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:Tt(e)?e:0},c.NA=function(){return w},c.NEGBINOM=ee,c.NEGBINOMDIST=to,c.NETWORKDAYS=Rt,c.NETWORKDAYSINTL=no,c.NOMINAL=function(e,t){return ae(e=U(e),t=U(t))?u:e<=0||t<1?h:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},c.NORM=pe,c.NORMDIST=oo,c.NORMINV=ro,c.NORMSDIST=io,c.NORMSINV=ao,c.NOT=function(e){return typeof e=="string"?u:e instanceof Error?e:!e},c.NOW=function(){return new Date},c.NPER=function(e,t,r,p,L){if(L=L===void 0?0:L,p=p===void 0?0:p,ae(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L)))return u;if(e===0)return-(r+p)/t;{const R=t*(1+e*L)-p*e,W=r*e+t*(1+e*L);return Math.log(R/W)/Math.log(1+e)}},c.NPV=Zt,c.NUMBERVALUE=function(e,t,r){return typeof(e=Te(e)?e:"")=="number"?e:typeof e!="string"?w:(t=t===void 0?".":t,r=r===void 0?",":r,Number(e.replace(t,".").replace(r,"")))},c.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const r=!(e.length!==10||e.substring(0,1)!=="7"),p=r?parseInt(e,8)-1073741824:parseInt(e,8);if(p<-512||p>511)return h;if(r)return"1"+jt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const L=p.toString(2);return t===void 0?L:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=L.length?jt("0",t-L.length)+L:h},c.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return h;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},c.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const r=parseInt(e,8);if(r>=536870912)return"ff"+(r+3221225472).toString(16);const p=r.toString(16);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?jt("0",t-p.length)+p:h},c.ODD=function(e){if((e=U(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},c.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},c.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},c.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},c.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},c.OR=function(){const e=Y(arguments);let t=u;for(let r=0;r<e.length;r++){if(e[r]instanceof Error)return e[r];e[r]!==void 0&&e[r]!==null&&typeof e[r]!="string"&&(t===u&&(t=!1),e[r]&&(t=!0))}return t},c.PDURATION=function(e,t,r){return ae(e=U(e),t=U(t),r=U(r))?u:e<=0?h:(Math.log(r)-Math.log(t))/Math.log(1+e)},c.PEARSON=ce,c.PERCENTILE=Q,c.PERCENTILEEXC=so,c.PERCENTILEINC=lo,c.PERCENTRANK=ve,c.PERCENTRANKEXC=uo,c.PERCENTRANKINC=co,c.PERMUT=function(e,t){return ae(e=U(e),t=U(t))?u:st(e)/st(e-t)},c.PERMUTATIONA=function(e,t){return ae(e=U(e),t=U(t))?u:Math.pow(e,t)},c.PHI=function(e){return(e=U(e))instanceof Error?u:Math.exp(-.5*e*e)/2.5066282746310002},c.PI=function(){return Math.PI},c.PMT=Dt,c.POISSON=Me,c.POISSONDIST=fo,c.POWER=en,c.PPMT=function(e,t,r,p,L,R){return L=L||0,R=R||0,ae(e=U(e),r=U(r),p=U(p),L=U(L),R=U(R))?u:Dt(e,r,p,L,R)-cn(e,t,r,p,L,R)},c.PRICE=function(){throw new Error("PRICE is not implemented")},c.PRICEDISC=function(e,t,r,p,L){if(ae(e=He(e),t=He(t),r=U(r),p=U(p),L=(L=U(L))||0))return u;if(r<=0||p<=0)return h;if(e>=t)return u;let R,W;switch(L){case 0:R=360,W=Ct(e,t,!1);break;case 1:case 3:R=365,W=It(e,t,"D");break;case 2:R=360,W=It(e,t,"D");break;case 4:R=360,W=Ct(e,t,!0);break;default:return h}return p-r*p*W/R},c.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},c.PROB=function(e,t,r,p){if(r===void 0)return 0;if(p=p===void 0?r:p,ae(e=Le(Y(e)),t=Le(Y(t)),r=U(r),p=U(p)))return u;if(r===p)return e.indexOf(r)>=0?t[e.indexOf(r)]:0;const L=e.sort((ie,de)=>ie-de),R=L.length;let W=0;for(let ie=0;ie<R;ie++)L[ie]>=r&&L[ie]<=p&&(W+=t[e.indexOf(L[ie])]);return W},c.PRODUCT=Vt,c.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},c.PROPER=function(e){return ae(e)?e:isNaN(e)&&typeof e=="number"?u:(e=qe(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},c.PV=function(e,t,r,p,L){return p=p||0,L=L||0,ae(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L))?u:e===0?-r*t-p:((1-Math.pow(1+e,t))/e*r*(1+e*L)-p)/Math.pow(1+e,t)},c.QUARTILE=Ne,c.QUARTILEEXC=po,c.QUARTILEINC=ho,c.QUOTIENT=function(e,t){return be(e=U(e),t=U(t))||parseInt(e/t,10)},c.RADIANS=function(e){return(e=U(e))instanceof Error?e:e*Math.PI/180},c.RAND=function(){return Math.random()},c.RANDBETWEEN=function(e,t){return be(e=U(e),t=U(t))||e+Math.ceil((t-e+1)*Math.random())-1},c.RANK=Ie,c.RANKAVG=go,c.RANKEQ=mo,c.RATE=function(e,t,r,p,L,R){if(R=R===void 0?.01:R,p=p===void 0?0:p,L=L===void 0?0:L,ae(e=U(e),t=U(t),r=U(r),p=U(p),L=U(L),R=U(R)))return u;const W=1e-10;let ie=R;L=L?1:0;for(let de=0;de<20;de++){if(ie<=-1)return h;let we,Se,Pe;if(Math.abs(ie)<W?we=r*(1+e*ie)+t*(1+ie*L)*e+p:(Se=Math.pow(1+ie,e),we=r*Se+t*(1/ie+L)*(Se-1)+p),Math.abs(we)<W)return ie;if(Math.abs(ie)<W)Pe=r*e+t*L*e;else{Se=Math.pow(1+ie,e);const Re=e*Math.pow(1+ie,e-1);Pe=r*Re+t*(1/ie+L)*Re+t*(-1/(ie*ie))*(Se-1)}ie-=we/Pe}return ie},c.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},c.REPLACE=function(e,t,r,p){return ae(t=U(t),r=U(r))||typeof e!="string"||typeof p!="string"?u:e.substr(0,t-1)+p+e.substr(t-1+r)},c.REPT=jt,c.RIGHT=function(e,t){return be(e,t)||(e=qe(e),(t=U(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},c.ROMAN=function(e){if((e=U(e))instanceof Error)return e;const t=String(e).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let p="",L=3;for(;L--;)p=(r[+t.pop()+10*L]||"")+p;return new Array(+t.join("")+1).join("M")+p},c.ROUND=wt,c.ROUNDDOWN=function(e,t){return be(e=U(e),t=U(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},c.ROUNDUP=function(e,t){return be(e=U(e),t=U(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},c.ROW=function(e,t){return arguments.length!==2?w:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?j.row(e,t):void 0:u},c.ROWS=function(e){return arguments.length!==1?w:e instanceof Array?e.length===0?0:j.rows(e):u},c.RRI=function(e,t,r){return ae(e=U(e),t=U(t),r=U(r))?u:e===0||t===0?h:Math.pow(r/t,1/e)-1},c.RSQ=function(e,t){return ae(e=Le(Y(e)),t=Le(Y(t)))?u:Math.pow(ce(e,t),2)},c.SEARCH=function(e,t,r){let p;return typeof e!="string"||typeof t!="string"?u:(r=r===void 0?0:r,p=t.toLowerCase().indexOf(e.toLowerCase(),r-1)+1,p===0?u:p)},c.SEC=function(e){return(e=U(e))instanceof Error?e:1/Math.cos(e)},c.SECH=function(e){return(e=U(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},c.SECOND=function(e){return(e=He(e))instanceof Error?e:e.getSeconds()},c.SERIESSUM=function(e,t,r,p){if(ae(e=U(e),t=U(t),r=U(r),p=Le(p)))return u;let L=p[0]*Math.pow(e,t);for(let R=1;R<p.length;R++)L+=p[R]*Math.pow(e,t+R*r);return L},c.SHEET=function(){throw new Error("SHEET is not implemented")},c.SHEETS=function(){throw new Error("SHEETS is not implemented")},c.SIGN=function(e){return(e=U(e))instanceof Error?e:e<0?-1:e===0?0:1},c.SIN=function(e){return(e=U(e))instanceof Error?e:Math.sin(e)},c.SINH=function(e){return(e=U(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},c.SKEW=Be,c.SKEWP=bo,c.SLN=function(e,t,r){return ae(e=U(e),t=U(t),r=U(r))?u:r===0?h:(e-t)/r},c.SLOPE=function(e,t){if(ae(e=Le(Y(e)),t=Le(Y(t))))return u;const r=j.mean(t),p=j.mean(e),L=t.length;let R=0,W=0;for(let ie=0;ie<L;ie++)R+=(t[ie]-r)*(e[ie]-p),W+=Math.pow(t[ie]-r,2);return R/W},c.SMALL=$e,c.SORT=function(e,t=1,r=1,p=!1){if(!e||!Array.isArray(e))return w;if(e.length===0)return 0;if(!(t=U(t))||t<1||(r=U(r))!==1&&r!==-1)return u;if(typeof(p=Ye(p))!="boolean")return b;const L=ie=>ie.sort((de,we)=>(de=qe(de[t-1]),we=qe(we[t-1]),r===1?de<we?-1*r:r:de>we?r:-1*r)),R=Z(e),W=p?xe(R):R;return t>=1&&t<=W[0].length?p?xe(L(W)):L(W):u},c.SQRT=function(e){return(e=U(e))instanceof Error?e:e<0?h:Math.sqrt(e)},c.SQRTPI=function(e){return(e=U(e))instanceof Error?e:Math.sqrt(e*Math.PI)},c.STANDARDIZE=function(e,t,r){return ae(e=U(e),t=U(t),r=U(r))?u:(e-t)/r},c.STDEV=nt,c.STDEVA=function(){const e=Ce.apply(this,arguments);return Math.sqrt(e)},c.STDEVP=jo,c.STDEVPA=function(){const e=Oe.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},c.STDEVS=vo,c.STEYX=function(e,t){if(ae(e=Le(Y(e)),t=Le(Y(t))))return u;const r=j.mean(t),p=j.mean(e),L=t.length;let R=0,W=0,ie=0;for(let de=0;de<L;de++)R+=Math.pow(e[de]-p,2),W+=(t[de]-r)*(e[de]-p),ie+=Math.pow(t[de]-r,2);return Math.sqrt((R-W*W/ie)/(L-2))},c.SUBSTITUTE=function(e,t,r,p){if(arguments.length<3)return w;if(e&&t){if(p===void 0)return e.split(t).join(r);{if(p=Math.floor(Number(p)),Number.isNaN(p)||p<=0)return u;let L=0,R=0;for(;L>-1&&e.indexOf(t,L)>-1;)if(L=e.indexOf(t,L+1),R++,L>-1&&R===p)return e.substring(0,L)+r+e.substring(L+t.length);return e}}return e},c.SUBTOTAL=function(e,t){if((e=U(e))instanceof Error)return e;switch(e){case 1:case 101:return S(t);case 2:case 102:return J(t);case 3:case 103:return oe(t);case 4:case 104:return X(t);case 5:case 105:return A(t);case 6:case 106:return Vt(t);case 7:case 107:return nt.S(t);case 8:case 108:return nt.P(t);case 9:case 109:return At(t);case 10:case 110:return me.S(t);case 11:case 111:return me.P(t)}},c.SUM=At,c.SUMIF=function(e,t,r){if(e=Y(e),r=r?Y(r):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let p=0;const L=t==="*",R=L?null:vt(t+"");for(let W=0;W<e.length;W++){const ie=e[W],de=r[W];if(L)p+=ie;else{const we=[ht(ie,ct)].concat(R);p+=gt(we)?de:0}}return p},c.SUMIFS=function(){const e=k(arguments),t=Le(Y(e.shift()));if(t instanceof Error)return t;const r=e,p=r.length/2;for(let R=0;R<p;R++)r[2*R]=Y(r[2*R]);let L=0;for(let R=0;R<t.length;R++){let W=!1;for(let ie=0;ie<p;ie++){const de=r[2*ie][R],we=r[2*ie+1];let Se=!1;if(we===void 0||we==="*")Se=!0;else{const Pe=vt(we+""),Re=[ht(de,ct)].concat(Pe);Se=gt(Re)}if(!Se){W=!1;break}W=!0}W&&(L+=t[R])}return L},c.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return u;const e=arguments.length+1;let t,r,p,L,R=0;for(let W=0;W<arguments[0].length;W++)if(arguments[0][W]instanceof Array)for(let ie=0;ie<arguments[0][W].length;ie++){for(t=1,r=1;r<e;r++){const de=arguments[r-1][W][ie];if(de instanceof Error)return de;if(L=U(de),L instanceof Error)return L;t*=L}R+=t}else{for(t=1,r=1;r<e;r++){const ie=arguments[r-1][W];if(ie instanceof Error)return ie;if(p=U(ie),p instanceof Error)return p;t*=p}R+=t}return R},c.SUMSQ=function(){const e=Le(Y(arguments));if(e instanceof Error)return e;let t=0;const r=e.length;for(let p=0;p<r;p++)t+=v(e[p])?e[p]*e[p]:0;return t},c.SUMX2MY2=function(e,t){if(ae(e=Le(Y(e)),t=Le(Y(t))))return u;let r=0;for(let p=0;p<e.length;p++)r+=e[p]*e[p]-t[p]*t[p];return r},c.SUMX2PY2=function(e,t){if(ae(e=Le(Y(e)),t=Le(Y(t))))return u;let r=0;e=Le(Y(e)),t=Le(Y(t));for(let p=0;p<e.length;p++)r+=e[p]*e[p]+t[p]*t[p];return r},c.SUMXMY2=function(e,t){if(ae(e=Le(Y(e)),t=Le(Y(t))))return u;let r=0;e=Y(e),t=Y(t);for(let p=0;p<e.length;p++)r+=Math.pow(e[p]-t[p],2);return r},c.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],r=arguments.length-1,p=Math.floor(r/2);let L=!1;const R=r%2!=0,W=r%2==0?null:arguments[arguments.length-1];if(p){for(let ie=0;ie<p;ie++)if(t===arguments[2*ie+1]){e=arguments[2*ie+2],L=!0;break}}L||(e=R?W:w)}else e=u;return e},c.SYD=function(e,t,r,p){return ae(e=U(e),t=U(t),r=U(r),p=U(p))?u:r===0||p<1||p>r?h:(e-t)*(r-(p=parseInt(p,10))+1)*2/(r*(r+1))},c.T=function(e){return e instanceof Error||typeof e=="string"?e:""},c.TAN=function(e){return(e=U(e))instanceof Error?e:Math.tan(e)},c.TANH=function(e){if((e=U(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},c.TBILLEQ=function(e,t,r){return ae(e=He(e),t=He(t),r=U(r))?u:r<=0||e>t||t-e>31536e6?h:365*r/(360-r*Ct(e,t,!1))},c.TBILLPRICE=function(e,t,r){return ae(e=He(e),t=He(t),r=U(r))?u:r<=0||e>t||t-e>31536e6?h:100*(1-r*Ct(e,t,!1)/360)},c.TBILLYIELD=function(e,t,r){return ae(e=He(e),t=He(t),r=U(r))?u:r<=0||e>t||t-e>31536e6?h:360*(100-r)/(r*Ct(e,t,!1))},c.TDIST=yo,c.TDISTRT=xo,c.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return w;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return u;const r=t.startsWith("$")?"$":"",p=t.endsWith("%");return p&&(e*=100),e=(e=sn(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+r+(e=e.replace("-","")):r+e,p&&(e+="%"),e},c.TEXTJOIN=function(e,t,...r){if(typeof t!="boolean"&&(t=Ye(t)),arguments.length<3)return w;e=e!=null?e:"";let p=Y(r),L=t?p.filter(R=>R):p;if(Array.isArray(e)){e=Y(e);let R=L.map(ie=>[ie]),W=0;for(let ie=0;ie<R.length-1;ie++)R[ie].push(e[W]),W++,W===e.length&&(W=0);return L=Y(R),L.join("")}return L.join(e)},c.TIME=function(e,t,r){return ae(e=U(e),t=U(t),r=U(r))?u:e<0||t<0||r<0?h:(3600*e+60*t+r)/86400},c.TIMEVALUE=function(e){return(e=He(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},c.TINV=wo,c.TODAY=function(){return kt(new Date)},c.TRANSPOSE=function(e){return e?xe(Z(e)):w},c.TREND=function(e,t,r){if(ae(e=Le(Y(e)),t=Le(Y(t)),r=Le(Y(r))))return u;const p=Ee(e,t),L=p[0],R=p[1],W=[];return r.forEach(ie=>{W.push(L*ie+R)}),W},c.TRIM=function(e){return(e=qe(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},c.TRIMMEAN=function(e,t){if(ae(e=Le(Y(e)),t=U(t)))return u;const r=xt(e.length*t,2)/2;return j.mean((L=(L=r)||1,(p=le(e.sort((R,W)=>R-W),r))&&typeof p.slice=="function"?p.slice(0,p.length-L):p));var p,L},c.TRUE=function(){return!0},c.TRUNC=function(e,t){return be(e=U(e),t=U(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},c.TTEST=Co,c.TYPE=function(e){return v(e)?1:C(e)?2:Ft(e)?4:Tt(e)?16:Array.isArray(e)?64:void 0},c.UNICHAR=yn,c.UNICODE=xn,c.UNIQUE=l,c.UPPER=function(e){return(e=qe(e))instanceof Error?e:e.toUpperCase()},c.VALUE=function(e){const t=be(e);if(t)return t;if(typeof e=="number")return e;if(Te(e)||(e=""),typeof e!="string")return u;const r=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let p=Number(e);return isNaN(p)?u:(p=p||0,r&&(p*=.01),p)},c.VAR=me,c.VARA=Ce,c.VARP=Eo,c.VARPA=Oe,c.VARS=Ao,c.VDB=function(){throw new Error("VDB is not implemented")},c.VLOOKUP=o,c.WEEKDAY=function(e,t){if((e=He(e))instanceof Error)return e;t===void 0&&(t=1);const r=e.getDay();return jn[t][r]},c.WEEKNUM=function(e,t){if((e=He(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return tn(e);const r=bn[t];let p=new Date(e.getFullYear(),0,1);const L=p.getDay()<r?1:0;return p-=24*Math.abs(p.getDay()-r)*60*60*1e3,Math.floor((e-p)/864e5/7+1)+L},c.WEIBULL=rt,c.WEIBULLDIST=Lo,c.WORKDAY=Ht,c.WORKDAYINTL=Mo,c.XIRR=function(e,t,r){if(ae(e=Le(Y(e)),t=lt(Y(t)),r=U(r)))return u;const p=(Re,ze,tt)=>{const ot=tt+1;let bt=Re[0];for(let dt=1;dt<Re.length;dt++)bt+=Re[dt]/Math.pow(ot,Lt(ze[dt],ze[0])/365);return bt},L=(Re,ze,tt)=>{const ot=tt+1;let bt=0;for(let dt=1;dt<Re.length;dt++){const Et=Lt(ze[dt],ze[0])/365;bt-=Et*Re[dt]/Math.pow(ot,Et+1)}return bt};let R=!1,W=!1;for(let Re=0;Re<e.length;Re++)e[Re]>0&&(R=!0),e[Re]<0&&(W=!0);if(!R||!W)return h;let ie,de,we,Se=r=r||.1,Pe=!0;do we=p(e,t,Se),ie=Se-we/L(e,t,Se),de=Math.abs(ie-Se),Se=ie,Pe=de>1e-10&&Math.abs(we)>1e-10;while(Pe);return Se},c.XNPV=function(e,t,r){if(ae(e=U(e),t=Le(Y(t)),r=lt(Y(r))))return u;let p=0;for(let L=0;L<t.length;L++)p+=t[L]/Math.pow(1+e,Lt(r[L],r[0])/365);return p},c.XOR=function(){const e=Y(arguments);let t=u;for(let r=0;r<e.length;r++){if(e[r]instanceof Error)return e[r];e[r]!==void 0&&e[r]!==null&&typeof e[r]!="string"&&(t===u&&(t=0),e[r]&&t++)}return t===u?t:!!(1&Math.floor(Math.abs(t)))},c.YEAR=function(e){return(e=He(e))instanceof Error?e:e.getFullYear()},c.YEARFRAC=Yt,c.YIELD=function(){throw new Error("YIELD is not implemented")},c.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},c.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},c.Z=Xe,c.ZTEST=No,c.utils=To}},f={};function E(P){var c=f[P];if(c!==void 0)return c.exports;var a=f[P]={exports:{}};return d[P].call(a.exports,a,a.exports,E),a.exports}E.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(P){if(typeof window=="object")return window}}();var I=E(960);s=I}(),s)},138:function(module,__unused_webpack_exports,__nested_webpack_require_141081__){if(!formula)var formula=__nested_webpack_require_141081__(243);var factory;factory=function(){"use strict";var Version=(info={title:"Jspreadsheet",version:"4.13.2",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(n){var s=(""+n)[0];return s=="="||s=="#"},getMask=function(n){if(n.format||n.mask||n.locale){var s={};return n.mask?s.mask=n.mask:n.format?s.mask=n.format:(s.locale=n.locale,s.options=n.options),n.decimal&&(s.options||(s.options={}),s.options={decimal:n.decimal}),s}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(n){n==null&&(n=!obj.options.fullscreen),obj.options.fullscreen!=n&&(obj.options.fullscreen=n,n==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(n){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var s=obj.options.onevent.apply(this,arguments);typeof obj.options[n]=="function"&&(s=obj.options[n].apply(this,Array.prototype.slice.call(arguments,1)))}if(n=="onafterchanges"&&obj.options.persistance){var d=obj.options.persistance==1?obj.options.url:obj.options.persistance,f=obj.prepareJson(arguments[2]);obj.save(d,f)}return s},obj.prepareTable=function(){var n=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var s=Object.keys(obj.options.data[0]);s.length>n&&(n=s.length)}obj.options.minDimensions[0]>n&&(n=obj.options.minDimensions[0]);for(var d=[],f=0;f<n;f++)obj.options.colHeaders[f]||(obj.options.colHeaders[f]=""),obj.options.colWidths[f]||(obj.options.colWidths[f]=obj.options.defaultColWidth),obj.options.colAlignments[f]||(obj.options.colAlignments[f]=obj.options.defaultColAlign),obj.options.columns[f]?obj.options.columns[f].type||(obj.options.columns[f].type="text"):obj.options.columns[f]={type:"text"},obj.options.columns[f].name||(obj.options.columns[f].name=s&&s[f]?s[f]:f),obj.options.columns[f].source||(obj.options.columns[f].source=[]),obj.options.columns[f].options||(obj.options.columns[f].options=[]),obj.options.columns[f].editor||(obj.options.columns[f].editor=null),obj.options.columns[f].allowEmpty||(obj.options.columns[f].allowEmpty=!1),obj.options.columns[f].title||(obj.options.columns[f].title=obj.options.colHeaders[f]?obj.options.colHeaders[f]:""),obj.options.columns[f].width||(obj.options.columns[f].width=obj.options.colWidths[f]?obj.options.colWidths[f]:obj.options.defaultColWidth),obj.options.columns[f].align||(obj.options.columns[f].align=obj.options.colAlignments[f]?obj.options.colAlignments[f]:"center"),obj.options.columns[f].type=="autocomplete"||obj.options.columns[f].type=="dropdown"?obj.options.columns[f].url&&d.push({url:obj.options.columns[f].url,index:f,method:"GET",dataType:"json",success:function(E){for(var I=0;I<E.length;I++)obj.options.columns[this.index].source.push(E[I])}}):obj.options.columns[f].type=="calendar"&&(obj.options.columns[f].options.format||(obj.options.columns[f].options.format="DD/MM/YYYY"));d.length?jSuites.ajax(d,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(h){obj.scrollControls(h)},obj.content.onwheel=function(h){obj.wheelControls(h)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var n=document.createElement("div"),s=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),n.appendChild(s),n.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var d=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var f=0;f<obj.options.paginationOptions.length;f++){var E=document.createElement("option");E.value=obj.options.paginationOptions[f],E.innerHTML=obj.options.paginationOptions[f],obj.paginationDropdown.appendChild(E)}obj.paginationDropdown.value=obj.options.pagination,d.appendChild(document.createTextNode(obj.options.text.show)),d.appendChild(obj.paginationDropdown),d.appendChild(document.createTextNode(obj.options.text.entries))}var I,P=document.createElement("div");if(P.classList.add("jexcel_filter"),P.appendChild(d),P.appendChild(n),obj.colgroupContainer=document.createElement("colgroup"),(I=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(I),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var c=0;c<obj.options.nestedHeaders.length;c++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[c]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(I=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(I),f=0;f<obj.options.columns.length;f++)obj.createCellHeader(f),obj.headerContainer.appendChild(obj.headers[f]),obj.colgroupContainer.appendChild(obj.colgroup[f]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var a=document.createElement("td");for(obj.filter.appendChild(a),f=0;f<obj.options.columns.length;f++)(a=document.createElement("td")).innerHTML="&nbsp;",a.setAttribute("data-x",f),a.className="jexcel_column_filter",obj.options.columns[f].type=="hidden"&&(a.style.display="none"),obj.filter.appendChild(a);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var j=document.createElement("a");j.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if(typeof sessionStorage!="undefined"&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var O=document.createElement("img");O.src="//bossanova.uk/jspreadsheet/logo.png",j.appendChild(O)}}catch(h){}var B=document.createElement("span");B.innerHTML="Jspreadsheet CE",j.appendChild(B),obj.ads.appendChild(j),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var g=document.createElement("div"),u=document.createElement("div");if(obj.pagination.appendChild(g),obj.pagination.appendChild(u),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(P),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var m=Object.keys(obj.options.classes);for(f=0;f<m.length;f++){var b=jexcel.getIdFromColumnName(m[f],!0);obj.records[b[1]][b[0]].classList.add(obj.options.classes[m[f]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(n){if(n&&(typeof n=="string"&&(n=JSON.parse(n)),obj.options.data=n),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){n=[];for(var s=0;s<obj.options.data.length;s++){for(var d=[],f=0;f<obj.options.columns.length;f++)d[f]=obj.options.data[s][obj.options.columns[f].name];n.push(d)}obj.options.data=n}s=0,f=0;var E=obj.options.columns.length,I=obj.options.data.length,P=obj.options.minDimensions[0],c=obj.options.minDimensions[1],a=P>E?P:E,j=c>I?c:I;for(s=0;s<j;s++)for(f=0;f<a;f++)obj.options.data[s]==null&&(obj.options.data[s]=[]),obj.options.data[s][f]==null&&(obj.options.data[s][f]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var O=0,B=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,O=obj.options.pagination*obj.pageNumber,B=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<B&&(B=obj.options.data.length)):(O=0,B=obj.options.data.length);for(s=0;s<obj.options.data.length;s++){var g=obj.createRow(s,obj.options.data[s]);s>=O&&s<B&&obj.tbody.appendChild(g)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var u=Object.keys(obj.options.mergeCells);for(f=0;f<u.length;f++){var m=obj.options.mergeCells[u[f]];obj.setMerge(u[f],m[0],m[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(n,s){for(var d=[],f=0,E=0,I=s==1||obj.options.copyCompatibility==0,P=obj.options.columns.length,c=obj.options.data.length,a=0;a<c;a++){f=0;for(var j=0;j<P;j++)n&&!obj.records[a][j].classList.contains("highlight")||(d[E]||(d[E]=[]),d[E][f]=I?obj.options.data[a][j]:obj.records[a][j].innerHTML,f++);f>0&&E++}return d},obj.getJsonRow=function(n){for(var s=obj.options.data[n],d=obj.options.columns.length,f={},E=0;E<d;E++)obj.options.columns[E].name||(obj.options.columns[E].name=E),f[obj.options.columns[E].name]=s[E];return f},obj.getJson=function(n){for(var s=[],d=obj.options.columns.length,f=obj.options.data.length,E=0;E<f;E++){for(var I=null,P=0;P<d;P++)n&&!obj.records[E][P].classList.contains("highlight")||(I==null&&(I={}),obj.options.columns[P].name||(obj.options.columns[P].name=P),I[obj.options.columns[P].name]=obj.options.data[E][P]);I!=null&&s.push(I)}return s},obj.prepareJson=function(n){for(var s=[],d=0;d<n.length;d++){var f=n[d].x,E=n[d].y,I=obj.options.columns[f].name?obj.options.columns[f].name:f;s[E]||(s[E]={row:E,data:{}}),s[E].data[I]=n[d].newValue}return s.filter(function(P){return P!=null})},obj.save=function(n,s){var d=obj.dispatch("onbeforesave",el,obj,s);if(d)s=d;else if(d===!1)return!1;jSuites.ajax({url:n,method:"POST",dataType:"json",data:{data:JSON.stringify(s)},success:function(f){obj.dispatch("onsave",el,obj,s)}})},obj.getRowData=function(n){return obj.options.data[n]},obj.setRowData=function(n,s){for(var d=0;d<obj.headers.length;d++){var f=jexcel.getColumnNameFromId([d,n]);s[d]!=null&&obj.setValue(f,s[d])}},obj.getColumnData=function(n){for(var s=[],d=0;d<obj.options.data.length;d++)s.push(obj.options.data[d][n]);return s},obj.setColumnData=function(n,s){for(var d=0;d<obj.rows.length;d++){var f=jexcel.getColumnNameFromId([n,d]);s[d]!=null&&obj.setValue(f,s[d])}},obj.createRow=function(n,s){obj.records[n]||(obj.records[n]=[]),s||(s=obj.options.data[n]),obj.rows[n]=document.createElement("tr"),obj.rows[n].setAttribute("data-y",n);var d=null;obj.options.defaultRowHeight&&(obj.rows[n].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[n]&&(obj.options.rows[n].height&&(obj.rows[n].style.height=obj.options.rows[n].height),obj.options.rows[n].title&&(d=obj.options.rows[n].title)),d||(d=parseInt(n+1));var f=document.createElement("td");f.innerHTML=d,f.setAttribute("data-y",n),f.className="jexcel_row",obj.rows[n].appendChild(f);for(var E=0;E<obj.options.columns.length;E++)obj.records[n][E]=obj.createCell(E,n,s[E]),obj.rows[n].appendChild(obj.records[n][E]);return obj.rows[n]},obj.parseValue=function(n,s,d,f){(""+d).substr(0,1)=="="&&obj.options.parseFormulas==1&&(d=obj.executeFormula(d,n,s));var E=obj.options.columns[n];if(E&&!isFormula(d)){var I=null;if(I=getMask(E)){d&&d==Number(d)&&(d=Number(d));var P=jSuites.mask.render(d,I,!0);if(f&&I.mask){var c=I.mask.split(";");c[1]&&(c[1].match(new RegExp("\\[Red\\]","gi"))&&(d<0?f.classList.add("red"):f.classList.remove("red")),c[1].match(new RegExp("\\(","gi"))&&d<0&&(P="("+P+")"))}P&&(d=P)}}return d};var validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])};obj.createCell=function(n,s,d){var f=document.createElement("td");if(f.setAttribute("data-x",n),f.setAttribute("data-y",s),(""+d).substr(0,1)=="="&&obj.options.secureFormulas==1){var E=secureFormula(d);E!=d&&(d=E)}if(obj.options.columns[n].editor)obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=d:f.textContent=d,typeof obj.options.columns[n].editor.createCell=="function"&&(f=obj.options.columns[n].editor.createCell(f));else if(obj.options.columns[n].type=="hidden")f.style.display="none",f.textContent=d;else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){var I=document.createElement("input");I.type=obj.options.columns[n].type,I.name="c"+n,I.checked=d==1||d==1||d=="true",I.onclick=function(){obj.setValue(f,this.checked)},obj.options.columns[n].readOnly!=1&&obj.options.editable!=0||I.setAttribute("disabled","disabled"),f.appendChild(I),obj.options.data[s][n]=I.checked}else if(obj.options.columns[n].type=="calendar"){var P=null;if(!validDate(d)){var c=jSuites.calendar.extractDateFromString(d,obj.options.columns[n].options.format);c&&(P=c)}f.textContent=jSuites.calendar.getDateString(P||d,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")f.classList.add("jexcel_dropdown"),f.textContent=obj.getDropDownValue(n,d);else if(obj.options.columns[n].type=="color")if(obj.options.columns[n].render=="square"){var a=document.createElement("div");a.className="color",a.style.backgroundColor=d,f.appendChild(a)}else f.style.color=d,f.textContent=d;else if(obj.options.columns[n].type=="image"){if(d&&d.substr(0,10)=="data:image"){var j=document.createElement("img");j.src=d,f.appendChild(j)}}else obj.options.columns[n].type=="html"||obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=stripScript(obj.parseValue(n,s,d,f)):f.textContent=obj.parseValue(n,s,d,f);obj.options.columns[n].readOnly==1&&(f.className="readonly");var O=obj.options.columns[n].align?obj.options.columns[n].align:"center";return f.style.textAlign=O,obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||f.innerHTML.length>200)&&(f.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(d||f.innerHTML?obj.records[s][n-1].style.overflow="hidden":n==obj.options.columns.length-1&&(f.style.overflow="hidden")),f},obj.createCellHeader=function(n){var s=obj.options.columns[n].width?obj.options.columns[n].width:obj.options.defaultColWidth,d=obj.options.columns[n].align?obj.options.columns[n].align:obj.options.defaultColAlign;obj.headers[n]=document.createElement("td"),obj.options.stripHTML?obj.headers[n].textContent=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n):obj.headers[n].innerHTML=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n),obj.headers[n].setAttribute("data-x",n),obj.headers[n].style.textAlign=d,obj.options.columns[n].title&&obj.headers[n].setAttribute("title",obj.headers[n].innerText),obj.options.columns[n].id&&obj.headers[n].setAttribute("id",obj.options.columns[n].id),obj.colgroup[n]=document.createElement("col"),obj.colgroup[n].setAttribute("width",s),obj.options.columns[n].type=="hidden"&&(obj.headers[n].style.display="none",obj.colgroup[n].style.display="none")},obj.updateNestedHeader=function(n,s,d){obj.options.nestedHeaders[s][n].title&&(obj.options.nestedHeaders[s][n].title=d,obj.options.nestedHeaders[s].element.children[n+1].textContent=d)},obj.createNestedHeader=function(n){var s=document.createElement("tr");s.classList.add("jexcel_nested");var d=document.createElement("td");s.appendChild(d),n.element=s;for(var f=0,E=0;E<n.length;E++){n[E].colspan||(n[E].colspan=1),n[E].align||(n[E].align="center"),n[E].title||(n[E].title=""),n[E].id||(n[E].id="");for(var I=n[E].colspan,P=[],c=0;c<I;c++)obj.options.columns[f]&&obj.options.columns[f].type=="hidden"&&I++,P.push(f),f++;(d=document.createElement("td")).setAttribute("data-column",P.join(",")),d.setAttribute("colspan",n[E].colspan),d.setAttribute("align",n[E].align),d.setAttribute("id",n[E].id),d.textContent=n[E].title,s.appendChild(d)}return s},obj.createToolbar=function(n){n?obj.options.toolbar=n:n=obj.options.toolbar;for(var s=0;s<n.length;s++)if(n[s].type=="i")(I=document.createElement("i")).classList.add("jexcel_toolbar_item"),I.classList.add("material-icons"),I.setAttribute("data-k",n[s].k),I.setAttribute("data-v",n[s].v),I.setAttribute("id",n[s].id),n[s].tooltip&&I.setAttribute("title",n[s].tooltip),n[s].onclick&&(n[s].onclick,1)?I.onclick=function(P){var c=P;return function(){n[c].onclick(el,obj,this)}}(s):I.onclick=function(){var P=this.getAttribute("data-k"),c=this.getAttribute("data-v");obj.setStyle(obj.highlighted,P,c)},I.textContent=n[s].content,obj.toolbar.appendChild(I);else if(n[s].type=="select"){var d=!1;(I=document.createElement("select")).classList.add("jexcel_toolbar_item"),I.setAttribute("data-k",n[s].k),n[s].tooltip&&I.setAttribute("title",n[s].tooltip),n[s].onchange&&(n[s].onchange,1)?(I.onchange=n[s].onchange,d=!0):I.onchange=function(){var P=this.getAttribute("data-k");obj.setStyle(obj.highlighted,P,this.value)};for(var f=0;f<n[s].v.length;f++){var E=document.createElement("option");E.value=n[s].v[f],E.textContent=n[s].v[f],n[s].selectedValue&&E.value===n[s].selectedValue&&(E.selected=!0),I.appendChild(E)}d&&I.dispatchEvent(new Event("change")),obj.toolbar.appendChild(I)}else if(n[s].type=="color"){var I;(I=document.createElement("i")).classList.add("jexcel_toolbar_item"),I.classList.add("material-icons"),I.setAttribute("data-k",n[s].k),I.setAttribute("data-v",""),n[s].tooltip&&I.setAttribute("title",n[s].tooltip),obj.toolbar.appendChild(I),I.textContent=n[s].content,jSuites.color(I,{onchange:function(P,c){var a=P.getAttribute("data-k");obj.setStyle(obj.highlighted,a,c)}})}},obj.setMerge=function(n,s,d,f){var E=!1;if(!n){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var I=parseInt(obj.highlighted[0].getAttribute("data-x")),P=parseInt(obj.highlighted[0].getAttribute("data-y")),c=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),a=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));n=jexcel.getColumnNameFromId([I,P]),s=c-I+1,d=a-P+1}var j=jexcel.getIdFromColumnName(n,!0);if(obj.options.mergeCells[n])obj.records[j[1]][j[0]].getAttribute("data-merged")&&(E=obj.options.text.cellAlreadyMerged);else if((!s||s<2)&&(!d||d<2))E=obj.options.text.invalidMergeProperties;else for(var O=j[1];O<j[1]+d;O++)for(var B=j[0];B<j[0]+s;B++)jexcel.getColumnNameFromId([B,O]),obj.records[O][B].getAttribute("data-merged")&&(E=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(E)alert(E);else{s>1?obj.records[j[1]][j[0]].setAttribute("colspan",s):s=1,d>1?obj.records[j[1]][j[0]].setAttribute("rowspan",d):d=1,obj.options.mergeCells[n]=[s,d,[]],obj.records[j[1]][j[0]].setAttribute("data-merged","true"),obj.records[j[1]][j[0]].style.overflow="hidden";for(var g=[],u=j[1];u<j[1]+d;u++)for(var m=j[0];m<j[0]+s;m++)j[0]==m&&j[1]==u||(g.push(obj.options.data[u][m]),obj.updateCell(m,u,"",!0),obj.options.mergeCells[n][2].push(obj.records[u][m]),obj.records[u][m].style.display="none",obj.records[u][m]=obj.records[j[1]][j[0]]);obj.updateSelection(obj.records[j[1]][j[0]]),f||(obj.setHistory({action:"setMerge",column:n,colspan:s,rowspan:d,data:g}),obj.dispatch("onmerge",el,n,s,d))}},obj.getMerge=function(n){var s={};if(n)s=obj.options.mergeCells[n]?[obj.options.mergeCells[n][0],obj.options.mergeCells[n][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var d=Object.keys(obj.options.mergeCells),f=0;f<d.length;f++)s[d[f]]=[obj.options.mergeCells[d[f]][0],obj.options.mergeCells[d[f]][1]]}return s},obj.removeMerge=function(n,s,d){if(obj.options.mergeCells[n]){var f=jexcel.getIdFromColumnName(n,!0);obj.records[f[1]][f[0]].removeAttribute("colspan"),obj.records[f[1]][f[0]].removeAttribute("rowspan"),obj.records[f[1]][f[0]].removeAttribute("data-merged");for(var E=obj.options.mergeCells[n],I=0,P=0;P<E[1];P++)for(var c=0;c<E[0];c++)(P>0||c>0)&&(obj.records[f[1]+P][f[0]+c]=E[2][I],obj.records[f[1]+P][f[0]+c].style.display="",s&&s[I]&&obj.updateCell(f[0]+c,f[1]+P,s[I]),I++);obj.updateSelection(obj.records[f[1]][f[0]],obj.records[f[1]+P-1][f[0]+c-1]),d||delete obj.options.mergeCells[n]}},obj.destroyMerged=function(n){if(obj.options.mergeCells){obj.options.mergeCells;for(var s=Object.keys(obj.options.mergeCells),d=0;d<s.length;d++)obj.removeMerge(s[d],null,n)}},obj.isColMerged=function(n,s){var d=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),E=0;E<f.length;E++){var I=jexcel.getIdFromColumnName(f[E],!0),P=obj.options.mergeCells[f[E]][0],c=I[0],a=I[0]+(P>1?P-1:0);s==null?c<=n&&a>=n&&d.push(f[E]):s?c<n&&a>=n&&d.push(f[E]):c<=n&&a>n&&d.push(f[E])}return d},obj.isRowMerged=function(n,s){var d=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),E=0;E<f.length;E++){var I=jexcel.getIdFromColumnName(f[E],!0),P=obj.options.mergeCells[f[E]][1],c=I[1],a=I[1]+(P>1?P-1:0);s==null?c<=n&&a>=n&&d.push(f[E]):s?c<n&&a>=n&&d.push(f[E]):c<=n&&a>n&&d.push(f[E])}return d},obj.openFilter=function(n){if(obj.options.filters){n=parseInt(n),obj.resetSelection();var s=[];if(obj.options.columns[n].type=="checkbox")s.push({id:"true",name:"True"}),s.push({id:"false",name:"False"});else{for(var d=[],f=!1,E=0;E<obj.options.data.length;E++){var I=obj.options.data[E][n],P=obj.records[E][n].innerHTML;I&&P?d[I]=P:f=!0}var c=Object.keys(d);for(s=[],E=0;E<c.length;E++)s.push({id:c[E],name:d[c[E]]});f&&s.push({value:"",id:"",name:"(Blanks)"})}var a=document.createElement("div");obj.filter.children[n+1].innerHTML="",obj.filter.children[n+1].appendChild(a),obj.filter.children[n+1].style.paddingLeft="0px",obj.filter.children[n+1].style.paddingRight="0px",obj.filter.children[n+1].style.overflow="initial";var j={data:s,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[n]!==void 0?obj.filters[n]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(O){obj.resetFilters(),obj.filters[n]=O.dropdown.getValue(!0),obj.filter.children[n+1].innerHTML=O.dropdown.getText(),obj.filter.children[n+1].style.paddingLeft="",obj.filter.children[n+1].style.paddingRight="",obj.filter.children[n+1].style.overflow="",obj.closeFilter(n),obj.refreshSelection()}};jSuites.dropdown(a,j)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var n=0;n<obj.filter.children.length;n++)obj.filter.children[n].innerHTML="&nbsp;",obj.filters[n]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(n){if(!n)for(var s=0;s<obj.filter.children.length;s++)obj.filters[s]&&(n=s);var d=function(I,P,c){for(var a=0;a<I.length;a++){var j=""+obj.options.data[c][P],O=""+obj.records[c][P].innerHTML;if(I[a]==j||I[a]==O)return!0}return!1},f=obj.filters[n];obj.results=[];for(var E=0;E<obj.options.data.length;E++)d(f,n,E)&&obj.results.push(E);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(n,s,d){var f=n.getAttribute("data-y"),E=n.getAttribute("data-x");obj.dispatch("oneditionstart",el,n,E,f),E>0&&(obj.records[f][E-1].style.overflow="hidden");var I=function(N){var T=n.getBoundingClientRect(),_=document.createElement(N);return _.style.width=T.width+"px",_.style.height=T.height-2+"px",_.style.minHeight=T.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(_),obj.dispatch("oncreateeditor",el,n,E,f,_),_};if(n.classList.contains("readonly")!=1){if(obj.edition=[obj.records[f][E],obj.records[f][E].innerHTML,E,f],obj.options.columns[E].editor)obj.options.columns[E].editor.openEditor(n,el,s,d);else if(obj.options.columns[E].type!="hidden")if(obj.options.columns[E].type=="checkbox"||obj.options.columns[E].type=="radio"){var P=!n.children[0].checked;obj.setValue(n,P),obj.edition=null}else if(obj.options.columns[E].type=="dropdown"||obj.options.columns[E].type=="autocomplete"){if(P=obj.options.data[f][E],obj.options.columns[E].multiple&&!Array.isArray(P)&&(P=P.split(";")),typeof obj.options.columns[E].filter=="function")var c=obj.options.columns[E].filter(el,n,E,f,obj.options.columns[E].source);else c=obj.options.columns[E].source;for(var a=[],j=0;j<c.length;j++)a.push(c[j]);var O=I("div"),B={data:a,multiple:!!obj.options.columns[E].multiple,autocomplete:!(!obj.options.columns[E].autocomplete&&obj.options.columns[E].type!="autocomplete"),opened:!0,value:P,width:"100%",height:O.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(n,!0)}};obj.options.columns[E].options&&obj.options.columns[E].options.type&&(B.type=obj.options.columns[E].options.type),jSuites.dropdown(O,B)}else if(obj.options.columns[E].type=="calendar"||obj.options.columns[E].type=="color")P=obj.options.data[f][E],(O=I("input")).value=P,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[E].options.position=!0),obj.options.columns[E].options.value=obj.options.data[f][E],obj.options.columns[E].options.opened=!0,obj.options.columns[E].options.onclose=function(N,T){obj.closeEditor(n,!0)},obj.options.columns[E].type=="color"?jSuites.color(O,obj.options.columns[E].options):jSuites.calendar(O,obj.options.columns[E].options),O.focus();else if(obj.options.columns[E].type=="html"){P=obj.options.data[f][E],(O=I("div")).style.position="relative",(m=document.createElement("div")).classList.add("jexcel_richtext"),O.appendChild(m),jSuites.editor(m,{focus:!0,value:P});var g=n.getBoundingClientRect(),u=m.getBoundingClientRect();window.innerHeight<g.bottom+u.height?m.style.top=g.top-(u.height+2)+"px":m.style.top=g.top+"px"}else if(obj.options.columns[E].type=="image"){var m,b=n.children[0];(O=I("div")).style.position="relative",(m=document.createElement("div")).classList.add("jclose"),b&&b.src&&m.appendChild(b),O.appendChild(m),jSuites.image(m,obj.options.imageOptions),g=n.getBoundingClientRect(),u=m.getBoundingClientRect(),window.innerHeight<g.bottom+u.height?m.style.top=g.top-(u.height+2)+"px":m.style.top=g.top+"px"}else{P=s==1?"":obj.options.data[f][E],obj.options.columns[E].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[E].wordWrap!=1?O=I("input"):O=I("textarea"),O.focus(),O.value=P,B=obj.options.columns[E];var h=null;if(!isFormula(P)&&(h=getMask(B))){if(!B.disabledMaskOnEdition)if(B.mask){var w=B.mask.split(";");O.setAttribute("data-mask",w[0])}else B.locale&&O.setAttribute("data-locale",B.locale);h.input=O,O.mask=h,jSuites.mask.render(P,h,!1)}O.onblur=function(){obj.closeEditor(n,!0)},O.scrollLeft=O.scrollWidth}}},obj.closeEditor=function(n,s){var d=parseInt(n.getAttribute("data-x")),f=parseInt(n.getAttribute("data-y"));if(s==1){if(obj.options.columns[d].editor)var E=obj.options.columns[d].editor.closeEditor(n,s);else if(!(obj.options.columns[d].type=="checkbox"||obj.options.columns[d].type=="radio"||obj.options.columns[d].type=="hidden"))if(obj.options.columns[d].type=="dropdown"||obj.options.columns[d].type=="autocomplete")E=n.children[0].dropdown.close(!0);else if(obj.options.columns[d].type=="calendar")E=n.children[0].calendar.close(!0);else if(obj.options.columns[d].type=="color")E=n.children[0].color.close(!0);else if(obj.options.columns[d].type=="html")E=n.children[0].children[0].editor.getData();else if(obj.options.columns[d].type=="image"){var I=n.children[0].children[0].children[0];E=I&&I.tagName=="IMG"?I.src:""}else if(obj.options.columns[d].type=="numeric")(""+(E=n.children[0].value)).substr(0,1)!="="&&E==""&&(E=obj.options.columns[d].allowEmpty?"":0),n.children[0].onblur=null;else{E=n.children[0].value,n.children[0].onblur=null;var P,c=obj.options.columns[d];if((P=getMask(c))&&E!==""&&!isFormula(E)&&typeof E!="number"){var a=jSuites.mask.extract(E,P,!0);a&&a.value!==""&&(E=a.value)}}obj.options.data[f][d]==E?n.innerHTML=obj.edition[1]:obj.setValue(n,E)}else obj.options.columns[d].editor?obj.options.columns[d].editor.closeEditor(n,s):obj.options.columns[d].type=="dropdown"||obj.options.columns[d].type=="autocomplete"?n.children[0].dropdown.close(!0):obj.options.columns[d].type=="calendar"?n.children[0].calendar.close(!0):obj.options.columns[d].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,n,d,f,E,s),n.classList.remove("editor"),obj.edition=null},obj.getCell=function(n){var s=(n=jexcel.getIdFromColumnName(n,!0))[0],d=n[1];return obj.records[d][s]},obj.getColumnOptions=function(n,s){var d=obj.options.columns[n];return d||(d={type:"text"}),d},obj.getCellFromCoords=function(n,s){return obj.records[s][n]},obj.getLabel=function(n){var s=(n=jexcel.getIdFromColumnName(n,!0))[0],d=n[1];return obj.records[d][s].innerHTML},obj.getLabelFromCoords=function(n,s){return obj.records[s][n].innerHTML},obj.getValue=function(n,s){if(typeof n=="object")var d=n.getAttribute("data-x"),f=n.getAttribute("data-y");else d=(n=jexcel.getIdFromColumnName(n,!0))[0],f=n[1];var E=null;return d!=null&&f!=null&&(obj.records[f]&&obj.records[f][d]&&(s||obj.options.copyCompatibility==1)?E=obj.records[f][d].innerHTML:obj.options.data[f]&&obj.options.data[f][d]!="undefined"&&(E=obj.options.data[f][d])),E},obj.getValueFromCoords=function(n,s,d){var f=null;return n!=null&&s!=null&&(obj.records[s]&&obj.records[s][n]&&d||obj.options.copyCompatibility==1?f=obj.records[s][n].innerHTML:obj.options.data[s]&&obj.options.data[s][n]!="undefined"&&(f=obj.options.data[s][n])),f},obj.setValue=function(n,s,d){var f=[];if(typeof n=="string"){var E=(a=jexcel.getIdFromColumnName(n,!0))[0],I=a[1];f.push(obj.updateCell(E,I,s,d)),obj.updateFormulaChain(E,I,f)}else if(E=null,I=null,n&&n.getAttribute&&(E=n.getAttribute("data-x"),I=n.getAttribute("data-y")),E!=null&&I!=null)f.push(obj.updateCell(E,I,s,d)),obj.updateFormulaChain(E,I,f);else{var P=Object.keys(n);if(P.length>0)for(var c=0;c<P.length;c++){var a;typeof n[c]=="string"?(E=(a=jexcel.getIdFromColumnName(n[c],!0))[0],I=a[1]):n[c].x!=null&&n[c].y!=null?(E=n[c].x,I=n[c].y,n[c].newValue!=null?s=n[c].newValue:n[c].value!=null&&(s=n[c].value)):(E=n[c].getAttribute("data-x"),I=n[c].getAttribute("data-y")),E!=null&&I!=null&&(f.push(obj.updateCell(E,I,s,d)),obj.updateFormulaChain(E,I,f))}}obj.setHistory({action:"setValue",records:f,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,f)},obj.setValueFromCoords=function(n,s,d,f){var E=[];E.push(obj.updateCell(n,s,d,f)),obj.updateFormulaChain(n,s,E),obj.setHistory({action:"setValue",records:E,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,E)},obj.setCheckRadioValue=function(){for(var n=[],s=Object.keys(obj.highlighted),d=0;d<s.length;d++){var f=obj.highlighted[d].getAttribute("data-x"),E=obj.highlighted[d].getAttribute("data-y");obj.options.columns[f].type!="checkbox"&&obj.options.columns[f].type!="radio"||n.push(obj.updateCell(f,E,!obj.options.data[E][f]))}n.length&&(obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.onafterchanges(el,n))};var stripScript=function(n){var s=new Option;s.innerHTML=n;var d=null;for(n=s.getElementsByTagName("script");d=n[0];)d.parentNode.removeChild(d);return s.innerHTML};obj.updateCell=function(n,s,d,f){if(obj.records[s][n].classList.contains("readonly")!=1||f){var E;(""+d).substr(0,1)=="="&&obj.options.secureFormulas==1&&(E=secureFormula(d))!=d&&(d=E),(E=obj.dispatch("onbeforechange",el,obj.records[s][n],n,s,d))!=null&&(d=E),obj.options.columns[n].editor&&typeof obj.options.columns[n].editor.updateCell=="function"&&(d=obj.options.columns[n].editor.updateCell(obj.records[s][n],d,f)),O={x:n,y:s,col:n,row:s,newValue:d,oldValue:obj.options.data[s][n]};let B=obj.options.columns[n].editor;if(B)obj.options.data[s][n]=d,typeof B.setValue=="function"&&B.setValue(obj.records[s][n],d);else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){if(obj.options.columns[n].type=="radio")for(var I=0;I<obj.options.data.length;I++)obj.options.data[I][n]=!1;obj.records[s][n].children[0].checked=d==1||d==1||d=="true"||d=="TRUE",obj.options.data[s][n]=obj.records[s][n].children[0].checked}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")obj.options.data[s][n]=d,obj.records[s][n].textContent=obj.getDropDownValue(n,d);else if(obj.options.columns[n].type=="calendar"){var P=null;if(!validDate(d)){var c=jSuites.calendar.extractDateFromString(d,obj.options.columns[n].options.format);c&&(P=c)}obj.options.data[s][n]=d,obj.records[s][n].textContent=jSuites.calendar.getDateString(P||d,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="color")if(obj.options.data[s][n]=d,obj.options.columns[n].render=="square"){var a=document.createElement("div");a.className="color",a.style.backgroundColor=d,obj.records[s][n].textContent="",obj.records[s][n].appendChild(a)}else obj.records[s][n].style.color=d,obj.records[s][n].textContent=d;else if(obj.options.columns[n].type=="image"){if(d=""+d,obj.options.data[s][n]=d,obj.records[s][n].innerHTML="",d&&d.substr(0,10)=="data:image"){var j=document.createElement("img");j.src=d,obj.records[s][n].appendChild(j)}}else obj.options.data[s][n]=d,obj.options.columns[n].type=="html"?obj.records[s][n].innerHTML=stripScript(obj.parseValue(n,s,d)):obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?obj.records[s][n].innerHTML=stripScript(obj.parseValue(n,s,d,obj.records[s][n])):obj.records[s][n].textContent=obj.parseValue(n,s,d,obj.records[s][n]),obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||obj.records[s][n].innerHTML.length>200)?obj.records[s][n].style.whiteSpace="pre-wrap":obj.records[s][n].style.whiteSpace="";n>0&&(obj.records[s][n-1].style.overflow=d?"hidden":""),obj.dispatch("onchange",el,obj.records[s]&&obj.records[s][n]?obj.records[s][n]:null,n,s,d,O.oldValue)}else var O={x:n,y:s,col:n,row:s};return O},obj.copyData=function(n,s){var d=obj.getData(!0,!0),f=obj.selectedContainer,E=parseInt(n.getAttribute("data-x")),I=parseInt(n.getAttribute("data-y")),P=parseInt(s.getAttribute("data-x")),c=parseInt(s.getAttribute("data-y")),a=[],j=!1;if(f[0]==E){if(I<f[1])var O=I-f[1];else O=1;var B=0}else B=E<f[0]?E-f[0]:1,O=0;for(var g=0,u=0,m=I;m<=c;m++)if(!obj.rows[m]||obj.rows[m].style.display!="none"){d[u]==null&&(u=0),g=0,f[0]!=E&&(B=E<f[0]?E-f[0]:1);for(var b=E;b<=P;b++){if(obj.records[m][b]&&!obj.records[m][b].classList.contains("readonly")&&obj.records[m][b].style.display!="none"&&j==0){if(!obj.selection.length&&obj.options.data[m][b]!=""){j=!0;continue}(d[u]==null||d[u][g]==null)&&(g=0);var h=d[u][g];if(h&&!d[1]&&obj.options.autoIncrement==1){if(obj.options.columns[b].type=="text"||obj.options.columns[b].type=="number")if((""+h).substr(0,1)=="="){var w=h.match(/([A-Z]+[0-9]+)/g);if(w){for(var N=[],T=0;T<w.length;T++){var _=jexcel.getIdFromColumnName(w[T],1);_[0]+=B,_[1]+=O,_[1]<0&&(_[1]=0);var k=jexcel.getColumnNameFromId([_[0],_[1]]);k!=w[T]&&(N[w[T]]=k)}N&&(h=obj.updateFormula(h,N))}}else h==Number(h)&&(h=Number(h)+O);else if(obj.options.columns[b].type=="calendar"){var M=new Date(h);M.setDate(M.getDate()+O),h=M.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(M.getMonth()+1))+"-"+jexcel.doubleDigitFormat(M.getDate())+" 00:00:00"}}a.push(obj.updateCell(b,m,h)),obj.updateFormulaChain(b,m,a)}g++,f[0]!=E&&B++}u++,O++}obj.setHistory({action:"setValue",records:a,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,a)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(n,s,d){if(n==1){if(obj.selectedCell&&(s>=obj.selectedCell[1]&&s<=obj.selectedCell[3]||d>=obj.selectedCell[1]&&d<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(s>=obj.selectedCell[0]&&s<=obj.selectedCell[2]||d>=obj.selectedCell[0]&&d<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(n){if(obj.highlighted.length){j=1;for(var s=0;s<obj.highlighted.length;s++){obj.highlighted[s].classList.remove("highlight"),obj.highlighted[s].classList.remove("highlight-left"),obj.highlighted[s].classList.remove("highlight-right"),obj.highlighted[s].classList.remove("highlight-top"),obj.highlighted[s].classList.remove("highlight-bottom"),obj.highlighted[s].classList.remove("highlight-selected");var d=parseInt(obj.highlighted[s].getAttribute("data-x")),f=parseInt(obj.highlighted[s].getAttribute("data-y"));if(obj.highlighted[s].getAttribute("data-merged"))var E=parseInt(obj.highlighted[s].getAttribute("colspan")),I=parseInt(obj.highlighted[s].getAttribute("rowspan")),P=E>0?d+(E-1):d,c=I>0?f+(I-1):f;else P=d,c=f;for(var a=d;a<=P;a++)obj.headers[a]&&obj.headers[a].classList.remove("selected");for(a=f;a<=c;a++)obj.rows[a]&&obj.rows[a].classList.remove("selected")}}else var j=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",n==1&&j==1&&obj.dispatch("onblur",el),j},obj.updateSelection=function(n,s,d){var f=n.getAttribute("data-x"),E=n.getAttribute("data-y");if(s)var I=s.getAttribute("data-x"),P=s.getAttribute("data-y");else I=f,P=E;obj.updateSelectionFromCoords(f,E,I,P,d)},obj.updateSelectionFromCoords=function(n,s,d,f,E){var I=obj.resetSelection();if(s==null&&(s=0,f=obj.rows.length-1),d==null&&(d=n),f==null&&(f=s),n>=obj.headers.length&&(n=obj.headers.length-1),s>=obj.rows.length&&(s=obj.rows.length-1),d>=obj.headers.length&&(d=obj.headers.length-1),f>=obj.rows.length&&(f=obj.rows.length-1),obj.selectedCell=[n,s,d,f],n!=null){if(obj.records[s][n]&&obj.records[s][n].classList.add("highlight-selected"),parseInt(n)<parseInt(d))var P=parseInt(n),c=parseInt(d);else P=parseInt(d),c=parseInt(n);if(parseInt(s)<parseInt(f))var a=parseInt(s),j=parseInt(f);else a=parseInt(f),j=parseInt(s);for(var O=P;O<=c;O++)for(var B=a;B<=j;B++)if(obj.records[B][O]&&obj.records[B][O].getAttribute("data-merged")){var g=parseInt(obj.records[B][O].getAttribute("data-x")),u=parseInt(obj.records[B][O].getAttribute("data-y")),m=parseInt(obj.records[B][O].getAttribute("colspan")),b=parseInt(obj.records[B][O].getAttribute("rowspan"));m>1&&(g<P&&(P=g),g+m>c&&(c=g+m-1)),b&&(u<a&&(a=u),u+b>j&&(j=u+b-1))}var h=null,w=null,N=null,T=null;for(B=a;B<=j;B++)obj.rows[B].style.display!="none"&&(N==null&&(N=B),T=B);for(O=P;O<=c;O++){for(B=a;B<=j;B++)obj.rows[B].style.display!="none"&&obj.records[B][O].style.display!="none"&&(obj.records[B][O].classList.add("highlight"),obj.highlighted.push(obj.records[B][O]));obj.options.columns[O].type!="hidden"&&(h==null&&(h=O),w=O)}for(h||(h=0),w||(w=0),O=h;O<=w;O++)obj.options.columns[O].type!="hidden"&&(obj.records[N]&&obj.records[N][O]&&obj.records[N][O].classList.add("highlight-top"),obj.records[T]&&obj.records[T][O]&&obj.records[T][O].classList.add("highlight-bottom"),obj.headers[O].classList.add("selected"));for(B=N;B<=T;B++)obj.rows[B]&&obj.rows[B].style.display!="none"&&(obj.records[B][h].classList.add("highlight-left"),obj.records[B][w].classList.add("highlight-right"),obj.rows[B].classList.add("selected"));obj.selectedContainer=[h,N,w,T]}I==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,h,N,w,T,E),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var n=0;n<obj.selection.length;n++)obj.selection[n].classList.remove("selection"),obj.selection[n].classList.remove("selection-left"),obj.selection[n].classList.remove("selection-right"),obj.selection[n].classList.remove("selection-top"),obj.selection[n].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(n,s){obj.removeCopySelection();var d=obj.selectedContainer[0],f=obj.selectedContainer[1],E=obj.selectedContainer[2],I=obj.selectedContainer[3];if(n!=null&&s!=null){if(n-E>0)var P=parseInt(E)+1,c=parseInt(n);else P=parseInt(n),c=parseInt(d)-1;if(s-I>0)var a=parseInt(I)+1,j=parseInt(s);else a=parseInt(s),j=parseInt(f)-1;c-P<=j-a?(P=parseInt(d),c=parseInt(E)):(a=parseInt(f),j=parseInt(I));for(var O=a;O<=j;O++)for(var B=P;B<=c;B++)obj.records[O][B]&&obj.rows[O].style.display!="none"&&obj.records[O][B].style.display!="none"&&(obj.records[O][B].classList.add("selection"),obj.records[a][B].classList.add("selection-top"),obj.records[j][B].classList.add("selection-bottom"),obj.records[O][P].classList.add("selection-left"),obj.records[O][c].classList.add("selection-right"),obj.selection.push(obj.records[O][B]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var n=obj.highlighted[obj.highlighted.length-1],s=n.getAttribute("data-x"),d=obj.content.getBoundingClientRect(),f=d.left,E=d.top,I=n.getBoundingClientRect(),P=I.left,c=I.top,a=I.width,j=I.height,O=P-f+obj.content.scrollLeft+a-4,B=c-E+obj.content.scrollTop+j-4;if(obj.corner.style.top=B+"px",obj.corner.style.left=O+"px",obj.options.freezeColumns){var g=obj.getFreezeWidth();s>obj.options.freezeColumns-1&&P-f+a<g?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(n){var s=obj.content.getBoundingClientRect(),d=s.left,f=s.top,E=s.width,I=s.height,P=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),c=P.left,a=P.top,j=P.width,O=P.height;if(n==0||n==1)var B=c-d+obj.content.scrollLeft,g=a-f+obj.content.scrollTop-2;else B=c-d+obj.content.scrollLeft+j,g=a-f+obj.content.scrollTop+O;g>obj.content.scrollTop+30&&g<obj.content.scrollTop+I||(g<obj.content.scrollTop+30?obj.content.scrollTop=g-O:obj.content.scrollTop=g-(I-2));var u=obj.getFreezeWidth();B>obj.content.scrollLeft+u&&B<obj.content.scrollLeft+E||(B<obj.content.scrollLeft+30?(obj.content.scrollLeft=B,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):B<obj.content.scrollLeft+u?obj.content.scrollLeft=B-u-1:obj.content.scrollLeft=B-(E-20))},obj.getWidth=function(n){if(n===void 0)for(var s=[],d=0;d<obj.headers.length;d++)s.push(obj.options.columns[d].width);else typeof n=="object"&&(n=$(n).getAttribute("data-x")),s=obj.colgroup[n].getAttribute("width");return s},obj.setWidth=function(n,s,d){if(s){if(Array.isArray(n)){d||(d=[]);for(var f=0;f<n.length;f++){d[f]||(d[f]=obj.colgroup[n[f]].getAttribute("width"));var E=Array.isArray(s)&&s[f]?s[f]:s;obj.colgroup[n[f]].setAttribute("width",E),obj.options.columns[n[f]].width=E}}else d||(d=obj.colgroup[n].getAttribute("width")),obj.colgroup[n].setAttribute("width",s),obj.options.columns[n].width=s;obj.setHistory({action:"setWidth",column:n,oldValue:d,newValue:s}),obj.dispatch("onresizecolumn",el,n,s,d),obj.updateCornerPosition()}},obj.setHeight=function(n,s,d){s>0&&(typeof n=="object"&&(n=n.getAttribute("data-y")),d||(d=obj.rows[n].getAttribute("height"))||(d=obj.rows[n].getBoundingClientRect().height),s=parseInt(s),obj.rows[n].style.height=s+"px",obj.options.rows[n]||(obj.options.rows[n]={}),obj.options.rows[n].height=s,obj.setHistory({action:"setHeight",row:n,oldValue:d,newValue:s}),obj.dispatch("onresizerow",el,n,s,d),obj.updateCornerPosition())},obj.getHeight=function(n){if(n===void 0)for(var s=[],d=0;d<obj.rows.length;d++){var f=obj.rows[d].style.height;f&&(s[d]=f)}else typeof n=="object"&&(n=$(n).getAttribute("data-y")),s=obj.rows[n].style.height;return s},obj.setFooter=function(n){if(n&&(obj.options.footers=n),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var s=0;s<obj.options.footers.length;s++){if(obj.tfoot.children[s])var d=obj.tfoot.children[s];else{d=document.createElement("tr");var f=document.createElement("td");d.appendChild(f),obj.tfoot.appendChild(d)}for(var E=0;E<obj.headers.length;E++){if(obj.options.footers[s][E]||(obj.options.footers[s][E]=""),obj.tfoot.children[s].children[E+1])f=obj.tfoot.children[s].children[E+1];else{f=document.createElement("td"),d.appendChild(f);var I=obj.options.columns[E].align?obj.options.columns[E].align:"center";f.style.textAlign=I}f.textContent=obj.parseValue(+obj.records.length+E,s,obj.options.footers[s][E]),f.style.display=obj.colgroup[E].style.display}}}},obj.getHeader=function(n){return obj.headers[n].textContent},obj.setHeader=function(n,s){if(obj.headers[n]){var d=obj.headers[n].textContent;s||(s=prompt(obj.options.text.columnName,d)),s&&(obj.headers[n].textContent=s,obj.headers[n].setAttribute("title",s),obj.options.columns[n].title=s),obj.setHistory({action:"setHeader",column:n,oldValue:d,newValue:s}),obj.dispatch("onchangeheader",el,n,d,s)}},obj.getHeaders=function(n){for(var s=[],d=0;d<obj.headers.length;d++)s.push(obj.getHeader(d));return n?s:s.join(obj.options.csvDelimiter)},obj.getMeta=function(n,s){return n?s?obj.options.meta[n]&&obj.options.meta[n][s]?obj.options.meta[n][s]:null:obj.options.meta[n]?obj.options.meta[n]:null:obj.options.meta},obj.setMeta=function(n,s,d){if(obj.options.meta||(obj.options.meta={}),s&&d)obj.options.meta[n]||(obj.options.meta[n]={}),obj.options.meta[n][s]=d;else for(var f=Object.keys(n),E=0;E<f.length;E++){obj.options.meta[f[E]]||(obj.options.meta[f[E]]={});for(var I=Object.keys(n[f[E]]),P=0;P<I.length;P++)obj.options.meta[f[E]][I[P]]=n[f[E]][I[P]]}obj.dispatch("onchangemeta",el,n,s,d)},obj.updateMeta=function(n){if(obj.options.meta){for(var s={},d=Object.keys(obj.options.meta),f=0;f<d.length;f++)n[d[f]]?s[n[d[f]]]=obj.options.meta[d[f]]:s[d[f]]=obj.options.meta[d[f]];obj.options.meta=s}},obj.getStyle=function(n,s){if(n)return n=jexcel.getIdFromColumnName(n,!0),s?obj.records[n[1]][n[0]].style[s]:obj.records[n[1]][n[0]].getAttribute("style");for(var d={},f=obj.options.data[0].length,E=obj.options.data.length,I=0;I<E;I++)for(var P=0;P<f;P++){var c=s?obj.records[I][P].style[s]:obj.records[I][P].getAttribute("style");c&&(d[jexcel.getColumnNameFromId([P,I])]=c)}return d},obj.resetStyle=function(n,s){for(var d=Object.keys(n),f=0;f<d.length;f++){var E=jexcel.getIdFromColumnName(d[f],!0);obj.records[E[1]]&&obj.records[E[1]][E[0]]&&obj.records[E[1]][E[0]].setAttribute("style","")}obj.setStyle(n,null,null,null,s)},obj.setStyle=function(n,s,d,f,E){var I={},P={},c=function(h,w,N){var T=jexcel.getIdFromColumnName(h,!0);if(obj.records[T[1]]&&obj.records[T[1]][T[0]]&&(obj.records[T[1]][T[0]].classList.contains("readonly")==0||f)){var _=obj.records[T[1]][T[0]].style[w];_!=N||f?obj.records[T[1]][T[0]].style[w]=N:(N="",obj.records[T[1]][T[0]].style[w]=""),P[h]||(P[h]=[]),I[h]||(I[h]=[]),P[h].push([w+":"+_]),I[h].push([w+":"+N])}};if(s&&d)if(typeof n=="string")c(n,s,d);else for(var a=[],j=0;j<n.length;j++){var O=n[j].getAttribute("data-x"),B=n[j].getAttribute("data-y"),g=jexcel.getColumnNameFromId([O,B]);a[g]||(c(g,s,d),a[g]=!0)}else{var u=Object.keys(n);for(j=0;j<u.length;j++){var m=n[u[j]];typeof m=="string"&&(m=m.split(";"));for(var b=0;b<m.length;b++)typeof m[b]=="string"&&(m[b]=m[b].split(":")),m[b][0].trim()&&c(u[j],m[b][0].trim(),m[b][1])}}for(u=Object.keys(P),j=0;j<u.length;j++)P[u[j]]=P[u[j]].join(";");for(u=Object.keys(I),j=0;j<u.length;j++)I[u[j]]=I[u[j]].join(";");E||obj.setHistory({action:"setStyle",oldValue:P,newValue:I}),obj.dispatch("onchangestyle",el,n,s,d)},obj.getComments=function(n,s){if(n)return typeof n=="string"&&(n=jexcel.getIdFromColumnName(n,!0)),s?[obj.records[n[1]][n[0]].getAttribute("title"),obj.records[n[1]][n[0]].getAttribute("author")]:obj.records[n[1]][n[0]].getAttribute("title")||"";for(var d={},f=0;f<obj.options.data.length;f++)for(var E=0;E<obj.options.columns.length;E++){var I=obj.records[f][E].getAttribute("title");I&&(d[n=jexcel.getColumnNameFromId([E,f])]=I)}return d},obj.setComments=function(n,s,d){if(typeof n=="string")var f=jexcel.getIdFromColumnName(n,!0);else f=n;var E=obj.records[f[1]][f[0]].getAttribute("title"),I=[E,d=obj.records[f[1]][f[0]].getAttribute("data-author")];obj.records[f[1]][f[0]].setAttribute("title",s||""),obj.records[f[1]][f[0]].setAttribute("data-author",d||""),s?obj.records[f[1]][f[0]].classList.add("jexcel_comments"):obj.records[f[1]][f[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:n,newValue:[s,d],oldValue:I}),obj.dispatch("oncomments",el,s,E,f,f[0],f[1])},obj.getConfig=function(){var n=obj.options;return n.style=obj.getStyle(),n.mergeCells=obj.getMerge(),n.comments=obj.getComments(),n},obj.orderBy=function(n,s){if(n>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}s=s==null?obj.headers[n].classList.contains("arrow-down")?1:0:s?1:0;var d=[];if(obj.options.columns[n].type=="number"||obj.options.columns[n].type=="numeric"||obj.options.columns[n].type=="percentage"||obj.options.columns[n].type=="autonumber"||obj.options.columns[n].type=="color")for(var f=0;f<obj.options.data.length;f++)d[f]=[f,Number(obj.options.data[f][n])];else if(obj.options.columns[n].type=="calendar"||obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio")for(f=0;f<obj.options.data.length;f++)d[f]=[f,obj.options.data[f][n]];else for(f=0;f<obj.options.data.length;f++)d[f]=[f,obj.records[f][n].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(I){return function(P,c){var a=P[1],j=c[1];return I?a===""&&j!==""?1:a!==""&&j===""||a>j?-1:a<j?1:0:a===""&&j!==""?1:a!==""&&j===""?-1:a>j?1:a<j?-1:0}}),d=d.sort(obj.options.sorting(s));var E=[];for(f=0;f<d.length;f++)E[f]=d[f][0];return obj.setHistory({action:"orderBy",rows:E,column:n,order:s}),obj.updateOrderArrow(n,s),obj.updateOrder(E),obj.dispatch("onsort",el,n,s),!0}},obj.updateOrderArrow=function(n,s){for(var d=0;d<obj.headers.length;d++)obj.headers[d].classList.remove("arrow-up"),obj.headers[d].classList.remove("arrow-down");s?obj.headers[n].classList.add("arrow-up"):obj.headers[n].classList.add("arrow-down")},obj.updateOrder=function(n){for(var s=[],d=0;d<n.length;d++)s[d]=obj.options.data[n[d]];for(obj.options.data=s,s=[],d=0;d<n.length;d++)s[d]=obj.records[n[d]];for(obj.records=s,s=[],d=0;d<n.length;d++)s[d]=obj.rows[n[d]];if(obj.rows=s,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(d=0;d<obj.rows.length;d++)obj.tbody.appendChild(obj.rows[d])},obj.moveRow=function(n,s,d){if(Object.keys(obj.options.mergeCells).length>0){if(n>s)var f=1;else f=0;if(obj.isRowMerged(n).length||obj.isRowMerged(s,f).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}d||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[s])>=0?n>s?obj.tbody.insertBefore(obj.rows[n],obj.rows[s]):obj.tbody.insertBefore(obj.rows[n],obj.rows[s].nextSibling):obj.tbody.removeChild(obj.rows[n])),obj.rows.splice(s,0,obj.rows.splice(n,1)[0]),obj.records.splice(s,0,obj.records.splice(n,1)[0]),obj.options.data.splice(s,0,obj.options.data.splice(n,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:n,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,n,s)},obj.insertRow=function(n,s,d){if(obj.options.allowInsertRow==1){var f=[];if(n>0)var E=n;else E=1,n&&(f=n);d=!!d;var I=obj.options.data.length-1;if((s==null||s>=parseInt(I)||s<0)&&(s=I),obj.dispatch("onbeforeinsertrow",el,s,E,d)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(s,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var P=d?s:s+1,c=obj.records.splice(P),a=obj.options.data.splice(P),j=obj.rows.splice(P),O=[],B=[],g=[],u=P;u<E+P;u++){obj.options.data[u]=[];for(var m=0;m<obj.options.columns.length;m++)obj.options.data[u][m]=f[m]?f[m]:"";var b=obj.createRow(u,obj.options.data[u]);j[0]?Array.prototype.indexOf.call(obj.tbody.children,j[0])>=0&&obj.tbody.insertBefore(b,j[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[s])>=0&&obj.tbody.appendChild(b),O.push(obj.records[u]),B.push(obj.options.data[u]),g.push(b)}Array.prototype.push.apply(obj.records,c),Array.prototype.push.apply(obj.options.data,a),Array.prototype.push.apply(obj.rows,j),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:s,numOfRows:E,insertBefore:d,rowRecords:O,rowData:B,rowNode:g}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,s,E,O,d)}},obj.deleteRow=function(n,s){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(n==null){var d=obj.getSelectedRows();d[0]?(n=parseInt(d[0].getAttribute("data-y")),s=d.length):(n=obj.options.data.length-1,s=1)}var f=obj.options.data.length-1;if((n==null||n>f||n<0)&&(n=f),s||(s=1),n+s>=obj.options.data.length&&(s=obj.options.data.length-n),obj.dispatch("onbeforedeleterow",el,n,s)===!1)return!1;if(parseInt(n)>-1){var E=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var I=n;I<n+s;I++)obj.isRowMerged(I,!1).length&&(E=!0);if(E){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&f+1===s&&(s--,console.error("Jspreadsheet: It is not possible to delete the last row")),I=n;I<n+s;I++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[I])>=0&&(obj.rows[I].className="",obj.rows[I].parentNode.removeChild(obj.rows[I]));var P=obj.records.splice(n,s),c=obj.options.data.splice(n,s),a=obj.rows.splice(n,s);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,n,n+s-1),obj.setHistory({action:"deleteRow",rowNumber:n,numOfRows:s,insertBefore:1,rowRecords:P,rowData:c,rowNode:a}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,n,s,P)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(n,s){if(Object.keys(obj.options.mergeCells).length>0){if(n>s)var d=1;else d=0;if(obj.isColMerged(n).length||obj.isColMerged(s,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((n=parseInt(n))>(s=parseInt(s))){obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s]),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s]);for(var f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][s])}else for(obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s].nextSibling),f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][s].nextSibling);for(obj.options.columns.splice(s,0,obj.options.columns.splice(n,1)[0]),obj.headers.splice(s,0,obj.headers.splice(n,1)[0]),obj.colgroup.splice(s,0,obj.colgroup.splice(n,1)[0]),f=0;f<obj.rows.length;f++)obj.options.data[f].splice(s,0,obj.options.data[f].splice(n,1)[0]),obj.records[f].splice(s,0,obj.records[f].splice(n,1)[0]);if(obj.options.footers)for(f=0;f<obj.options.footers.length;f++)obj.options.footers[f].splice(s,0,obj.options.footers[f].splice(n,1)[0]);obj.setHistory({action:"moveColumn",oldValue:n,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,n,s)},obj.insertColumn=function(n,s,d,f){if(obj.options.allowInsertColumn==1){var E=[];if(n>0)var I=n;else I=1,n&&(E=n);d=!!d;var P=obj.options.columns.length-1;if((s==null||s>=parseInt(P)||s<0)&&(s=P),obj.dispatch("onbeforeinsertcolumn",el,s,I,d)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(s,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}f||(f=[]);for(var c=0;c<I;c++)f[c]||(f[c]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var a=d?s:s+1;obj.options.columns=jexcel.injectArray(obj.options.columns,a,f);for(var j=obj.headers.splice(a),O=obj.colgroup.splice(a),B=[],g=[],u=[],m=[],b=[],h=a;h<I+a;h++)obj.createCellHeader(h),obj.headerContainer.insertBefore(obj.headers[h],obj.headerContainer.children[h+1]),obj.colgroupContainer.insertBefore(obj.colgroup[h],obj.colgroupContainer.children[h+1]),B.push(obj.headers[h]),g.push(obj.colgroup[h]);if(obj.options.footers)for(var w=0;w<obj.options.footers.length;w++){for(b[w]=[],c=0;c<I;c++)b[w].push("");obj.options.footers[w].splice(a,0,b[w])}for(var N=0;N<obj.options.data.length;N++){var T=obj.options.data[N].splice(a),_=obj.records[N].splice(a);for(m[N]=[],u[N]=[],h=a;h<I+a;h++){var k=E[N]?E[N]:"";obj.options.data[N][h]=k;var M=obj.createCell(h,N,obj.options.data[N][h]);obj.records[N][h]=M,obj.rows[N]&&obj.rows[N].insertBefore(M,obj.rows[N].children[h+1]),m[N].push(k),u[N].push(M)}Array.prototype.push.apply(obj.options.data[N],T),Array.prototype.push.apply(obj.records[N],_)}if(Array.prototype.push.apply(obj.headers,j),Array.prototype.push.apply(obj.colgroup,O),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(w=0;w<obj.options.nestedHeaders.length;w++){var D=parseInt(obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan)+I;obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan=D,obj.thead.children[w].children[obj.thead.children[w].children.length-1].setAttribute("colspan",D);var Z=obj.thead.children[w].children[obj.thead.children[w].children.length-1].getAttribute("data-column");for(Z=Z.split(","),h=a;h<I+a;h++)Z.push(h);obj.thead.children[w].children[obj.thead.children[w].children.length-1].setAttribute("data-column",Z)}else D=parseInt(obj.options.nestedHeaders[0].colspan)+I,obj.options.nestedHeaders[0].colspan=D,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",D);obj.setHistory({action:"insertColumn",columnNumber:s,numOfColumns:I,insertBefore:d,columns:f,headers:B,colgroup:g,records:u,footers:b,data:m}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,s,I,u,d)}},obj.deleteColumn=function(n,s){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(n==null){var d=obj.getSelectedColumns(!0);d.length?(n=parseInt(d[0]),s=parseInt(d.length)):(n=obj.headers.length-1,s=1)}var f=obj.options.data[0].length-1;if((n==null||n>f||n<0)&&(n=f),s||(s=1),s>obj.options.data[0].length-n&&(s=obj.options.data[0].length-n),obj.dispatch("onbeforedeletecolumn",el,n,s)===!1)return!1;if(parseInt(n)>-1){var E=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var I=n;I<n+s;I++)obj.isColMerged(I,!1).length&&(E=!0);if(E){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var P=obj.options.columns.splice(n,s);for(I=n;I<n+s;I++)obj.colgroup[I].className="",obj.headers[I].className="",obj.colgroup[I].parentNode.removeChild(obj.colgroup[I]),obj.headers[I].parentNode.removeChild(obj.headers[I]);for(var c=obj.headers.splice(n,s),a=obj.colgroup.splice(n,s),j=[],O=[],B=[],g=0;g<obj.options.data.length;g++)for(I=n;I<n+s;I++)obj.records[g][I].className="",obj.records[g][I].parentNode.removeChild(obj.records[g][I]);for(g=0;g<obj.options.data.length;g++)O[g]=obj.options.data[g].splice(n,s),j[g]=obj.records[g].splice(n,s);if(obj.options.footers)for(g=0;g<obj.options.footers.length;g++)B[g]=obj.options.footers[g].splice(n,s);if(obj.conditionalSelectionUpdate(0,n,n+s-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var u=0;u<obj.options.nestedHeaders.length;u++){var m=parseInt(obj.options.nestedHeaders[u][obj.options.nestedHeaders[u].length-1].colspan)-s;obj.options.nestedHeaders[u][obj.options.nestedHeaders[u].length-1].colspan=m,obj.thead.children[u].children[obj.thead.children[u].children.length-1].setAttribute("colspan",m)}else m=parseInt(obj.options.nestedHeaders[0].colspan)-s,obj.options.nestedHeaders[0].colspan=m,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",m);obj.setHistory({action:"deleteColumn",columnNumber:n,numOfColumns:s,insertBefore:1,columns:P,headers:c,colgroup:a,records:j,footers:B,data:O}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,n,s,j)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(n){for(var s=[],d=0;d<obj.rows.length;d++)obj.rows[d].classList.contains("selected")&&(n?s.push(d):s.push(obj.rows[d]));return s},obj.getSelectedColumns=function(){for(var n=[],s=0;s<obj.headers.length;s++)obj.headers[s].classList.contains("selected")&&n.push(s);return n},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var n=0;n<obj.headers.length;n++)(I=obj.headers[n].getAttribute("data-x"))!=n&&(obj.headers[n].setAttribute("data-x",n),obj.headers[n].getAttribute("title")||(obj.headers[n].innerHTML=jexcel.getColumnName(n)));for(var s=0;s<obj.rows.length;s++)obj.rows[s]&&(P=obj.rows[s].getAttribute("data-y"))!=s&&(obj.rows[s].setAttribute("data-y",s),obj.rows[s].children[0].setAttribute("data-y",s),obj.rows[s].children[0].innerHTML=s+1);var d=[],f=[],E=function(u,m,b,h){if(u!=b&&obj.records[h][b].setAttribute("data-x",b),m!=h&&obj.records[h][b].setAttribute("data-y",h),u!=b||m!=h){var w=jexcel.getColumnNameFromId([u,m]),N=jexcel.getColumnNameFromId([b,h]);d[w]=N}};for(s=0;s<obj.records.length;s++)for(n=0;n<obj.records[0].length;n++)if(obj.records[s][n]){var I=obj.records[s][n].getAttribute("data-x"),P=obj.records[s][n].getAttribute("data-y");if(obj.records[s][n].getAttribute("data-merged")){var c=jexcel.getColumnNameFromId([I,P]),a=jexcel.getColumnNameFromId([n,s]);if(f[c]==null)if(c==a)f[c]=!1;else{var j=parseInt(n-I),O=parseInt(s-P);f[c]=[a,j,O]}}else E(I,P,n,s)}var B=Object.keys(f);if(B.length){for(n=0;n<B.length;n++)if(f[B[n]]){var g=jexcel.getIdFromColumnName(B[n],!0);for(E(I=g[0],P=g[1],I+f[B[n]][1],P+f[B[n]][2]),c=B[n],a=f[B[n]][0],s=0;s<obj.options.mergeCells[c][2].length;s++)I=parseInt(obj.options.mergeCells[c][2][s].getAttribute("data-x")),P=parseInt(obj.options.mergeCells[c][2][s].getAttribute("data-y")),obj.options.mergeCells[c][2][s].setAttribute("data-x",I+f[B[n]][1]),obj.options.mergeCells[c][2][s].setAttribute("data-y",P+f[B[n]][2]);obj.options.mergeCells[a]=obj.options.mergeCells[c],delete obj.options.mergeCells[c]}}obj.updateFormulas(d),obj.updateMeta(d),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var n=0,s=obj.rows.length-1;s>=0;s--){for(var d=!1,f=0;f<obj.headers.length;f++)obj.options.data[s][f]&&(d=!0);if(d)break;n++}obj.options.minSpareRows-n>0&&obj.insertRow(obj.options.minSpareRows-n)}if(obj.options.minSpareCols>0){var E=0;for(f=obj.headers.length-1;f>=0;f--){for(d=!1,s=0;s<obj.rows.length;s++)obj.options.data[s][f]&&(d=!0);if(d)break;E++}obj.options.minSpareCols-E>0&&obj.insertColumn(obj.options.minSpareCols-E)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),s=0;s<obj.rows.length;s++)for(f=0;f<obj.headers.length;f++)obj.options.updateTable(el,obj.records[s][f],f,s,obj.options.data[s][f],obj.records[s][f].textContent,jexcel.getColumnNameFromId([f,s]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(n){if(n=obj.getCell(n))return!!n.classList.contains("readonly")},obj.setReadOnly=function(n,s){(n=obj.getCell(n))&&(s?n.classList.add("readonly"):n.classList.remove("readonly"))},obj.showRow=function(n){obj.rows[n].style.display=""},obj.hideRow=function(n){obj.rows[n].style.display="none"},obj.showColumn=function(n){obj.headers[n].style.display="",obj.colgroup[n].style.display="",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="");for(var s=0;s<obj.options.data.length;s++)obj.records[s][n].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(n){obj.headers[n].style.display="none",obj.colgroup[n].style.display="none",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="none");for(var s=0;s<obj.options.data.length;s++)obj.records[s][n].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(n,s,d){var f=jexcel.getColumnNameFromId([n,s]);if(obj.formula[f]&&obj.formula[f].length>0)if(chainLoopProtection[f])obj.records[s][n].innerHTML="#ERROR",obj.formula[f]="";else{chainLoopProtection[f]=!0;for(var E=0;E<obj.formula[f].length;E++){var I=jexcel.getIdFromColumnName(obj.formula[f][E],!0),P=""+obj.options.data[I[1]][I[0]];P.substr(0,1)=="="?d.push(obj.updateCell(I[0],I[1],P,!0)):Object.keys(obj.formula)[E]=null,obj.updateFormulaChain(I[0],I[1],d)}}chainLoopProtection=[]},obj.updateFormulas=function(n){for(var s=0;s<obj.options.data.length;s++)for(var d=0;d<obj.options.data[0].length;d++)if((c=""+obj.options.data[s][d]).substr(0,1)=="="){var f=obj.updateFormula(c,n);f!=c&&(obj.options.data[s][d]=f)}var E=[],I=Object.keys(obj.formula);for(s=0;s<I.length;s++){var P=I[s],c=obj.formula[P];for(n[P]&&(P=n[P]),E[P]=[],d=0;d<c.length;d++){var a=c[d];n[a]&&(a=n[a]),E[P].push(a)}}obj.formula=E},obj.updateFormula=function(n,s){for(var d=/[A-Z]/,f=/[0-9]/,E="",I=null,P=null,c="",a=0;a<n.length;a++)d.exec(n[a])?(I=1,P=0,c+=n[a]):f.exec(n[a])?(P=I?1:0,c+=n[a]):(I&&P&&(c=s[c]?s[c]:c),E+=c,E+=n[a],I=0,P=0,c="");return c&&(I&&P&&(c=s[c]?s[c]:c),E+=c),E};var secureFormula=function(n){for(var s="",d=0,f=0;f<n.length;f++)n[f]=='"'&&(d=d==0?1:0),s+=d==1?n[f]:n[f].toUpperCase();return s};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(n){for(var s=0;s<n.length;s++){var d=[],f=n[s].split(":"),E=jexcel.getIdFromColumnName(f[0],!0),I=jexcel.getIdFromColumnName(f[1],!0);if(E[0]<=I[0])var P=E[0],c=I[0];else P=I[0],c=E[0];if(E[1]<=I[1])var a=E[1],j=I[1];else a=I[1],j=E[1];for(var O=a;O<=j;O++)for(var B=P;B<=c;B++)d.push(jexcel.getColumnNameFromId([B,O]));expression=expression.replace(n[s],d.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(n){var res="#ERROR";console.log(n)}return res};return execute(expression,x,y)},obj.parseNumber=function(n,s){var d=s&&obj.options.columns[s].decimal?obj.options.columns[s].decimal:".",f=""+n;return(f=f.split(d))[0]=f[0].match(/[+-]?[0-9]/g),f[0]&&(f[0]=f[0].join("")),f[1]&&(f[1]=f[1].match(/[0-9]*/g).join("")),f[0]&&Number.isInteger(Number(f[0]))?f[1]?n=+(f[0]+"."+f[1]):n=+(f[0]+".00"):n=null,n},obj.row=function(n){},obj.col=function(n){},obj.up=function(n,s){if(n?obj.selectedCell[3]>0&&obj.up.visible(1,s?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var d=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-d<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var f=obj.whichPage(obj.selectedCell[3]);f!=obj.pageNumber&&obj.page(f)}obj.updateScroll(1)},obj.up.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=0;E<f;E++)if(obj.records[E][d].style.display!="none"&&obj.rows[E].style.display!="none"){f=E;break}}else f=obj.up.get(d,f);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=f):(obj.selectedCell[2]=d,obj.selectedCell[3]=f)},obj.up.get=function(n,s){n=parseInt(n);for(var d=(s=parseInt(s))-1;d>=0;d--)if(obj.records[d][n].style.display!="none"&&obj.rows[d].style.display!="none"){if(obj.records[d][n].getAttribute("data-merged")&&obj.records[d][n]==obj.records[s][n])continue;s=d;break}return s},obj.down=function(n,s){if(n?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,s?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}obj.updateScroll(3)},obj.down.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=obj.rows.length-1;E>f;E--)if(obj.records[E][d].style.display!="none"&&obj.rows[E].style.display!="none"){f=E;break}}else f=obj.down.get(d,f);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=f):(obj.selectedCell[2]=d,obj.selectedCell[3]=f)},obj.down.get=function(n,s){n=parseInt(n);for(var d=(s=parseInt(s))+1;d<obj.rows.length;d++)if(obj.records[d][n].style.display!="none"&&obj.rows[d].style.display!="none"){if(obj.records[d][n].getAttribute("data-merged")&&obj.records[d][n]==obj.records[s][n])continue;s=d;break}return s},obj.right=function(n,s){n?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,s?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=obj.headers.length-1;E>d;E--)if(obj.records[f][E].style.display!="none"){d=E;break}}else d=obj.right.get(d,f);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=f):(obj.selectedCell[2]=d,obj.selectedCell[3]=f)},obj.right.get=function(n,s){n=parseInt(n),s=parseInt(s);for(var d=n+1;d<obj.headers.length;d++)if(obj.records[s][d].style.display!="none"){if(obj.records[s][d].getAttribute("data-merged")&&obj.records[s][d]==obj.records[s][n])continue;n=d;break}return n},obj.left=function(n,s){n?obj.selectedCell[2]>0&&obj.left.visible(1,s?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=0;E<d;E++)if(obj.records[f][E].style.display!="none"){d=E;break}}else d=obj.left.get(d,f);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=f):(obj.selectedCell[2]=d,obj.selectedCell[3]=f)},obj.left.get=function(n,s){n=parseInt(n),s=parseInt(s);for(var d=n-1;d>=0;d--)if(obj.records[s][d].style.display!="none"){if(obj.records[s][d].getAttribute("data-merged")&&obj.records[s][d]==obj.records[s][n])continue;n=d;break}return n},obj.first=function(n,s){if(n?s?obj.selectedCell[3]=0:obj.left.visible(1,0):(s?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(n,s){if(n?s?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(s?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(n){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)s=obj.rows;else var s=obj.results;var d=100;n!=null&&n!=-1||(n=Math.ceil(s.length/d)-1);var f=n*d,E=n*d+d;E>s.length&&(E=s.length),(f=E-100)<0&&(f=0);for(var I=f;I<E;I++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[I]):obj.tbody.appendChild(obj.rows[s[I]]),obj.tbody.children.length>d&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var s=0;if(n.length>100){var d=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(d=n.indexOf(d)),d>0)for(var f=0;f<30;f++)(d-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[d],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[n[d]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),s=1))}return s},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var s=0;if(n.length>100){var d=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(d=n.indexOf(d)),d<obj.rows.length-1)for(var f=0;f<=30;f++)d<n.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[d]):obj.tbody.appendChild(obj.rows[n[d]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),s=1)),d+=1}return s},obj.loadValidation=function(){if(obj.selectedCell){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,s=parseInt(obj.selectedCell[3]/100),d=parseInt(obj.rows.length/100);if(n!=s&&s<=d&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(s),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(n){if(n&&(n=n.toLowerCase()),obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],n){var s=function(d){obj.results.indexOf(d)==-1&&obj.results.push(d)};obj.options.data.filter(function(d,f){if(function(a,j,O){for(var B=0;B<a.length;B++)if((""+a[B]).toLowerCase().search(j)>=0||(""+obj.records[O][B].innerHTML).toLowerCase().search(j)>=0)return!0;return!1}(d,n,f)){var E=obj.isRowMerged(f);if(E.length)for(var I=0;I<E.length;I++)for(var P=jexcel.getIdFromColumnName(E[I],!0),c=0;c<obj.options.mergeCells[E[I]][1];c++)s(P[1]+c);else s(f);return!0}return!1})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var n,s=0;for(n=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var d=0;d<obj.rows.length;d++)!obj.results||obj.results.indexOf(d)>-1?(s<n&&(obj.tbody.appendChild(obj.rows[d]),s++),obj.rows[d].style.display=""):obj.rows[d].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),n},obj.whichPage=function(n){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=obj.results.indexOf(n)),Math.ceil((parseInt(n)+1)/parseInt(obj.options.pagination))-1},obj.page=function(n){var s=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)d=obj.rows;else var d=obj.results;var f=parseInt(obj.options.pagination);n!=null&&n!=-1||(n=Math.ceil(d.length/f)-1),obj.pageNumber=n;var E=n*f,I=n*f+f;for(I>d.length&&(I=d.length),E<0&&(E=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var P=E;P<I;P++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[P]):obj.tbody.appendChild(obj.rows[d[P]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,n,s)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows.length;else var n=obj.results.length;if(n){var s=Math.ceil(n/obj.options.pagination);if(obj.pageNumber<6)var d=1,f=s<10?s:10;else s-obj.pageNumber<5?(f=s,(d=s-9)<1&&(d=1)):(d=obj.pageNumber-4,f=obj.pageNumber+5);d>1&&((I=document.createElement("div")).className="jexcel_page",I.innerHTML="<",I.title=1,obj.pagination.children[1].appendChild(I));for(var E=d;E<=f;E++){var I;(I=document.createElement("div")).className="jexcel_page",I.innerHTML=E,obj.pagination.children[1].appendChild(I),obj.pageNumber==E-1&&I.classList.add("jexcel_page_selected")}f<s&&((I=document.createElement("div")).className="jexcel_page",I.innerHTML=">",I.title=s,obj.pagination.children[1].appendChild(I)),obj.pagination.children[0].innerHTML=function(P){var c=Array.prototype.slice.call(arguments,1);return P.replace(/{(\d+)}/g,function(a,j){return c[j]!==void 0?c[j]:a})}(obj.options.text.showingPage,obj.pageNumber+1,s)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(n){if(obj.options.allowExport==0)console.error("Export not allowed");else{var s="";s+=obj.copy(!1,obj.options.csvDelimiter,!0,n,!0);var d=new Blob(["\uFEFF"+s],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(d,obj.options.csvFileName+".csv");else{var f=document.createElement("a"),E=URL.createObjectURL(d);f.href=E,f.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(f),f.click(),f.parentNode.removeChild(f)}}},obj.setHistory=function(n){if(obj.ignoreHistory!=1){var s=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,s+1),obj.history[s]=n}},obj.copy=function(n,s,d,f,E){s||(s="	");for(var I=new RegExp(s,"ig"),P=[],c=[],a=[],j=[],O=[],B=obj.options.data[0].length,g=obj.options.data.length,u="",m=!1,b="",h="",w=0,N=0,T=0,_=0,k=!0,M=0;M<g;M++)for(var D=0;D<B;D++)n&&!obj.records[M][D].classList.contains("highlight")||(T<=D&&(T=D),_<=M&&(_=M));if(B===T+1&&g===_+1&&(k=!1),E&&obj.options.includeHeadersOnDownload==1||!E&&obj.options.includeHeadersOnCopy==1&&!k||f){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(u=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],M=0;M<u.length;M++){var Z=[];for(D=0;D<u[M].length;D++){var Y=parseInt(u[M][D].colspan);Z.push(u[M][D].title);for(var se=0;se<Y-1;se++)Z.push("")}h+=Z.join(s)+`\r
`}m=!0}for(obj.style=[],M=0;M<g;M++){for(c=[],a=[],D=0;D<B;D++)if(!n||obj.records[M][D].classList.contains("highlight")){m==1&&P.push(obj.headers[D].textContent);var he=obj.options.data[M][D];if(he.match&&(he.match(I)||he.match(/,/g)||he.match(/\n/)||he.match(/\"/))&&(he='"'+(he=he.replace(new RegExp('"',"g"),'""'))+'"'),c.push(he),obj.options.columns[D].type=="checkbox"||obj.options.columns[D].type=="radio")var le=he;else(le=obj.options.stripHTMLOnCopy==1?obj.records[M][D].textContent:obj.records[M][D].innerHTML).match&&(le.match(I)||le.match(/,/g)||le.match(/\n/)||le.match(/\"/))&&(le='"'+(le=le.replace(new RegExp('"',"g"),'""'))+'"');a.push(le),u=(u=obj.records[M][D].getAttribute("style")).replace("display: none;",""),obj.style.push(u||"")}c.length&&(m&&(w=c.length,j.push(P.join(s))),j.push(c.join(s))),a.length&&(N++,m&&(O.push(P.join(s)),m=!1),O.push(a.join(s)))}B==w&&g==N&&(b=h);var xe=b+j.join(`\r
`),Ae=b+O.join(`\r
`);if(d||(obj.options.copyCompatibility==1?obj.textarea.value=Ae:obj.textarea.value=xe,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Ae:obj.data=xe,obj.hashString=obj.hash(obj.data),!d){if(obj.removeCopyingSelection(),obj.highlighted)for(D=0;D<obj.highlighted.length;D++)obj.highlighted[D].classList.add("copying"),obj.highlighted[D].classList.contains("highlight-left")&&obj.highlighted[D].classList.add("copying-left"),obj.highlighted[D].classList.contains("highlight-right")&&obj.highlighted[D].classList.add("copying-right"),obj.highlighted[D].classList.contains("highlight-top")&&obj.highlighted[D].classList.add("copying-top"),obj.highlighted[D].classList.contains("highlight-bottom")&&obj.highlighted[D].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?O:j,obj.hashString)}return obj.data},obj.paste=function(n,s,d){var f=obj.dispatch("onbeforepaste",el,d,n,s);if(f===!1)return!1;f&&(d=f);var E=obj.hash(d),I=E==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&E==obj.hashString&&(d=obj.data),d=obj.parseCSV(d,"	"),n!=null&&s!=null&&d){for(var P=0,c=0,a=[],j={},O={},B=0,g=parseInt(n),u=parseInt(s),m=null;m=d[c];){for(P=0,g=parseInt(n);m[P]!=null;){var b=obj.updateCell(g,u,m[P]);if(a.push(b),obj.updateFormulaChain(g,u,a),I&&I[B]){var h=jexcel.getColumnNameFromId([g,u]);j[h]=I[B],O[h]=obj.getStyle(h),obj.records[u][g].setAttribute("style",I[B]),B++}if(m[++P]!=null){if(g>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}g=obj.right.get(g,u)}}if(d[++c]){if(u>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}u=obj.down.get(n,u)}}obj.updateSelectionFromCoords(n,s,g,u),obj.setHistory({action:"setValue",records:a,selection:obj.selectedCell,newStyle:j,oldStyle:O}),obj.updateTable(),obj.dispatch("onpaste",el,d),obj.onafterchanges(el,a)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var n=document.querySelectorAll(".jexcel .copying"),s=0;s<n.length;s++)n[s].classList.remove("copying"),n[s].classList.remove("copying-left"),n[s].classList.remove("copying-right"),n[s].classList.remove("copying-top"),n[s].classList.remove("copying-bottom")},obj.historyProcessRow=function(n,s){var d=s.insertBefore?+s.rowNumber:s.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),n==1){for(var f=s.numOfRows,E=d;E<f+d;E++)obj.rows[E].parentNode.removeChild(obj.rows[E]);obj.records.splice(d,f),obj.options.data.splice(d,f),obj.rows.splice(d,f),obj.conditionalSelectionUpdate(1,d,f+d-1)}else{obj.records=jexcel.injectArray(obj.records,d,s.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,d,s.rowData),obj.rows=jexcel.injectArray(obj.rows,d,s.rowNode);var I=0;for(E=d;E<s.numOfRows+d;E++)obj.tbody.insertBefore(s.rowNode[I],obj.tbody.children[E]),I++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(n,s){var d=s.insertBefore?s.columnNumber:s.columnNumber+1;if(n==1){var f=s.numOfColumns;obj.options.columns.splice(d,f);for(var E=d;E<f+d;E++)obj.headers[E].parentNode.removeChild(obj.headers[E]),obj.colgroup[E].parentNode.removeChild(obj.colgroup[E]);obj.headers.splice(d,f),obj.colgroup.splice(d,f);for(var I=0;I<s.data.length;I++){for(E=d;E<f+d;E++)obj.records[I][E].parentNode.removeChild(obj.records[I][E]);obj.records[I].splice(d,f),obj.options.data[I].splice(d,f)}if(obj.options.footers)for(I=0;I<obj.options.footers.length;I++)obj.options.footers[I].splice(d,f)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,d,s.columns),obj.headers=jexcel.injectArray(obj.headers,d,s.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,d,s.colgroup);var P=0;for(E=d;E<s.numOfColumns+d;E++)obj.headerContainer.insertBefore(s.headers[P],obj.headerContainer.children[E+1]),obj.colgroupContainer.insertBefore(s.colgroup[P],obj.colgroupContainer.children[E+1]),P++;for(I=0;I<s.data.length;I++)for(obj.options.data[I]=jexcel.injectArray(obj.options.data[I],d,s.data[I]),obj.records[I]=jexcel.injectArray(obj.records[I],d,s.records[I]),P=0,E=d;E<s.numOfColumns+d;E++)obj.rows[I].insertBefore(s.records[I][P],obj.rows[I].children[E+1]),P++;if(obj.options.footers)for(I=0;I<obj.options.footers.length;I++)obj.options.footers[I]=jexcel.injectArray(obj.options.footers[I],d,s.footers[I])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(I=0;I<obj.options.nestedHeaders.length;I++){if(n==1)var c=parseInt(obj.options.nestedHeaders[I][obj.options.nestedHeaders[I].length-1].colspan)-s.numOfColumns;else c=parseInt(obj.options.nestedHeaders[I][obj.options.nestedHeaders[I].length-1].colspan)+s.numOfColumns;obj.options.nestedHeaders[I][obj.options.nestedHeaders[I].length-1].colspan=c,obj.thead.children[I].children[obj.thead.children[I].children.length-1].setAttribute("colspan",c)}else c=n==1?parseInt(obj.options.nestedHeaders[0].colspan)-s.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+s.numOfColumns,obj.options.nestedHeaders[0].colspan=c,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",c);obj.updateTableReferences()},obj.undo=function(){var n=!!obj.ignoreEvents,s=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var d=[];if(obj.historyIndex>=0){var f=obj.history[obj.historyIndex--];if(f.action=="insertRow")obj.historyProcessRow(1,f);else if(f.action=="deleteRow")obj.historyProcessRow(0,f);else if(f.action=="insertColumn")obj.historyProcessColumn(1,f);else if(f.action=="deleteColumn")obj.historyProcessColumn(0,f);else if(f.action=="moveRow")obj.moveRow(f.newValue,f.oldValue);else if(f.action=="moveColumn")obj.moveColumn(f.newValue,f.oldValue);else if(f.action=="setMerge")obj.removeMerge(f.column,f.data);else if(f.action=="setStyle")obj.setStyle(f.oldValue,null,null,1);else if(f.action=="setWidth")obj.setWidth(f.column,f.oldValue);else if(f.action=="setHeight")obj.setHeight(f.row,f.oldValue);else if(f.action=="setHeader")obj.setHeader(f.column,f.oldValue);else if(f.action=="setComments")obj.setComments(f.column,f.oldValue[0],f.oldValue[1]);else if(f.action=="orderBy"){for(var E=[],I=0;I<f.rows.length;I++)E[f.rows[I]]=I;obj.updateOrderArrow(f.column,f.order?0:1),obj.updateOrder(E)}else if(f.action=="setValue"){for(var P=0;P<f.records.length;P++)d.push({x:f.records[P].x,y:f.records[P].y,newValue:f.records[P].oldValue}),f.oldStyle&&obj.resetStyle(f.oldStyle);obj.setValue(d),f.selection&&obj.updateSelectionFromCoords(f.selection[0],f.selection[1],f.selection[2],f.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=s,obj.dispatch("onundo",el,f)},obj.redo=function(){var n=!!obj.ignoreEvents,s=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var d=obj.history[++obj.historyIndex];if(d.action=="insertRow")obj.historyProcessRow(0,d);else if(d.action=="deleteRow")obj.historyProcessRow(1,d);else if(d.action=="insertColumn")obj.historyProcessColumn(0,d);else if(d.action=="deleteColumn")obj.historyProcessColumn(1,d);else if(d.action=="moveRow")obj.moveRow(d.oldValue,d.newValue);else if(d.action=="moveColumn")obj.moveColumn(d.oldValue,d.newValue);else if(d.action=="setMerge")obj.setMerge(d.column,d.colspan,d.rowspan,1);else if(d.action=="setStyle")obj.setStyle(d.newValue,null,null,1);else if(d.action=="setWidth")obj.setWidth(d.column,d.newValue);else if(d.action=="setHeight")obj.setHeight(d.row,d.newValue);else if(d.action=="setHeader")obj.setHeader(d.column,d.newValue);else if(d.action=="setComments")obj.setComments(d.column,d.newValue[0],d.newValue[1]);else if(d.action=="orderBy")obj.updateOrderArrow(d.column,d.order),obj.updateOrder(d.rows);else if(d.action=="setValue"){obj.setValue(d.records);for(var f=0;f<d.records.length;f++)d.oldStyle&&obj.resetStyle(d.newStyle);d.selection&&obj.updateSelectionFromCoords(d.selection[0],d.selection[1],d.selection[2],d.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=s,obj.dispatch("onredo",el,d)},obj.getDropDownValue=function(n,s){var d=[];if(obj.options.columns[n]&&obj.options.columns[n].source){for(var f=[],E=obj.options.columns[n].source,I=0;I<E.length;I++)typeof E[I]=="object"?f[E[I].id]=E[I].name:f[E[I]]=E[I];var P=Array.isArray(s)?s:(""+s).split(";");for(I=0;I<P.length;I++)typeof P[I]=="object"?d.push(f[P[I].id]):f[P[I]]&&d.push(f[P[I]])}else console.error("Invalid column");return d.length>0?d.join("; "):""},obj.parseCSV=function(n,s){(n=n.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(n.length-1)==9&&(n+="\0"),s=s||",";for(var d=[],f=!1,E=0,I=0,P=0;P<n.length;P++){var c=n[P],a=n[P+1];d[E]=d[E]||[],d[E][I]=d[E][I]||"",c=='"'&&f&&a=='"'?(d[E][I]+=c,++P):c!='"'?c!=s||f?c!="\r"||a!=`
`||f?c==`
`&&!f||c=="\r"&&!f?(++E,I=0):d[E][I]+=c:(++E,I=0,++P):++I:f=!f}return d},obj.hash=function(n){var s,d=0;if(n.length===0)return d;for(s=0;s<n.length;s++)d=(d<<5)-d+n.charCodeAt(s),d|=0;return d},obj.onafterchanges=function(n,s){obj.dispatch("onafterchanges",n,s)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(n){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(n){var s=obj.parseCSV(n,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&s.length>0)for(var d=s.shift(),f=0;f<d.length;f++)obj.options.columns[f]||(obj.options.columns[f]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[f].title===void 0&&(obj.options.columns[f].title=d[f]);obj.options.data=s,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(n,s,d,f){var E=[];if(d==null)obj.options.allowInsertColumn==1&&E.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(s),1)}}),obj.options.allowInsertColumn==1&&E.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(s),0)}}),obj.options.allowDeleteColumn==1&&E.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(s))}}),obj.options.allowRenameColumn==1&&E.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(s)}}),obj.options.columnSorting==1&&(E.push({type:"line"}),E.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(s,0)}}),E.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(s,1)}}));else if(obj.options.allowInsertRow==1&&(E.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(d),1)}}),E.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(d))}})),obj.options.allowDeleteRow==1&&E.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(d))}}),s&&obj.options.allowComments==1){E.push({type:"line"});var I=obj.records[d][s].getAttribute("title")||"";E.push({title:I?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var P=prompt(obj.options.text.comments,I);P&&obj.setComments([s,d],P)}}),I&&E.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([s,d],"")}})}return E.push({type:"line"}),E.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&E.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(P){P&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],P)})}}),obj.options.allowExport&&E.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&E.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),E},obj.scrollControls=function(n){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&n.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(n){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var n=0;if(obj.options.freezeColumns>0)for(var s=0;s<obj.options.freezeColumns;s++)n+=parseInt(obj.options.columns[s].width);return n};var scrollLeft=0;return obj.updateFreezePosition=function(){var n=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var s=0;s<obj.options.freezeColumns;s++){s>0&&obj.options.columns[s-1].type!=="hidden"&&(n+=parseInt(obj.options.columns[s-1].width)),obj.headers[s].classList.add("jexcel_freezed"),obj.headers[s].style.left=n+"px";for(var d=0;d<obj.rows.length;d++)if(obj.rows[d]&&obj.records[d][s]){var f=scrollLeft+(s>0?obj.records[d][s-1].style.width:0)-51+"px";obj.records[d][s].classList.add("jexcel_freezed"),obj.records[d][s].style.left=f}}else for(s=0;s<obj.options.freezeColumns;s++)for(obj.headers[s].classList.remove("jexcel_freezed"),obj.headers[s].style.left="",d=0;d<obj.rows.length;d++)obj.records[d][s]&&(obj.records[d][s].classList.remove("jexcel_freezed"),obj.records[d][s].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(n){jSuites.setDictionary(n)},jexcel.setExtensions=function(n){for(var s=Object.keys(n),d=0;d<s.length;d++)typeof n[s[d]]=="function"&&(jexcel[s[d]]=n[s[d]],jexcel.license&&typeof n[s[d]].license=="function"&&n[s[d]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(n){n.removeEventListener("mouseup",jexcel.mouseUpControls),n.removeEventListener("mousedown",jexcel.mouseDownControls),n.removeEventListener("mousemove",jexcel.mouseMoveControls),n.removeEventListener("mouseover",jexcel.mouseOverControls),n.removeEventListener("dblclick",jexcel.doubleClickControls),n.removeEventListener("paste",jexcel.pasteControls),n.removeEventListener("contextmenu",jexcel.contextMenuControls),n.removeEventListener("touchstart",jexcel.touchStartControls),n.removeEventListener("touchend",jexcel.touchEndControls),n.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(n,s){if(n.jexcel){var d=n.jexcel.options.root?n.jexcel.options.root:document;n.removeEventListener("DOMMouseScroll",n.jexcel.scrollControls),n.removeEventListener("mousewheel",n.jexcel.scrollControls),n.jexcel=null,n.innerHTML="",s&&(destroyEvents(d),jexcel=null)}},jexcel.build=function(n){destroyEvents(n),n.addEventListener("mouseup",jexcel.mouseUpControls),n.addEventListener("mousedown",jexcel.mouseDownControls),n.addEventListener("mousemove",jexcel.mouseMoveControls),n.addEventListener("mouseover",jexcel.mouseOverControls),n.addEventListener("dblclick",jexcel.doubleClickControls),n.addEventListener("paste",jexcel.pasteControls),n.addEventListener("contextmenu",jexcel.contextMenuControls),n.addEventListener("touchstart",jexcel.touchStartControls),n.addEventListener("touchend",jexcel.touchEndControls),n.addEventListener("touchcancel",jexcel.touchEndControls),n.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(n){if(jexcel.current){if(jexcel.current.edition)if(n.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&n.altKey){var s=jexcel.current.edition[0].children[0],d=jexcel.current.edition[0].children[0].value,f=s.selectionStart;d=d.slice(0,f)+`
`+d.slice(f),s.value=d,s.focus(),s.selectionStart=f+1,s.selectionEnd=f+1}else jexcel.current.edition[0].children[0].blur()}else n.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(n.which==37)jexcel.current.left(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)jexcel.current.right(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)jexcel.current.up(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)jexcel.current.down(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)jexcel.current.first(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)jexcel.current.last(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(n.which==13)n.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),n.preventDefault();else if(n.which==9)n.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var E=jexcel.current.selectedCell[1],I=jexcel.current.selectedCell[0];jexcel.current.options.columns[I].type!="readonly"&&(n.keyCode==32?(n.preventDefault(),jexcel.current.options.columns[I].type=="checkbox"||jexcel.current.options.columns[I].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[E][I],!0)):n.keyCode==113?jexcel.current.openEditor(jexcel.current.records[E][I],!1):(n.keyCode==8||n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=111||n.keyCode>=187&&n.keyCode<=190||(String.fromCharCode(n.keyCode)==n.key||String.fromCharCode(n.keyCode).toLowerCase()==n.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(n.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[E][I],!0),jexcel.current.options.columns[I].type=="calendar"&&n.preventDefault()))}}else n.which==65?(jexcel.current.selectAll(),n.preventDefault()):n.which==83?(jexcel.current.download(),n.preventDefault()):n.which==89?(jexcel.current.redo(),n.preventDefault()):n.which==90?(jexcel.current.undo(),n.preventDefault()):n.which==67?(jexcel.current.copy(!0),n.preventDefault()):n.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),n.preventDefault()):n.which==86&&jexcel.pasteControls();else n.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(n.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;var d=jexcel.getElement(n.target);if(d[0]?jexcel.current!=d[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=d[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&s==1){if(n.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(n.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(d[1]==1){if(u=n.target.getAttribute("data-x")){var f=n.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&f.width-n.offsetX<6){jexcel.current.resizing={mousePosition:n.pageX,column:u,width:f.width},jexcel.current.headers[u].classList.add("resizing");for(var E=0;E<jexcel.current.records.length;E++)jexcel.current.records[E][u]&&jexcel.current.records[E][u].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&f.height-n.offsetY<6)if(jexcel.current.isColMerged(u).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target,column:u,destination:u},jexcel.current.headers[u].classList.add("dragging"),E=0;E<jexcel.current.records.length;E++)jexcel.current.records[E][u]&&jexcel.current.records[E][u].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(n.shiftKey||n.ctrlKey))var I=jexcel.current.selectedHeader,P=u;else jexcel.current.selectedHeader==u&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(u)},800)),jexcel.current.selectedHeader=u,I=u,P=u;jexcel.current.updateSelectionFromCoords(I,0,P,jexcel.current.options.data.length-1)}}else if(n.target.parentNode.classList.contains("jexcel_nested")){if(n.target.getAttribute("data-column"))var c=n.target.getAttribute("data-column").split(","),a=parseInt(c[0]),j=parseInt(c[c.length-1]);else a=0,j=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(a,0,j,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(d[1]==2){var O=n.target.getAttribute("data-y");if(n.target.classList.contains("jexcel_row"))f=n.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&f.height-n.offsetY<6?(jexcel.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:O,height:f.height},n.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&f.width-n.offsetX<6?jexcel.current.isRowMerged(O).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target.parentNode,row:O,destination:O},n.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(n.shiftKey||n.ctrlKey)?(I=jexcel.current.selectedRow,P=O):(jexcel.current.selectedRow=O,I=O,P=O),jexcel.current.updateSelectionFromCoords(0,I,jexcel.current.options.data[0].length-1,P));else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var B=function(m){var b=m.getAttribute("data-x"),h=m.getAttribute("data-y");return b&&h?[b,h]:m.parentNode?B(m.parentNode):void 0},g=B(n.target);if(g){var u=g[0];O=g[1],jexcel.current.edition&&(jexcel.current.edition[2]==u&&jexcel.current.edition[3]==O||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(n.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],u,O):jexcel.current.updateSelectionFromCoords(u,O)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;n.target.classList.contains("jexcel_page")&&(n.target.textContent=="<"?jexcel.current.page(0):n.target.textContent==">"?jexcel.current.page(n.target.getAttribute("title")-1):jexcel.current.page(n.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(n){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var s=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),d=jexcel.current.getSelectedColumns();if(d.length>1){for(var f=[],E=0;E<d.length;E++)f.push(parseInt(jexcel.current.colgroup[d[E]].getAttribute("width")));f[d.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(d,s,f)}else jexcel.current.setWidth(jexcel.current.resizing.column,s,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var I=0;I<jexcel.current.records.length;I++)jexcel.current.records[I][jexcel.current.resizing.column]&&jexcel.current.records[I][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var P=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,P,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var c=n.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),I=0;I<jexcel.current.rows.length;I++)jexcel.current.records[I][jexcel.current.dragging.column]&&jexcel.current.records[I][jexcel.current.dragging.column].classList.remove("dragging");for(E=0;E<jexcel.current.headers.length;E++)jexcel.current.headers[E].classList.remove("dragging-left"),jexcel.current.headers[E].classList.remove("dragging-right");c&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var a=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<a&&(a-=1)}else a=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,a,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;if(s||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var d=n.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+d>0){var f=jexcel.current.resizing.width+d;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",f),jexcel.current.updateCornerPosition()}}else{var E=n.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+E>0){var I=jexcel.current.resizing.height+E;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",I),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var P=n.target.getAttribute("data-x");if(P)if(jexcel.current.isColMerged(P).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var c=0;c<jexcel.current.headers.length;c++)jexcel.current.headers[c].classList.remove("dragging-left"),jexcel.current.headers[c].classList.remove("dragging-right");jexcel.current.dragging.column==P?jexcel.current.dragging.destination=parseInt(P):n.target.clientWidth/2>n.offsetX?(jexcel.current.dragging.column<P?jexcel.current.dragging.destination=parseInt(P)-1:jexcel.current.dragging.destination=parseInt(P),jexcel.current.headers[P].classList.add("dragging-left")):(jexcel.current.dragging.column<P?jexcel.current.dragging.destination=parseInt(P):jexcel.current.dragging.destination=parseInt(P)+1,jexcel.current.headers[P].classList.add("dragging-right"))}}else{var a=n.target.getAttribute("data-y");if(a)if(jexcel.current.isRowMerged(a).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var j=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;jexcel.current.dragging.element!=j&&(n.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,j),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var O=n.target.getAttribute("data-x"),B=n.target.getAttribute("data-y"),g=n.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&O&&!B&&g.width-(n.clientX-g.left)<6?(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="col-resize"):n.target&&!O&&B&&g.height-(n.clientY-g.top)<6&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!O&&B&&g.width-(n.clientX-g.left)<6||n.target&&O&&!B&&g.height-(n.clientY-g.top)<6)&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;if(s||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var d=jexcel.getElement(n.target);if(d[0]){if(jexcel.current!=d[0].jexcel&&jexcel.current)return!1;var f=n.target.getAttribute("data-x"),E=n.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(d[1]==1&&jexcel.current.selectedHeader){f=n.target.getAttribute("data-x");var I=jexcel.current.selectedHeader,P=f;jexcel.current.updateSelectionFromCoords(I,0,P,jexcel.current.options.data.length-1)}d[1]==2&&(n.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(I=jexcel.current.selectedRow,P=E,jexcel.current.updateSelectionFromCoords(0,I,jexcel.current.options.data[0].length-1,P)):jexcel.current.edition||f&&E&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(f,E):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],f,E)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(n){if(jexcel.current)if(n.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var s=jexcel.current.highlighted[0].getAttribute("data-x"),d=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,f=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),E=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[d][s],jexcel.current.records[E][f])}}else if(n.target.classList.contains("jexcel_column_filter")){var I=n.target.getAttribute("data-x");jexcel.current.openFilter(I)}else{var P=jexcel.getElement(n.target);if(P[1]==1&&jexcel.current.options.columnSorting==1&&(I=n.target.getAttribute("data-x"))&&jexcel.current.orderBy(I),P[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var c=function(j){if(j.parentNode){var O=j.getAttribute("data-x"),B=j.getAttribute("data-y");return O&&B?j:c(j.parentNode)}},a=c(n.target);a&&a.classList.contains("highlight")&&jexcel.current.openEditor(a)}}},jexcel.copyControls=function(n){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(n){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(n){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(n&&n.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,jexcel.current){if(jexcel.current.edition)n.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var s=n.target.getAttribute("data-x"),d=n.target.getAttribute("data-y");if(s||d){(s<parseInt(jexcel.current.selectedCell[0])||s>parseInt(jexcel.current.selectedCell[2])||d<parseInt(jexcel.current.selectedCell[1])||d>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(s,d,s,d);var f=jexcel.current.options.contextMenu(jexcel.current,s,d,n);jexcel.current.contextMenu.contextmenu.open(n,f),n.preventDefault()}}}},jexcel.touchStartControls=function(n){var s=jexcel.getElement(n.target);if(s[0]?jexcel.current!=s[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=s[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var d=n.target.getAttribute("data-x"),f=n.target.getAttribute("data-y");d&&f&&(jexcel.current.updateSelectionFromCoords(d,f),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[d].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=n.target,jexcel.current.openEditor(n.target,!1,n)},500))}},jexcel.touchEndControls=function(n){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(n,s){var d=[];if(n.classList.contains("jexcel_tabs"))E=n.children[0],I=n.children[1];else{n.innerHTML="",n.classList.add("jexcel_tabs"),n.jexcel=[];var f=document.createElement("div"),E=n.appendChild(f),I=(f=document.createElement("div"),n.appendChild(f))}for(var P=[],c=[],a=0;a<s.length;a++){P[a]=document.createElement("div"),P[a].classList.add("jexcel_tab");var j=jexcel(P[a],s[a]);I.appendChild(P[a]),d[a]=n.jexcel.push(j),c[a]=document.createElement("div"),c[a].classList.add("jexcel_tab_link"),c[a].setAttribute("data-spreadsheet",n.jexcel.length-1),c[a].innerHTML=s[a].sheetName,c[a].onclick=function(){for(var B=0;B<E.children.length;B++)E.children[B].classList.remove("selected"),I.children[B].style.display="none";var g=this.getAttribute("data-spreadsheet");I.children[g].style.display="block",E.children[g].classList.add("selected")},E.appendChild(c[a])}for(var O=0;O<E.children.length;O++)E.children[O].classList.remove("selected"),I.children[O].style.display="none";return E.children[E.children.length-1].classList.add("selected"),I.children[E.children.length-1].style.display="block",d},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(n,s){var d,f=function(E){var I=[];return E.SheetNames.forEach(function(P){var c={rows:[],columns:[],data:[],style:{}};if(c.sheetName=P,(h=E.Sheets[P]["!cols"])&&h.length)for(var a=0;a<h.length;a++)c.columns[a]={},h[a]&&h[a].wpx&&(c.columns[a].width=h[a].wpx+"px");if((h=E.Sheets[P]["!rows"])&&h.length)for(a=0;a<h.length;a++)h[a]&&h[a].hpx&&(c.rows[a]={},c.rows[a].height=h[a].hpx+"px");if((h=E.Sheets[P]["!merges"])&&h.length>0)for(c.mergeCells=[],a=0;a<h.length;a++){var j=h[a].s.c,O=h[a].s.r,B=h[a].e.c,g=h[a].e.r,u=jexcel.getColumnNameFromId([j,O]);c.mergeCells[u]=[B-j+1,g-O+1]}var m=0,b=0,h=Object.keys(E.Sheets[P]);for(a=0;a<h.length;a++)if(h[a].substr(0,1)!="!"){var w=E.Sheets[P][h[a]],N=jexcel.getIdFromColumnName(h[a],!0);c.data[N[1]]||(c.data[N[1]]=[]),c.data[N[1]][N[0]]=w.f?"="+w.f:w.w,m<N[0]&&(m=N[0]),b<N[1]&&(b=N[1]),w.style&&Object.keys(w.style).length>0&&(c.style[h[a]]=w.style),w.s&&w.s.fgColor&&(c.style[h[a]]&&(c.style[h[a]]+=";"),c.style[h[a]]+="background-color:#"+w.s.fgColor.rgb)}for(var T=c.columns,_=0;_<=b;_++)for(a=0;a<=m;a++)c.data[_]||(c.data[_]=[]),c.data[_][a]||T<a&&(c.data[_][a]="");I.push(c)}),I};(d=new XMLHttpRequest).open("GET",n,!0),typeof Uint8Array!="undefined"?(d.responseType="arraybuffer",d.onload=function(E){var I=d.response,P=new Uint8Array(I),c=XLSX.read(P,{type:"array",cellFormula:!0,cellStyles:!0});s(f(c))}):(d.setRequestHeader("Accept-Charset","x-user-defined"),d.onreadystatechange=function(){if(d.readyState==4&&d.status==200){var E=convertResponseBodyToText(d.responseBody),I=XLSX.read(E,{type:"binary",cellFormula:!0,cellStyles:!0});s(f(I))}}),d.send()},jexcel.validLetter=function(n){return n.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(n,s,d){return n.slice(0,s).concat(d).concat(n.slice(s))},jexcel.getColumnName=function(n){var s="";return n>701?(s+=String.fromCharCode(64+parseInt(n/676)),s+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(s+=String.fromCharCode(64+parseInt(n/26))),s+String.fromCharCode(65+n%26)},jexcel.getIdFromColumnName=function(n,s){var d=/^[a-zA-Z]+/.exec(n);if(d){for(var f=0,E=0;E<d[0].length;E++)f+=parseInt(d[0].charCodeAt(E)-64)*Math.pow(26,d[0].length-1-E);--f<0&&(f=0);var I=parseInt(/[0-9]+$/.exec(n));I>0&&I--,n=s==1?[f,I]:f+"-"+I}return n},jexcel.getColumnNameFromId=function(n){return Array.isArray(n)||(n=n.split("-")),jexcel.getColumnName(parseInt(n[0]))+(parseInt(n[1])+1)},jexcel.getElement=function(n){var s=0,d=0;return function f(E){E.className&&E.classList.contains("jexcel_container")&&(d=E),E.tagName=="THEAD"?s=1:E.tagName=="TBODY"&&(s=2),E.parentNode&&(d||f(E.parentNode))}(n),[d,s]},jexcel.doubleDigitFormat=function(n){return(n=""+n).length==1&&(n="0"+n),n},jexcel.createFromTable=function(n,s){if(n.tagName=="TABLE"){s||(s={}),s.columns=[],s.data=[];var d=n.querySelectorAll("colgroup > col");if(d.length)for(var f=0;f<d.length;f++){if(!(E=d[f].style.width))var E=d[f].getAttribute("width");E&&(s.columns[f]||(s.columns[f]={}),s.columns[f].width=E)}var I=function(xe){var Ae=xe.getBoundingClientRect(),be=Ae.width>50?Ae.width:50;s.columns[f]||(s.columns[f]={}),xe.getAttribute("data-celltype")?s.columns[f].type=xe.getAttribute("data-celltype"):s.columns[f].type="text",s.columns[f].width=be+"px",s.columns[f].title=xe.innerHTML,s.columns[f].align=xe.style.textAlign||"center",(Ae=xe.getAttribute("name"))&&(s.columns[f].name=Ae),(Ae=xe.getAttribute("id"))&&(s.columns[f].id=Ae),(Ae=xe.getAttribute("data-mask"))&&(s.columns[f].mask=Ae)},P=[],c=n.querySelectorAll(":scope > thead > tr");if(c.length){for(var a=0;a<c.length-1;a++){var j=[];for(f=0;f<c[a].children.length;f++){var O={title:c[a].children[f].textContent,colspan:c[a].children[f].getAttribute("colspan")||1};j.push(O)}P.push(j)}for(c=c[c.length-1].children,f=0;f<c.length;f++)I(c[f])}var B=0,g={},u={},m={},b={},h=n.querySelectorAll(":scope > tr, :scope > tbody > tr");for(a=0;a<h.length;a++)if(s.data[B]=[],s.parseTableFirstRowAsHeader!=1||c.length||a!=0){for(f=0;f<h[a].children.length;f++){if(w=h[a].children[f].getAttribute("data-formula"))w.substr(0,1)!="="&&(w="="+w);else var w=h[a].children[f].innerHTML;s.data[B].push(w);var N=jexcel.getColumnNameFromId([f,a]),T=h[a].children[f].getAttribute("class");T&&(b[N]=T);var _=parseInt(h[a].children[f].getAttribute("colspan"))||0,k=parseInt(h[a].children[f].getAttribute("rowspan"))||0;(_||k)&&(g[N]=[_||1,k||1]),h[a].children[f].style&&h[a].children[f].style.display=="none"&&(h[a].children[f].style.display="");var M=h[a].children[f].getAttribute("style");M&&(m[N]=M),h[a].children[f].classList.contains("styleBold")&&(m[N]?m[N]+="; font-weight:bold;":m[N]="font-weight:bold;")}h[a].style&&h[a].style.height&&(u[a]={height:h[a].style.height}),B++}else for(f=0;f<h[a].children.length;f++)I(h[a].children[f]);if(Object.keys(P).length>0&&(s.nestedHeaders=P),Object.keys(m).length>0&&(s.style=m),Object.keys(g).length>0&&(s.mergeCells=g),Object.keys(u).length>0&&(s.rows=u),Object.keys(b).length>0&&(s.classes=b),(h=n.querySelectorAll("tfoot tr")).length){var D=[];for(a=0;a<h.length;a++){var Z=[];for(f=0;f<h[a].children.length;f++)Z.push(h[a].children[f].textContent);D.push(Z)}Object.keys(D).length>0&&(s.footers=D)}if(s.parseTableAutoCellType==1){var Y=[];for(f=0;f<s.columns.length;f++){var se=!0,he=!0;for(Y[f]=[],a=0;a<s.data.length;a++)w=s.data[a][f],Y[f][w]||(Y[f][w]=0),Y[f][w]++,w.length>25&&(se=!1),w.length==10&&w.substr(4,1)=="-"&&w.substr(7,1)=="-"||(he=!1);var le=Object.keys(Y[f]).length;he?s.columns[f].type="calendar":se==1&&le>1&&le<=parseInt(.1*s.data.length)&&(s.columns[f].type="dropdown",s.columns[f].source=Object.keys(Y[f]))}}return s}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(n){if(this.config.root)var s=this.config.root;else s=window;var d=0,f=s.getSelection();if(f&&f.rangeCount!==0){var E=f.getRangeAt(0),I=E.cloneRange();I.selectNodeContents(n),I.setEnd(E.endContainer,E.endOffset),d=I.toString().length}return d},invert:function(n){for(var s=[],d=Object.keys(n),f=0;f<d.length;f++)s[n[d[f]]]=d[f];return s},getColumnName:function(n){var s="";return n>701?(s+=String.fromCharCode(64+parseInt(n/676)),s+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(s+=String.fromCharCode(64+parseInt(n/26))),s+String.fromCharCode(65+n%26)},getColumnNameFromCoords:function(n,s){return component.getColumnName(parseInt(n))+(parseInt(s)+1)},getCoordsFromColumnName:function(n){var s=/^[a-zA-Z]+/.exec(n);if(s){for(var d=0,f=0;f<s[0].length;f++)d+=parseInt(s[0].charCodeAt(f)-64)*Math.pow(26,s[0].length-1-f);--d<0&&(d=0);var E=parseInt(/[0-9]+$/.exec(n))||null;return E>0&&E--,[d,E]}},createFromTable:function(){},injectArray:function(n,s,d){return n.slice(0,s).concat(d).concat(n.slice(s))},parseCSV:function(n,s){s=s||",";for(var d=0,f=0,E=[[]],I=0,P=null,c=!1,a=!1,j=0;j<n.length;j++)if(E[f]||(E[f]=[]),E[f][d]||(E[f][d]=""),n[j]!="\r")if(n[j]!=`
`&&n[j]!=s||c!=0&&a!=1&&P){if(n[j]=='"'&&(c=!c),P===null){if((P=c)==1)continue}else if(P===!0&&!a&&n[j]=='"'){n[j+1]=='"'?(c=!0,E[f][d]+=n[j],j++):a=!0;continue}E[f][d]+=n[j]}else{if(P=null,c=!1,a=!1,E[f][d][0]=='"'){var O=E[f][d].trim();O[O.length-1]=='"'&&(E[f][d]=O.substr(1,O.length-2))}n[j]==`
`?(d=0,f++):++d>I&&(I=d)}for(var B=0;B<E.length;B++)for(j=0;j<=I;j++)E[B][j]===void 0&&(E[B][j]="");return E}},component),typeof jQuery!="undefined"&&function(n){n.fn.jspreadsheet=n.fn.jexcel=function(s){var d=n(this).get(0);return d.jexcel?Array.isArray(d.jexcel)?d.jexcel[s][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):d.jexcel[s].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __nested_webpack_require_281566__(n){var s=__webpack_module_cache__[n];if(s!==void 0)return s.exports;var d=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(d.exports,d,d.exports,__nested_webpack_require_281566__),d.exports}var __webpack_exports__=__nested_webpack_require_281566__(138);return __webpack_exports__}()})},2699:function(n){(function(d,f){n.exports=f()})(this,function(){return function(){var s={195:function(I){(function(P,c){I.exports=c()})(this,function(){return function(U){function c(De,Te){this.highOrder=De,this.lowOrder=Te}var a=[new c(1779033703,4089235720),new c(3144134277,2227873595),new c(1013904242,4271175723),new c(2773480762,1595750129),new c(1359893119,2917565137),new c(2600822924,725511199),new c(528734635,4215389547),new c(1541459225,327033209)],j=[new c(1116352408,3609767458),new c(1899447441,602891725),new c(3049323471,3964484399),new c(3921009573,2173295548),new c(961987163,4081628472),new c(1508970993,3053834265),new c(2453635748,2937671579),new c(2870763221,3664609560),new c(3624381080,2734883394),new c(310598401,1164996542),new c(607225278,1323610764),new c(1426881987,3590304994),new c(1925078388,4068182383),new c(2162078206,991336113),new c(2614888103,633803317),new c(3248222580,3479774868),new c(3835390401,2666613458),new c(4022224774,944711139),new c(264347078,2341262773),new c(604807628,2007800933),new c(770255983,1495990901),new c(1249150122,1856431235),new c(1555081692,3175218132),new c(1996064986,2198950837),new c(2554220882,3999719339),new c(2821834349,766784016),new c(2952996808,2566594879),new c(3210313671,3203337956),new c(3336571891,1034457026),new c(3584528711,2466948901),new c(113926993,3758326383),new c(338241895,168717936),new c(666307205,1188179964),new c(773529912,1546045734),new c(1294757372,1522805485),new c(1396182291,2643833823),new c(1695183700,2343527390),new c(1986661051,1014477480),new c(2177026350,1206759142),new c(2456956037,344077627),new c(2730485921,1290863460),new c(2820302411,3158454273),new c(3259730800,3505952657),new c(3345764771,106217008),new c(3516065817,3606008344),new c(3600352804,1432725776),new c(4094571909,1467031594),new c(275423344,851169720),new c(430227734,3100823752),new c(506948616,1363258195),new c(659060556,3750685593),new c(883997877,3785050280),new c(958139571,3318307427),new c(1322822218,3812723403),new c(1537002063,2003034995),new c(1747873779,3602036899),new c(1955562222,1575990012),new c(2024104815,1125592928),new c(2227730452,2716904306),new c(2361852424,442776044),new c(2428436474,593698344),new c(2756734187,3733110249),new c(3204031479,2999351573),new c(3329325298,3815920427),new c(3391569614,3928383900),new c(3515267271,566280711),new c(3940187606,3454069534),new c(4118630271,4000239992),new c(116418474,1914138554),new c(174292421,2731055270),new c(289380356,3203993006),new c(460393269,320620315),new c(685471733,587496836),new c(852142971,1086792851),new c(1017036298,365543100),new c(1126000580,2618297676),new c(1288033470,3409855158),new c(1501505948,4234509866),new c(1607167915,987167468),new c(1816402316,1246189591)],O=new Array(64),B,g,u,m,b,h,w,N,T,_,k,M,D=8;function Z(De){return unescape(encodeURIComponent(De))}function Y(De){for(var Te=[],Fe=(1<<D)-1,_e=De.length*D,Ke=0;Ke<_e;Ke+=D)Te[Ke>>5]|=(De.charCodeAt(Ke/D)&Fe)<<32-D-Ke%32;return Te}function se(De){for(var Te="0123456789abcdef",Fe="",_e=De.length*4,Ke,Je=0;Je<_e;Je+=1)Ke=De[Je>>2]>>(3-Je%4)*8,Fe+=Te.charAt(Ke>>4&15)+Te.charAt(Ke&15);return Fe}function he(De,Te){var Fe,_e,Ke,Je;return Fe=(De.lowOrder&65535)+(Te.lowOrder&65535),_e=(De.lowOrder>>>16)+(Te.lowOrder>>>16)+(Fe>>>16),Ke=(_e&65535)<<16|Fe&65535,Fe=(De.highOrder&65535)+(Te.highOrder&65535)+(_e>>>16),_e=(De.highOrder>>>16)+(Te.highOrder>>>16)+(Fe>>>16),Je=(_e&65535)<<16|Fe&65535,new c(Je,Ke)}function le(De,Te,Fe,_e){var Ke,Je,ut,ft;return Ke=(De.lowOrder&65535)+(Te.lowOrder&65535)+(Fe.lowOrder&65535)+(_e.lowOrder&65535),Je=(De.lowOrder>>>16)+(Te.lowOrder>>>16)+(Fe.lowOrder>>>16)+(_e.lowOrder>>>16)+(Ke>>>16),ut=(Je&65535)<<16|Ke&65535,Ke=(De.highOrder&65535)+(Te.highOrder&65535)+(Fe.highOrder&65535)+(_e.highOrder&65535)+(Je>>>16),Je=(De.highOrder>>>16)+(Te.highOrder>>>16)+(Fe.highOrder>>>16)+(_e.highOrder>>>16)+(Ke>>>16),ft=(Je&65535)<<16|Ke&65535,new c(ft,ut)}function xe(De,Te,Fe,_e,Ke){var Je,ut,ft,ct;return Je=(De.lowOrder&65535)+(Te.lowOrder&65535)+(Fe.lowOrder&65535)+(_e.lowOrder&65535)+(Ke.lowOrder&65535),ut=(De.lowOrder>>>16)+(Te.lowOrder>>>16)+(Fe.lowOrder>>>16)+(_e.lowOrder>>>16)+(Ke.lowOrder>>>16)+(Je>>>16),ft=(ut&65535)<<16|Je&65535,Je=(De.highOrder&65535)+(Te.highOrder&65535)+(Fe.highOrder&65535)+(_e.highOrder&65535)+(Ke.highOrder&65535)+(ut>>>16),ut=(De.highOrder>>>16)+(Te.highOrder>>>16)+(Fe.highOrder>>>16)+(_e.highOrder>>>16)+(Ke.highOrder>>>16)+(Je>>>16),ct=(ut&65535)<<16|Je&65535,new c(ct,ft)}function Ae(De,Te,Fe){return new c(De.highOrder&Te.highOrder^De.highOrder&Fe.highOrder^Te.highOrder&Fe.highOrder,De.lowOrder&Te.lowOrder^De.lowOrder&Fe.lowOrder^Te.lowOrder&Fe.lowOrder)}function be(De,Te,Fe){return new c(De.highOrder&Te.highOrder^~De.highOrder&Fe.highOrder,De.lowOrder&Te.lowOrder^~De.lowOrder&Fe.lowOrder)}function ae(De,Te){return Te<=32?new c(De.highOrder>>>Te|De.lowOrder<<32-Te,De.lowOrder>>>Te|De.highOrder<<32-Te):new c(De.lowOrder>>>Te|De.highOrder<<32-Te,De.highOrder>>>Te|De.lowOrder<<32-Te)}function Ve(De){var Te=ae(De,28),Fe=ae(De,34),_e=ae(De,39);return new c(Te.highOrder^Fe.highOrder^_e.highOrder,Te.lowOrder^Fe.lowOrder^_e.lowOrder)}function Ge(De){var Te=ae(De,14),Fe=ae(De,18),_e=ae(De,41);return new c(Te.highOrder^Fe.highOrder^_e.highOrder,Te.lowOrder^Fe.lowOrder^_e.lowOrder)}function Ye(De){var Te=ae(De,1),Fe=ae(De,8),_e=lt(De,7);return new c(Te.highOrder^Fe.highOrder^_e.highOrder,Te.lowOrder^Fe.lowOrder^_e.lowOrder)}function He(De){var Te=ae(De,19),Fe=ae(De,61),_e=lt(De,6);return new c(Te.highOrder^Fe.highOrder^_e.highOrder,Te.lowOrder^Fe.lowOrder^_e.lowOrder)}function lt(De,Te){return Te<=32?new c(De.highOrder>>>Te,De.lowOrder>>>Te|De.highOrder<<32-Te):new c(0,De.highOrder<<32-Te)}var U=Z(U),Le=U.length*D;U=Y(U),U[Le>>5]|=128<<24-Le%32,U[(Le+128>>10<<5)+31]=Le;for(var T=0;T<U.length;T+=32){B=a[0],g=a[1],u=a[2],m=a[3],b=a[4],h=a[5],w=a[6],N=a[7];for(var _=0;_<80;_++)_<16?O[_]=new c(U[_*2+T],U[_*2+T+1]):O[_]=le(He(O[_-2]),O[_-7],Ye(O[_-15]),O[_-16]),k=xe(N,Ge(b),be(b,h,w),j[_],O[_]),M=he(Ve(B),Ae(B,g,u)),N=w,w=h,h=b,b=he(m,k),m=u,u=g,g=B,B=he(k,M);a[0]=he(B,a[0]),a[1]=he(g,a[1]),a[2]=he(u,a[2]),a[3]=he(m,a[3]),a[4]=he(b,a[4]),a[5]=he(h,a[5]),a[6]=he(w,a[6]),a[7]=he(N,a[7])}for(var qe=[],T=0;T<a.length;T++)qe.push(a[T].highOrder),qe.push(a[T].lowOrder);return se(qe)}})}},d={};function f(I){var P=d[I];if(P!==void 0)return P.exports;var c=d[I]={exports:{}};return s[I].call(c.exports,c,c.exports,f),c.exports}(function(){f.n=function(I){var P=I&&I.__esModule?function(){return I.default}:function(){return I};return f.d(P,{a:P}),P}})(),function(){f.d=function(I,P){for(var c in P)f.o(P,c)&&!f.o(I,c)&&Object.defineProperty(I,c,{enumerable:!0,get:P[c]})}}(),function(){f.o=function(I,P){return Object.prototype.hasOwnProperty.call(I,P)}}();var E={};return function(){"use strict";f.d(E,{default:function(){return Ft}});var I={};I.two=function(v){return v=""+v,v.length==1&&(v="0"+v),v},I.focus=function(v){if(v.innerText.length){var C=document.createRange(),l=window.getSelection(),o=v.childNodes[v.childNodes.length-1];C.setStart(o,o.length),C.collapse(!0),l.removeAllRanges(),l.addRange(C),v.scrollLeft=v.scrollWidth}},I.isNumeric=function(v){return typeof v=="string"&&(v=v.trim()),!isNaN(v)&&v!==null&&v!==""},I.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(v){var C=Math.random()*16|0,l=v=="x"?C:C&3|8;return l.toString(16)})},I.getNode=function(){var v=document.getSelection().anchorNode;return v?v.nodeType==3?v.parentNode:v:null},I.hash=function(v){var C=0,l,o;if(v.length===0)return C;for(l=0;l<v.length;l++)o=v.charCodeAt(l),o>32&&(C=(C<<5)-C+o,C|=0);return C},I.randomColor=function(v){var C=-.25,l=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");l.length<6&&(l=l[0]+l[0]+l[1]+l[1]+l[2]+l[2]);var o=[],S,q;for(q=0;q<3;q++)S=parseInt(l.substr(q*2,2),16),S=Math.round(Math.min(Math.max(0,S+S*C),255)).toString(16),o.push(("00"+S).substr(S.length));return v==!0?"#"+I.two(o[0].toString(16))+I.two(o[1].toString(16))+I.two(o[2].toString(16)):o},I.getWindowWidth=function(){var v=window,C=document,l=C.documentElement,o=C.getElementsByTagName("body")[0],S=v.innerWidth||l.clientWidth||o.clientWidth;return S},I.getWindowHeight=function(){var v=window,C=document,l=C.documentElement,o=C.getElementsByTagName("body")[0],S=v.innerHeight||l.clientHeight||o.clientHeight;return S},I.getPosition=function(v){if(v.changedTouches&&v.changedTouches[0])var C=v.changedTouches[0].pageX,l=v.changedTouches[0].pageY;else var C=window.Event?v.pageX:v.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),l=window.Event?v.pageY:v.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[C,l]},I.click=function(v){if(v.click)v.click();else{var C=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});v.dispatchEvent(C)}},I.findElement=function(v,C){var l=!1;function o(S){S&&!l&&(typeof C=="function"?l=C(S):typeof C=="string"&&S.classList&&S.classList.contains(C)&&(l=S)),S.parentNode&&!l&&o(S.parentNode)}return o(v),l};var P=I;function c(){var v={};v.now=function(S,q){var G=null,z=null,V=null,H=null,J=null,oe=null;return Array.isArray(S)?(G=S[0],z=S[1],V=S[2],H=S[3],J=S[4],oe=S[5]):(S||(S=new Date),G=S.getFullYear(),z=S.getMonth()+1,V=S.getDate(),H=S.getHours(),J=S.getMinutes(),oe=S.getSeconds()),q==!0?P.two(G)+"-"+P.two(z)+"-"+P.two(V):P.two(G)+"-"+P.two(z)+"-"+P.two(V)+" "+P.two(H)+":"+P.two(J)+":"+P.two(oe)},v.toArray=function(S){var G=S.split(S.indexOf("T")!==-1?"T":" "),q=G[1],G=G[0].split("-"),z=parseInt(G[0]),V=parseInt(G[1]),H=parseInt(G[2]),J=0,oe=0;return q&&(q=q.split(":"),J=parseInt(q[0]),oe=parseInt(q[1])),[z,V,H,J,oe,0]};var C=Date.UTC(1900,0,0),l=Date.UTC(1900,1,29),o=864e5;return v.dateToNum=function(S){typeof S=="string"&&(S=new Date(S+"  GMT+0"));var q=S.getTime();return q>=l&&(q+=o),q-=C,q/o},v.numToDate=function(S){var q=C+S*o;q>=l&&(q-=o);const G=new Date(q);var z=[G.getUTCFullYear(),G.getUTCMonth()+1,G.getUTCDate(),G.getUTCHours(),G.getUTCMinutes(),G.getUTCSeconds()];return v.now(z)},v.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],v.months=["January","February","March","April","May","June","July","August","September","October","November","December"],v.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],v.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],v}var a=c(),j=function(v){document.dictionary||(document.dictionary={});var C=null,l=null,o=Object.keys(v);for(l=0;l<o.length;l++)document.dictionary[o[l]]=v[o[l]];for(l=0;l<a.weekdays.length;l++)C=O(a.weekdays[l]),a.weekdays[l]&&(a.weekdays[l]=C,a.weekdaysShort[l]=C.substr(0,3));for(l=0;l<a.months.length;l++)C=O(a.months[l]),C&&(a.months[l]=C,a.monthsShort[l]=C.substr(0,3))},O=function(v){return typeof document!="undefined"&&document.dictionary&&document.dictionary[v]||v},B={setDictionary:j,translate:O};function g(v,C){if(C==!0)document.jsuitesComponents=document.jsuitesComponents.filter(function(o){return o!==null}),setTimeout(function(){document.jsuitesComponents.push(v)},0);else{var l=document.jsuitesComponents.indexOf(v);l>=0&&document.jsuitesComponents.splice(l,1)}}function u(v,C,l){if(v=v.split("."),v.length){let o=this,S=null;for(;v.length>1;)if(S=v.shift(),o.hasOwnProperty(S))o=o[S];else{if(typeof C=="undefined")return;o[S]={},o=o[S]}if(S=v.shift(),typeof C!="undefined")return l===!0?delete o[S]:o[S]=C,!0;if(o)return o[S]}return!1}function m(v,C){var l={};l.options={};var o={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},S=null;for(var q in o)C&&C.hasOwnProperty(q)?l.options[q]=C[q]:l.options[q]=o[q];v.classList.add("jsorting"),v.addEventListener("dragstart",function(V){var H=Array.prototype.indexOf.call(V.target.parentNode.children,V.target);S={element:V.target,o:H,d:H},V.target.style.opacity="0.25",typeof l.options.ondragstart=="function"&&l.options.ondragstart(v,V.target,V)}),v.addEventListener("dragover",function(V){if(V.preventDefault(),G(V.target)&&S&&V.target.getAttribute("draggable")=="true"&&S.element!=V.target){if(l.options.direction)var H=V.target.clientWidth/2>V.offsetX;else var H=V.target.clientHeight/2>V.offsetY;H?V.target.parentNode.insertBefore(S.element,V.target):V.target.parentNode.insertBefore(S.element,V.target.nextSibling),S.d=Array.prototype.indexOf.call(V.target.parentNode.children,S.element)}}),v.addEventListener("dragleave",function(V){V.preventDefault()}),v.addEventListener("dragend",function(V){V.preventDefault(),S&&(typeof l.options.ondragend=="function"&&l.options.ondragend(v,S.element,V),S.o<S.d?V.target.parentNode.insertBefore(S.element,V.target.parentNode.children[S.o]):V.target.parentNode.insertBefore(S.element,V.target.parentNode.children[S.o].nextSibling),S.element.style.opacity="",S=null)}),v.addEventListener("drop",function(V){V.preventDefault(),S&&S.o!=S.d&&typeof l.options.ondrop=="function"&&l.options.ondrop(v,S.o,S.d,S.element,V.target,V),S.element.style.opacity="",S=null});for(var G=function(V){var H=!1;function J(oe){oe.className&&oe.classList.contains("jsorting")&&(H=!0),H||J(oe.parentNode)}return J(V),H},z=0;z<v.children.length;z++)v.children[z].hasAttribute("draggable")||v.children[z].setAttribute("draggable","true");return v.val=function(){for(var V=null,H=[],J=0;J<v.children.length;J++)(V=v.children[J].getAttribute("data-id"))&&H.push(V);return H},v}function b(v,C){var l={};(!C.loadUp||typeof C.loadUp!="function")&&(C.loadUp=function(){return!1}),(!C.loadDown||typeof C.loadDown!="function")&&(C.loadDown=function(){return!1}),C.timer||(C.timer=100);var o=null,S=function(q){if(o==null){var G=!1,z=v.scrollTop;v.scrollTop+v.clientHeight*2>=v.scrollHeight?C.loadDown()&&(z==v.scrollTop&&(v.scrollTop=v.scrollTop-v.clientHeight),G=!0):v.scrollTop<=v.clientHeight&&C.loadUp()&&(z==v.scrollTop&&(v.scrollTop=v.scrollTop+v.clientHeight),G=!0),o=setTimeout(function(){o=null},C.timer),G&&typeof C.onupdate=="function"&&C.onupdate()}};return v.onscroll=function(q){S(q)},v.onwheel=function(q){S(q)},l}function h(){var v=function(C,l){if(Array.isArray(C)){var o={instance:[],complete:l};if(C.length>0)for(var S=0;S<C.length;S++)C[S].multiple=o,o.instance.push(v(C[S]));return o}if(C.data||(C.data={}),C.type&&(C.method=C.type),C.method||(C.method="GET"),C.dataType||(C.dataType="json"),C.data){var q=function(oe,je){var ue=[];if(oe){var te=Object.keys(oe);if(te.length)for(var ge=0;ge<te.length;ge++){if(je)var ye=je+"["+te[ge]+"]";else var ye=te[ge];if(oe[ye]instanceof FileList)ue[ye]=oe[te[ge]];else if(oe[te[ge]]===null||oe[te[ge]]===void 0)ue[ye]="";else if(typeof oe[te[ge]]=="object")for(var ke=q(oe[te[ge]],ye),We=Object.keys(ke),Qe=0;Qe<We.length;Qe++)ue[We[Qe]]=ke[We[Qe]];else ue[ye]=oe[te[ge]]}}return ue},G=q(C.data),z=Object.keys(G);if(C.method=="GET"){if(z.length){for(var V=[],S=0;S<z.length;S++)V.push(z[S]+"="+encodeURIComponent(G[z[S]]));C.url.indexOf("?")<0&&(C.url+="?"),C.url+=V.join("&")}}else for(var V=new FormData,S=0;S<z.length;S++)if(G[z[S]]instanceof FileList){if(G[z[S]].length)for(var H=0;H<G[z[S]].length;H++)V.append(z[S],G[z[S]][H],G[z[S]][H].name)}else V.append(z[S],G[z[S]])}var J=new XMLHttpRequest;return J.open(C.method,C.url,!0),J.setRequestHeader("X-Requested-With","XMLHttpRequest"),C.contentType&&J.setRequestHeader("Content-Type",C.contentType),C.method==="POST"?J.setRequestHeader("Accept","application/json"):C.dataType==="blob"?J.responseType="blob":C.contentType||(C.dataType==="json"?J.setRequestHeader("Content-Type","text/json"):C.dataType==="html"&&J.setRequestHeader("Content-Type","text/html")),C.cache!==!0&&(J.setRequestHeader("pragma","no-cache"),J.setRequestHeader("cache-control","no-cache")),C.withCredentials===!0&&(J.withCredentials=!0),typeof C.beforeSend=="function"&&C.beforeSend(J),typeof v.beforeSend=="function"&&v.beforeSend(J),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(J),J.onload=function(){if(J.status>=200&&J.status<300)if(C.dataType==="json")try{var oe=JSON.parse(J.responseText);C.success&&typeof C.success=="function"&&C.success(oe)}catch(ue){C.error&&typeof C.error=="function"&&C.error(ue,oe)}else{if(C.dataType==="blob")var oe=J.response;else var oe=J.responseText;C.success&&typeof C.success=="function"&&C.success(oe)}else C.error&&typeof C.error=="function"&&C.error(J.responseText,J.status);if(v.queue&&v.queue.length>0&&v.send(v.queue.shift()),v.requests&&v.requests.length){var je=v.requests.indexOf(J);if(v.requests.splice(je,1),v.requests.length||C.complete&&typeof C.complete=="function"&&C.complete(oe),C.group&&v.oncomplete&&typeof v.oncomplete[C.group]=="function"&&(v.pending(C.group)||(v.oncomplete[C.group](),v.oncomplete[C.group]=null)),C.multiple&&C.multiple.instance){var je=C.multiple.instance.indexOf(J);C.multiple.instance.splice(je,1),C.multiple.instance.length||C.multiple.complete&&typeof C.multiple.complete=="function"&&C.multiple.complete(oe)}}},J.options=C,J.data=V,C.queue===!0&&v.requests.length>0?v.queue.push(J):v.send(J),J};return v.send=function(C){C.data?Array.isArray(C.data)?C.send(C.data.join("&")):C.send(C.data):C.send(),v.requests.push(C)},v.exists=function(C,l){var o=new XMLHttpRequest;o.open("HEAD",C,!1),o.send(),o.status&&l(o.status)},v.pending=function(C){var l=0,o=v.requests;if(o&&o.length)for(var S=0;S<o.length;S++)(!C||C==o[S].options.group)&&l++;return l},v.oncomplete={},v.requests=[],v.queue=[],v}var w=h();function N(){const v={loading:{}};return v.loading.show=function(C){v.loading.element||(v.loading.element=document.createElement("div"),v.loading.element.className="jloading"),document.body.appendChild(v.loading.element),C>0&&setTimeout(function(){v.loading.hide()},C*1e3)},v.loading.hide=function(){v.loading.element&&v.loading.element.parentNode&&document.body.removeChild(v.loading.element)},v.slideLeft=function(C,l,o){l==!0?(C.classList.add("slide-left-in"),setTimeout(function(){C.classList.remove("slide-left-in"),typeof o=="function"&&o()},400)):(C.classList.add("slide-left-out"),setTimeout(function(){C.classList.remove("slide-left-out"),typeof o=="function"&&o()},400))},v.slideRight=function(C,l,o){l===!0?(C.classList.add("slide-right-in"),setTimeout(function(){C.classList.remove("slide-right-in"),typeof o=="function"&&o()},400)):(C.classList.add("slide-right-out"),setTimeout(function(){C.classList.remove("slide-right-out"),typeof o=="function"&&o()},400))},v.slideTop=function(C,l,o){l===!0?(C.classList.add("slide-top-in"),setTimeout(function(){C.classList.remove("slide-top-in"),typeof o=="function"&&o()},400)):(C.classList.add("slide-top-out"),setTimeout(function(){C.classList.remove("slide-top-out"),typeof o=="function"&&o()},400))},v.slideBottom=function(C,l,o){l===!0?(C.classList.add("slide-bottom-in"),setTimeout(function(){C.classList.remove("slide-bottom-in"),typeof o=="function"&&o()},400)):(C.classList.add("slide-bottom-out"),setTimeout(function(){C.classList.remove("slide-bottom-out"),typeof o=="function"&&o()},100))},v.fadeIn=function(C,l){C.style.display="",C.classList.add("fade-in"),setTimeout(function(){C.classList.remove("fade-in"),typeof l=="function"&&l()},2e3)},v.fadeOut=function(C,l){C.classList.add("fade-out"),setTimeout(function(){C.style.display="none",C.classList.remove("fade-out"),typeof l=="function"&&l()},1e3)},v}var T=N();function _(){var v={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","PM","AM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},C=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var A=0;this.date[4]&&(A=parseFloat(this.date[4]/60));var F=parseInt(this.date[3])+A;F/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?F=P.two(this.date[3])+":"+P.two(this.date[4])+":"+P.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),F=P.two(this.date[0])+"-"+P.two(this.date[1])+"-"+P.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(F+=" "+P.two(this.date[3])+":"+P.two(this.date[4])+":"+P.two(this.date[5])));return F},l=function(){var A="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4]))this.mask.toLowerCase().indexOf("[h]")!==-1?A=parseInt(this.date[3]):A=parseInt(this.date[3])%24,this.date[4]&&(A+=parseFloat(this.date[4]/60)),A/=24;else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var F=a.now(this.date);A=a.dateToNum(F),this.date[4]&&(A+=parseFloat(this.date[4]/60))}return isNaN(A)&&(A=""),A},o=function(A){return A===null||A===""||A===void 0},K=function(A){return(""+A).chartAt(0)=="="},S=function(A){return A==="currency"||A==="percentage"||A==="numeric"},q=function(A){if(A&&Number(A)==A)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var F=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=F[1]}else{A||(A=this.mask);var ee=new RegExp("0{1}(.{1})0+","ig"),F=ee.exec(A);if(F&&F[1]&&F[1].length==1)return this.options.decimal=F[1],F[1];var ee=new RegExp("#{1}(.{1})#+","ig"),F=ee.exec(A);F&&F[1]&&F[1].length==1?F[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},G=function(A,F){if(A=="")return"";F||(F=q.call(this)),A=(""+A).split(F);var ee=A[0].match(/[-]+/g);if(ee&&ee.length?ee=!0:ee=!1,A[0]=A[0].match(/[0-9]+/g),A[0]?(ee&&A[0].unshift("-"),A[0]=A[0].join("")):ee&&(A[0]="-"),A[0]||A[1])A[1]!==void 0&&(A[1]=A[1].match(/[0-9]+/g),A[1]?A[1]=A[1].join(""):A[1]="");else return"";return A},z=function(A,F){if(A=="")return"";var ee=q.call(this),pe=this.options;if(A=G.call(this,A),A=="")return"";if(A[0]){var ce=parseFloat(A[0]+".1");pe.style=="percent"&&(ce/=100)}else var ce=null;if((A[0]=="-"||A[0]=="-00")&&!A[1]&&F&&F.inputType=="deleteContentBackward")return"";var Q=new Intl.NumberFormat(this.locale,pe).format(ce);if(Q=Q.split(ee),typeof Q[1]!="undefined"){var ve=Q[1].replace(/[0-9]*/g,"");ve&&(Q[2]=ve)}return A[1]!==void 0?Q[1]=ee+A[1]:Q[1]="",Q.join("")},V=function(A,F){var ee=oe.call(A);if(ee){var pe=q.call(this),ce=z.call(this,ee,F),Q=ce.length-ee.length,ve=J.call(A)+Q;oe.call(A,ce,ve,!0)}},H=function(A){var F=G.call(this,A);return F?(F[0]==="-"&&(F[0]="-0"),parseFloat(F.join("."))):null},J=function(A,F){if(A===void 0)if(this.tagName=="DIV"){var ee=0,pe=window.getSelection();if(pe&&pe.rangeCount!==0){var ce=pe.getRangeAt(0),Q=ce.cloneRange();Q.selectNodeContents(this),Q.setEnd(ce.endContainer,ce.endOffset),ee=Q.toString().length}return ee}else return this.selectionStart;else{var ve=oe.call(this);if(F){for(var Q=null,Me=0;Me<ve.length;Me++)(ve[Me].match(/[\-0-9]/g)||ve[Me]=="."||ve[Me]==",")&&(Q=Me);Q===null&&(Q=ve.indexOf(" ")),A>=Q&&(A=Q+1)}if(A>ve.length&&(A=ve.length),A)if(this.tagName=="DIV"){var pe=window.getSelection(),ce=document.createRange();this.childNodes[0]&&(ce.setStart(this.childNodes[0],A),pe.removeAllRanges(),pe.addRange(ce))}else this.selectionStart=A,this.selectionEnd=A}},oe=function(A,F,ee){if(this.tagName=="DIV")if(A===void 0){var A=this.innerText;return this.value&&this.value.length>A.length&&(A=this.value),A}else this.innerText!==A&&(this.innerText=A,F&&J.call(this,F,ee));else{if(A===void 0)return this.value;this.value!==A&&(this.value=A,F&&J.call(this,F,ee))}},je=a.weekdays,ue=a.weekdaysShort,te=a.months,ge=a.monthsShort,ye={YEAR:function(A,F){var ee=""+new Date().getFullYear();if(typeof this.values[this.index]=="undefined"&&(this.values[this.index]=""),parseInt(A)>=0&&parseInt(A)<=10&&this.values[this.index].length<F&&(this.values[this.index]+=A),this.values[this.index].length==F){if(F==2)var ee=ee.substr(0,2)+this.values[this.index];else if(F==3)var ee=ee.substr(0,1)+this.values[this.index];else if(F==4)var ee=this.values[this.index];this.date[0]=ee,this.index++}},YYYY:function(A){ye.YEAR.call(this,A,4)},YYY:function(A){ye.YEAR.call(this,A,3)},YY:function(A){ye.YEAR.call(this,A,2)},FIND:function(A,F){if(o(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=A;return}for(var ee=0,pe=0,ce=(this.values[this.index]+A).toLowerCase(),Q=0;Q<F.length;Q++)F[Q].toLowerCase().indexOf(ce)==0&&(ee=Q,pe++);if(pe>1)this.values[this.index]+=A;else if(pe==1){var ve=F[ee].length-this.values[this.index].length-1;return this.position+=ve,this.values[this.index]=F[ee],this.index++,ee}},MMM:function(A){var F=ye.FIND.call(this,A,ge);F!==void 0&&(this.date[1]=F+1)},MON:function(A){ye.MMM.call(this,A)},MMMM:function(A){var F=ye.FIND.call(this,A,te);F!==void 0&&(this.date[1]=F+1)},MONTH:function(A){ye.MMMM.call(this,A)},MMMMM:function(A){o(this.values[this.index])&&(this.values[this.index]="");for(var F=0,ee=0,pe=(this.values[this.index]+A).toLowerCase(),ce=0;ce<te.length;ce++)if(te[ce][0].toLowerCase().indexOf(pe)==0){this.values[this.index]=te[ce][0],this.date[1]=ce+1,this.index++;break}},MM:function(A){o(this.values[this.index])?parseInt(A)>1&&parseInt(A)<10?(this.date[1]=this.values[this.index]="0"+A,this.index++):parseInt(A)<2&&(this.values[this.index]=A):this.values[this.index]==1&&parseInt(A)<3?(this.date[1]=this.values[this.index]+=A,this.index++):this.values[this.index]==0&&parseInt(A)>0&&parseInt(A)<10&&(this.date[1]=this.values[this.index]+=A,this.index++)},M:function(A){var F=!1;if(parseInt(A)>=0&&parseInt(A)<10)if(o(this.values[this.index]))this.values[this.index]=A,A>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(A)<3)this.date[1]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==0&&parseInt(A)>0)this.date[1]=this.values[this.index]+=A,this.index++;else var F=!0;else var F=!0;if(F==!0){var ee=parseInt(this.values[this.index]);ee>0&&ee<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(A){var F=!1;if(parseInt(A)>=0&&parseInt(A)<10)if(o(this.values[this.index]))this.values[this.index]=A,parseInt(A)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(A)<2)this.date[2]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==0&&parseInt(A)>0)this.date[2]=this.values[this.index]+=A,this.index++;else var F=!0;else var F=!0;if(F==!0){var ee=parseInt(this.values[this.index]);ee>0&&ee<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(A){o(this.values[this.index])?parseInt(A)>3&&parseInt(A)<10?(this.date[2]=this.values[this.index]="0"+A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==3&&parseInt(A)<2?(this.date[2]=this.values[this.index]+=A,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(A)<10?(this.date[2]=this.values[this.index]+=A,this.index++):this.values[this.index]==0&&parseInt(A)>0&&parseInt(A)<10&&(this.date[2]=this.values[this.index]+=A,this.index++)},DDD:function(A){ye.FIND.call(this,A,ue)},DY:function(A){ye.DDD.call(this,A)},DDDD:function(A){ye.FIND.call(this,A,je)},DAY:function(A){ye.DDDD.call(this,A)},HH12:function(A,F){o(this.values[this.index])?parseInt(A)>1&&parseInt(A)<10?(F&&(A=0+A),this.date[3]=this.values[this.index]=A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==1&&parseInt(A)<3?(this.date[3]=this.values[this.index]+=A,this.index++):this.values[this.index]<1&&parseInt(A)<10&&(this.date[3]=this.values[this.index]+=A,this.index++)},HH24:function(A,F){var ee=!1;parseInt(A)>=0&&parseInt(A)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(A)>2&&parseInt(A)<10?(F&&(A=0+A),this.date[3]=this.values[this.index]=A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==2&&parseInt(A)<4?(this.date[3]=this.values[this.index]+=A,this.index++):this.values[this.index]<2&&parseInt(A)<10&&(this.date[3]=this.values[this.index]+=A,this.index++))},HH:function(A){ye.HH24.call(this,A,1)},H:function(A){ye.HH24.call(this,A,0)},"\\[H\\]":function(A){this.values[this.index]==null&&(this.values[this.index]=""),A.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=A:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(A,F){this.values[this.index]==null||this.values[this.index]==""?parseInt(A)>5&&parseInt(A)<10?(this.date[F]=this.values[this.index]="0"+A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):parseInt(A)<10&&(this.date[F]=this.values[this.index]+=A,this.index++)},MI:function(A){ye.N60.call(this,A,4)},SS:function(A){ye.N60.call(this,A,5)},"AM/PM":function(A){this.values[this.index]="",A&&(this.date[3]>12?this.values[this.index]="PM":this.values[this.index]="AM"),this.index++},WD:function(A){typeof this.values[this.index]=="undefined"&&(this.values[this.index]=""),parseInt(A)>=0&&parseInt(A)<7&&(this.values[this.index]=A),this.value[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(A){var F=q.call(this),ee=!1;o(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(ee=!0);var pe=G.call(this,this.values[this.index],F);pe&&(this.values[this.index]=pe.join(F)),parseInt(A)>=0&&parseInt(A)<10?(this.values[this.index]=="0"&&A>0?this.values[this.index]="":this.values[this.index]=="-0"&&A>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||A==F)&&(this.values[this.index]+=A)):F&&A==F?this.values[this.index].indexOf(F)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=A):A=="-"&&(ee=!0),ee===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(A){ye["0{1}(.{1}0+)?"].call(this,A),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(A){ye["0{1}(.{1}0+)?"].call(this,A);var F=q.call(this),ee=this.tokens[this.index].substr(1,1),pe=this.values[this.index][0]==="-",ce=G.call(this,this.values[this.index],F);if(ce!==""){var Q=ce[0].match(/[0-9]/g);if(Q){Q=Q.join("");for(var ve=[],Me=0,Ne=Q.length-1;Ne>=0;Ne--)ve.push(Q[Ne]),Me++,Me%3||ve.push(ee);ve=ve.reverse(),ce[0]=ve.join(""),ce[0].substr(0,1)==ee&&(ce[0]=ce[0].substr(1))}else ce[0]="";this.values[this.index]=ce.join(F),pe&&(this.values[this.index]="-"+this.values[this.index])}},0:function(A){A.match(/[0-9]/g)&&(this.values[this.index]=A,this.index++)},"[0-9a-zA-Z$]+":function(A){o(this.values[this.index])&&(this.values[this.index]="");var F=this.tokens[this.index],ee=this.values[this.index],pe=ee.length;F[pe]==A?(this.values[this.index]+=A,this.values[this.index]==F&&this.index++):(this.values[this.index]=F,this.index++,A.match(/[\-0-9]/g)&&this.position--)},A:function(A){A.match(/[a-zA-Z]/gi)&&(this.values[this.index]=A,this.index++)},".":function(A){ye["[0-9a-zA-Z$]+"].call(this,A)},"@":function(A){o(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=A}},ke=function(A){if(this.type=="general")var F=[].concat(v.general);else var F=[].concat(v.currency,v.datetime,v.percentage,v.numeric,v.text,v.general);var ee=new RegExp(F.join("|"),"gi");return A.match(ee)},We=function(A){if(this.type)if(this.type=="text")var F=["text"];else if(this.type=="general")var F=["general"];else if(this.type=="datetime")var F=["numeric","datetime","general"];else var F=["currency","percentage","numeric","general"];else var F=Object.keys(v);for(var ee=0;ee<F.length;ee++)for(var pe=F[ee],ce=0;ce<v[pe].length;ce++){var Q=new RegExp(v[pe][ce],"gi"),ve=A.match(Q);if(ve)return{type:pe,method:v[pe][ce]}}},Qe=function(A){for(var F=[],ee=0;ee<A.length;ee++){var pe=We.call(this,A[ee]);pe?F.push(pe.method):F.push(null)}for(var ee=0;ee<F.length;ee++)F[ee]=="MM"&&(F[ee-1]&&F[ee-1].indexOf("H")>=0||F[ee-2]&&F[ee-2].indexOf("H")>=0||F[ee+1]&&F[ee+1].indexOf("S")>=0||F[ee+2]&&F[ee+2].indexOf("S")>=0)&&(F[ee]="MI");return F},fe=function(A){var F=We.call(this,A);if(F)var ee=F.type;if(ee){for(var pe=0,ce=ke.call(this,A),Q=0;Q<ce.length;Q++)F=We.call(this,ce[Q]),F&&S(F.type)&&pe++;pe>1&&(ee="general")}return ee},Ee=function(){typeof ye[this.methods[this.index]]=="function"?(ye[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},K=function(A){var F=(""+A)[0];return F=="="},X=function(A){return(""+ +A).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(F,ee,pe,ce,Q){return Q<0?ee+"0."+Array(1-Q-pe.length).join(0)+pe+ce:ee+pe+ce+Array(Q-ce.length+1).join(0)})},re=function(A,F,ee){var pe=null,ce=null,Q={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof A=="object"){if(Q.input=A.target,Q.value=oe.call(A.target),Q.caret=J.call(A.target),(ce=A.target.getAttribute("data-mask"))&&(Q.mask=ce),(ce=A.target.getAttribute("data-type"))&&(Q.type=ce),A.target.mask?(A.target.mask.options&&(Q.options=A.target.mask.options),A.target.mask.locale&&(Q.locale=A.target.mask.locale)):(ce=A.target.getAttribute("data-locale"))&&(Q.locale=ce,Q.mask&&(Q.options.style=Q.mask)),A.target.attributes&&A.target.attributes.length)for(var ve=0;ve<A.target.attributes.length;ve++){var Me=A.target.attributes[ve].name,Ne=A.target.attributes[ve].value;Me.substr(0,4)=="data"&&(Q.options[Me.substr(5)]=Ne)}}else{if(typeof F=="string")Q.mask=F;else for(var Me=Object.keys(F),ve=0;ve<Me.length;ve++)Q[Me[ve]]=F[Me[ve]];typeof A=="number"&&(q.call(Q,Q.mask),A=(""+A).replace(".",Q.options.decimal)),Q.value=A,Q.input&&(oe.call(Q.input,A),P.focus(Q.input),Q.caret=J.call(Q.input))}if(!K(Q.value)&&(Q.mask||Q.locale)){if(Q.mask){if(Q.mask=Q.mask.replace(new RegExp(/\[h]/),"|h|"),Q.mask=Q.mask.replace(new RegExp(/\[.*?\]/),""),Q.mask=Q.mask.replace(new RegExp(/\|h\|/),"[h]"),Q.mask.indexOf(";")!==-1){var ce=Q.mask.split(";");Q.mask=ce[0]}if(Q.mask.indexOf("##")!==-1){var Ie=Q.mask.split(";");Ie[0]&&(Ie[0]=Ie[0].replace("*","	"),Ie[0]=Ie[0].replace(new RegExp(/_-/g)," "),Ie[0]=Ie[0].replace(new RegExp(/_/g),""),Ie[0]=Ie[0].replace("##0.###","##0.000"),Ie[0]=Ie[0].replace("##0.##","##0.00"),Ie[0]=Ie[0].replace("##0.#","##0.0"),Ie[0]=Ie[0].replace("##0,###","##0,000"),Ie[0]=Ie[0].replace("##0,##","##0,00"),Ie[0]=Ie[0].replace("##0,#","##0,0")),Q.mask=Ie[0]}Q.type||(Q.type=fe.call(Q,Q.mask)),Q.tokens=ke.call(Q,Q.mask)}if(typeof A!="object"||!A.inputType||!A.inputType.indexOf("insert")||!A.inputType.indexOf("delete"))if(Q.locale)if(Q.input)V.call(Q,Q.input,A);else var Be=z.call(Q,Q.value);else{for(Q.methods=Qe.call(Q,Q.tokens),Q.event=A;Q.position<Q.value.length&&typeof Q.tokens[Q.index]!="undefined";)Ee.call(Q);var Be=Q.values.join("");if(S(Q.type)&&Be!==""){for(;typeof Q.tokens[Q.index]!="undefined";){var ce=We.call(Q,Q.tokens[Q.index]);ce&&ce.type=="general"&&(Q.values[Q.index]=Q.tokens[Q.index]),Q.index++}var $e=!0}else var $e=!1;if(Be=Q.values.join(""),Q.input){if(ce=Be.length-Q.value.length,ce>0)var nt=Q.caret+ce;else var nt=Q.caret;oe.call(Q.input,Be,nt,$e)}}if(Q.input){var ne=null;if(S(Q.type)){let me=oe.call(Q.input);Q.number=H.call(Q,me),Q.type=="percentage"&&me.indexOf("%")!==-1?ne=Q.number/100:ne=Q.number}else Q.type=="datetime"&&(ne=C.call(Q),Q.date[0]&&Q.date[1]&&Q.date[2]&&Q.input.setAttribute("data-completed",!0));ne&&Q.input.setAttribute("data-value",ne)}if(Be!==void 0)return ee?Q:Be}};return re.getType=fe,re.prepare=function(A,F){return F||(F={}),ke.call(F,A)},re.apply=function(A){var F=oe.call(A.target);A.key.length==1&&(F+=A.key),oe.call(A.target,re(F,A.target.getAttribute("data-mask")))},re.run=function(A,F,ee){return re(A,{mask:F,decimal:ee})},re.extract=function(A,F,ee){if(o(A)||typeof F!="object")return A;if(F=Object.assign({},F),F.options||(F.options={}),!F.mask&&F.format&&(F.mask=F.format),F.mask){if(F.mask.indexOf(";")!==-1){var pe=F.mask.split(";");F.mask=pe[0]}F.mask=F.mask.replace(new RegExp(/\[h]/),"|h|"),F.mask=F.mask.replace(new RegExp(/\[.*?\]/),""),F.mask=F.mask.replace(new RegExp(/\|h\|/),"[h]")}q.call(F,F.mask);var ce=null,Q=null;if(F.type=="percent"||F.options.style=="percent"?ce="percentage":F.mask&&(ce=fe.call(F,F.mask)),ce==="general"){var ve=re(A,F,!0);Q=A}else if(ce==="datetime"){A instanceof Date&&(A=re.getDateString(A,F.mask));var ve=re(A,F,!0);P.isNumeric(A)?Q=A:Q=l.call(ve)}else{Q=H.call(F,A),ce==="percentage"&&A.indexOf("%")!==-1&&(Q/=100);var ve=F}return ve.value=Q,!ve.type&&ce&&(ve.type=ce),ee?ve:Q},re.render=function(A,F,ee){if(o(A)||typeof F!="object")return A;if(F=Object.assign({},F),F.options||(F.options={}),!F.mask&&F.format&&(F.mask=F.format),F.mask){if(F.mask.indexOf(";")!==-1){var pe=F.mask.split(";");F.mask=pe[0]}F.mask=F.mask.replace(new RegExp(/\[h]/),"|h|"),F.mask=F.mask.replace(new RegExp(/\[.*?\]/),""),F.mask=F.mask.replace(new RegExp(/\|h\|/),"[h]")}var ce=null;F.type=="percent"||F.options.style=="percent"?ce="percentage":F.mask?ce=fe.call(F,F.mask):A instanceof Date&&(ce="datetime");var Q=!1;if(ce=="datetime"||F.type=="calendar"){var pe=re.getDateString(A,F.mask);pe&&(A=pe),F.mask&&ee&&(Q=!0)}else if(ce=="percentage"&&(A*=100),typeof A=="number"){var pe=null;if(F.mask&&ee&&(""+A).indexOf("e")===-1){var ve=q.call(F,F.mask);F.mask.indexOf(ve)!==-1?(ve=F.mask.split(ve),ve=""+ve[1].match(/[0-9]+/g),ve=ve.length,pe=A.toFixed(ve)):pe=A.toFixed(0)}else if(F.locale&&ee){var ve=(""+A).split(".");if(F.options){typeof ve[1]=="undefined"&&(ve[1]="");var Ne=ve[1].length;if(F.options.minimumFractionDigits>Ne)for(var Me=0;Me<F.options.minimumFractionDigits-Ne;Me++)ve[1]+="0"}ve[1].length?pe=ve.join("."):pe=ve[0];var Ne=ve[1].length;F.options&&F.options.maximumFractionDigits<Ne&&(pe=parseFloat(pe).toFixed(F.options.maximumFractionDigits))}else pe=X(A);pe!==null&&(A=pe,q.call(F,F.mask),F.options.decimal&&(A=A.replace(".",F.options.decimal)))}else F.mask&&ee&&(Q=!0);if(Q){var Ie=F.mask.length-A.length;if(Ie>0)for(var Me=0;Me<Ie;Me++)A+=" "}if(A=re(A,F),ee&&ce==="numeric"){var Be=F.mask.match(new RegExp(/^[0]+$/gm));if(Be&&Be.length===1){var $e=Be[0].length;if($e>3)for(A=""+A;A.length<$e;)A="0"+A}}return A},re.set=function(A,F){if(F){A.setAttribute("data-mask",F);var ee=new Event("input",{bubbles:!0,cancelable:!0});A.dispatchEvent(ee)}},re.extractDateFromString=function(A,F){var ee=re(A,{mask:F},!0);if(A>0&&Number(A)==A&&(ee.values.join("")!==ee.value||ee.type=="numeric")){var pe=new Date(Math.round((A-25569)*86400*1e3));return pe.getFullYear()+"-"+P.two(pe.getMonth())+"-"+P.two(pe.getDate())+" 00:00:00"}var ce=!1;return ee.values.length===ee.tokens.length&&ee.values[ee.values.length-1].length>=ee.tokens[ee.tokens.length-1].length&&(ce=!0),ee.date[0]&&ee.date[1]&&(ee.date[2]||ce)?(ee.date[2]||(ee.date[2]=1),ee.date[0]+"-"+P.two(ee.date[1])+"-"+P.two(ee.date[2])+" "+P.two(ee.date[3])+":"+P.two(ee.date[4])+":"+P.two(ee.date[5])):""},re.getDateString=function(A,F){if(!F)var F={};if(F&&typeof F=="object")var ee=F.format;else var ee=F;if(ee||(ee="YYYY-MM-DD"),ee.indexOf("[h]")>=0){var pe=0;if(A&&P.isNumeric(A)&&(pe=parseFloat(24*Number(A)),ee.indexOf("mm")>=0)){var ce=(""+pe).split(".");if(ce[1]){var Q=60*parseFloat("0."+ce[1]);Q=parseFloat(Q.toFixed(2))}else var Q=0;pe=parseInt(ce[0])+":"+P.two(Q)}return pe}A instanceof Date?A=a.now(A):A&&P.isNumeric(A)&&(A=a.numToDate(A));for(var ve=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Me=new RegExp(ve.join("|"),"gi"),Ne=ee.match(Me),Ie=0;Ie<Ne.length;Ie++)Ne[Ie].toUpperCase()=="MM"&&(Ne[Ie-1]&&Ne[Ie-1].toUpperCase().indexOf("H")>=0||Ne[Ie-2]&&Ne[Ie-2].toUpperCase().indexOf("H")>=0||Ne[Ie+1]&&Ne[Ie+1].toUpperCase().indexOf("S")>=0||Ne[Ie+2]&&Ne[Ie+2].toUpperCase().indexOf("S")>=0)&&(Ne[Ie]="mi");var Be={tokens:Ne};if(A){var Q=""+A,$e=Q.indexOf("T")!==-1?"T":" ";Q=Q.split($e);var ce=0,nt=0,ne=0;if(Q[1]&&(ce=Q[1].split(":"),nt=ce[1]?ce[1]:0,ne=ce[2]?ce[2]:0,ce=ce[0]?ce[0]:0),Q=Q[0].split("-"),Q[0]&&Q[1]&&Q[2]&&Q[0]>0&&Q[1]>0&&Q[1]<13&&Q[2]>0&&Q[2]<32){Be.data=[Q[0],Q[1],Q[2],ce,nt,ne],Be.value=[];for(var me=new Date(Be.data[0],Be.data[1]-1,Be.data[2],Be.data[3],Be.data[4],Be.data[5]),Ce=function(Xe){var Ze=this.tokens[Xe],et=Ze.toUpperCase(),Ue=null;et==="YYYY"?Ue=this.data[0]:et==="YYY"?Ue=this.data[0].substring(1,4):et==="YY"?Ue=this.data[0].substring(2,4):et==="Y"?Ue=this.data[0].substring(3,4):Ze==="MON"?Ue=a.months[me.getMonth()].substr(0,3).toUpperCase():Ze==="mon"?Ue=a.months[me.getMonth()].substr(0,3).toLowerCase():Ze==="MONTH"?Ue=a.months[me.getMonth()].toUpperCase():Ze==="month"?Ue=a.months[me.getMonth()].toLowerCase():et==="MMMMM"?Ue=a.months[me.getMonth()].substr(0,1):et==="MMMM"||Ze==="Month"?Ue=a.months[me.getMonth()]:et==="MMM"||Ze=="Mon"?Ue=a.months[me.getMonth()].substr(0,3):et==="MM"?Ue=P.two(this.data[1]):et==="M"?Ue=me.getMonth()+1:Ze==="DAY"?Ue=a.weekdays[me.getDay()].toUpperCase():Ze==="day"?Ue=a.weekdays[me.getDay()].toLowerCase():et==="DDDD"||Ze=="Day"?Ue=a.weekdays[me.getDay()]:et==="DDD"?Ue=a.weekdays[me.getDay()].substr(0,3):et==="DD"?Ue=P.two(this.data[2]):et==="D"?Ue=parseInt(this.data[2]):et==="Q"?Ue=Math.floor((me.getMonth()+3)/3):et==="HH24"||et==="HH"?Ue=P.two(this.data[3]):et==="HH12"?this.data[3]>12?Ue=P.two(this.data[3]-12):Ue=P.two(this.data[3]):et==="H"?Ue=this.data[3]:et==="MI"?Ue=P.two(this.data[4]):et==="SS"?Ue=P.two(this.data[5]):et==="MS"?Ue=me.getMilliseconds():et==="AM/PM"?this.data[3]>=12?Ue="PM":Ue="AM":et==="WD"&&(Ue=a.weekdays[me.getDay()]),Ue===null?this.value[Xe]=this.tokens[Xe]:this.value[Xe]=Ue},Ie=0;Ie<Be.tokens.length;Ie++)Ce.call(Be,Ie);A=Be.value.join("")}else A=""}return A},typeof document!="undefined"&&document.addEventListener("input",function(A){(A.target.getAttribute("data-mask")||A.target.mask)&&re(A)}),re}var k=_();function M(){var v=function(C,l){if(C.calendar)return C.calendar.setOptions(l,!0);var o={type:"calendar"};o.options={},o.date=null,o.setOptions=function(X,re){var A={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:a.monthsShort,monthsFull:a.months,weekdays:a.weekdays,textDone:B.translate("Done"),textReset:B.translate("Reset"),textUpdate:B.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var F in A)X&&X.hasOwnProperty(F)?o.options[F]=X[F]:(typeof o.options[F]=="undefined"||re===!0)&&(o.options[F]=A[F]);if(o.options.resetButton==!1?V.style.display="none":V.style.display="",o.options.readonly?C.setAttribute("readonly","readonly"):C.removeAttribute("readonly"),o.options.placeholder?C.setAttribute("placeholder",o.options.placeholder):C.removeAttribute("placeholder"),P.isNumeric(o.options.value)&&o.options.value>0&&(o.options.value=v.numToDate(o.options.value),o.options.dataType="numeric"),V.innerHTML=o.options.textReset,H.innerHTML=o.options.textDone,Qe.innerHTML=o.options.textUpdate,C.setAttribute("data-mask",o.options.format.toLowerCase()),!o.options.value&&o.options.today)var ee=v.now();else var ee=o.options.value;return ee&&(o.options.value=null,o.setValue(ee)),o},o.open=function(X){if(!z.classList.contains("jcalendar-focus")&&!z.classList.contains("jcalendar-inline")){if(v.current=o,g(o,!0),o.getDays(),o.options.type=="year-month-picker"&&o.getMonths(),o.options.time&&(fe.value=o.date[3],Ee.value=o.date[4]),z.classList.add("jcalendar-focus"),P.getWindowWidth()<800||o.options.fullscreen)z.classList.add("jcalendar-fullsize"),T.slideBottom(oe,1);else{z.classList.remove("jcalendar-fullsize");var re=C.getBoundingClientRect(),A=oe.getBoundingClientRect();if(o.options.position)J.style.position="fixed",window.innerHeight<re.bottom+A.height?J.style.top=re.top-(A.height+2)+"px":J.style.top=re.top+re.height+2+"px",J.style.left=re.left+"px";else{if(window.innerHeight<re.bottom+A.height){var F=-1*(re.height+A.height+2);F+re.top<0&&(F=-1*(re.top+re.height)),J.style.top=F+"px"}else J.style.top="2px";if(window.innerWidth<re.left+A.width){var F=window.innerWidth-(re.left+A.width+20);J.style.left=F+"px"}else J.style.left="0px"}}typeof o.options.onopen=="function"&&o.options.onopen(C)}},o.close=function(X,re){if(o.options.autoSelect!==!0&&typeof re=="undefined"&&(re=!1),z.classList.contains("jcalendar-focus")){if(re!==!1){var A=z.querySelector(".jcalendar-selected");if(typeof re=="string")var F=re;else if(!A||A.classList.contains("jcalendar-disabled"))var F=o.options.value;else var F=o.getValue();o.setValue(F)}else if(o.options.value){let ee=o.options.value;o.options.value="",o.setValue(ee)}!X&&typeof o.options.onclose=="function"&&o.options.onclose(C),z.classList.remove("jcalendar-focus"),g(o,!1),v.current=null}return o.options.value},o.prev=function(){o.options.mode=="years"?(o.date[0]=o.date[0]-12,o.getYears()):o.options.mode=="months"?(o.date[0]=parseInt(o.date[0])-1,o.getMonths()):(o.date[1]<2?(o.date[0]=o.date[0]-1,o.date[1]=12):o.date[1]=o.date[1]-1,o.getDays())},o.next=function(){o.options.mode=="years"?(o.date[0]=parseInt(o.date[0])+12,o.getYears()):o.options.mode=="months"?(o.date[0]=parseInt(o.date[0])+1,o.getMonths()):(o.date[1]>11?(o.date[0]=parseInt(o.date[0])+1,o.date[1]=1):o.date[1]=parseInt(o.date[1])+1,o.getDays())},o.setToday=function(){var X=new Date().toISOString().substr(0,10);return o.setValue(X),X},o.setValue=function(X){X||(X=""+X);var re=X,A=o.options.value;if(A!=re){if(re){var F=o.setLabel(re,o.options),pe=re.split(" ");pe[1]||(pe[1]="00:00:00");var ee=pe[1].split(":"),pe=pe[0].split("-"),ce=parseInt(pe[0]),Q=parseInt(pe[1]),ve=parseInt(pe[2]),Me=parseInt(ee[0]),Ne=parseInt(ee[1]);o.date=[ce,Q,ve,Me,Ne,0];var X=o.setLabel(re,o.options),Ie=v.now(new Date(ce,Q-1,ve),!0);if(o.options.validRange){if(!o.options.validRange[0]||Ie>=o.options.validRange[0])var Be=!0;else var Be=!1;if(!o.options.validRange[1]||Ie<=o.options.validRange[1])var $e=!0;else var $e=!1;Be&&$e?(C.classList.remove("jcalendar_warning"),C.title=""):(C.classList.add("jcalendar_warning"),C.title=B.translate("Date outside the valid range"))}else C.classList.remove("jcalendar_warning"),C.title=""}else{o.date=null;var X="";C.classList.remove("jcalendar_warning"),C.title=""}o.options.value=re,typeof o.options.onchange=="function"&&o.options.onchange(C,re,A),C.value!=X&&(C.value=X,typeof C.oninput=="function"&&C.oninput({type:"input",target:C,value:C.value}))}o.getDays(),o.options.type=="year-month-picker"&&o.getMonths()},o.getValue=function(){return o.date?o.options.time?P.two(o.date[0])+"-"+P.two(o.date[1])+"-"+P.two(o.date[2])+" "+P.two(o.date[3])+":"+P.two(o.date[4])+":"+P.two(0):P.two(o.date[0])+"-"+P.two(o.date[1])+"-"+P.two(o.date[2])+" "+P.two(0)+":"+P.two(0)+":"+P.two(0):""},o.update=function(X,re){if(!X.classList.contains("jcalendar-disabled")){var A=z.querySelector(".jcalendar-selected");A&&A.classList.remove("jcalendar-selected"),X.classList.add("jcalendar-selected"),X.classList.contains("jcalendar-set-month")?(o.date[1]=re,o.date[2]=1):o.date[2]=X.innerText,o.options.time?(o.date[3]=fe.value,o.date[4]=Ee.value):o.close(null,!0)}G()},o.reset=function(){o.setValue(""),o.date=null,o.close(!1,!1)},o.getDays=function(){o.options.mode="days";var ve=new Date,X=o.date&&P.isNumeric(o.date[0])?o.date[0]:parseInt(ve.getFullYear()),re=o.date&&P.isNumeric(o.date[1])?o.date[1]:parseInt(ve.getMonth())+1,A=o.date&&P.isNumeric(o.date[2])?o.date[2]:parseInt(ve.getDate()),F=o.date&&P.isNumeric(o.date[3])?o.date[3]:parseInt(ve.getHours()),ee=o.date&&P.isNumeric(o.date[4])?o.date[4]:parseInt(ve.getMinutes());o.date=[X,re,A,F,ee,0],je.innerHTML=X,ue.innerHTML=o.options.months[re-1];var pe=ve.getMonth()==re-1&&ve.getFullYear()==X,ce=ve.getDate(),ve=new Date(X,re,0,0,0),Q=ve.getDate(),ve=new Date(X,re-1,0,0,0),Me=ve.getDay()+1,$e=o.options.startingDay||0;Me=Me-$e,ge.innerHTML="";var Ne=document.createElement("tr");Ne.setAttribute("align","center"),ge.appendChild(Ne);for(var Ie=0;Ie<7;Ie++){var Be=document.createElement("td");Be.classList.add("jcalendar-weekday"),Be.innerHTML=o.options.weekdays[$e].substr(0,1),Ne.appendChild(Be),$e++,$e>6&&($e=0)}for(var $e=0,nt=0,ne=0;ne<6;ne++){var Ne=document.createElement("tr");Ne.setAttribute("align","center"),Ne.style.height="34px";for(var Ie=0;Ie<7;Ie++){var Be=document.createElement("td");if(Be.classList.add("jcalendar-set-day"),$e>=Me&&$e<Me+Q){nt++,Be.innerHTML=nt,nt==A&&Be.classList.add("jcalendar-selected"),pe&&ce==nt&&(Be.style.fontWeight="bold");var me=v.now(new Date(X,re-1,nt),!0);if(o.options.validRange){if(!o.options.validRange[0]||me>=o.options.validRange[0])var Ce=!0;else var Ce=!1;if(!o.options.validRange[1]||me<=o.options.validRange[1])var Oe=!0;else var Oe=!1;Ce&&Oe||Be.classList.add("jcalendar-disabled")}}Ne.appendChild(Be),$e++}ge.appendChild(Ne)}o.options.time?ke.style.display="":ke.style.display="none",G()},o.getMonths=function(){o.options.mode="months";var X=o.options.months,re=o.options.value,A=new Date,F=parseInt(A.getFullYear()),ee=parseInt(A.getMonth())+1,pe=o.date&&P.isNumeric(o.date[0])?o.date[0]:F,ce=o.date&&P.isNumeric(o.date[1])?o.date[1]:ee;je.innerHTML=o.date[0],ue.innerHTML=X[ce-1];var Q=document.createElement("table");Q.setAttribute("width","100%");for(var ve=null,Me=0;Me<12;Me++){if(!(Me%4)){var ve=document.createElement("tr");ve.setAttribute("align","center"),Q.appendChild(ve)}var Ne=document.createElement("td");if(Ne.classList.add("jcalendar-set-month"),Ne.setAttribute("data-value",Me+1),Ne.innerText=X[Me],o.options.validRange){var Ie=pe+"-"+P.two(Me+1);if(!o.options.validRange[0]||Ie>=o.options.validRange[0].substr(0,7))var Be=!0;else var Be=!1;if(!o.options.validRange[1]||Ie<=o.options.validRange[1].substr(0,7))var $e=!0;else var $e=!1;Be&&$e||Ne.classList.add("jcalendar-disabled")}Me+1==ce&&Ne.classList.add("jcalendar-selected"),F==pe&&Me+1==ee&&(Ne.style.fontWeight="bold"),ve.appendChild(Ne)}ge.innerHTML='<tr><td colspan="7"></td></tr>',ge.children[0].children[0].appendChild(Q),G()},o.getYears=function(){o.options.mode="years";for(var X=new Date,re=X.getFullYear(),A=o.date&&P.isNumeric(o.date[0])?o.date[0]:parseInt(X.getFullYear()),F=[],ee=0;ee<25;ee++)F[ee]=parseInt(o.date[0])+(ee-12);var pe=document.createElement("table");pe.setAttribute("width","100%");for(var ee=0;ee<25;ee++){if(!(ee%5)){var ce=document.createElement("tr");ce.setAttribute("align","center"),pe.appendChild(ce)}var Q=document.createElement("td");Q.classList.add("jcalendar-set-year"),Q.innerText=F[ee],A==F[ee]&&Q.classList.add("jcalendar-selected"),re==F[ee]&&(Q.style.fontWeight="bold"),ce.appendChild(Q)}ge.innerHTML='<tr><td colspan="7"></td></tr>',ge.firstChild.firstChild.appendChild(pe),G()},o.setLabel=function(X,re){return v.getDateString(X,re)},o.fromFormatted=function(X,re){return v.extractDateFromString(X,re)};var S=function(X){var re=P.findElement(X.target,"jcalendar-container");if(re){var A=X.target.className;if(A=="jcalendar-prev")o.prev();else if(A=="jcalendar-next")o.next();else if(A=="jcalendar-month")o.getMonths();else if(A=="jcalendar-year")o.getYears();else if(A=="jcalendar-set-year")o.date[0]=X.target.innerText,o.options.type=="year-month-picker"?o.getMonths():o.getDays();else if(X.target.classList.contains("jcalendar-set-month")){var F=parseInt(X.target.getAttribute("data-value"));o.options.type=="year-month-picker"?o.update(X.target,F):(o.date[1]=F,o.getDays())}else A=="jcalendar-confirm"||A=="jcalendar-update"||A=="jcalendar-close"?o.close(null,!0):A=="jcalendar-backdrop"?o.close(!1,!1):A=="jcalendar-reset"?o.reset():X.target.classList.contains("jcalendar-set-day")&&X.target.innerText&&o.update(X.target)}else o.close(!1,!1)},q=function(X){if(X.target.value&&X.target.value.length>3){var re=v.extractDateFromString(X.target.value,o.options.format);re&&o.setValue(re)}},G=function(){var X=z.querySelector(".jcalendar-selected");X&&X.classList.contains("jcalendar-disabled")?(Qe.setAttribute("disabled","disabled"),fe.setAttribute("disabled","disabled"),Ee.setAttribute("disabled","disabled")):(Qe.removeAttribute("disabled"),fe.removeAttribute("disabled"),Ee.removeAttribute("disabled")),typeof o.options.onupdate=="function"&&o.options.onupdate(C,o.getValue())},z=null,V=null,H=null,J=null,oe=null,je=null,ue=null,te=null,ge=null,ye=null,ke=null,We=null,Qe=null,fe=null,Ee=null,K=function(){C.tagName=="INPUT"&&C.value&&(l.value=C.value),V=document.createElement("div"),V.className="jcalendar-reset",H=document.createElement("div"),H.className="jcalendar-confirm",ye=document.createElement("div"),ye.className="jcalendar-controls",ye.style.borderBottom="1px solid #ddd",ye.appendChild(V),ye.appendChild(H),J=document.createElement("div"),J.className="jcalendar-container",oe=document.createElement("div"),oe.className="jcalendar-content",J.appendChild(oe),C.tagName=="DIV"?(z=C,z.classList.add("jcalendar-inline")):(oe.appendChild(ye),z=document.createElement("div"),z.className="jcalendar"),z.classList.add("jcalendar-container"),z.appendChild(J);var X=document.createElement("div");X.className="jcalendar-table",oe.appendChild(X);var re=document.createElement("td");re.setAttribute("colspan","2"),re.className="jcalendar-prev",je=document.createElement("span"),je.className="jcalendar-year",ue=document.createElement("span"),ue.className="jcalendar-month";var A=document.createElement("td");A.className="jcalendar-header",A.setAttribute("colspan","3"),A.appendChild(ue),A.appendChild(je);var F=document.createElement("td");F.setAttribute("colspan","2"),F.className="jcalendar-next";var ee=document.createElement("thead"),pe=document.createElement("tr");pe.appendChild(re),pe.appendChild(A),pe.appendChild(F),ee.appendChild(pe),te=document.createElement("table"),ge=document.createElement("tbody"),te.setAttribute("cellpadding","0"),te.setAttribute("cellspacing","0"),te.appendChild(ee),te.appendChild(ge),X.appendChild(te),fe=document.createElement("select"),fe.className="jcalendar-select",fe.onchange=function(){o.date[3]=this.value,typeof o.options.onupdate=="function"&&o.options.onupdate(C,o.getValue())};for(var ce=0;ce<24;ce++){var Q=document.createElement("option");Q.value=ce,Q.innerHTML=P.two(ce),fe.appendChild(Q)}Ee=document.createElement("select"),Ee.className="jcalendar-select",Ee.onchange=function(){o.date[4]=this.value,typeof o.options.onupdate=="function"&&o.options.onupdate(C,o.getValue())};for(var ce=0;ce<60;ce++){var Q=document.createElement("option");Q.value=ce,Q.innerHTML=P.two(ce),Ee.appendChild(Q)}var ve=document.createElement("div");ve.className="jcalendar-controls",ke=document.createElement("div"),ke.className="jcalendar-time",ke.style.maxWidth="140px",ke.appendChild(fe),ke.appendChild(Ee),Qe=document.createElement("button"),Qe.setAttribute("type","button"),Qe.className="jcalendar-update",We=document.createElement("div"),We.style.flexGrow="10",We.appendChild(Qe),ve.appendChild(ke),C.tagName=="INPUT"&&ve.appendChild(We),oe.appendChild(ve);var Me=document.createElement("div");Me.className="jcalendar-backdrop",z.appendChild(Me),C.addEventListener("keyup",q),z.addEventListener("swipeleft",function(Ne){T.slideLeft(te,0,function(){o.next(),T.slideRight(te,1)}),Ne.preventDefault(),Ne.stopPropagation()}),z.addEventListener("swiperight",function(Ne){T.slideRight(te,0,function(){o.prev(),T.slideLeft(te,1)}),Ne.preventDefault(),Ne.stopPropagation()}),"ontouchend"in document.documentElement?(z.addEventListener("touchend",S),C.addEventListener("touchend",o.open)):(z.addEventListener("mouseup",S),C.addEventListener("mouseup",o.open)),v.hasEvents||(v.hasEvents=!0,document.addEventListener("keydown",v.keydown)),o.setOptions(l),C.tagName=="INPUT"?(C.parentNode.insertBefore(z,C.nextSibling),C.setAttribute("autocomplete","off"),C.classList.add("jcalendar-input"),C.value=o.setLabel(o.getValue(),o.options)):(o.getDays(),o.options.time&&(fe.value=o.date[3],Ee.value=o.date[4])),o.options.opened==!0&&o.open(),o.options.controls==!1&&J.classList.add("jcalendar-hide-controls"),C.change=o.setValue,C.val=function(Ne){if(Ne===void 0)return o.getValue();o.setValue(Ne)},C.calendar=z.calendar=o};return K(),o};return v.keydown=function(C){var l=null;(l=v.current)&&(C.which==13?l.close(!1,!0):C.which==27&&l.close(!1,!1))},v.prettify=function(C,l){if(!l)var l={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};C.indexOf("GMT")===-1&&(C+=" GMT");var o=new Date,S=new Date(C),q=parseInt((o-S)/1e3/60);if(String.prototype.format=function(z){return this.replace("{0}",z)},q==0)var G=l.justNow;else if(q<90)var G=l.xMinutesAgo.format(q);else if(q<1440)var G=l.xHoursAgo.format(Math.round(q/60));else if(q<20160)var G=l.xDaysAgo.format(Math.round(q/1440));else if(q<43200)var G=l.xWeeksAgo.format(Math.round(q/10080));else if(q<1036800)var G=l.xMonthsAgo.format(Math.round(q/43200));else var G=l.xYearsAgo.format(Math.round(q/525600));return G},v.prettifyAll=function(){for(var C=document.querySelectorAll(".prettydate"),l=0;l<C.length;l++)C[l].getAttribute("data-date")?C[l].innerHTML=v.prettify(C[l].getAttribute("data-date")):C[l].innerHTML&&(C[l].setAttribute("title",C[l].innerHTML),C[l].setAttribute("data-date",C[l].innerHTML),C[l].innerHTML=v.prettify(C[l].innerHTML))},v.now=a.now,v.toArray=a.toArray,v.dateToNum=a.dateToNum,v.numToDate=a.numToDate,v.weekdays=a.weekdays,v.months=a.months,v.weekdaysShort=a.weekdaysShort,v.monthsShort=a.monthsShort,v.extractDateFromString=k.extractDateFromString,v.getDateString=k.getDateString,v}var D=M();function Z(){var v={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},C=function(l){return v[l]?v[l]:v.material};return C.get=function(l){return v[l]?v[l]:v},C.set=function(l,o){v[l]=o},C}var Y=Z();function se(v,C){var l={};l.options={};var o={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var S in o)C&&C.hasOwnProperty(S)?l.options[S]=C[S]:l.options[S]=o[S];v.classList.add("jtabs");var q=null,G=null,z=null,V=function(ue){if(l.options.animation){var te=l.headers.children[ue].getBoundingClientRect();l.options.palette==="modern"?(z.style.width=te.width-4+"px",z.style.left=l.headers.children[ue].offsetLeft+2+"px"):(z.style.width=te.width+"px",z.style.left=l.headers.children[ue].offsetLeft+"px"),l.options.position==="bottom"?z.style.top="0px":z.style.bottom="0px"}},H=function(ue){typeof l.headers.scrollTo=="function"?l.headers.scrollTo({left:ue,behavior:"smooth"}):l.headers.scrollLeft=ue,ue<=1?q.classList.add("disabled"):q.classList.remove("disabled"),ue>=l.headers.scrollWidth-l.headers.offsetWidth?G.classList.add("disabled"):G.classList.remove("disabled"),l.headers.scrollWidth<=l.headers.offsetWidth?(q.style.display="none",G.style.display="none"):(q.style.display="",G.style.display="")};if(l.setBorder=V,l.open=function(ue){for(var te=null,ge=0;ge<l.headers.children.length;ge++)l.headers.children[ge].classList.contains("jtabs-selected")&&(te=ge),l.headers.children[ge].classList.remove("jtabs-selected"),l.content.children[ge]&&l.content.children[ge].classList.remove("jtabs-selected");if(l.headers.children[ue].classList.add("jtabs-selected"),l.content.children[ue]&&l.content.children[ue].classList.add("jtabs-selected"),te!=ue&&typeof l.options.onchange=="function"&&l.content.children[ue]&&l.options.onchange(v,l,ue,l.headers.children[ue],l.content.children[ue]),l.options.hideHeaders==!0&&l.headers.children.length<3&&l.options.allowCreate==!1)l.headers.parentNode.style.display="none";else{V(ue),l.headers.parentNode.style.display="";var ye=l.headers.children[ue].offsetLeft,ke=ye+l.headers.children[ue].offsetWidth,We=l.headers.scrollLeft,Qe=We+l.headers.offsetWidth;We<=ye&&Qe>=ke||H(ye-1)}},l.selectIndex=function(ue){var te=Array.prototype.indexOf.call(l.headers.children,ue);return te>=0&&l.open(te),te},l.rename=function(ue,te){te||(te=prompt("New title",l.headers.children[ue].innerText)),l.headers.children[ue].innerText=te,l.open(ue)},l.create=function(ue,te){if(typeof l.options.onbeforecreate=="function"){var ge=l.options.onbeforecreate(v);if(ge===!1)return!1;ue=ge}var ye=l.appendElement(ue);return typeof l.options.oncreate=="function"&&l.options.oncreate(v,ye),V(),ye},l.remove=function(ue){return l.deleteElement(ue)},l.nextNumber=function(){for(var ue=0,te=0;te<l.headers.children.length;te++){var ge=l.headers.children[te].innerText.match(/[0-9].*/);ge>ue&&(ue=parseInt(ge))}return ue?ue++:ue=1,ue},l.deleteElement=function(ue){if(l.headers.children[ue])l.headers.removeChild(l.headers.children[ue]),l.content.removeChild(l.content.children[ue]);else return!1;l.open(0),typeof l.options.ondelete=="function"&&l.options.ondelete(v,ue)},l.appendElement=function(ue,te){if(!ue)var ue=prompt("Title?","");if(ue){var ge=document.createElement("div");l.content.appendChild(ge);var ye=document.createElement("div");return ye.innerHTML=ue,ye.content=ge,l.headers.insertBefore(ye,l.headers.lastChild),l.options.allowChangePosition&&ye.setAttribute("draggable","true"),l.selectIndex(ye),typeof te=="function"&&te(ge,ye),ge}},l.getActive=function(){for(var ue=0;ue<l.headers.children.length;ue++)if(l.headers.children[ue].classList.contains("jtabs-selected"))return ue;return 0},l.updateContent=function(ue,te){if(typeof te!="string")var ge=te;else{var ge=document.createElement("div");ge.innerHTML=te}l.content.children[ue].classList.contains("jtabs-selected")&&te.classList.add("jtabs-selected"),l.content.replaceChild(te,l.content.children[ue]),V()},l.updatePosition=function(ue,te){ue>te?l.content.insertBefore(l.content.children[ue],l.content.children[te]):l.content.insertBefore(l.content.children[ue],l.content.children[te].nextSibling),l.open(te),typeof l.options.onchangeposition=="function"&&l.options.onchangeposition(l.headers,ue,te)},l.move=function(ue,te){ue>te?l.headers.insertBefore(l.headers.children[ue],l.headers.children[te]):l.headers.insertBefore(l.headers.children[ue],l.headers.children[te].nextSibling),l.updatePosition(ue,te)},l.setBorder=V,l.init=function(){v.innerHTML="",l.headers=document.createElement("div"),l.content=document.createElement("div"),l.headers.classList.add("jtabs-headers"),l.content.classList.add("jtabs-content"),l.options.palette?v.classList.add("jtabs-modern"):v.classList.remove("jtabs-modern"),l.options.padding&&(l.content.style.padding=parseInt(l.options.padding)+"px");var ue=document.createElement("div");ue.className="jtabs-headers-container",ue.appendChild(l.headers),l.options.maxWidth&&(ue.style.maxWidth=parseInt(l.options.maxWidth)+"px");var te=document.createElement("div");if(te.className="jtabs-controls",te.setAttribute("draggable","false"),ue.appendChild(te),l.options.position=="bottom"?(v.appendChild(l.content),v.appendChild(ue)):(v.appendChild(ue),v.appendChild(l.content)),l.options.allowCreate==!0){var ge=document.createElement("div");ge.className="jtabs-add",ge.onclick=function(){l.create()},te.appendChild(ge)}q=document.createElement("div"),q.className="jtabs-prev",q.onclick=function(){H(l.headers.scrollLeft-l.headers.offsetWidth)},te.appendChild(q),G=document.createElement("div"),G.className="jtabs-next",G.onclick=function(){H(l.headers.scrollLeft+l.headers.offsetWidth)},te.appendChild(G);for(var ye=0;ye<l.options.data.length;ye++){if(l.options.data[ye].titleElement)var ke=l.options.data[ye].titleElement;else var ke=document.createElement("div");if(l.options.data[ye].icon){var We=document.createElement("div"),Qe=document.createElement("i");Qe.classList.add("material-icons"),Qe.innerHTML=l.options.data[ye].icon,We.appendChild(Qe),ke.appendChild(We)}if(l.options.data[ye].title){var fe=document.createTextNode(l.options.data[ye].title);ke.appendChild(fe)}if(l.options.data[ye].width&&(ke.style.width=l.options.data[ye].width),l.options.data[ye].contentElement)var Ee=l.options.data[ye].contentElement;else{var Ee=document.createElement("div");Ee.innerHTML=l.options.data[ye].content}l.headers.appendChild(ke),l.content.appendChild(Ee)}z=document.createElement("div"),z.className="jtabs-border",l.headers.appendChild(z),l.options.animation&&v.classList.add("jtabs-animation"),l.headers.addEventListener("click",function(K){if(K.target.parentNode.classList.contains("jtabs-headers"))var X=K.target;else if(K.target.tagName=="I")var X=K.target.parentNode.parentNode;else var X=K.target.parentNode;var re=l.selectIndex(X);typeof l.options.onclick=="function"&&l.options.onclick(v,l,re,l.headers.children[re],l.content.children[re])}),l.headers.addEventListener("contextmenu",function(K){l.selectIndex(K.target)}),l.headers.children.length&&l.open(0),H(0),l.options.allowChangePosition==!0&&m(l.headers,{direction:1,ondrop:function(K,X,re){l.updatePosition(X,re)}}),typeof l.options.onload=="function"&&l.options.onload(v,l)},v.children[0]&&v.children[0].children.length)for(var J=0;J<v.children[0].children.length;J++){var oe=l.options.data&&l.options.data[J]?l.options.data[J]:{};v.children[1]&&v.children[1].children[J]?(oe.titleElement=v.children[0].children[J],oe.contentElement=v.children[1].children[J]):oe.contentElement=v.children[0].children[J],l.options.data[J]=oe}var je=!1;if(l.options.data)for(var J=0;J<l.options.data.length;J++)l.options.data[J].url&&(w({url:l.options.data[J].url,type:"GET",dataType:"text/html",index:J,success:function(te){l.options.data[this.index].content=te},complete:function(){l.init()}}),je=!0);return je||l.init(),v.tabs=l,l}function he(v,C){if(v.color)return v.color.setOptions(C,!0);var l={type:"color"};l.options={};var o=null,S=null,q=null,G=null,z=null,V=null,H=null;l.setOptions=function(F,ee){var pe={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};F||(F={}),F&&!F.palette&&(F.palette=Y());for(var ce in pe)F&&F.hasOwnProperty(ce)?l.options[ce]=F[ce]:(typeof l.options[ce]=="undefined"||ee===!0)&&(l.options[ce]=pe[ce]);return G&&(G.innerHTML=l.options.resetLabel),z&&(z.innerHTML=l.options.doneLabel),l.options.palette&&H&&H.updateContent(0,ge()),typeof l.options.value=="string"&&(v.value=l.options.value,v.tagName==="INPUT"&&(v.style.color=v.value,v.style.backgroundColor=v.value)),l.options.placeholder?v.setAttribute("placeholder",l.options.placeholder):v.getAttribute("placeholder")&&v.removeAttribute("placeholder"),l},l.select=function(F){var ee=o.querySelector(".jcolor-selected");ee&&ee.classList.remove("jcolor-selected"),l.values[F]&&l.values[F].classList.add("jcolor-selected"),l.options.value=F},l.open=function(){if(!o.classList.contains("jcolor-focus")){g(l,!0),o.classList.add("jcolor-focus"),l.options.value&&l.select(l.options.value),q.style.marginTop="",q.style.marginLeft="";var F=q.getBoundingClientRect(),ee=P.getWindowWidth(),pe=P.getWindowHeight();if(ee<800||l.options.fullscreen==!0?(q.classList.add("jcolor-fullscreen"),T.slideBottom(q,1),S.style.display="block"):(q.classList.contains("jcolor-fullscreen")&&(q.classList.remove("jcolor-fullscreen"),S.style.display=""),l.options.position?q.style.position="fixed":q.style.position="",F.left+F.width>ee&&(q.style.marginLeft=-1*(F.left+F.width-(ee-20))+"px"),F.top+F.height>pe&&(q.style.marginTop=-1*(F.top+F.height-(pe-20))+"px")),typeof l.options.onopen=="function"&&l.options.onopen(v,l),H.setBorder(H.getActive()),l.options.value){var ce=te(l.options.value);K.forEach(function(Q,ve){Q.value=ce[ve],Q.dispatchEvent(new Event("input"))})}}},l.close=function(F){return o.classList.contains("jcolor-focus")&&(o.classList.remove("jcolor-focus"),S.style.display="",!F&&typeof l.options.onclose=="function"&&l.options.onclose(v,l),g(l,!1)),l.options.value},l.setValue=function(F){F||(F=""),F!=l.options.value&&(l.options.value=F,Ee=F,l.select(F),typeof l.options.onchange=="function"&&l.options.onchange(v,F,l),v.value!=l.options.value&&(v.value=l.options.value,v.tagName==="INPUT"&&(v.style.color=v.value,v.style.backgroundColor=v.value),typeof v.oninput=="function"&&v.oninput({type:"input",target:v,value:v.value})),l.options.closeOnChange==!0&&l.close())},l.getValue=function(){return l.options.value};var J=!1,oe=function(F){var ee=F.toString(16);return ee.length===1?"0"+ee:ee},je=function(F,ee,pe){return"#"+oe(F)+oe(ee)+oe(pe)},ue=function(F){return parseInt("0x"+F)},te=function(F){return[ue(F.substr(1,2)),ue(F.substr(3,2)),ue(F.substr(5,2))]},ge=function(){var F=document.createElement("div");F.className="jcolor-grid",l.values=[];var ee=document.createElement("table");ee.setAttribute("cellpadding","7"),ee.setAttribute("cellspacing","0");for(var pe=0;pe<l.options.palette.length;pe++){for(var ce=document.createElement("tr"),Q=0;Q<l.options.palette[pe].length;Q++){var ve=document.createElement("td"),Me=l.options.palette[pe][Q];Me.length<7&&Me.substr(0,1)!=="#"&&(Me="#"+Me),ve.style.backgroundColor=Me,ve.setAttribute("data-value",Me),ve.innerHTML="",ce.appendChild(ve),l.options.value==Me&&ve.classList.add("jcolor-selected"),l.values[Me]=ve}ee.appendChild(ce)}return F.appendChild(ee),F},ye=document.createElement("canvas");ye.width=200,ye.height=160;var ke=ye.getContext("2d"),We=function(){var F=V.firstChild.getBoundingClientRect();ye.width=F.width-14,Qe()},Qe=function(){var F=ke.createLinearGradient(0,0,ye.width,0);F.addColorStop(0,"rgb(255,0,0)"),F.addColorStop(.15,"rgb(255,0,255)"),F.addColorStop(.33,"rgb(0,0,255)"),F.addColorStop(.49,"rgb(0,255,255)"),F.addColorStop(.67,"rgb(0,255,0)"),F.addColorStop(.84,"rgb(255,255,0)"),F.addColorStop(1,"rgb(255,0,0)"),ke.fillStyle=F,ke.fillRect(0,0,ye.width,ye.height),F=ke.createLinearGradient(0,0,0,ye.height),F.addColorStop(0,"rgba(255,255,255,1)"),F.addColorStop(.5,"rgba(255,255,255,0)"),F.addColorStop(.5,"rgba(0,0,0,0)"),F.addColorStop(1,"rgba(0,0,0,1)"),ke.fillStyle=F,ke.fillRect(0,0,ye.width,ye.height)},fe=function(){var F=document.createElement("div");F.className="jcolor-hsl";var ee=document.createElement("div");ee.className="jcolor-point";var pe=document.createElement("div");pe.appendChild(ye),pe.appendChild(ee),F.appendChild(pe);var ce=function(Q,ve,Me){if(Q===1){var Ne=F.getBoundingClientRect(),Ie=ve-Ne.left,Be=Me-Ne.top;Ie<0&&(Ie=0),Be<0&&(Be=0),Ie>Ne.width&&(Ie=Ne.width),Be>Ne.height&&(Be=Ne.height),ee.style.left=Ie+"px",ee.style.top=Be+"px";var $e=ke.getImageData(Ie,Be,1,1).data;Ee=je($e[0],$e[1],$e[2])}};return F.addEventListener("mousedown",function(Q){ce(Q.buttons,Q.clientX,Q.clientY)}),F.addEventListener("mousemove",function(Q){ce(Q.buttons,Q.clientX,Q.clientY)}),F.addEventListener("touchmove",function(Q){ce(1,Q.changedTouches[0].clientX,Q.changedTouches[0].clientY)}),F},Ee="",K=[],X=function(){if(Ee!=="")for(var F=0;F<K.length;F++){var ee=te(Ee);ee[F]=0;var pe="linear-gradient(90deg, rgb(";pe+=ee.join(", "),pe+="), rgb(",ee[F]=255,pe+=ee.join(", "),pe+="))",K[F].style.backgroundImage=pe}},re=function(){var F=document.createElement("div");F.className="jcolor-sliders";var ee=document.createElement("div"),pe=function(Me){var Ne=document.createElement("div");Ne.className="jcolor-sliders-input-container";var Ie=document.createElement("label");Ie.innerText=Me;var Be=document.createElement("div");Be.className="jcolor-sliders-input-subcontainer";var $e=document.createElement("input");$e.type="range",$e.min=0,$e.max=255,$e.value=0,Ne.appendChild(Ie),Be.appendChild($e);var nt=document.createElement("div");return nt.innerText=$e.value,$e.addEventListener("input",function(){nt.innerText=$e.value}),Be.appendChild(nt),Ne.appendChild(Be),ee.appendChild(Ne),$e};K=[pe("Red"),pe("Green"),pe("Blue")],F.appendChild(ee);var ce=document.createElement("div");ce.className="jcolor-sliders-final-color";var Q=document.createElement("div");Q.style.visibility="hidden",Q.innerText="a",ce.appendChild(Q);var ve=function(){var Me=je(parseInt(K[0].value),parseInt(K[1].value),parseInt(K[2].value));Q.innerText=Me,Q.style.color=Me,Q.style.removeProperty("visibility"),Ee=Me};return K.forEach(function(Me){Me.addEventListener("input",function(){ve(),X()})}),F.appendChild(ce),F},A=function(){l.setOptions(C),v.tagName=="INPUT"&&(v.classList.add("jcolor-input"),v.readOnly=!0),o=document.createElement("div"),o.className="jcolor",S=document.createElement("div"),S.className="jcolor-backdrop",o.appendChild(S),q=document.createElement("div"),q.className="jcolor-content";var F=document.createElement("div");F.className="jcolor-controls",q.appendChild(F),G=document.createElement("div"),G.className="jcolor-reset",G.innerHTML=l.options.resetLabel,F.appendChild(G),z=document.createElement("div"),z.className="jcolor-close",z.innerHTML=l.options.doneLabel,F.appendChild(z),V=document.createElement("div"),q.appendChild(V),H=se(V,{animation:!0,data:[{title:"Grid",contentElement:ge()},{title:"Spectrum",contentElement:fe()},{title:"Sliders",contentElement:re()}],onchange:function(ee,pe,ce){if(ce===1)We();else{var Q=Ee!==""?Ee:l.getValue();if(ce===2&&Q){var ve=te(Q);K.forEach(function(Me,Ne){Me.value=ve[Ne],Me.dispatchEvent(new Event("input"))})}}},palette:"modern"}),o.appendChild(q),v.tagName=="INPUT"?v.parentNode.insertBefore(o,v.nextSibling):v.appendChild(o),o.addEventListener("click",function(ee){if(ee.target.tagName=="TD"){var pe=ee.target.getAttribute("data-value");pe&&l.setValue(pe)}else ee.target.classList.contains("jcolor-reset")?(l.setValue(""),l.close()):ee.target.classList.contains("jcolor-close")?(H.getActive()>0&&l.setValue(Ee),l.close()):ee.target.classList.contains("jcolor-backdrop")?l.close():l.open()}),v.addEventListener("mouseup",function(ee){l.open()}),window.addEventListener("resize",function(){o.classList.contains("jcolor-focus")&&H.getActive()==1&&We()}),l.options.opened==!0&&l.open(),v.change=l.setValue,v.val=function(ee){if(ee===void 0)return l.getValue();l.setValue(ee)},v.color=l,o.color=l};return l.toHex=function(F){var ee=function(pe){return("0"+parseInt(pe).toString(16)).slice(-2)};if(F)return/^#[0-9A-F]{6}$/i.test(F)?F:(F=F.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),F&&F.length?"#"+ee(F[1])+ee(F[2])+ee(F[3]):"")},A(),l}function le(){var v=function(C,l){var o={type:"contextmenu"};o.options={};var S={items:null,onclick:null};for(var q in S)l&&l.hasOwnProperty(q)?o.options[q]=l[q]:o.options[q]=S[q];C.classList.add("jcontextmenu"),o.open=function(V,H){if(H&&(o.options.items=H,o.create(H)),v.current&&v.current.close(),g(o,!0),C.classList.add("jcontextmenu-focus"),v.current=o,o.options.items&&o.options.items.length>0||C.children.length){if(V.target)if(V.changedTouches&&V.changedTouches[0])J=V.changedTouches[0].clientX,oe=V.changedTouches[0].clientY;else var J=V.clientX,oe=V.clientY;else var J=V.x,oe=V.y;var je=C.getBoundingClientRect();if(window.innerHeight<oe+je.height){var ue=oe-je.height;ue<0&&(ue=0),C.style.top=ue+"px"}else C.style.top=oe+"px";window.innerWidth<J+je.width?J-je.width>0?C.style.left=J-je.width+"px":C.style.left="10px":C.style.left=J+"px"}},o.isOpened=function(){return!!C.classList.contains("jcontextmenu-focus")},o.close=function(){C.classList.contains("jcontextmenu-focus")&&C.classList.remove("jcontextmenu-focus"),g(o,!1)},o.create=function(V){C.innerHTML="";var H=G();C.appendChild(H);for(var J=0;J<V.length;J++){var oe=z(V[J]);C.appendChild(oe)}};function G(){var V=document.createElement("div");V.classList.add("header"),V.addEventListener("click",function(oe){oe.preventDefault(),oe.stopPropagation()});var H=document.createElement("a");H.classList.add("title"),H.innerHTML=B.translate("Menu"),V.appendChild(H);var J=document.createElement("a");return J.classList.add("close"),J.innerHTML=B.translate("close"),J.addEventListener("click",function(oe){o.close()}),V.appendChild(J),V}function z(V){if(V.type&&(V.type=="line"||V.type=="divisor"))var H=document.createElement("hr");else{var H=document.createElement("div"),J=document.createElement("a");if(J.innerHTML=V.title,V.tooltip&&H.setAttribute("title",V.tooltip),V.icon&&H.setAttribute("data-icon",V.icon),V.id&&(H.id=V.id),V.disabled?H.className="jcontextmenu-disabled":V.onclick&&(H.method=V.onclick,H.addEventListener("mousedown",function(We){We.preventDefault()}),H.addEventListener("mouseup",function(We){this.method(this,We)})),H.appendChild(J),V.submenu){var oe=document.createElement("span");oe.innerHTML="&#9658;",H.appendChild(oe),H.classList.add("jcontexthassubmenu");var je=document.createElement("div");je.classList.add("jcontextmenu"),je.setAttribute("tabindex","900");for(var ue=V.submenu,te=0;te<ue.length;te++){var ge=z(ue[te]);je.appendChild(ge)}H.appendChild(je)}else if(V.shortcut){var ye=document.createElement("span");ye.innerHTML=V.shortcut,H.appendChild(ye)}}return H}return typeof o.options.onclick=="function"&&C.addEventListener("click",function(V){o.options.onclick(o,V)}),o.options.items&&o.create(o.options.items),window.addEventListener("mousewheel",function(){o.close()}),C.contextmenu=o,o};return v}var xe=le();function Ae(){var v=function(C,l){if(C.dropdown)return C.dropdown.setOptions(l,!0);var o={type:"dropdown"};o.options={};var S=function(K,X){K&&K.length&&(o.options.sortResults!==!1&&(typeof o.options.sortResults=="function"?K.sort(o.options.sortResults):K.sort(q)),o.setData(K)),typeof o.options.onload=="function"&&o.options.onload(C,o,K,X),X&&z(X),X==null&&(o.options.value=""),C.value=o.options.value,o.options.opened==!0&&o.open()},q=function(K,X){var re,A;return typeof K=="string"?re=K:K.text?re=K.text:K.name&&(re=K.name),typeof X=="string"?A=X:X.text?A=X.text:X.name&&(A=X.name),typeof re=="string"||typeof A=="string"?(typeof re!="string"&&(re=""+re),typeof A!="string"&&(A=""+A),re.localeCompare(A)):re-A},G=function(){o.value={};for(var K=0;K<o.items.length;K++)o.items[K].selected==!0&&(o.items[K].element&&o.items[K].element.classList.remove("jdropdown-selected"),o.items[K].selected=null);o.options.value="",C.value=""},z=function(K){if(G(),K!==null)if(!K)typeof o.value[""]!="undefined"&&(o.value[""]="");else{Array.isArray(K)||(K=(""+K).split(";"));for(var X=0;X<K.length;X++)o.value[K[X]]=""}for(var X=0;X<o.items.length;X++)typeof o.value[V(X)]!="undefined"&&(o.items[X].element&&o.items[X].element.classList.add("jdropdown-selected"),o.items[X].selected=!0,o.value[V(X)]=H(X));o.options.value=Object.keys(o.value).join(";"),o.header.value=o.getText()},V=function(K,X){if(o.options.format)var re="id";else var re="value";return o.items[K]?X!==void 0?o.items[K].data[re]=X:o.items[K].data[re]:""},H=function(K,X){if(o.options.format)var re="name";else var re="text";return o.items[K]?X!==void 0?o.items[K].data[re]=X:o.items[K].data[re]:""},J=function(){return Object.keys(o.value)},oe=function(){for(var K=[],X=Object.keys(o.value),re=0;re<X.length;re++)K.push(o.value[X[re]]);return K};o.setOptions=function(K,X){K||(K={});var re={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1};for(var A in re)K&&K.hasOwnProperty(A)?o.options[A]=K[A]:(typeof o.options[A]=="undefined"||X===!0)&&(o.options[A]=re[A]);return(o.options.remoteSearch==!0||o.options.type==="searchbar")&&(o.options.autocomplete=!0),o.options.newOptions==!0?o.header.classList.add("jdropdown-add"):o.header.classList.remove("jdropdown-add"),o.options.autocomplete==!0?o.header.removeAttribute("readonly"):o.header.setAttribute("readonly","readonly"),o.options.placeholder?o.header.setAttribute("placeholder",o.options.placeholder):o.header.removeAttribute("placeholder"),C.classList.remove("jdropdown-searchbar"),C.classList.remove("jdropdown-picker"),C.classList.remove("jdropdown-list"),o.options.type=="searchbar"?C.classList.add("jdropdown-searchbar"):o.options.type=="list"?C.classList.add("jdropdown-list"):o.options.type=="picker"?C.classList.add("jdropdown-picker"):P.getWindowWidth()<800?o.options.autocomplete?(C.classList.add("jdropdown-searchbar"),o.options.type="searchbar"):(C.classList.add("jdropdown-picker"),o.options.type="picker"):(o.options.width?(C.style.width=o.options.width,C.style.minWidth=o.options.width):(C.style.removeProperty("width"),C.style.removeProperty("min-width")),C.classList.add("jdropdown-default"),o.options.type="default"),o.options.type=="searchbar"?je.appendChild(ge):ue.insertBefore(ge,ue.firstChild),o.options.url&&!K.data?w({url:o.options.url,method:"GET",dataType:"json",success:function(F){F&&S(F,o.options.value)}}):S(o.options.data,o.options.value),o};var je=null,ue=null,te=null,ge=null,ye=null,ke=null,We=null,Qe=function(){if(l||(l={}),C.tagName=="SELECT"){var K=v.extractFromDom(C,l);C=K.el,l=K.options}!l.placeholder&&C.getAttribute("placeholder")&&(l.placeholder=C.getAttribute("placeholder")),o.value={},o.items=[],o.groups=[],o.search="",o.results=null,C.classList.add("jdropdown"),je=document.createElement("div"),je.className="jdropdown-container-header",o.header=document.createElement("input"),o.header.className="jdropdown-header jss_object",o.header.type="text",o.header.setAttribute("autocomplete","off"),o.header.onfocus=function(){typeof o.options.onfocus=="function"&&o.options.onfocus(C)},o.header.onblur=function(){typeof o.options.onblur=="function"&&o.options.onblur(C)},o.header.onkeyup=function(X){o.options.autocomplete==!0&&!We?(o.search!=o.header.value.trim()&&(We=setTimeout(function(){o.find(o.header.value.trim()),We=null},400)),C.classList.contains("jdropdown-focus")||o.open()):o.options.autocomplete||o.next(X.key)},v.hasEvents||(v.hasEvents=!0,document.addEventListener("keydown",v.keydown)),ue=document.createElement("div"),ue.className="jdropdown-container",te=document.createElement("div"),te.className="jdropdown-content",ge=document.createElement("div"),ge.className="jdropdown-close",ge.textContent="Done",ye=document.createElement("div"),ye.className="jdropdown-reset",ye.textContent="x",ye.onclick=function(){o.reset(),o.close()},ke=document.createElement("div"),ke.className="jdropdown-backdrop",je.appendChild(o.header),ue.appendChild(te),C.appendChild(je),C.appendChild(ue),C.appendChild(ke),o.setOptions(l),"ontouchsend"in document.documentElement?C.addEventListener("touchsend",v.mouseup):C.addEventListener("mouseup",v.mouseup),o.options.lazyLoading==!0&&b(te,{loadUp:o.loadUp,loadDown:o.loadDown}),te.onwheel=function(X){X.stopPropagation()},C.change=o.setValue,C.val=function(X){if(X===void 0)return o.getValue(!!o.options.multiple);o.setValue(X)},C.dropdown=o};o.getUrl=function(){return o.options.url},o.setUrl=function(K,X){o.options.url=K,w({url:o.options.url,method:"GET",dataType:"json",success:function(re){o.setData(re),typeof X=="function"&&X(o)}})},o.setId=function(K,X){if(o.options.format)var re="id";else var re="value";typeof K=="object"?K[re]=X:o.items[K].data[re]=X},o.add=function(K,X){if(!K){var re=o.options.autocomplete==!0?o.header.value:"",K=prompt(B.translate("Add A New Option"),re);if(!K)return!1}if(X||(X=P.guid()),o.options.format)var A={id:X,name:K};else var A={value:X,text:K};if(typeof o.options.onbeforeinsert=="function"){var F=o.options.onbeforeinsert(o,A);if(F===!1)return!1;F&&(A=F)}o.options.data.push(A);var ee=o.createItem(A);return te.appendChild(ee.element),typeof o.options.oninsert=="function"&&o.options.oninsert(o,A,ee),te.style.display=="none"&&(te.style.display=""),o.results&&o.results.push(ee),A},o.createItem=function(K,X,re){o.options.format?(!K.id&&K.value!==void 0&&(K.id=K.value),!K.name&&K.text!==void 0&&(K.name=K.text)):(!K.value&&K.id!==void 0&&(K.value=K.id),!K.text&&K.name!==void 0&&(K.text=K.name));var A={};if(A.element=document.createElement("div"),A.element.className="jdropdown-item",A.element.indexValue=o.items.length,A.data=K,X&&(A.group=X),K.id&&A.element.setAttribute("id",K.id),K.disabled==!0&&A.element.setAttribute("data-disabled",!0),K.tooltip&&A.element.setAttribute("title",K.tooltip),K.image){var F=document.createElement("img");F.className="jdropdown-image",F.src=K.image,K.title||F.classList.add("jdropdown-image-small"),A.element.appendChild(F)}else if(K.icon){var ee=document.createElement("span");ee.className="jdropdown-icon material-icons",ee.innerText=K.icon,K.title||ee.classList.add("jdropdown-icon-small"),K.color&&(ee.style.color=K.color),A.element.appendChild(ee)}else if(K.color){var pe=document.createElement("div");pe.className="jdropdown-color",pe.style.backgroundColor=K.color,A.element.appendChild(pe)}if(o.options.format)var ce=K.name;else var ce=K.text;var Q=document.createElement("div");if(Q.className="jdropdown-description",Q.textContent=ce||"&nbsp;",K.title){var ve=document.createElement("div");ve.className="jdropdown-title",ve.innerText=K.title,Q.appendChild(ve)}if(o.options.format)var Me=K.id;else var Me=K.value;return o.value[Me]&&(A.element.classList.add("jdropdown-selected"),A.selected=!0),o.items.push(A),A.element.appendChild(Q),A},o.appendData=function(K){if(K.length){for(var X=[],re=[],A=0;A<K.length;A++)K[A].group?(re[K[A].group]||(re[K[A].group]=[]),re[K[A].group].push(A)):X.push(A);var F=0,ee=Object.keys(re);if(ee.length>0)for(var A=0;A<ee.length;A++){var pe=document.createElement("div");pe.className="jdropdown-group";var ce=document.createElement("div");ce.className="jdropdown-group-name",ce.textContent=ee[A];var Q=document.createElement("i");Q.className="jdropdown-group-arrow jdropdown-group-arrow-down",ce.appendChild(Q);var ve=document.createElement("div");ve.className="jdropdown-group-items";for(var Me=0;Me<re[ee[A]].length;Me++){var Ne=o.createItem(K[re[ee[A]][Me]],pe,ee[A]);(o.options.lazyLoading==!1||F<200)&&(ve.appendChild(Ne.element),F++)}pe.appendChild(ce),pe.appendChild(ve),o.groups.push(pe),ve.children.length>0&&te.appendChild(pe)}if(X.length)for(var A=0;A<X.length;A++){var Ne=o.createItem(K[X[A]]);(o.options.lazyLoading==!1||F<200)&&(te.appendChild(Ne.element),F++)}}},o.setData=function(K){if(G(),te.textContent="",o.header.value="",o.items=[],K&&K.length){for(var X=0;X<K.length;X++)typeof K[X]!="object"&&(o.options.format?K[X]={id:K[X],name:K[X]}:K[X]={value:K[X],text:K[X]});o.appendData(K),o.options.data=K}else o.options.data=[];o.close()},o.getData=function(){return o.options.data},o.getPosition=function(K){for(var X=0;X<o.items.length;X++)if(V(X)==K)return X;return!1},o.getText=function(K){var X=oe();return K?X:X.join("; ")},o.getValue=function(K){var X=J();return K?X:X.join(";")};var fe=function(K){C.value!=o.options.value&&(C.value=o.options.value,typeof C.oninput=="function"&&C.oninput({type:"input",target:C,value:C.value})),typeof o.options.onchange=="function"&&o.options.onchange(C,o,K,o.options.value)};o.setValue=function(K){var X=o.getValue();Array.isArray(K)&&(K=K.join(";")),X!==K&&(z(K),fe(X))},o.resetSelected=function(){o.setValue(null)},o.selectIndex=function(re,X){var re=parseInt(re);if(o.items&&o.items[re]&&(X===!0||o.items[re].data.disabled!==!0))if(o.setCursor(re,!1),!o.options.multiple)o.items[re].selected?o.setValue(null):o.setValue(V(re)),o.close();else{var A=o.options.value;o.items[re].selected?(o.items[re].element.classList.remove("jdropdown-selected"),o.items[re].selected=!1,delete o.value[V(re)]):(o.items[re].element.classList.add("jdropdown-selected"),o.items[re].selected=!0,o.value[V(re)]=H(re)),o.options.value=Object.keys(o.value).join(";"),o.options.autocomplete==!1&&(o.header.value=oe().join("; ")),fe(A)}},o.selectItem=function(K){o.selectIndex(K.indexValue)};var Ee=function(K,X){for(var re=0;re<X.length;re++)if(o.options.format){if(X[re].id==K)return!0}else if(X[re].value==K)return!0;return!1};return o.find=function(K){if(o.search==K.trim())return!1;if(o.search=K,o.setCursor(),o.groups.length)for(var X=0;X<o.groups.length;X++)o.groups[X].lastChild.textContent="";if(te.textContent="",o.options.remoteSearch==!0){o.results=null;var re=o.options.url;let ve={url:re,method:"GET",data:{q:K},dataType:"json",success:function(Me){o.items=[];var Ne=Object.keys(o.value);if(Ne.length)for(var Ie=0;Ie<Ne.length;Ie++)Ee(Ne[Ie],Me)||(o.options.format?Me.unshift({id:Ne[Ie],name:o.value[Ne[Ie]]}):Me.unshift({value:Ne[Ie],text:o.value[Ne[Ie]]}));o.appendData(Me),Me.length?te.style.display="":te.style.display="none",typeof o.options.onsearch=="function"&&o.options.onsearch(o,Me)}};if(typeof o.options.onbeforesearch=="function"){let Me=o.options.onbeforesearch(o,ve);if(Me===!1)return;typeof Me=="object"&&(ve=Me)}w(ve)}else{K=new RegExp(K,"gi");for(var A=[],X=0;X<o.items.length;X++){var F=H(X),ee=o.items[X].data.title||"",pe=o.items[X].data.group||"",ce=o.items[X].data.synonym||"";ce&&(ce=ce.join(" ")),(K==null||o.items[X].selected==!0||F.match(K)||ee.match(K)||pe.match(K)||ce.match(K))&&A.push(o.items[X])}if(!A.length)te.style.display="none",o.results=null;else{te.style.display="",o.results=A;var Q=A.length||0;o.options.lazyLoading==!0&&Q>200&&(Q=200);for(var X=0;X<Q;X++)o.results[X].group?(o.results[X].group.parentNode||te.appendChild(o.results[X].group),o.results[X].group.lastChild.appendChild(o.results[X].element)):te.appendChild(o.results[X].element)}}o.options.autofocus==!0&&o.first()},o.open=function(){if(!C.classList.contains("jdropdown-focus")){v.current=o,g(o,!0),C.classList.add("jdropdown-focus"),P.getWindowWidth()<800&&(o.options.type==null||o.options.type=="picker")&&T.slideBottom(ue,1),o.options.autocomplete==!0&&(o.header.value=o.search,o.header.focus());var K=J();if(K[0]){var X=o.getPosition(K[0]);X!==!1&&o.setCursor(X)}if(!o.options.type||o.options.type=="default"){var re=C.getBoundingClientRect(),A=ue.getBoundingClientRect();o.options.position?(ue.style.position="fixed",window.innerHeight<re.bottom+A.height?(ue.style.top="",ue.style.bottom=window.innerHeight-re.top+1+"px"):(ue.style.top=re.bottom+"px",ue.style.bottom=""),ue.style.left=re.left+"px"):window.innerHeight<re.bottom+A.height?(ue.style.top="",ue.style.bottom=re.height+1+"px"):(ue.style.top="",ue.style.bottom=""),ue.style.minWidth=re.width+"px",o.options.maxWidth&&(ue.style.maxWidth=o.options.maxWidth),!o.items.length&&o.options.autocomplete==!0?te.style.display="none":te.style.display=""}}typeof o.options.onopen=="function"&&o.options.onopen(C)},o.close=function(K){return C.classList.contains("jdropdown-focus")&&(o.header.value=o.getText(),o.setCursor(),!K&&typeof o.options.onclose=="function"&&o.options.onclose(C),o.header.blur&&o.header.blur(),C.classList.remove("jdropdown-focus"),g(o,!1),v.current=null),o.getValue()},o.setCursor=function(K,X){if(o.currentIndex!=null&&o.items&&o.items[o.currentIndex]&&o.items[o.currentIndex].element.classList.remove("jdropdown-cursor"),K==null)o.currentIndex=null;else if(K=parseInt(K),o.items[K].element.parentNode&&(o.items[K].element.classList.add("jdropdown-cursor"),o.currentIndex=K,X!==!1&&o.items[o.currentIndex].element)){var re=te.scrollTop,A=o.items[o.currentIndex].element;te.scrollTop=A.offsetTop-A.scrollTop+A.clientTop-95}},o.resetCursor=o.setCursor,o.updateCursor=o.setCursor,o.reset=function(){o.setCursor(),o.setValue(null)},o.first=function(){o.options.lazyLoading===!0&&o.loadFirst();var K=te.querySelectorAll(".jdropdown-item");if(K.length){var X=K[0].indexValue;o.setCursor(X)}},o.last=function(){o.options.lazyLoading===!0&&o.loadLast();var K=te.querySelectorAll(".jdropdown-item");if(K.length){var X=K[K.length-1].indexValue;o.setCursor(X)}},o.next=function(K){var X=null;if(K){if(K.length==1){var re=o.currentIndex||-1;K=K.toLowerCase();var A=null,F=null,ee=te.querySelectorAll(".jdropdown-item");if(ee.length){for(var pe=0;pe<ee.length;pe++)if(ee[pe].indexValue>re&&(A=o.items[ee[pe].indexValue])&&(F=A.element.innerText[0])&&(F=F.toLowerCase(),K==F)){X=ee[pe].indexValue;break}o.setCursor(X)}}}else if(o.currentIndex==null||o.currentIndex==null)o.first();else{var ce=o.items[o.currentIndex].element,Q=ce.nextElementSibling;Q?(Q.classList.contains("jdropdown-group")&&(Q=Q.lastChild.firstChild),X=Q.indexValue):ce.parentNode.classList.contains("jdropdown-group-items")&&((Q=ce.parentNode.parentNode.nextElementSibling)&&(Q.classList.contains("jdropdown-group")?Q=Q.lastChild.firstChild:Q.classList.contains("jdropdown-item")?X=Q.indexValue:Q=null),Q&&(X=Q.indexValue)),X!==null&&o.setCursor(X)}},o.prev=function(){var K=null;if(o.currentIndex===null)o.first();else{var X=o.items[o.currentIndex].element,re=X.previousElementSibling;re?(re.classList.contains("jdropdown-group")&&(re=re.lastChild.lastChild),K=re.indexValue):X.parentNode.classList.contains("jdropdown-group-items")&&((re=X.parentNode.parentNode.previousElementSibling)&&(re.classList.contains("jdropdown-group")?re=re.lastChild.lastChild:re.classList.contains("jdropdown-item")?K=re.indexValue:re=null),re&&(K=re.indexValue))}K!==null&&o.setCursor(K)},o.loadFirst=function(){if(o.results)var K=o.results;else var K=o.items;var X=K.length||0;o.options.lazyLoading==!0&&X>200&&(X=200),te.textContent="";for(var re=0;re<X;re++)K[re].group?(K[re].group.parentNode||te.appendChild(K[re].group),K[re].group.lastChild.appendChild(K[re].element)):te.appendChild(K[re].element);te.scrollTop=0},o.loadLast=function(){if(o.results)var K=o.results;else var K=o.items;var X=K.length;if(X>200){X=X-200,te.textContent="";for(var re=X;re<K.length;re++)K[re].group?(K[re].group.parentNode||te.appendChild(K[re].group),K[re].group.lastChild.appendChild(K[re].element)):te.appendChild(K[re].element);te.scrollTop=te.scrollHeight}},o.loadUp=function(){var K=!1;if(o.results)var X=o.results;else var X=o.items;var re=te.querySelectorAll(".jdropdown-item"),A=re[0].indexValue;A=o.items[A];var F=X.indexOf(A)-1;if(F>0){for(var ee=0;F>0&&X[F]&&ee<200;)X[F].group?(X[F].group.parentNode||te.insertBefore(X[F].group,te.firstChild),X[F].group.lastChild.insertBefore(X[F].element,X[F].group.lastChild.firstChild)):te.insertBefore(X[F].element,te.firstChild),F--,ee++;K=!0}return K},o.loadDown=function(){var K=!1;if(o.results)var X=o.results;else var X=o.items;var re=te.querySelectorAll(".jdropdown-item"),A=re[re.length-1].indexValue;A=o.items[A];var F=X.indexOf(A)+1;if(F<X.length){for(var ee=0;F<X.length&&X[F]&&ee<200;)X[F].group?(X[F].group.parentNode||te.appendChild(X[F].group),X[F].group.lastChild.appendChild(X[F].element)):te.appendChild(X[F].element),F++,ee++;K=!0}return K},Qe(),o};return v.keydown=function(C){var l=null;if(l=v.current){if(C.which==13||C.which==9)l.header.value&&l.currentIndex==null&&l.options.newOptions?l.add():(l.currentIndex==null&&l.options.autocomplete==!0&&l.header.value!=""&&l.find(l.header.value),l.selectIndex(l.currentIndex));else if(C.which==38)l.currentIndex==null?l.first():l.currentIndex>0&&l.prev(),C.preventDefault();else if(C.which==40)l.currentIndex==null?l.first():l.currentIndex+1<l.items.length&&l.next(),C.preventDefault();else if(C.which==36)l.first(),C.target.classList.contains("jdropdown-header")||C.preventDefault();else if(C.which==35)l.last(),C.target.classList.contains("jdropdown-header")||C.preventDefault();else if(C.which==27)l.close();else if(C.which==33){if(l.currentIndex==null)l.first();else if(l.currentIndex>0)for(var o=0;o<7;o++)l.prev();C.preventDefault()}else if(C.which==34){if(l.currentIndex==null)l.first();else if(l.currentIndex+1<l.items.length)for(var o=0;o<7;o++)l.next();C.preventDefault()}}},v.mouseup=function(C){var l=P.findElement(C.target,"jdropdown");if(l){var o=l.dropdown;if(C.target.classList.contains("jdropdown-header"))if(l.classList.contains("jdropdown-focus")&&l.classList.contains("jdropdown-default")){var S=l.getBoundingClientRect();if(C.changedTouches&&C.changedTouches[0])var q=C.changedTouches[0].clientX,G=C.changedTouches[0].clientY;else var q=C.clientX,G=C.clientY;S.width-(q-S.left)<30?C.target.classList.contains("jdropdown-add")?o.add():o.close():o.options.autocomplete==!1&&o.close()}else o.open();else if(C.target.classList.contains("jdropdown-group-name")){var z=C.target.nextSibling.children;if(C.target.nextSibling.style.display!="none")for(var V=0;V<z.length;V++)z[V].style.display!="none"&&o.selectItem(z[V])}else C.target.classList.contains("jdropdown-group-arrow")?C.target.classList.contains("jdropdown-group-arrow-down")?(C.target.classList.remove("jdropdown-group-arrow-down"),C.target.classList.add("jdropdown-group-arrow-up"),C.target.parentNode.nextSibling.style.display="none"):(C.target.classList.remove("jdropdown-group-arrow-up"),C.target.classList.add("jdropdown-group-arrow-down"),C.target.parentNode.nextSibling.style.display=""):C.target.classList.contains("jdropdown-item")?o.selectItem(C.target):C.target.classList.contains("jdropdown-image")||C.target.classList.contains("jdropdown-description")?o.selectItem(C.target.parentNode):C.target.classList.contains("jdropdown-title")?o.selectItem(C.target.parentNode.parentNode):(C.target.classList.contains("jdropdown-close")||C.target.classList.contains("jdropdown-backdrop"))&&o.close()}},v.extractFromDom=function(C,l){var o=C;if(l||(l={}),C.getAttribute("multiple")&&(!l||l.multiple==null)&&(l.multiple=!0),C.getAttribute("placeholder")&&(!l||l.placeholder==null)&&(l.placeholder=C.getAttribute("placeholder")),C.getAttribute("data-autocomplete")&&(!l||l.autocomplete==null)&&(l.autocomplete=!0),(!l||l.width==null)&&(l.width=C.offsetWidth),C.value&&(!l||l.value==null)&&(l.value=C.value),!l||l.data==null){l.data=[];for(var S=0;S<C.children.length;S++)if(C.children[S].tagName=="OPTGROUP")for(var q=0;q<C.children[S].children.length;q++)l.data.push({value:C.children[S].children[q].value,text:C.children[S].children[q].textContent,group:C.children[S].getAttribute("label")});else l.data.push({value:C.children[S].value,text:C.children[S].textContent})}(!l||l.onchange==null)&&(l.onchange=function(z,V,H,J){l.multiple==!0?obj.items[V].classList.contains("jdropdown-selected")?o.options[V].setAttribute("selected","selected"):o.options[V].removeAttribute("selected"):o.value=J});var G=document.createElement("div");return C.parentNode.insertBefore(G,C),C.style.display="none",C=G,{el:C,options:l}},v}var be=Ae();function ae(v,C){if(v.picker)return v.picker.setOptions(C,!0);var l={type:"picker"};l.options={};var o=null,S=null,q=function(V){return V instanceof Element||V instanceof HTMLDocument},G=function(){S.innerHTML="";for(var V=Object.keys(l.options.data),H=0;H<V.length;H++){var J=document.createElement("div");J.classList.add("jpicker-item"),J.k=V[H],J.v=l.options.data[V[H]];var oe=l.getLabel(V[H],J);q(oe)?J.appendChild(oe):J.innerHTML=oe,S.appendChild(J)}};l.setOptions=function(V,H){var J={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};V&&V.options&&(V.data=V.options);for(var oe in J)V&&V.hasOwnProperty(oe)?l.options[oe]=V[oe]:(typeof l.options[oe]=="undefined"||H===!0)&&(l.options[oe]=J[oe]);return l.options.header===!1?o.style.display="none":o.style.display="",l.options.width?o.style.width=parseInt(l.options.width)+"px":o.style.width="",l.options.height?(S.style.maxHeight=l.options.height+"px",S.style.overflow="scroll"):S.style.overflow="",l.options.columns>0&&(l.options.grid?(S.classList.add("jpicker-grid"),S.style.gridTemplateColumns="repeat("+l.options.grid+", 1fr)"):(S.classList.add("jpicker-columns"),S.style.width=l.options.width?l.options.width:36*l.options.columns+"px")),isNaN(parseInt(l.options.value))&&(l.options.value=0),G(),l.setValue(l.options.value),l},l.getValue=function(){return l.options.value},l.setValue=function(V,H){if(l.setLabel(V),l.options.value=String(V),v.value!=l.options.value&&(v.value=l.options.value,typeof v.oninput=="function"&&v.oninput({type:"input",target:v,value:v.value})),S.children[V]&&S.children[V].getAttribute("type")!=="generic"&&l.close(),H&&typeof l.options.onchange=="function"){var J=l.options.data[V];l.options.onchange(v,l,J,J,V,H)}},l.getLabel=function(V,H){var J=l.options.data[V]||null;return typeof l.options.render=="function"&&(J=l.options.render(J,H)),J},l.setLabel=function(V){var H;l.options.content?H='<i class="material-icons">'+l.options.content+"</i>":H=l.getLabel(V,null),q(H)?(o.innerHTML="",o.appendChild(H)):o.innerHTML=H},l.open=function(){if(!v.classList.contains("jpicker-focus")){g(l,!0),v.classList.add("jpicker-focus"),v.focus();var V=0,H=0;S.style.marginLeft="";var J=o.getBoundingClientRect(),oe=S.getBoundingClientRect();window.innerHeight<J.bottom+oe.height||l.options.bottom?V=-1*(oe.height+4):V=J.height+4,l.options.right===!0&&(H=-1*oe.width+J.width),oe.left+H<0&&(H=H+oe.left+10),oe.left+oe.width>window.innerWidth&&(H=-1*(10+oe.left+oe.width-window.innerWidth)),S.style.marginTop=parseInt(V)+"px",S.style.marginLeft=parseInt(H)+"px",typeof l.options.onopen=="function"&&l.options.onopen(v,l)}},l.close=function(){v.classList.contains("jpicker-focus")&&(v.classList.remove("jpicker-focus"),g(l,!1),typeof l.options.onclose=="function"&&l.options.onclose(v,l))};var z=function(){v.classList.add("jpicker"),v.setAttribute("tabindex","900"),v.onmousedown=function(V){v.classList.contains("jpicker-focus")||l.open()},o=document.createElement("div"),o.classList.add("jpicker-header"),S=document.createElement("div"),S.classList.add("jpicker-content"),S.onclick=function(V){var H=P.findElement(V.target,"jpicker-item");H&&H.parentNode===S&&l.setValue(H.k,V)},v.appendChild(o),v.appendChild(S),v.value=C.value||0,l.setOptions(C),typeof l.options.onload=="function"&&l.options.onload(v,l),v.change=l.setValue,v.val=function(V){if(V===void 0)return l.getValue();l.setValue(V)},v.picker=l};return z(),l}function Ve(v,C){var l={type:"toolbar"};l.options={};var o={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var S in o)C&&C.hasOwnProperty(S)?l.options[S]=C[S]:l.options[S]=o[S];!v&&C.app&&C.app.el&&(v=document.createElement("div"),C.app.el.appendChild(v));var q=document.createElement("div");q.classList.add("jtoolbar-item"),q.classList.add("jtoolbar-arrow");var G=document.createElement("div");G.classList.add("jtoolbar-floating"),q.appendChild(G),l.selectItem=function(V){for(var H=z.children,J=0;J<H.length;J++)V!=H[J]&&H[J].classList.remove("jtoolbar-selected");V.classList.add("jtoolbar-selected")},l.hide=function(){T.slideBottom(v,0,function(){v.style.display="none"})},l.show=function(){v.style.display="",T.slideBottom(v,1)},l.get=function(){return v},l.setBadge=function(V,H){z.children[V].children[1].firstChild.innerHTML=H},l.destroy=function(){toolbar.remove(),v.innerHTML=""},l.update=function(V,H){for(var J=0;J<z.children.length;J++){var oe=z.children[J];typeof oe.updateState=="function"&&oe.updateState(v,l,oe,V,H)}for(var J=0;J<G.children.length;J++){var oe=G.children[J];typeof oe.updateState=="function"&&oe.updateState(v,l,oe,V,H)}},l.create=function(V){z.innerHTML="";for(var H=0;H<V.length;H++){var J=document.createElement("div");if(J.classList.add("jtoolbar-item"),V[H].width&&(J.style.width=parseInt(V[H].width)+"px"),V[H].k&&(J.k=V[H].k),V[H].tooltip&&J.setAttribute("title",V[H].tooltip),V[H].id&&J.setAttribute("id",V[H].id),V[H].updateState&&(J.updateState=V[H].updateState),V[H].active&&J.classList.add("jtoolbar-active"),V[H].disabled&&J.classList.add("jtoolbar-disabled"),V[H].type=="select"||V[H].type=="dropdown")ae(J,V[H]);else if(V[H].type=="divisor")J.classList.add("jtoolbar-divisor");else if(V[H].type=="label")J.classList.add("jtoolbar-label"),J.innerHTML=V[H].content;else{var oe=document.createElement("i");if(typeof V[H].class=="undefined")oe.classList.add("material-icons");else for(var je=V[H].class.split(" "),ue=0;ue<je.length;ue++)oe.classList.add(je[ue]);if(oe.innerHTML=V[H].content?V[H].content:"",J.appendChild(oe),l.options.badge==!0){var te=document.createElement("div");te.classList.add("jbadge");var ge=document.createElement("div");ge.innerHTML=V[H].badge?V[H].badge:"",te.appendChild(ge),J.appendChild(te)}if(V[H].title)if(l.options.title==!0){var ye=document.createElement("span");ye.innerHTML=V[H].title,J.appendChild(ye)}else J.setAttribute("title",V[H].title);l.options.app&&V[H].route&&(J.route=V[H].route,J.onclick=function(){l.options.app.pages(this.route)},l.options.app.pages(V[H].route,{toolbarItem:J,closed:!0})),typeof V[H].render=="function"&&V[H].render(J,V[H])}V[H].onclick&&(J.onclick=V[H].onclick.bind(V[H],v,l,J)),z.appendChild(J)}setTimeout(function(){l.refresh()},0)},l.open=function(){q.classList.add("jtoolbar-arrow-selected");var V=v.getBoundingClientRect(),H=G.getBoundingClientRect();H.bottom>window.innerHeight||l.options.bottom?G.style.bottom="0":G.style.removeProperty("bottom"),G.style.right="0",q.children[0].focus(),g(l,!0)},l.close=function(){q.classList.remove("jtoolbar-arrow-selected"),g(l,!1)},l.refresh=function(){if(l.options.responsive==!0){var V=v.parentNode.getBoundingClientRect();l.options.maxWidth||(l.options.maxWidth=V.width);var H=parseInt(l.options.maxWidth);for(q.parentNode&&q.parentNode.removeChild(q);G.firstChild;)z.appendChild(G.firstChild);if(H<z.offsetWidth)for(H-=50;z.lastChild&&H<z.offsetWidth;)G.insertBefore(z.lastChild,G.firstChild);G.children.length>0&&z.appendChild(q)}},l.setReadonly=function(V){V=V?"add":"remove",v.classList[V]("jtoolbar-disabled")},v.onclick=function(V){var H=P.findElement(V.target,"jtoolbar-item");H&&l.selectItem(H),V.target.classList.contains("jtoolbar-arrow")&&l.open()},window.addEventListener("resize",function(){l.refresh()}),v.classList.add("jtoolbar"),v.innerHTML="",l.options.container==!0&&v.classList.add("jtoolbar-container");var z=document.createElement("div");return v.appendChild(z),l.options.app&&v.classList.add("jtoolbar-mobile"),l.create(l.options.items),v.toolbar=l,l}function Ge(){var v=function(C,l){var o={type:"editor"};o.options={};var S={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var q in S)l&&l.hasOwnProperty(q)?o.options[q]=l[q]:o.options[q]=S[q];var G=null,z=null,V=[];o.el=C,typeof o.options.onclick=="function"&&(C.onclick=function(ne){o.options.onclick(C,o,ne)}),C.classList.add("jeditor-container");var H=document.createElement("div");H.className="jsnippet",H.setAttribute("contenteditable",!1);var J=document.createElement("div");if(J.className="jeditor-toolbar",o.editor=document.createElement("div"),o.editor.setAttribute("contenteditable",!0),o.editor.setAttribute("spellcheck",!1),o.editor.classList.add("jeditor"),o.options.placeholder&&o.editor.setAttribute("data-placeholder",o.options.placeholder),(o.options.maxHeight||o.options.height)&&(o.editor.style.overflowY="auto",o.options.maxHeight&&(o.editor.style.maxHeight=o.options.maxHeight),o.options.height&&(o.editor.style.height=o.options.height)),o.options.url)w({url:o.options.url,dataType:"html",success:function(ne){o.editor.innerHTML=ne,v.setCursor(o.editor,o.options.focus=="initial")}});else if(o.options.value)o.editor.innerHTML=o.options.value;else for(var oe=0;oe<C.children.length;oe++)o.editor.appendChild(C.children[oe]);C.innerHTML="";var je=function(ne){typeof o.options.onchange=="function"&&o.options.onchange(C,o,ne),o.options.value=o.getData(),C.value!=o.options.value&&(C.value=o.options.value,typeof C.oninput=="function"&&C.oninput({type:"input",target:C,value:C.value}))},ue=function(ne){var me=document.createElement("div");me.innerHTML=ne;var Ce=me.querySelectorAll("img");if(Ce.length)for(var Oe=0;Oe<Ce.length;Oe++)o.addImage(Ce[Oe].src)},te=function(ne){var me,Ce;if(window.getSelection&&(me=window.getSelection(),me.rangeCount)){Ce=me.getRangeAt(0);var Oe=Ce.toString();Ce.deleteContents(),Ce.insertNode(ne),Ce.setStartAfter(ne),Ce.setEndAfter(ne),me.removeAllRanges(),me.addRange(Ce)}},ge=function(){var ne=null;if(ne=H.children[0]){ne.classList.contains("jslider-grid")||ne.classList.add("jslider-grid");var me=ne.children.length;ne.setAttribute("data-number",me>4?4:me),me>4?ne.setAttribute("data-total",me-4):ne.removeAttribute("data-total")}},ye=function(ne){H.innerHTML||o.appendSnippet({}),H.children[0].appendChild(ne),ge()};o.appendSnippet=function(ne){H.innerHTML="";for(var me=["image","title","description","host","url"],Ce=0;Ce<me.length;Ce++){var Oe=document.createElement("div");if(Oe.className="jsnippet-"+me[Ce],Oe.setAttribute("data-k",me[Ce]),H.appendChild(Oe),ne[me[Ce]])if(me[Ce]=="image"){Array.isArray(ne.image)||(ne.image=[ne.image]);for(var rt=0;rt<ne.image.length;rt++){var Xe=document.createElement("img");Xe.src=ne.image[rt],Oe.appendChild(Xe)}}else Oe.innerHTML=ne[me[Ce]]}o.editor.appendChild(document.createElement("br")),o.editor.appendChild(H)},o.setData=function(ne){typeof ne=="object"?o.editor.innerHTML=ne.content:o.editor.innerHTML=ne,o.options.focus&&v.setCursor(o.editor,!0),V=[]},o.getFiles=function(){for(var ne=o.editor.querySelectorAll(".jfile"),me=[],Ce=0;Ce<ne.length;Ce++)V[ne[Ce].src]&&me.push(V[ne[Ce].src]);return me},o.getText=function(){return o.editor.innerText},o.getData=function(ne){if(ne){var me={content:""};if(H.innerHTML){var Ce=0;me.snippet={};for(var Oe=0;Oe<H.children.length;Oe++){var rt=H.children[Oe].getAttribute("data-k");if(rt)if(rt=="image"){me.snippet.image||(me.snippet.image=[]);for(var Xe=0;Xe<H.children[Oe].children.length;Xe++)me.snippet.image.push(H.children[Oe].children[Xe].getAttribute("src"))}else me.snippet[rt]=H.children[Oe].innerHTML}}var Ze=Object.keys(V);if(Ze.length){me.files=[];for(var Oe=0;Oe<Ze.length;Oe++)me.files.push(V[Ze[Oe]])}var et=document.createElement("div");et.innerHTML=o.editor.innerHTML;var Ue=et.querySelector(".jsnippet");Ue&&Ue.remove();var st=et.innerHTML;st=st.replace(/<br>/g,`
`),st=st.replace(/<\/div>/g,`</div>
`),st=st.replace(/<(?:.|\n)*?>/gm,""),me.content=st.trim(),Be("getData",me)}else var me=o.editor.innerHTML;return me},o.reset=function(){o.editor.innerHTML="",H.innerHTML="",V=[]},o.addPdf=function(ne){if(ne.result.substr(0,4)!="data")console.error("Invalid source");else{var me=document.createElement("canvas");me.width=60,me.height=60;var Ce=new Image,Oe=me.getContext("2d");Oe.drawImage(Ce,0,0,me.width,me.height),me.toBlob(function(rt){var Xe=document.createElement("img");Xe.src=window.URL.createObjectURL(rt),Xe.title=ne.name,Xe.className="jfile pdf",V[Xe.src]={file:Xe.src,extension:"pdf",content:ne.result},document.execCommand("insertHtml",!1,Xe.outerHTML)})}},o.addImage=function(ne,me){if(ne||(ne=""),ne.substr(0,4)!="data"&&!o.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(ne.substr(0,4)=="data"){var Ce=ne.split(";");Ce=Ce[0].split("/"),Ce=Ce[1]}else{var Ce=ne.substr(ne.lastIndexOf(".")+1);ne=o.options.remoteParser+ne}var Oe=new Image;Oe.onload=function(){var Xe=document.createElement("canvas");Xe.width=Oe.width,Xe.height=Oe.height;var Ze=Xe.getContext("2d");Ze.drawImage(Oe,0,0,Xe.width,Xe.height),Xe.toBlob(function(et){var Ue=document.createElement("img");Ue.src=window.URL.createObjectURL(et),Ue.classList.add("jfile"),Ue.setAttribute("tabindex","900"),Ue.setAttribute("width",Oe.width),Ue.setAttribute("height",Oe.height),V[Ue.src]={file:Ue.src,extension:Ce,content:Xe.toDataURL()},o.options.dropAsSnippet||me?(ye(Ue),V[Ue.src].snippet=!0):document.execCommand("insertHtml",!1,Ue.outerHTML),je()})},Oe.src=ne}},o.addFile=function(ne){for(var me=[],Ce=0;Ce<ne.length;Ce++)if(ne[Ce].size>o.options.maxFileSize)alert("The file is too big");else{var Oe=ne[Ce].type.split("/");Oe[0]=="image"?Oe=1:Oe[1]=="pdf"?Oe=2:Oe=0,Oe?(me[Ce]=new FileReader,me[Ce].index=Ce,me[Ce].type=Oe,me[Ce].name=ne[Ce].name,me[Ce].date=ne[Ce].lastModified,me[Ce].size=ne[Ce].size,me[Ce].addEventListener("load",function(rt){rt.target.type==2?o.options.acceptFiles==!0&&o.addPdf(rt.target):o.addImage(rt.target.result)},!1),me[Ce].readAsDataURL(ne[Ce])):alert("The extension is not allowed")}},o.destroy=function(){o.editor.removeEventListener("mouseup",Me),o.editor.removeEventListener("mousedown",Ne),o.editor.removeEventListener("mousemove",Ie),o.editor.removeEventListener("keyup",Q),o.editor.removeEventListener("keydown",ve),o.editor.removeEventListener("dragstart",re),o.editor.removeEventListener("dragenter",A),o.editor.removeEventListener("dragover",F),o.editor.removeEventListener("drop",ee),o.editor.removeEventListener("paste",X),o.editor.removeEventListener("blur",pe),o.editor.removeEventListener("focus",ce),C.editor=null,C.classList.remove("jeditor-container"),J.remove(),H.remove(),o.editor.remove()},o.upload=function(){P.click(o.file)};var ke=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],We=["width","height","align","border","src","tabindex"],Qe=["color","font-weight","font-size","background","background-color","margin"],fe=function(ne){if(ne.attributes&&ne.attributes.length){var me=null,Ce=null,Oe=ne.getAttribute("style");if(Oe){Ce=[];for(var rt=Oe.split(";"),Xe=0;Xe<rt.length;Xe++){var Ze=rt[Xe].trim().split(":");if(Qe.indexOf(Ze[0].trim())>=0){var et=Ze.shift(),Ze=Ze.join(":");Ce.push(et+":"+Ze)}}}ne.tagName.toUpperCase()=="IMG"&&(!o.options.acceptImages||!ne.src?ne.parentNode.removeChild(ne):(ne.setAttribute("tabindex","900"),o.addImage(ne.src)));for(var Ue=[],st=0;st<ne.attributes.length;st++)Ue.push(ne.attributes[st].name);Ue.length&&Ue.forEach(function(xt){We.indexOf(xt)==-1?ne.removeAttribute(xt):ne.attributes[st].value.indexOf("<")!==-1&&ne.attributes[st].value.replace("<","&#60;")}),ne.style="",Ce&&Ce.length&&ne.setAttribute("style",Ce.join(";"))}if(ne.children.length)for(var st=0;st<ne.children.length;st++)fe(ne.children[st]);ke.indexOf(ne.constructor)>=0&&ne.remove()},Ee=function(ne){var me=window.getSelection(),Ce=document.createRange();Ce.selectNode(ne),me.addRange(Ce)},K=function(ne){ne&&(ne=ne.replace(new RegExp("<!--(.*?)-->","gsi"),""));var me=new DOMParser,Ce=me.parseFromString(ne,"text/html");fe(Ce);var Oe=document.createElement("span");return Oe.innerHTML=Ce.firstChild.innerHTML,Oe},X=function(ne){if(o.options.filterPaste==!0){if(ne.clipboardData||ne.originalEvent.clipboardData)var me=(ne.originalEvent||ne).clipboardData.getData("text/html"),Ce=(ne.originalEvent||ne).clipboardData.getData("text/plain"),Oe=(ne.originalEvent||ne).clipboardData.files;else if(window.clipboardData)var me=window.clipboardData.getData("Html"),Ce=window.clipboardData.getData("Text"),Oe=window.clipboardData.files;if(Oe.length)o.addFile(Oe);else if(!me)me=Ce.split(`\r
`),ne.target.innerText?(me=me.map(function(Xe){return"<div>"+Xe+"</div>"}),document.execCommand("insertHtml",!1,me.join(""))):me.map(function(Xe){var Ze=document.createElement("div");Ze.innerText=Xe,o.editor.appendChild(Ze)});else{var rt=K(me);document.execCommand("insertHtml",!1,rt.innerHTML)}ne.preventDefault()}},re=function(ne){z&&z.e&&ne.preventDefault()},A=function(ne){z||o.options.dropZone==!1||(C.classList.add("jeditor-dragging"),ne.preventDefault())},F=function(ne){z||o.options.dropZone==!1||(G&&clearTimeout(G),G=setTimeout(function(){C.classList.remove("jeditor-dragging")},100),ne.preventDefault())},ee=function(ne){if(!(z||o.options.dropZone==!1)){var me=null;document.caretRangeFromPoint?me=document.caretRangeFromPoint(ne.clientX,ne.clientY):ne.rangeParent&&(me=document.createRange(),me.setStart(ne.rangeParent,ne.rangeOffset));var Ce=window.getSelection();Ce.removeAllRanges(),Ce.addRange(me),Ce.anchorNode.parentNode.focus();var Oe=(ne.originalEvent||ne).dataTransfer.getData("text/html"),rt=(ne.originalEvent||ne).dataTransfer.getData("text/plain"),Xe=(ne.originalEvent||ne).dataTransfer.files;Xe.length?o.addFile(Xe):rt&&ue(Oe),C.classList.remove("jeditor-dragging"),ne.preventDefault()}},pe=function(ne){Be("onevent",ne),je(ne),typeof o.options.onblur=="function"&&o.options.onblur(C,o,ne)},ce=function(ne){typeof o.options.onfocus=="function"&&o.options.onfocus(C,o,ne)},Q=function(ne){o.editor.innerHTML||(o.editor.innerHTML="<div><br></div>"),typeof o.options.onkeyup=="function"&&o.options.onkeyup(C,o,ne)},ve=function(ne){if(Be("onevent",ne),ne.key=="Delete"&&ne.target.tagName=="IMG"){var me=ne.target.parentNode;Ee(ne.target),me.classList.contains("jsnippet-image")&&ge()}typeof o.options.onkeydown=="function"&&o.options.onkeydown(C,o,ne)},Me=function(ne){if(z&&z.e&&(z.e.classList.remove("resizing"),z.e.changed==!0)){var me=z.e.cloneNode();me.width=parseInt(z.e.style.width)||z.e.getAttribute("width"),me.height=parseInt(z.e.style.height)||z.e.getAttribute("height"),z.e.style.width="",z.e.style.height="",Ee(z.e),document.execCommand("insertHtml",!1,me.outerHTML)}z=!1},Ne=function(ne){var me=function(Xe){var Ze=Xe.getBoundingClientRect();Ze.width-(ne.clientX-Ze.left)<40&&ne.clientY-Ze.top<40&&(Xe.innerHTML="",Xe.remove())};if(ne.target.tagName=="IMG")if(ne.target.style.cursor){var Ce=ne.target.getBoundingClientRect();z={e:ne.target,x:ne.clientX,y:ne.clientY,w:Ce.width,h:Ce.height,d:ne.target.style.cursor},ne.target.getAttribute("width")||ne.target.setAttribute("width",Ce.width),ne.target.getAttribute("height")||ne.target.setAttribute("height",Ce.height);var Oe=window.getSelection();if(Oe.rangeCount)for(var rt=0;rt<Oe.rangeCount;rt++)Oe.removeRange(Oe.getRangeAt(rt));ne.target.classList.add("resizing")}else z=!0;else ne.target.classList.contains("jsnippet")?me(ne.target):ne.target.parentNode.classList.contains("jsnippet")&&me(ne.target.parentNode),z=!0},Ie=function(ne){if(ne.target.tagName=="IMG"&&!ne.target.parentNode.classList.contains("jsnippet-image")&&o.options.allowImageResize==!0&&ne.target.getAttribute("tabindex")){var me=ne.target.getBoundingClientRect();ne.clientY-me.top<5?me.width-(ne.clientX-me.left)<5?ne.target.style.cursor="ne-resize":ne.clientX-me.left<5?ne.target.style.cursor="nw-resize":ne.target.style.cursor="n-resize":me.height-(ne.clientY-me.top)<5?me.width-(ne.clientX-me.left)<5?ne.target.style.cursor="se-resize":ne.clientX-me.left<5?ne.target.style.cursor="sw-resize":ne.target.style.cursor="s-resize":me.width-(ne.clientX-me.left)<5?ne.target.style.cursor="e-resize":ne.clientX-me.left<5?ne.target.style.cursor="w-resize":ne.target.style.cursor=""}if(ne.which==1&&z&&z.d){if(z.d=="e-resize"||z.d=="ne-resize"||z.d=="se-resize")if(z.e.style.width=z.w+(ne.clientX-z.x),ne.shiftKey){var Ce=(ne.clientX-z.x)*(z.h/z.w);z.e.style.height=z.h+Ce}else var Ce=null;Ce||(z.d=="s-resize"||z.d=="se-resize"||z.d=="sw-resize")&&(ne.shiftKey||(z.e.style.height=z.h+(ne.clientY-z.y))),z.e.changed=!0}},Be=function(ne,me){if(o.options.extensions){var Ce=Object.keys(o.options.extensions);if(Ce.length)for(var Oe=0;Oe<Ce.length;Oe++)o.options.extensions[Ce[Oe]]&&typeof o.options.extensions[Ce[Oe]][ne]=="function"&&o.options.extensions[Ce[Oe]][ne].call(o,me)}},$e=function(){if(o.options.extensions){var ne=Object.keys(o.options.extensions);if(ne.length)for(var me=0;me<ne.length;me++)o.options.extensions[ne[me]]&&typeof o.options.extensions[ne[me]]=="function"&&(o.options.extensions[ne[me]]=o.options.extensions[ne[me]](C,o))}};if(document.addEventListener("mouseup",Me),document.addEventListener("mousemove",Ie),o.editor.addEventListener("mousedown",Ne),o.editor.addEventListener("keyup",Q),o.editor.addEventListener("keydown",ve),o.editor.addEventListener("dragstart",re),o.editor.addEventListener("dragenter",A),o.editor.addEventListener("dragover",F),o.editor.addEventListener("drop",ee),o.editor.addEventListener("paste",X),o.editor.addEventListener("focus",ce),o.editor.addEventListener("blur",pe),C.appendChild(o.editor),o.options.snippet&&o.appendSnippet(o.options.snippet),o.options.toolbar){if(Array.isArray(o.options.toolbar))var nt={container:!0,responsive:!0,items:o.options.toolbar};else if(o.options.toolbar===!0)var nt={container:!0,responsive:!0,items:[]};else var nt=o.options.toolbar;nt.items&&nt.items.length||(nt.items=v.getDefaultToolbar(o)),o.options.toolbarOnTop?(C.classList.add("toolbar-on-top"),C.insertBefore(J,C.firstChild)):(o.editor.style.padding="15px",C.appendChild(J)),Ve(J,nt),J.addEventListener("click",function(){o.editor.focus()})}return o.file=document.createElement("input"),o.file.style.display="none",o.file.type="file",o.file.setAttribute("accept","image/*"),o.file.onchange=function(){o.addFile(this.files)},C.appendChild(o.file),o.options.focus&&v.setCursor(o.editor,o.options.focus=="initial"),C.change=o.setData,C.val=function(ne){if(ne===void 0){var me=C.getAttribute("data-html")!=="true";return o.getData(me)}else o.setData(ne)},$e(),C.editor=o,typeof o.options.onload=="function"&&o.options.onload(C,o,o.editor),o};return v.setCursor=function(C,l){C.focus(),document.execCommand("selectAll");var o=window.getSelection(),S=o.getRangeAt(0);if(l==!0)var q=S.startContainer,G=0;else var q=S.endContainer,G=q.length;S.setStart(q,G),S.setEnd(q,G),o.removeAllRanges(),o.addRange(S)},v.getDefaultToolbar=function(C){var l=function(S,q,G){if(!G.color){var z=null,V=he(G,{onchange:function(H,J){G.k==="color"?document.execCommand("foreColor",!1,J):document.execCommand("backColor",!1,J)}});G.color.open()}},o=[];return o.push({content:"undo",onclick:function(){document.execCommand("undo")}}),o.push({content:"redo",onclick:function(){document.execCommand("redo")}}),o.push({type:"divisor"}),C.options.toolbarOnTop&&(o.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(S){return'<span style="font-family:'+S+'">'+S+"</span>"},onchange:function(S,q,G,z,V){document.execCommand("fontName",!1,z)}}),o.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(S){return'<span style="font-size:'+S+'">'+S+"</span>"},onchange:function(S,q,G,z,V){document.execCommand("fontSize",!1,parseInt(V)+1)}}),o.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(S){return'<i class="material-icons">'+S+"</i>"},onchange:function(S,q,G,z,V){var H=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(H[V])}}),o.push({type:"divisor"}),o.push({content:"format_color_text",k:"color",onclick:l}),o.push({content:"format_color_fill",k:"background-color",onclick:l})),o.push({content:"format_bold",onclick:function(S,q,G){document.execCommand("bold"),document.queryCommandState("bold")?G.classList.add("selected"):G.classList.remove("selected")}}),o.push({content:"format_italic",onclick:function(S,q,G){document.execCommand("italic"),document.queryCommandState("italic")?G.classList.add("selected"):G.classList.remove("selected")}}),o.push({content:"format_underline",onclick:function(S,q,G){document.execCommand("underline"),document.queryCommandState("underline")?G.classList.add("selected"):G.classList.remove("selected")}}),o.push({type:"divisor"}),o.push({content:"format_list_bulleted",onclick:function(S,q,G){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?G.classList.add("selected"):G.classList.remove("selected")}}),o.push({content:"format_list_numbered",onclick:function(S,q,G){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?G.classList.add("selected"):G.classList.remove("selected")}}),o.push({content:"format_indent_increase",onclick:function(S,q,G){document.execCommand("indent",!0,null),document.queryCommandState("indent")?G.classList.add("selected"):G.classList.remove("selected")}}),o.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),C.options.toolbarOnTop&&(o.push({type:"divisor"}),o.push({content:"photo",onclick:function(){C.upload()}}),o.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(S,q){q&&(q.onmouseover=this.onmouseover,S=S.split("x"),q.setAttribute("data-x",S[0]),q.setAttribute("data-y",S[1]));var G=document.createElement("div");return q.style.margin="1px",q.style.border="1px solid #ddd",G},onmouseover:function(S){for(var q=parseInt(S.target.getAttribute("data-x")),G=parseInt(S.target.getAttribute("data-y")),z=0;z<S.target.parentNode.children.length;z++){var V=S.target.parentNode.children[z],H=parseInt(V.getAttribute("data-x")),J=parseInt(V.getAttribute("data-y"));H<=q&&J<=G?(V.style.backgroundColor="#cae1fc",V.style.borderColor="#2977ff"):(V.style.backgroundColor="",V.style.borderColor="#ddd")}},onchange:function(S,q,G){G=G.split("x");for(var z=document.createElement("table"),V=document.createElement("tbody"),H=0;H<=G[1];H++){for(var J=document.createElement("tr"),oe=0;oe<=G[0];oe++){var je=document.createElement("td");je.innerHTML="",J.appendChild(je)}V.appendChild(J)}z.appendChild(V),z.setAttribute("width","100%"),z.setAttribute("cellpadding","6"),z.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,z.outerHTML)}})),o},v}var Ye=Ge();function He(){var v=function(C,l){var o={};o.options={};var S={type:"big",title:"Untitled",width:510,height:472};for(var q in S)l&&l.hasOwnProperty(q)?o.options[q]=l[q]:o.options[q]=S[q];var G=function(){for(var H=document.createElement("div");C.children[0];)H.appendChild(C.children[0]);for(o.content=document.createElement("div"),o.content.className="jfloating_content",o.content.innerHTML=C.innerHTML;H.children[0];)o.content.appendChild(H.children[0]);o.container=document.createElement("div"),o.container.className="jfloating",o.container.appendChild(o.content),o.options.title?o.container.setAttribute("title",o.options.title):o.container.classList.add("no-title"),o.options.width&&(o.container.style.width=parseInt(o.options.width)+"px"),o.options.height&&(o.container.style.height=parseInt(o.options.height)+"px"),C.innerHTML="",C.appendChild(o.container)},z=function(){o.container&&o.container.addEventListener("click",function(H){var J=H.target.getBoundingClientRect();if(H.target.classList.contains("jfloating")){if(H.changedTouches&&H.changedTouches[0])var oe=H.changedTouches[0].clientX,je=H.changedTouches[0].clientY;else var oe=H.clientX,je=H.clientY;J.width-(oe-J.left)<50&&je-J.top<50?setTimeout(function(){o.close()},100):o.setState()}})},V=function(){o.container.classList.add("jfloating-"+o.options.type)};return o.state={isMinized:!1},o.setState=function(){o.state.isMinized?o.container.classList.remove("jfloating-minimized"):o.container.classList.add("jfloating-minimized"),o.state.isMinized=!o.state.isMinized},o.close=function(){Components.elements.splice(v.elements.indexOf(o.container),1),o.updatePosition(),C.remove()},o.updatePosition=function(){for(var H=0;H<v.elements.length;H++){var J=v.elements[H],oe=v.elements[H-1];J.style.right=H*(oe?oe.offsetWidth:J.offsetWidth)*1.01+"px"}},o.init=function(){G(),z(),V(),v.elements.push(o.container),o.updatePosition(),C.floating=o},o.init(),o};return v.elements=[],v}var lt=He();function U(){var v=function(q){return!isNaN(q)&&q!==null&&q!==""},C={between:function(q,G){return q>=G[0]&&q<=G[1]},"not between":function(q,G){return q<G[0]||q>G[1]},"<":function(q,G){return q<G[0]},"<=":function(q,G){return q<=G[0]},">":function(q,G){return q>G[0]},">=":function(q,G){return q>=G[0]},"=":function(q,G){return q==G[0]},"!=":function(q,G){return q!=G[0]}},l={"valid date":function(){return!0},"=":function(q,G){return q===G[0]},"<":function(q,G){return q<G[0]},"<=":function(q,G){return q<=G[0]},">":function(q,G){return q>G[0]},">=":function(q,G){return q>=G[0]},between:function(q,G){return q>=G[0]&&q<=G[1]},"not between":function(q,G){return q<G[0]||q>G[1]}},o={contains:function(q,G){return q.includes(G[0])},"not contains":function(q,G){return!q.includes(G[0])},"begins with":function(q,G){return q.startsWith(G[0])},"ends with":function(q,G){return q.endsWith(G[0])},"=":function(q,G){return q===G[0]},"valid email":function(q){var G=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return G.test(q)},"valid url":function(q){var G=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return G.test(q)}},S=function(q,G){return typeof S[G.type]=="function"?G.allowBlank&&q===""?!0:S[G.type](q,G):null};return S.url=function(){var q=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!q.test(data)},S.email=function(q){var G=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(q&&G.test(q))},S.required=function(q){return!!q.trim()},S.exist=function(q,G){return!!q.toString()},S["not exist"]=function(q,G){return!q.toString()},S.empty=function(q){return!q.toString()},S.notEmpty=function(q){return!!q.toString()},S.number=function(q,G){if(!v(q))return!1;if(!G||!G.criteria)return!0;if(!C[G.criteria])return!1;var z=G.value.map(function(V){return parseFloat(V)});return C[G.criteria](q,z)},S.login=function(q){var G=new RegExp(/^[a-zA-Z0-9\_\-\.\s+]+$/);return!!(q&&G.test(q))},S.list=function(q,G){var z=typeof q;if(z!=="string"&&z!=="number")return!1;if(typeof G.value[0]=="string")var V=G.value[0].split(",");else var V=G.value[0];var H=V.findIndex(function(oe){return oe==q});return H>-1},S.date=function(q,G){if(new Date(q)=="Invalid Date")return!1;if(!G||!G.criteria)return!0;if(!l[G.criteria])return!1;var z=G.value.map(function(V){return new Date(V).getTime()});return l[G.criteria](new Date(q).getTime(),z)},S.text=function(q,G){return typeof q!="string"?!1:!G||!G.criteria?!0:o[G.criteria]?o[G.criteria](q,G.value):!1},S.textLength=function(q,G){return q=q.toString(),S.number(q.length,G)},S}var Le=U();function qe(){var v=function(C,l){var o={};o.options={};var S={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(V,H){alert(H)}};for(var q in S)l&&l.hasOwnProperty(q)?o.options[q]=l[q]:o.options[q]=S[q];o.options.validations||(o.options.validations={}),o.options.submitButton||(o.options.submitButton=C.querySelector("input[type=submit]")),o.options.submitButton&&o.options.url&&(o.options.submitButton.onclick=function(){o.save()}),o.options.validations.email||(o.options.validations.email=Le.email),o.options.validations.length||(o.options.validations.length=Le.length),o.options.validations.required||(o.options.validations.required=Le.required),o.setUrl=function(V){o.options.url=V},o.load=function(){w({url:o.options.url,method:"GET",dataType:"json",queue:!0,success:function(V){if(typeof o.options.onbeforeload=="function"){var H=o.options.onbeforeload(C,V);H&&(V=H)}v.setElements(C,V),typeof o.options.onload=="function"&&o.options.onload(C,V)}})},o.save=function(){var V=o.validate();if(V)o.options.onerror(C,V);else{var H=v.getElements(C,!0);if(typeof o.options.onbeforesave=="function"){var H=o.options.onbeforesave(C,H);if(H===!1)return}w({url:o.options.url,method:"POST",dataType:"json",data:H,success:function(J){typeof o.options.onsave=="function"&&o.options.onsave(C,H,J)}})}},o.remove=function(){if(typeof o.options.onbeforeremove=="function"){var V=o.options.onbeforeremove(C,o);if(V===!1)return!1}w({url:o.options.url,method:"DELETE",dataType:"json",success:function(H){typeof o.options.onremove=="function"&&o.options.onremove(C,o,H),o.reset()}})};var G=function(V){V.classList.add("error"),o.options.submitButton&&o.options.submitButton.setAttribute("disabled",!0);var H=V.getAttribute("data-error")||"There is an error in the form";return V.setAttribute("title",H),H},z=function(V){var H=!1;V.classList.remove("error"),V.removeAttribute("title");for(var J=C.querySelectorAll("input, select, textarea, div[name]"),oe=0;oe<J.length;oe++)J[oe].getAttribute("data-validation")&&J[oe].classList.contains("error")&&(H=!0);o.options.submitButton&&(H?o.options.submitButton.setAttribute("disabled",!0):o.options.submitButton.removeAttribute("disabled"))};return o.validateElement=function(V){var H=!1,J=v.getValue(V),oe=V.getAttribute("data-validation");return typeof o.options.validations[oe]=="function"&&!o.options.validations[oe](J,V)?H=G(V):V.classList.contains("error")&&z(V),H},o.reset=function(){for(var V=null,H=C.querySelectorAll("input, select, textarea, div[name]"),J=0;J<H.length;J++)(V=H[J].getAttribute("name"))&&(H[J].type=="checkbox"||H[J].type=="radio"?H[J].checked=!1:typeof H[J].val=="function"?H[J].val(""):H[J].value="")},o.validate=function(){for(var V=[],H=C.querySelectorAll("input, select, textarea, div[name]"),J=0;J<H.length;J++)if(H[J].getAttribute("data-validation")){var oe=o.validateElement(H[J]);oe&&V.push(oe)}return V.length>0?V.join("<br>"):!1},o.getError=function(){return!!o.validation()},o.setHash=function(){return o.getHash(v.getElements(C))},o.getHash=function(V){var H=0,J,oe;if(V.length===0)return H;for(J=0;J<V.length;J++)oe=V.charCodeAt(J),H=(H<<5)-H+oe,H|=0;return H},o.isChanged=function(){var V=o.setHash();return o.options.currentHash!=V},o.resetTracker=function(){o.options.currentHash=o.setHash(),o.options.ignore=!1},o.setIgnore=function(V){o.options.ignore=!!V},setTimeout(function(){o.options.currentHash=o.setHash()},1e3),C.addEventListener("keyup",function(V){V.target.getAttribute("data-validation")&&o.validateElement(V.target)}),v.hasEvents||(window.addEventListener("beforeunload",function(V){if(o.isChanged()&&o.options.ignore==!1){var H=o.options.message?o.options.message:"o/";return H?(typeof V=="undefined"&&(V=window.event),V&&(V.returnValue=H),H):void 0}}),v.hasEvents=!0),C.form=o,o};return v.getValue=function(C){var l=null;if(C.type=="checkbox")C.checked==!0&&(l=C.value||!0);else if(C.type=="radio")C.checked==!0&&(l=C.value);else if(C.type=="file")l=C.files;else if(C.tagName=="select"&&C.multiple==!0){l=[];for(var o=C.querySelectorAll("options[selected]"),S=0;S<o.length;S++)l.push(o[S].value)}else typeof C.val=="function"?l=C.val():l=C.value||"";return l},v.getElements=function(C,l){for(var o={},S=null,q=C.querySelectorAll("input, select, textarea, div[name]"),G=0;G<q.length;G++)(S=q[G].getAttribute("name"))&&(o[S]=v.getValue(q[G])||"");return l==!0?o:JSON.stringify(o)},v.setElements=function(C,l){for(var o=null,S=null,q=C.querySelectorAll("input, select, textarea, div[name]"),G=0;G<q.length;G++){var z=q[G].getAttribute("type");if(o=q[G].getAttribute("name")){if(o=o.replace(new RegExp(/\[(.*?)\]/ig),".$1"),S=null,o.match(/\./)){var V=u.call(l,o)||"";typeof V!="undefined"&&(S=V)}else typeof l[o]!="undefined"&&(S=l[o]);S!==null&&(z=="checkbox"||z=="radio"?q[G].checked=!!S:z=="file"||(typeof q[G].val=="function"?q[G].val(S):q[G].value=S))}}},v}var De=qe();function Te(){var v=function(){var l=null,o=function(z){if(z.which==27)for(var V=document.querySelectorAll(".jmodal"),H=0;H<V.length;H++)V[H].parentNode.modal.close()},S=function(z){var V=P.findElement(z.target,"jmodal");if(V){var H=V.getBoundingClientRect();if(z.changedTouches&&z.changedTouches[0])var J=z.changedTouches[0].clientX,oe=z.changedTouches[0].clientY;else var J=z.clientX,oe=z.clientY;H.width-(J-H.left)<50&&oe-H.top<50&&V.parentNode.modal.close()}l&&(l.element.style.cursor="auto",l=null)},q=function(z){var V=P.findElement(z.target,"jmodal");if(V){var H=V.getBoundingClientRect();if(z.changedTouches&&z.changedTouches[0])var J=z.changedTouches[0].clientX,oe=z.changedTouches[0].clientY;else var J=z.clientX,oe=z.clientY;H.width-(J-H.left)<50&&oe-H.top<50||oe-H.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),l={left:H.left,top:H.top,x:z.clientX,y:z.clientY,width:H.width,height:H.height,element:V})}},G=function(z){if(l){if(z=z||window.event,z.buttons)var V=z.buttons;else if(z.button)var V=z.button;else var V=z.which;V?(l.element.style.top=l.top+(z.clientY-l.y)+l.height/2+"px",l.element.style.left=l.left+(z.clientX-l.x)+l.width/2+"px",l.element.style.cursor="move"):l.element.style.cursor="auto"}};document.addEventListener("keydown",o),document.addEventListener("mouseup",S),document.addEventListener("mousedown",q),document.addEventListener("mousemove",G)},C=function(l,o){var S={};S.options={};var q={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var G in q)o&&o.hasOwnProperty(G)?S.options[G]=o[G]:S.options[G]=q[G];!S.options.title&&l.getAttribute("title")&&(S.options.title=l.getAttribute("title"));for(var z=document.createElement("div");l.children[0];)z.appendChild(l.children[0]);for(S.title=document.createElement("div"),S.title.className="jmodal_title",S.options.icon&&S.title.setAttribute("data-icon",S.options.icon),S.content=document.createElement("div"),S.content.className="jmodal_content",S.content.innerHTML=l.innerHTML;z.children[0];)S.content.appendChild(z.children[0]);if(S.container=document.createElement("div"),S.container.className="jmodal",S.container.appendChild(S.title),S.container.appendChild(S.content),S.options.padding&&(S.content.style.padding=S.options.padding),S.options.width&&(S.container.style.width=S.options.width),S.options.height&&(S.container.style.height=S.options.height),S.options.title){var V=document.createElement("h4");V.innerText=S.options.title,S.title.appendChild(V)}if(l.innerHTML="",l.style.display="none",l.appendChild(S.container),S.options.backdrop){var H=document.createElement("div");H.className="jmodal_backdrop",H.onclick=function(){S.close()},l.appendChild(H)}return S.open=function(){l.style.display="block";var J=S.container.getBoundingClientRect();P.getWindowWidth()<J.width?(S.container.style.top="",S.container.style.left="",S.container.classList.add("jmodal_fullscreen"),T.slideBottom(S.container,1)):S.options.backdrop&&(H.style.display="block"),typeof S.options.onopen=="function"&&S.options.onopen(l,S)},S.resetPosition=function(){S.container.style.top="",S.container.style.left=""},S.isOpen=function(){return l.style.display!="none"},S.close=function(){S.isOpen()&&(l.style.display="none",S.options.backdrop&&(H.style.display=""),S.container.classList.remove("jmodal_fullscreen"),typeof S.options.onclose=="function"&&S.options.onclose(l,S))},S.options.url?w({url:S.options.url,method:"GET",dataType:"text/html",success:function(J){S.content.innerHTML=J,S.options.closed||S.open(),typeof S.options.onload=="function"&&S.options.onload(S)}}):(S.options.closed||S.open(),typeof S.options.onload=="function"&&S.options.onload(S)),l.modal=S,v(),v=function(){},S};return C}var Fe=Te();function _e(){var v=function(C){var l={};l.options={};var o={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var S in o)C&&C.hasOwnProperty(S)?l.options[S]=C[S]:l.options[S]=o[S];var q=document.createElement("div");q.className="jnotification",l.options.error&&q.classList.add("jnotification-error");var G=document.createElement("div");G.className="jnotification-container",q.appendChild(G);var z=document.createElement("div");z.className="jnotification-header",G.appendChild(z);var V=document.createElement("div");if(V.className="jnotification-image",z.appendChild(V),l.options.icon){var H=document.createElement("img");H.src=l.options.icon,V.appendChild(H)}var J=document.createElement("div");if(J.className="jnotification-name",J.innerHTML=l.options.name,z.appendChild(J),l.options.closeable==!0){var oe=document.createElement("div");oe.className="jnotification-close",oe.onclick=function(){l.hide()},z.appendChild(oe)}var je=document.createElement("div");je.className="jnotification-date",z.appendChild(je);var ue=document.createElement("div");if(ue.className="jnotification-content",G.appendChild(ue),l.options.title){var te=document.createElement("div");te.className="jnotification-title",te.innerHTML=l.options.title,ue.appendChild(te)}var ge=document.createElement("div");if(ge.className="jnotification-message",ge.innerHTML=l.options.message,ue.appendChild(ge),l.show=function(){document.body.appendChild(q),P.getWindowWidth()>800?T.fadeIn(q):T.slideTop(q,1)},l.hide=function(){P.getWindowWidth()>800?T.fadeOut(q,function(){q.parentNode&&(q.parentNode.removeChild(q),ye&&clearTimeout(ye))}):T.slideTop(q,0,function(){q.parentNode&&(q.parentNode.removeChild(q),ye&&clearTimeout(ye))})},l.show(),l.options.autoHide==!0)var ye=setTimeout(function(){l.hide()},l.options.timeout);return P.getWindowWidth()<800&&q.addEventListener("swipeup",function(ke){l.hide(),ke.preventDefault(),ke.stopPropagation()}),l};return v.isVisible=function(){var C=document.querySelector(".jnotification");return!!(C&&C.parentNode)},v}var Ke=_e();function Je(v,C){var l={};l.options={};var o={value:0,onchange:null,width:null};for(var S in o)C&&C.hasOwnProperty(S)?l.options[S]=C[S]:l.options[S]=o[S];v.classList.add("jprogressbar"),v.setAttribute("tabindex",1),v.setAttribute("data-value",l.options.value);var q=document.createElement("div");q.style.width=l.options.value+"%",q.style.color="#fff",v.appendChild(q),l.options.width&&(v.style.width=l.options.width),l.setValue=function(z){z=parseInt(z),l.options.value=z,q.style.width=z+"%",v.setAttribute("data-value",z+"%"),z<6?v.style.color="#000":v.style.color="#fff",l.options.value=z,typeof l.options.onchange=="function"&&l.options.onchange(v,z),v.value!=l.options.value&&(v.value=l.options.value,typeof v.oninput=="function"&&v.oninput({type:"input",target:v,value:v.value}))},l.getValue=function(){return l.options.value};var G=function(z){if(z.which){var V=v.getBoundingClientRect();if(z.changedTouches&&z.changedTouches[0])var H=z.changedTouches[0].clientX,J=z.changedTouches[0].clientY;else var H=z.clientX,J=z.clientY;l.setValue(Math.round((H-V.left)/V.width*100))}};return"touchstart"in document.documentElement?(v.addEventListener("touchstart",G),v.addEventListener("touchend",G)):(v.addEventListener("mousedown",G),v.addEventListener("mousemove",G)),v.change=l.setValue,v.val=function(z){if(z===void 0)return l.getValue();l.setValue(z)},v.progressbar=l,l}function ut(v,C){if(v.rating)return v.rating.setOptions(C,!0);var l={};l.options={},l.setOptions=function(S,q){var G={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var z in G)S&&S.hasOwnProperty(z)?l.options[z]=S[z]:(typeof l.options[z]=="undefined"||q===!0)&&(l.options[z]=G[z]);v.innerHTML="";for(var V=0;V<l.options.number;V++){var H=document.createElement("div");H.setAttribute("data-index",V+1),H.setAttribute("title",l.options.tooltip[V]),v.appendChild(H)}if(l.options.value)for(var V=0;V<l.options.number;V++)V<l.options.value&&v.children[V].classList.add("jrating-selected");return l},l.setValue=function(S){for(var q=0;q<l.options.number;q++)q<S?v.children[q].classList.add("jrating-selected"):(v.children[q].classList.remove("jrating-over"),v.children[q].classList.remove("jrating-selected"));l.options.value=S,typeof l.options.onchange=="function"&&l.options.onchange(v,S),v.value!=l.options.value&&(v.value=l.options.value,typeof v.oninput=="function"&&v.oninput({type:"input",target:v,value:v.value}))},l.getValue=function(){return l.options.value};var o=function(){l.setOptions(C),v.classList.add("jrating"),v.addEventListener("click",function(S){var q=S.target.getAttribute("data-index");q!=null&&(q==l.options.value?l.setValue(0):l.setValue(q))}),v.addEventListener("mouseover",function(S){for(var q=S.target.getAttribute("data-index"),G=0;G<l.options.number;G++)G<q?v.children[G].classList.add("jrating-over"):v.children[G].classList.remove("jrating-over")}),v.addEventListener("mouseout",function(S){for(var q=0;q<l.options.number;q++)v.children[q].classList.remove("jrating-over")}),v.change=l.setValue,v.val=function(S){if(S===void 0)return l.getValue();l.setValue(S)},v.rating=l};return o(),l}function ft(v,C){if(v.search)return v.search;var l=null,o=function(H){if(H.target.classList.contains("jsearch_item"))var J=H.target;else var J=H.target.parentNode;z.selectIndex(J),H.preventDefault()},S=function(H){if(typeof z.options.onsearch=="function"){var J=z.options.onsearch(z,H);J&&(H=J)}if(V.innerHTML="",!H.length)v.style.display="";else{v.style.display="block";for(var oe=H.length<11?H.length:10,je=0;je<oe;je++){if(typeof H[je]=="string")var ue=H[je],te=H[je];else{var ue=H[je].text;!ue&&H[je].name&&(ue=H[je].name);var te=H[je].value;!te&&H[je].id&&(te=H[je].id)}var ge=document.createElement("div");ge.setAttribute("data-value",te),ge.setAttribute("data-text",ue),ge.className="jsearch_item",H[je].id&&ge.setAttribute("id",H[je].id),z.options.forceSelect&&je==0&&ge.classList.add("selected");var ye=document.createElement("img");H[je].image?ye.src=H[je].image:ye.style.display="none",ge.appendChild(ye);var ke=document.createElement("div");ke.innerHTML=ue,ge.appendChild(ke),V.appendChild(ge)}}},q=function(H){if(H!=z.terms)if(z.terms=H,z.options.forceSelect?l=0:l=null,Array.isArray(z.options.data)){var J=function(je){if(typeof je=="string"){if((""+je).toLowerCase().search(H.toLowerCase())>=0)return!0}else for(var ue in je){var te=je[ue];if((""+te).toLowerCase().search(H.toLowerCase())>=0)return!0}return!1},oe=z.options.data.filter(function(je){return J(je)});S(oe)}else w({url:z.options.data+H,method:"GET",dataType:"json",success:function(je){S(je)}})},G=null,z=function(H){G&&clearTimeout(G),G=setTimeout(function(){q(H)},500)};C.forceSelect===null&&(C.forceSelect=!0),z.options={data:C.data||null,input:C.input||null,searchByNode:C.searchByNode||null,onselect:C.onselect||null,forceSelect:C.forceSelect,onsearch:C.onsearch||null,onbeforesearch:C.onbeforesearch||null},z.selectIndex=function(H){var J=H.getAttribute("id"),oe=H.getAttribute("data-text"),je=H.getAttribute("data-value"),ue=H.children[0].src||"";typeof z.options.onselect=="function"&&z.options.onselect(z,oe,je,J,ue),z.close()},z.open=function(){v.style.display="block"},z.close=function(){G&&clearTimeout(G),z.terms="",V.innerHTML="",v.style.display=""},z.isOpened=function(){return!!v.style.display},z.keydown=function(H){z.isOpened()&&(H.key=="Enter"?l!==null&&V.children[l]?(z.selectIndex(V.children[l]),H.preventDefault()):z.close():H.key==="ArrowUp"?(l!==null&&V.children[0]&&(V.children[l].classList.remove("selected"),!z.options.forceSelect&&l===0?l=null:(l=Math.max(0,l-1),V.children[l].classList.add("selected"))),H.preventDefault()):H.key==="ArrowDown"&&(l==null?l=-1:V.children[l].classList.remove("selected"),l<9&&V.children[l+1]&&l++,V.children[l].classList.add("selected"),H.preventDefault()))},z.keyup=function(H){if(!z.options.searchByNode&&z.options.input)if(z.options.input.tagName==="DIV")var J=z.options.input.innerText;else var J=z.options.input.value;else{var oe=P.getNode();if(oe)var J=oe.innerText}if(typeof z.options.onbeforesearch=="function"){var je=z.options.onbeforesearch(z,J);if(je)J=je;else if(je===!1)return}z(J)},z.blur=function(H){z.close()},z.options.input&&(z.options.input.addEventListener("keyup",z.keyup),z.options.input.addEventListener("keydown",z.keydown),z.options.input.addEventListener("blur",z.blur));var V=document.createElement("div");return V.classList.add("jsearch_container"),V.onmousedown=o,v.appendChild(V),v.classList.add("jsearch"),v.search=z,z}function ct(v,C){var l={};if(l.options={},l.currentImage=null,C&&(l.options=C),v.setAttribute("tabindex","900"),l.options.items=[],!v.classList.contains("jslider")){if(v.classList.add("jslider"),v.classList.add("unselectable"),l.options.height&&(v.style.minHeight=parseInt(l.options.height)+"px"),l.options.width&&(v.style.width=parseInt(l.options.width)+"px"),l.options.grid){v.classList.add("jslider-grid");var o=v.children.length;o>4&&v.setAttribute("data-total",o-4),v.setAttribute("data-number",o>4?4:o)}var S=document.createElement("div");if(S.classList.add("jslider-counter"),v.children.length>0)for(var q=0;q<v.children.length;q++){l.options.items.push(v.children[q]);var G=document.createElement("div");G.onclick=function(){var oe=Array.prototype.slice.call(S.children).indexOf(this);l.show(l.currentImage=l.options.items[oe])},S.appendChild(G)}var z=document.createElement("div");z.className="jslider-caption";var V=document.createElement("div"),H=document.createElement("div");H.className="jslider-close",H.innerHTML="",H.onclick=function(){l.close()},V.appendChild(z),V.appendChild(H)}l.updateCounter=function(oe){for(var je=0;je<S.children.length;je++)if(S.children[je].classList.contains("jslider-counter-focus")){S.children[je].classList.remove("jslider-counter-focus");break}S.children[oe].classList.add("jslider-counter-focus")},l.show=function(oe){if(!oe)var oe=v.children[0];v.classList.add("jslider-focus"),v.classList.remove("jslider-grid"),v.appendChild(V),v.appendChild(S);var je=l.options.items.indexOf(oe);l.updateCounter(je);for(var ue=0;ue<v.children.length;ue++)v.children[ue].style.display="";oe.style.display="block",oe.previousElementSibling?v.classList.add("jslider-left"):v.classList.remove("jslider-left"),oe.nextElementSibling&&oe.nextElementSibling.tagName=="IMG"?v.classList.add("jslider-right"):v.classList.remove("jslider-right"),l.currentImage=oe,l.currentImage.offsetHeight>l.currentImage.offsetWidth&&l.currentImage.classList.add("jslider-vertical"),V.children[0].innerText=l.currentImage.getAttribute("title")},l.open=function(){l.show(),typeof l.options.onopen=="function"&&l.options.onopen(v)},l.close=function(){v.classList.remove("jslider-focus"),v.classList.remove("jslider-left"),v.classList.remove("jslider-right"),l.options.grid&&v.classList.add("jslider-grid");for(var oe=0;oe<v.children.length;oe++)v.children[oe].style.display="";S.remove(),V.remove(),l.currentImage=null,typeof l.options.onclose=="function"&&l.options.onclose(v)},l.reset=function(){v.innerHTML=""},l.next=function(){var oe=l.currentImage.nextElementSibling;oe&&oe.tagName==="IMG"&&l.show(l.currentImage.nextElementSibling)},l.prev=function(){l.currentImage.previousElementSibling&&l.show(l.currentImage.previousElementSibling)};var J=function(oe){if(oe.target.tagName=="IMG")l.show(oe.target);else if(!oe.target.classList.contains("jslider-close")&&!(oe.target.parentNode.classList.contains("jslider-counter")||oe.target.classList.contains("jslider-counter"))){var je=oe.offsetX||oe.changedTouches[0].clientX;oe.target.clientWidth-je<40?l.next():je<40&&l.prev()}};return"ontouchend"in document.documentElement?v.addEventListener("touchend",J):v.addEventListener("mouseup",J),v.addEventListener("swipeleft",function(oe){l.next(),oe.preventDefault(),oe.stopPropagation()}),v.addEventListener("swiperight",function(oe){l.prev(),oe.preventDefault(),oe.stopPropagation()}),v.addEventListener("keydown",function(oe){oe.which==27&&l.close()}),v.slider=l,l}function ht(v,C){if(v.tags)return v.tags.setOptions(C,!0);var l={type:"tags"};l.options={};var o=function(){return!!(l.options.limit&&v.children.length>=l.options.limit)},S=null,q=null;l.setOptions=function(fe,Ee){var K={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var X in K)fe&&fe.hasOwnProperty(X)?l.options[X]=fe[X]:(typeof l.options[X]=="undefined"||Ee===!0)&&(l.options[X]=K[X]);return l.options.placeholder?v.setAttribute("data-placeholder",l.options.placeholder):v.removeAttribute("data-placeholder"),v.placeholder=l.options.placeholder,l.setValue(l.options.value),H(),l.options.search?q||(q=document.createElement("div"),v.parentNode.insertBefore(q,v.nextSibling),S=ft(q,{data:l.options.search,onselect:function(re,A,F){l.selectIndex(A,F)}})):q&&(S=null,q.remove(),q=null),l},l.add=function(fe,Ee){if(typeof l.options.onbeforechange=="function"){var K=l.options.onbeforechange(v,l,l.options.value,fe);if(K===!1)return!1;K!=null&&(fe=K)}if(S&&S.close(),o())typeof l.options.onlimit=="function"?l.options.onlimit(l,l.options.limit):alert(B.translate("You reach the limit number of entries")+" "+l.options.limit);else{var X=P.getNode();if(X&&X.parentNode&&X.parentNode.classList.contains("jtags")&&X.nextSibling&&!(X.nextSibling.innerText&&X.nextSibling.innerText.trim()))re=X.nextSibling;else{if(v.lastChild&&(v.lastChild.innerText.trim()||v.removeChild(v.lastChild)),!fe||typeof fe=="string")var re=z(fe,fe,X);else for(var A=0;A<=fe.length;A++)if(!o()){if(!fe[A]||typeof fe[A]=="string")var F=fe[A]||"",ee=null;else var F=fe[A].text,ee=fe[A].value;var re=z(F,ee)}V()}Ee&&G(re)}},l.setLimit=function(fe){l.options.limit=fe;for(var Ee=v.children.length-fe;v.children.length>fe;)v.removeChild(v.lastChild)},l.remove=function(fe){fe.parentNode.removeChild(fe),v.children.length?V():l.add("",!0)},l.getData=function(){for(var fe=[],Ee=0;Ee<v.children.length;Ee++){var K=v.children[Ee].innerText.replace(`
`,""),X=v.children[Ee].getAttribute("data-value");X||(X=K),(K||X)&&fe.push({text:K,value:X})}return fe},l.getValue=function(fe){var Ee=null;if(fe!=null)Ee=v.children[fe].getAttribute("data-value"),Ee||(Ee=v.children[fe].innerText.replace(`
`,""));else{for(var K=[],X=0;X<v.children.length;X++)Ee=v.children[X].innerText.replace(`
`,""),Ee&&K.push(l.getValue(X));Ee=K.join(",")}return Ee},l.setValue=function(fe){if(!fe)l.reset();else if(v.value!=fe)if(Array.isArray(fe))l.add(fe);else{var Ee=(""+fe).trim(),K=oe(Ee);v.innerHTML="",l.add(K)}},l.reset=function(){v.classList.add("jtags-empty"),v.innerHTML="<div></div>",V()},l.isValid=function(){for(var fe=0,Ee=0;Ee<v.children.length;Ee++)v.children[Ee].classList.contains("jtags_error")&&fe++;return fe==0},l.selectIndex=function(fe,Ee){var K=P.getNode();K&&(K.innerText=fe,Ee&&K.setAttribute("data-value",Ee),K.classList.remove("jtags_error"),o()||l.add("",!0))},l.search=function(fe){var Ee=fe.innerText},l.destroy=function(){v.removeEventListener("mouseup",ye),v.removeEventListener("keydown",ue),v.removeEventListener("keyup",te),v.removeEventListener("paste",ge),v.removeEventListener("focus",ke),v.removeEventListener("blur",We),v.parentNode.removeChild(v)};var G=function(fe){if(v.children.length){var Ee=document.createRange(),K=window.getSelection();if(!fe)var fe=v.childNodes[v.childNodes.length-1];Ee.setStart(fe,fe.length),Ee.collapse(!0),K.removeAllRanges(),K.addRange(Ee),v.scrollLeft=v.scrollWidth}},z=function(fe,Ee,K){var X=document.createElement("div");return X.innerHTML=fe||"",Ee&&X.setAttribute("data-value",Ee),K&&K.parentNode.classList.contains("jtags")?v.insertBefore(X,K.nextSibling):v.appendChild(X),X},V=function(){var fe=l.getValue();fe!=l.options.value&&(l.options.value=fe,typeof l.options.onchange=="function"&&l.options.onchange(v,l,l.options.value),v.value!=l.options.value&&(v.value=l.options.value,typeof v.oninput=="function"&&v.oninput({type:"input",target:v,value:v.value}))),H()},H=function(){for(var fe=0;fe<v.children.length;fe++)v.children[fe].tagName==="DIV"&&(l.getValue(fe)?(v.children[fe].classList.add("jtags_label"),typeof l.options.validation=="function"&&l.getValue(fe)?l.options.validation(v.children[fe],v.children[fe].innerText,v.children[fe].getAttribute("data-value"))?v.children[fe].classList.remove("jtags_error"):v.children[fe].classList.add("jtags_error"):v.children[fe].classList.remove("jtags_error")):v.children[fe].classList.remove("jtags_label"));J()},J=function(){v.innerText.trim()?v.classList.remove("jtags-empty"):(!v.children.length||v.children[0].tagName==="BR")&&(v.innerHTML="",G(z()))},oe=function(fe){var Ee=[],K="";if(fe=fe.trim(),fe){for(var X=0;X<fe.length;X++)fe[X]==","||fe[X]==";"||fe[X]==`
`?K&&(Ee.push(K.trim()),K=""):K+=fe[X];K&&Ee.push(K)}return Ee},je=0,ue=function(fe){if(je=window.getSelection().anchorOffset,J(),fe.key==="Tab"||fe.key===";"||fe.key===","){var Ee=window.getSelection().anchorOffset;Ee>1&&(o()?typeof l.options.onlimit=="function"&&l.options.onlimit(l,l.options.limit):l.add("",!0)),fe.preventDefault()}else if(fe.key=="Enter"){if(!S||!S.isOpened()){var Ee=window.getSelection().anchorOffset;Ee>1&&(o()||l.add("",!0)),fe.preventDefault()}}else fe.key=="Backspace"&&v.children.length==1&&window.getSelection().anchorOffset<1&&fe.preventDefault();S&&S.keydown(fe),J()},te=function(fe){if(fe.which==39){var Ee=window.getSelection().anchorOffset;Ee>1&&Ee==je&&l.add("",!0)}else fe.which==13||fe.which==38||fe.which==40?fe.preventDefault():S&&S.keyup(fe);H()},ge=function(fe){if(fe.clipboardData||fe.originalEvent.clipboardData)var Ee=(fe.originalEvent||fe).clipboardData.getData("text/plain");else if(window.clipboardData)var Ee=window.clipboardData.getData("Text");var K=oe(Ee);if(typeof l.options.onbeforepaste=="function"){var X=l.options.onbeforepaste(v,l,K);if(X===!1)return fe.preventDefault(),!1;X&&(K=X)}K.length>1?(l.add(K,!0),fe.preventDefault()):K[0]&&(document.execCommand("insertText",!1,K[0]),fe.preventDefault())},ye=function(fe){if(fe.target.parentNode&&fe.target.parentNode.classList.contains("jtags")&&(fe.target.classList.contains("jtags_label")||fe.target.classList.contains("jtags_error"))){var Ee=fe.target.getBoundingClientRect();Ee.width-(fe.clientX-Ee.left)<16&&l.remove(fe.target)}fe.target==v&&G()},ke=function(){v.classList.contains("jtags-focus")||((!v.children.length||l.getValue(v.children.length-1))&&(o()||z("")),typeof l.options.onfocus=="function"&&l.options.onfocus(v,l,l.getValue()),v.classList.add("jtags-focus"))},We=function(){if(v.classList.contains("jtags-focus")){S&&S.close();for(var fe=0;fe<v.children.length-1;fe++)l.getValue(fe)||v.removeChild(v.children[fe]);V(),v.classList.remove("jtags-focus"),typeof l.options.onblur=="function"&&l.options.onblur(v,l,l.getValue())}},Qe=function(){"touchend"in document.documentElement?v.addEventListener("touchend",ye):v.addEventListener("mouseup",ye),v.addEventListener("keydown",ue),v.addEventListener("keyup",te),v.addEventListener("paste",ge),v.addEventListener("focus",ke),v.addEventListener("blur",We),v.setAttribute("contenteditable",!0),v.classList.add("jtags"),l.setOptions(C),typeof l.options.onload=="function"&&l.options.onload(v,l),v.change=l.setValue,v.val=function(fe){if(fe===void 0)return l.getValue();l.setValue(fe)},v.tags=l};return Qe(),l}function vt(v,C){var l={};l.options={};var o={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var S in o)C&&C.hasOwnProperty(S)?l.options[S]=C[S]:l.options[S]=o[S];l.options.multiple==!0&&v.setAttribute("data-multiple",!0),v.content=[],v.classList.add("jupload"),l.options.input==!0&&v.classList.add("input"),l.add=function(H){if(l.options.multiple==!1&&(v.content=[],v.innerText=""),l.options.type=="image"){var J=document.createElement("img");J.setAttribute("src",H.file),J.setAttribute("tabindex",-1),v.getAttribute("name")||(J.className="jfile",J.content=H),v.appendChild(J)}else{if(H.name)var oe=H.name;else var oe=H.file;var je=document.createElement("div");je.innerText=oe||l.options.type,je.classList.add("jupload-item"),je.setAttribute("tabindex",-1),v.appendChild(je)}H.content&&(H.file=P.guid()),v.content.push(H),typeof l.options.onchange=="function"&&l.options.onchange(v,H)},l.addFromFile=function(H){var J=H.type.split("/");if(J[0]==l.options.type){var oe=new FileReader;oe.addEventListener("load",function(je){var ue={file:je.srcElement.result,extension:H.name.substr(H.name.lastIndexOf(".")+1),name:H.name,size:H.size,lastmodified:H.lastModified,content:je.srcElement.result};l.add(ue)}),oe.readAsDataURL(H)}else alert(B.translate("This extension is not allowed"))},l.addFromUrl=function(H){if(H.substr(0,4)!="data"&&!l.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(H.substr(0,4)=="data"){var J=H.split(";");J=J[0].split("/");var oe=J[0].replace("data:","");if(oe==l.options.type){var je={file:H,name:"",extension:J[1],content:H};l.add(je)}else alert(l.options.text.extensionNotAllowed)}else{var J=H.substr(H.lastIndexOf(".")+1);H=l.options.remoteParser+H,w({url:H,type:"GET",dataType:"blob",success:function(te){}})}};var q=function(H,J){for(var oe=.92,je=null,ue=H.toDataURL(J,oe);l.options.maxJpegSizeBytes&&J==="image/jpeg"&&ue.length>l.options.maxJpegSizeBytes&&ue.length!==je;)oe*=.9,je=ue.length,ue=H.toDataURL(J,oe);return ue},G=l.options.type+"/"+l.options.extension,z=document.createElement("input");z.type="file",z.setAttribute("accept",G),z.onchange=function(){for(var H=0;H<this.files.length;H++)l.addFromFile(this.files[H])},l.options.multiple==!0&&z.setAttribute("multiple",!0);var V=null;return v.addEventListener("click",function(H){V=null,!v.children.length||H.target===v?P.click(z):H.target.parentNode==v&&(V=H.target)}),v.addEventListener("dblclick",function(H){P.click(z)}),v.addEventListener("dragenter",function(H){v.style.border="1px dashed #000"}),v.addEventListener("dragleave",function(H){v.style.border="1px solid #eee"}),v.addEventListener("dragstop",function(H){v.style.border="1px solid #eee"}),v.addEventListener("dragover",function(H){H.preventDefault()}),v.addEventListener("keydown",function(H){if(V&&H.which==46){var J=Array.prototype.indexOf.call(v.children,V);J>=0&&(v.content.splice(J,1),V.remove(),V=null)}}),v.addEventListener("drop",function(H){H.preventDefault(),H.stopPropagation();var J=(H.originalEvent||H).dataTransfer.getData("text/html"),oe=(H.originalEvent||H).dataTransfer.files;if(oe.length)for(var je=0;je<H.dataTransfer.files.length;je++)l.addFromFile(H.dataTransfer.files[je]);else if(J){l.options.multiple==!1&&(v.innerText="");var ue=document.createElement("div");ue.innerHTML=J;var te=ue.querySelectorAll("img");if(te.length)for(var je=0;je<te.length;je++)l.addFromUrl(te[je].src)}return v.style.border="1px solid #eee",!1}),v.val=function(H){if(H===void 0)return v.content&&v.content.length?v.content:null;if(v.innerText="",v.content=[],H)if(Array.isArray(H))for(var J=0;J<H.length;J++)typeof H[J]=="string"?l.add({file:H[J]}):l.add(H[J]);else typeof H=="string"&&l.add({file:H})},v.upload=v.image=l,l}var gt=f(195),St=f.n(gt),mt=pn(Qt(Qt({version:"5.0.18",setExtensions:function(v){if(typeof v=="object")for(var C=Object.keys(v),l=0;l<C.length;l++)mt[C[l]]=v[C[l]]},tracking:g},B),P),{path:u,sorting:m,lazyLoading:b,ajax:w,animation:T,calendar:D,color:he,contextmenu:xe,dropdown:be,editor:Ye,floating:lt,form:De,mask:k,modal:Fe,notification:Ke,palette:Y,picker:ae,progressbar:Je,rating:ut,search:ft,slider:ct,tabs:se,tags:ht,toolbar:Ve,upload:vt,validations:Le});mt.image=vt,mt.image.create=function(v){var C=document.createElement("img");return C.setAttribute("src",v.file),C.className="jfile",C.setAttribute("tabindex",-1),C.content=v,C},mt.tracker=De,mt.loading=T.loading,mt.sha512=St();var Tt=function(){document.jsuitesComponents=[];var v=function(te,ge){return te[ge.type]&&te[ge.type]==ge||te.component&&te.component==ge?!0:te.parentNode?v(te.parentNode,ge):!1},C=function(te){if(document.jsuitesComponents&&document.jsuitesComponents.length>0)for(var ge=0;ge<document.jsuitesComponents.length;ge++)document.jsuitesComponents[ge]&&!v(te,document.jsuitesComponents[ge])&&document.jsuitesComponents[ge].close()},l=15,o=null,S=!1,q={x:null,y:null},G=document.createElement("div");G.classList.add("jtooltip");var z=function(te){var ge=mt.findElement(te.target,"jpanel");if(ge&&!ge.classList.contains("readonly")){ge.focus();var ye=te.target.getBoundingClientRect();S={e:ge,x:te.clientX,y:te.clientY,w:ye.width,h:ye.height,d:ge.style.cursor,resizing:!!ge.style.cursor,actioned:!1},ge.style.width||(ge.style.width=ye.width+"px"),ge.style.height||(ge.style.height=ye.height+"px");var ke=window.getSelection();if(ke.rangeCount)for(var We=0;We<ke.rangeCount;We++)ke.removeRange(ke.getRangeAt(We));te.preventDefault(),te.stopPropagation()}else S=!1;if(te.changedTouches&&te.changedTouches[0])var Qe=te.changedTouches[0].clientX,fe=te.changedTouches[0].clientY;else var Qe=te.clientX,fe=te.clientY;var Ee=te.path||te.composedPath&&te.composedPath();if(Ee)o=Ee[0];else{if(te.target&&te.target.shadowRoot)var K=te.target.shadowRoot;else var K=document;o=K.elementFromPoint(Qe,fe)}C(o)},V=function(te){S&&S.e&&(typeof S.e.refresh=="function"&&q.actioned&&S.e.refresh(),S.e.style.cursor=""),q={x:null,y:null},S=!1},H=function(te){if(S){var ge=te.clientX||te.pageX,ye=te.clientY||te.pageY;if(S.resizing){var Ee=null,K=null;if(S.d=="e-resize"||S.d=="ne-resize"||S.d=="se-resize")if(Ee=S.w+(ge-S.x),S.e.style.width=Ee+"px",te.shiftKey){var X=(ge-S.x)*(S.h/S.w);K=S.h+X,S.e.style.height=K+"px"}else var X=!1;X||(S.d=="s-resize"||S.d=="se-resize"||S.d=="sw-resize")&&(K=S.h+(ye-S.y),S.e.style.height=K+"px"),typeof S.e.refresh=="function"&&(q.actioned=!0,S.e.refresh("dimensions",Ee,K))}else{q.x==null&&q.y==null&&(q.x=ge,q.y=ye);var ke=ge-q.x,We=ye-q.y,Qe=S.e.offsetTop+We,fe=S.e.offsetLeft+ke;S.e.style.top=Qe+"px",S.e.style.left=fe+"px",S.e.style.cursor="move",q.x=ge,q.y=ye,typeof S.e.refresh=="function"&&(q.actioned=!0,S.e.refresh("position",Qe,fe))}}else{var re=mt.findElement(te.target,"jpanel");if(re&&re.getAttribute("tabindex")){var A=re.getBoundingClientRect();te.clientY-A.top<l?A.width-(te.clientX-A.left)<l?re.style.cursor="ne-resize":te.clientX-A.left<l?re.style.cursor="nw-resize":re.style.cursor="n-resize":A.height-(te.clientY-A.top)<l?A.width-(te.clientX-A.left)<l?re.style.cursor="se-resize":te.clientX-A.left<l?re.style.cursor="sw-resize":re.style.cursor="s-resize":A.width-(te.clientX-A.left)<l?re.style.cursor="e-resize":te.clientX-A.left<l?re.style.cursor="w-resize":re.style.cursor=""}}},J=function(te){var ge=te.target.getAttribute("data-tooltip");if(ge){if(G.innerText=ge,te.changedTouches&&te.changedTouches[0])var ye=te.changedTouches[0].clientX,ke=te.changedTouches[0].clientY;else var ye=te.clientX,ke=te.clientY;G.style.top=ke+"px",G.style.left=ye+"px",document.body.appendChild(G)}else G.innerText&&(G.innerText="",document.body.removeChild(G))},oe=function(te){var ge=mt.findElement(te.target,"jpanel");ge&&typeof ge.dblclick=="function"&&ge.dblclick(te)},je=function(te){var ge=document.activeElement;if(ge&&typeof ge.contextmenu=="function")ge.contextmenu(te),te.preventDefault(),te.stopImmediatePropagation();else if(ge=mt.findElement(te.target,function(ke){return ke.tagName&&ke.getAttribute("aria-contextmenu-id")}),ge){var ye=document.querySelector("#"+ge);ye?(ye.contextmenu.open(te),te.preventDefault(),te.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+ge)}},ue=function(te){var ge=document.activeElement;ge&&te.key=="Delete"&&typeof ge.delete=="function"&&(ge.delete(),te.preventDefault(),te.stopImmediatePropagation()),document.jsuitesComponents&&document.jsuitesComponents.length&&(ge=document.jsuitesComponents[document.jsuitesComponents.length-1])&&te.key=="Escape"&&typeof ge.isOpened=="function"&&typeof ge.close=="function"&&ge.isOpened()&&(ge.close(),te.preventDefault(),te.stopImmediatePropagation())};document.addEventListener("mouseup",V),document.addEventListener("mousedown",z),document.addEventListener("mousemove",H),document.addEventListener("mouseover",J),document.addEventListener("dblclick",oe),document.addEventListener("keydown",ue),document.addEventListener("contextmenu",je)};typeof document!="undefined"&&!document.jsuitesComponents&&Tt();var Ft=mt}(),E=E.default,E}()})}}]);
