(self.webpackChunkInvocationlab_ERD_Online=self.webpackChunkInvocationlab_ERD_Online||[]).push([[7918],{52107:function(U,g){var l={UNKNOWN:0,KEYWORD:1,NUMBER:2,STRING:3,FUNCTION:4,VARIABLE:5,PARAMS:6,OPERATOR:7,COMMAS:8,MEMORY:9,COMMENT:99},D=function(d){for(var _=[],E=l.UNKNOWN,f="",v="",h="",p="",u=0;u<d.length;u++){if(v=d.charAt(u),v=="/"&&d.charAt(u+1)=="*"){for(f="",u++;++u<d.length;){if(h=d.charAt(u),p=d.charAt(u+1),h=="*"&&p=="/"){f=f.substr(0,f.length-1),u++;break}f===""?f+=h+p:f+=p}_[_.length]={text:f.replace(/^[\*\s]+/,"").replace(/[\s\*]+$/,""),type:l.COMMENT}}else if(v=="'"||v=='"'||v=="`"){for(f="";u<d.length&&v!=(h=d.charAt(++u));)f+=h=="\\"?d.charAt(++u):h;_[_.length]={text:f,type:v=="`"?l.VARIABLE:l.STRING}}else if(v==":"){for(f=v;u<d.length&&(h=d.charAt(++u),!!/^\w+$/i.test(h));)f+=h;u--,_[_.length]={text:f,type:l.PARAMS}}else if(/^[a-z_]+$/i.test(v)){for(f=v;u<d.length&&(h=d.charAt(++u),!!/^[\w\.:]+$/i.test(h));)f+=h;u--,_[_.length]={text:f,type:h=="("?l.FUNCTION:l.KEYWORD}}else if(v=="-"&&l.VARIABLE!=E||/\d+/.test(v)){for(f=v;u<d.length&&(h=d.charAt(++u),!!/^[\d\.]+$/.test(h));)f+=h;u--,f=="-"?_[_.length]={text:"-",type:l.OPERATOR}:_[_.length]={text:f-0,type:l.NUMBER}}else if(/^[\,;\(\)]+$/.test(v))_[_.length]={text:v,type:l.COMMAS};else if(/^(\+|\-|\*|\/|>|<|=|!)$/.test(v)){for(f=v;u<d.length&&(h=d.charAt(++u),!!/^(\+|\*|\/|>|<|=|!)+$/.test(h));)f+=h;u--,_[_.length]={text:f,type:l.OPERATOR}}E=_.length===0?E:_[_.length-1].type}return _},c=function(d){this.tokens=d instanceof Array?d:D(d.toString()),this.blocks=[];for(var _=0,E={"(":1,")":-1},f=0;f<this.tokens.length;++f){var v=this.tokens[f];v.type==l.COMMAS&&E[v.text]!==void 0?_+=E[v.text]:_||(this.blocks[this.blocks.length]=f)}};c.prototype.getAll=function(){return this.tokens},c.prototype.indexOf=function(T,v){var _=0,E=null;try{var f=new RegExp(T.text,"i")}catch(p){var f=T.text.toLowerCase()}for(var v=v==null?0:v+1,h=0;h<this.blocks.length;++h)if(_=this.blocks[h],!(_<v)&&(E=this.tokens[_],T.type==E.type&&(f instanceof RegExp&&f.test(E.text)||f==E.text.toLowerCase())))return this.blocks[h];return-1},g.vars=function(T,d,_){var E;if(_){var f=new c(d);d=f.getAll()}if(!d[T])return null;switch(d[T].type){case l.OPERATOR:E=[d[T-1],d[T+1]];break;case l.FUNCTION:E=[];for(var v=[],h=0,p=T+1,u=d.length;p<u;p++){var e=d[p];if(e.type!=l.COMMAS){v.push(e);continue}switch(e.text){case"(":h>0&&v.push(e),h++;break;case")":if(--h==0){E.push(v),v=[],p=u;break}else v.push(e);break;case",":h==1?(E.push(v),v=[]):v.push(e);break;default:break}}break;default:E=null;break}return E},g.text=function(T,d){var _=[];for(var E in T){var f=T[E];if(!f||!f.type||f.text==null)_.push(null);else switch(f.type){case l.STRING:_.push("'"+f.text+"'");break;case l.VARIABLE:_.push(f.text);break;default:_.push(f.text);break}d&&_.push(d)}return d&&_.pop(),_},g.types=l,g.create=function(T){return new c(T)}},95430:function(U,g,l){var D=l(52107),c=l(91459),T=l(93363);function d(r){for(var n=[],t=0,i=0,a=0;a<r.length;a++){var s=r[a].text;if(s==="("){t++;continue}if(s===")"){t--;continue}t===0&&/^UNION$/i.test(s)&&r[a].type===D.types.KEYWORD&&(n.push(c.removeParenthese(r.slice(i,a))),i=a+1)}return n.push(c.removeParenthese(r.slice(i))),n}function _(r){for(var n=[],t={},i=0,a=0,s=0;s<r.length;s++){var o=r[s].text,m=r[s].type;if(o==="("){a++;continue}if(o===")"){a--;continue}if(!(a!==0||m!==D.types.KEYWORD)){if(/^SELECT$/i.test(o)){if(t.column!==void 0)continue;n.push({keyword:"column",pos:s}),t.column=!0}else if(/^FROM$/i.test(o)){if(t.source!==void 0)continue;n.push({keyword:"source",pos:s}),t.source=!0}else if(/^(JOIN|INNER|OUTER|LEFT|RIGHT)$/i.test(o)){if(t.joinmap!==void 0)continue;n.push({keyword:"joinmap",pos:s}),t.joinmap=!0}else if(/^WHERE$/i.test(o)){if(t.where!==void 0)continue;n.push({keyword:"where",pos:s}),t.where=!0}else if(/^GROUP$/i.test(o)){if(t.groupby!==void 0)continue;n.push({keyword:"groupby",pos:s}),t.groupby=!0}else if(/^ORDER$/i.test(o)){if(t.orderby!==void 0)continue;n.push({keyword:"orderby",pos:s}),t.orderby=!0}else if(/^LIMIT$/i.test(o)){if(t.limit!==void 0)continue;n.push({keyword:"limit",pos:s}),t.limit=!0}}}for(var P={},s=1;s<n.length;s++)P[n[s-1].keyword]=r.slice(n[s-1].pos,n[s].pos);return P[n[n.length-1].keyword]=r.slice(n[n.length-1].pos),P}function E(r){var n={},t=c.pickUp(r,",");t[0].shift();for(var i=0;i<t.length;i++){var a=t[i],s=null;/^(distinct|all|distinctrow)$/i.test(a[0].text)&&(a[0].text=a[0].text.toUpperCase(),s=a[0],a.shift());var o,m;a[a.length-1].type===D.types.KEYWORD||a[a.length-1].type===D.types.VARIABLE?(m=a[a.length-1].text.indexOf("."))===-1?(o=a[a.length-1].text,a.length===1?n[o]={dist:s,expr:a}:/^as$/i.test(a[a.length-2].text)?n[o]={dist:s,expr:a.slice(0,a.length-2)}:n[o]={dist:s,expr:a.slice(0,a.length-1)}):(o=a[a.length-1].text.substr(m+1),n[o]={dist:s,expr:a}):(o=c.merge(a,""),n[o]={dist:s,expr:a})}return n}g.parseColumn=E;function f(r){var n={},t=c.pickUp(r,",");t[0].shift();for(var i=0;i<t.length;i++){var a=c.parseOneSource(t[i]);n[a.name]={type:a.type,source:a.source}}return n}g.parseSource=f;function v(r){for(var n={},t=c.pickUp(r,"JOIN"),i=void 0,a=0;a<t.length;a++){var s=t[a];if(s.length===1){i=s[0].text.toUpperCase();continue}var o=i===void 0?"INNER JOIN":i+" JOIN",m,P,y;i=/^(LEFT|RIGHT|OUTER|INNER)$/i.test(s[s.length-1].text)?s.pop().text:void 0;for(var O=void 0,R=0;R<s.length;R++)if(/^on$/i.test(s[R].text)){O=R;var M=s.slice(0,R),b=c.parseOneSource(M);y=b.name,m=b.type,P=b.source;break}if(O===void 0)throw new Error("no keyword 'on' in join part");var w=[],A=O+1;s.push({text:"and",type:1});for(var R=A;R<s.length;R++)if(/^and$/i.test(s[R].text)){var W=s.slice(A,R);w.push(c.parseOneWhere(W)),A=R+1}n[y]={type:m,source:P,method:c.JOIN[o.toUpperCase()],where:w}}return n}g.parseJoinmap=v;function h(r){var n=[],t=c.pickUp(r,"and");return t[0].shift(),t.forEach(function(i){n.push(c.parseOneWhere(i))}),n}g.parseWhere=h;function p(r){var n=[],t=c.pickUp(r,",");return t[0].shift(),t[0].shift(),t.forEach(function(i){n.push(i)}),n}g.parseGroupby=p;function u(r){var n=[],t=c.pickUp(r,",");t[0].shift(),t[0].shift();for(var i=0;i<t.length;i++){var a=t[i],s,o=a[a.length-1].text.toUpperCase();/^(ASC|DESC)$/i.test(o)?(s=c.ORDER[o],a.pop()):s=c.ORDER.ASC,a.length!==0&&n.push({type:s,expr:a})}return n}g.parseOrderby=u;function e(r){var n=[],t=c.pickUp(r,",");t[0].shift();for(var i=0;i<t.length;i++){var a=t[i];if(a.length>=2)throw new Error("something wrong in 'limit' part");n.push(a[0])}return n.length===1&&n.unshift({text:0,type:2}),n}g.parseLimit=e,g.createObj=function(r){for(var n=[],t=D.create(r).getAll(),i=d(t),a=0;a<i.length;a++){var s={},o=_(i[a]),m=c.getHint(o.column,1);m&&(s.hint=m),o.column&&(s.column=E(o.column)),o.source&&(s.source=f(o.source)),o.joinmap&&(s.joinmap=v(o.joinmap)),o.where&&(s.where=h(o.where)),o.groupby&&(s.groupby=p(o.groupby)),o.orderby&&(s.orderby=u(o.orderby)),o.limit&&(s.limit=e(o.limit)),n.push(s)}return n}},91459:function(U,g,l){var D=l(52107),c={"=":1,">":2,">=":3,"<":4,"<=":5,"<>":6,"!=":6,in:7,"not in":8,like:9,"not like":10,between:11,"is null":20,"not null":21};g.RELATE=c;var T={ASC:1,DESC:2};g.ORDER=T;var d={"INNER JOIN":1,"OUTER JOIN":2,"LEFT JOIN":3,"RIGHT JOIN":4};g.JOIN=d;function _(e){if(e[0]===void 0||e[0].text!=="(")return e;for(var r=0,n=0;n<e.length;n++)e[n].text==="("&&r++,e[n].text===")"&&r--;if(r===0&&e[e.length-1].text===")")return e.pop(),e.shift(),_(e);throw new Error("lack parenthese")}g.removeParenthese=_;function E(e,r){r=r===void 0?" ":r;for(var n="",t=0;t<e.length;t++)n+=e[t].text+r;return n.substr(0,n.length-r.length)}g.merge=E;function f(e,r){e.push({text:r});for(var n=[],t=0,i=0,a=0;a<e.length;a++)if(e[a].text==="("&&i++,e[a].text===")"&&i--,new RegExp("^"+r+"$","i").test(e[a].text)&&i===0){var s=e.slice(t,a);if(s.length===0){t=a+1;continue}n.push(s),t=a+1}return n}g.pickUp=f;function v(e,r){var n=void 0;if(e&&e[r]&&e[r].type===D.types.COMMENT){n=e[r];for(var t=e.slice(0,r),i=0;i<=r;i++)e.shift();for(;t.length>0;)e.unshift(t.pop())}return n}g.getHint=v;function h(e){var r,n,t,i,a=e[0].text.indexOf(".");if(n=e[0].text.substr(0,a),a===-1)if(e[0].text==="("){for(var s=1,o=1;o<e.length;o++)if(e[o].text==="("&&s++,e[o].text===")"&&s--,s===0){t=E(e.slice(1,o)," "),e=e.slice(o+1,e.length);break}}else t=e[0].text,e.shift();else if(a===e[0].text.length-1){if(e[1].text!=="(")throw new Error("something wrong in 'source' part");var s=0,o;for(o=1;o<e.length;o++)if(e[o].text==="("&&s++,e[o].text===")"&&s--,s===0){t=E(e.slice(2,o)," "),e=e.slice(o+1,e.length);break}if(o===e.length)throw new Error("lack parentheses in 'source' part")}else t=e[0].text.substr(a+1),e.shift();if(e.length===0)i={name:t,type:n,source:t};else{if(e.length>=3||e.length===2&&!/^as$/i.test(e[0].text)||e[e.length-1].type!==D.types.KEYWORD&&e[e.length-1].type!==D.types.VARIABLE)throw new Error("something wrong in 'source' part");i={name:e[e.length-1].text,type:n,source:t}}return i}g.parseOneSource=h;function p(e){var r={},n=e[1];if(r.column=e[0],!n)return r;if(n.type===D.types.OPERATOR){if(c[n.text]===void 0)throw new Error("unrecognized operator");r.relate=c[n.text],r.values=u(e.slice(2),",")}else if(n.text.toLowerCase()==="between")r.relate=c[n.text.toLowerCase()],r.values=u(e.slice(3,e.length-1),"and");else if(n.text.toLowerCase()==="in")r.relate=c[n.text.toLowerCase()],r.values=u(e.slice(3,e.length-1),",");else if(n.text.toLowerCase()==="like")r.relate=c[n.text.toLowerCase()],r.values=[[e[2]]];else if(n.text.toLowerCase()==="is")if(e[2].text.toLowerCase()==="not")r.relate=c["not null"],r.values=null;else if(e[2].text.toLowerCase()==="null")r.relate=c["is null"],r.values=null;else throw new Error('wrong key word after "is"');else if(n.text.toLowerCase()==="not")if(e[2].text.toLowerCase()==="in")r.relate=c["not in"],r.values=u(e.slice(4,e.length-1),",");else if(e[2].text.toLowerCase()==="like")r.relate=c["not like"],r.values=[[e[3]]];else throw new Error('wrong key word after "not"');else throw new Error("unrecognized relate");return r}g.parseOneWhere=p;function u(e,r){r=new RegExp(r,"i");var n=[],t=0,i=[];for(var a in e)r.test(e[a].text)?(n.push(i),i=[]):i.push(e[a]);return i.length!==0&&n.push(i),n}},33293:function(U,g,l){var D=l(91459),c=l(52107),T={select:l(95430)};g.parse=function(d){d=d.trim();var _=d.substr(0,d.indexOf(" ")).toLowerCase();if(T[_]===void 0)throw new Error("Unsupport sentence");return T[_].createObj(d)},g.RELATE=D.RELATE,g.JOIN=D.JOIN,g.ORDER=D.ORDER,g.types=c.types},46298:function(U,g,l){"use strict";l.d(g,{Z:function(){return a}});var D=l(9083),c=l.n(D),T=l(2927),d=l.n(T),_=l(98404),E=l(44761),f=l(86957),v=l(44925),h=l(50205),p=l(8236),u=l(58168),e=l(33293),r=l(36422),n=new Map,t=new Map,i=function(o){var m=o.selectDB,P=o.mode,y=o.height,O=o.width,R=o.name,M=o.placeholder,b=o.value,w=o.theme,A=o.onChange,W=o.tables,S=(0,_.useRef)(null),z=function(){var K=W||[];t.set(m,{});var x=K.map(function(C){var L={name:C.title,value:C.title,meta:C.chnname};return t.get(m)[C.title]=C.fields.map(function(I){return{name:I.name,value:I.name,meta:"".concat(I.chnname,"(").concat(C.title,")"),remarks:I.chnname,dataType:I.dataType,notNull:I.notNull,autoIncrement:I.autoIncrement,defaultValue:I.defaultValue,pk:I.pk}}),L});n.set(m,x)},$=function(K){var x=[];try{var C=e.parse(K),L=Object.entries(C[0].source);C[0].joinmap&&L.push.apply(L,d()(Object.entries(C[0].joinmap))),L.forEach(function(I){var j=c()(I,2),N=j[0],H=j[1],Z=H.source,G=t.get(m)[Z];G&&x.push.apply(x,d()(G)),N!==Z&&x.push({name:N,value:N,meta:Z})})}catch(I){}return x};return(0,_.useImperativeHandle)(o.onRef,function(){return{selectLine:function(){return S.current.editor.selection.selectLine()},getEditor:function(){return S.current.editor},getSelectValue:function(){return S.current.editor.getSelectedText()},setSelectValue:function(K){return S.current.editor.insert(K)},getDbTableFieldsMap:function(K){var x={},C=t.get(m)[K];if(!C)return x;for(var L=0;L<C.length;L++){var I=C[L];x[I.name]=I}return x}}}),n.get(m)||z(),(0,_.useEffect)(function(){(0,h.addCompleter)({getCompletions:function(K,x,C,L,I){var j=x.getTextRange({start:{row:C.row,column:0},end:{row:C.row,column:2e3}}).toLowerCase(),N=[];if(j.includes("select")&&j.includes("from")){N=$(j),I(null,n.get(m).concat(N));return}j=x.getTextRange({start:{row:0,column:0},end:{row:100,column:2e3}}),j=j.replace(/[\r\n]/g," ").replace(/\s{2,}/g," "),N=$(j),I(null,n.get(m).concat(N))}})},[]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(E.ZP,{ref:S,width:O||"100%",height:y||"250px",mode:P||"sql",theme:w||"xcode",placeholder:M||"",onChange:A,name:R||"ace-editor",value:b,editorProps:{$blockScrolling:!0},fontSize:"14px",showGutter:!0,highlightActiveLine:!0,showPrintMargin:!1,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,wrap:!1}})})},a=_.memo(i)},90338:function(U,g,l){"use strict";l.d(g,{I:function(){return T}});var D=l(98404),c=l(36422),T=function(_){var E=_.prefixCount,f=E===void 0?10:E,v=_.suffixCount,h=v===void 0?4:v,p=_.children,u=_.title,e=_.style,r=p.length;if(r<=f)return(0,c.jsx)("span",{title:u,style:e,children:p});var n=r-f;if(n<=3)return(0,c.jsx)("span",{title:u,style:e,children:p});n<h&&(h=n);var t=p.slice(0,f).trim(),i=p.slice(-h).trim();return(0,c.jsxs)("span",{title:u,style:e,children:[t,"...",i]})}},49573:function(U,g,l){"use strict";l.d(g,{$5:function(){return r},Hk:function(){return a},K:function(){return n},Ow:function(){return t},gs:function(){return e},wx:function(){return i}});var D=l(2927),c=l.n(D),T=l(39346),d=l.n(T),_=l(42525),E=l.n(_),f=l(23759),v=l(23041),h=l.n(v),p=l(36422),u=["onResize","width"],e=function(o){var m=document.createElement("textarea");m.style.position="absolute",m.style.left="-9999px",m.style.top="-9999px",document.body.appendChild(m),m.value=o,m.select(),document.execCommand("copy"),document.body.removeChild(m),f.ZP.success("\u590D\u5236\u6210\u529F")},r=function(o,m){var P="";return o!=="key"?m!=null&&m.pk?P="*"+o+"(\u4E3B\u952E)":m!=null&&m.notNull?P="*"+o:P=o:P=o+"(\u865A\u62DF\u5217\u8BF7\u52FF\u4FEE\u6539)",P},n=function(o){var m="";return o&&(o.pk?m="".concat(o.remarks," --- ")+(o.autoIncrement?"(\u81EA\u589E)":"(\u975E\u81EA\u589E)")+"("+o.dataType+")":m="".concat(o.remarks)+" --- ("+o.dataType+")"+(o.defaultValue?"(\u9ED8\u8BA4\u503C:".concat(o.defaultValue,")"):"")),m},t=function(o,m,P){var y,O=m[o];return O?y={name:O.name,value:O.name,remarks:O.remarks,dataType:O.typeName,notNull:O.isNullable==="NO",autoIncrement:O.isAutoincrement==="YES",defaultValue:O.def,pk:O.primaryKey}:y=P[o],y},i={header:{cell:function(o){var m=o.onResize,P=o.width,y=E()(o,u);return P===void 0?(0,p.jsx)("th",d()({},y)):(0,p.jsx)(v.Resizable,{width:P,height:0,onResize:m,children:(0,p.jsx)("th",d()({},y))})}}},a=function(o,m,P){var y={width:o.width,onResize:function(R,M){var b=M.size;P(function(w){var A=c()(w);return A[m]=d()(d()({},A[m]),{},{width:b.width}),A})}};return y}},34973:function(U,g,l){"use strict";l.d(g,{D7:function(){return p},HT:function(){return s},UC:function(){return m},a4:function(){return i},dm:function(){return n},fU:function(){return e}});var D=l(43953),c=l.n(D),T=l(39346),d=l.n(T),_=l(91184),E=l.n(_),f=l(68413);function v(y,O,R){return h.apply(this,arguments)}function h(){return h=_asyncToGenerator(_regeneratorRuntime().mark(function y(O,R,M){var b,w;return _regeneratorRuntime().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return M||(M={}),b=JSON.stringify(M)==="{}",w=[],b||Object.keys(M).map(function(S,z){var $=M[S];$==="ascend"&&w.push({column:S,asc:!0}),$==="descend"&&w.push({column:S,asc:!1})}),W.abrupt("return",request(O,{method:"GET",params:_objectSpread({size:R.pageSize,orders:w},R)}));case 5:case"end":return W.stop()}},y)})),h.apply(this,arguments)}function p(y,O){return u.apply(this,arguments)}function u(){return u=E()(c()().mark(function y(O,R){return c()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,f.ZP)(O,{method:"POST",data:d()({},R)}));case 1:case"end":return b.stop()}},y)})),u.apply(this,arguments)}function e(y,O){return r.apply(this,arguments)}function r(){return r=E()(c()().mark(function y(O,R){return c()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,f.ZP)(O,{method:"DELETE",data:d()({},R)}));case 1:case"end":return b.stop()}},y)})),r.apply(this,arguments)}function n(y,O){return t.apply(this,arguments)}function t(){return t=E()(c()().mark(function y(O,R){return c()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,f.ZP)(O,{method:"PUT",data:d()({},R)}));case 1:case"end":return b.stop()}},y)})),t.apply(this,arguments)}function i(y,O){return a.apply(this,arguments)}function a(){return a=E()(c()().mark(function y(O,R){return c()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,f.ZP)(O,{method:"POST",data:d()({},R)}));case 1:case"end":return b.stop()}},y)})),a.apply(this,arguments)}function s(y,O){return o.apply(this,arguments)}function o(){return o=E()(c()().mark(function y(O,R){return c()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,f.ZP)(O,{method:"GET",params:d()({},R)}));case 1:case"end":return b.stop()}},y)})),o.apply(this,arguments)}function m(y,O){return P.apply(this,arguments)}function P(){return P=E()(c()().mark(function y(O,R){return c()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,f.ZP)(O,{method:"GET",params:d()({},R)}));case 1:case"end":return b.stop()}},y)})),P.apply(this,arguments)}},85448:function(U,g,l){"use strict";var D=l(31777),c=l(34973),T=l(7599),d=l(29612),_=l(55074),E=l(44766),f=l.n(E),v=l(56918),h=l(23759),p=l(68413),u=(0,D.Z)(function(e,r){return{querySearchKey:"",treeData:[],dispatch:{queryHistory:function(t){return(0,c.HT)("/ncnb/queryHistory",t)},explain:function(t){return(0,c.a4)("/ncnb/queryInfo/explain",t)},exec:function(t){return(0,c.a4)("/ncnb/queryInfo/exec",t)},getTableRecordTotal:function(t){return(0,c.a4)("/ncnb/queryInfo/getTableRecordTotal",t)},exportSql:function(t,i){(0,p.Ht)(t,i,"/ncnb/queryInfo/exportSql")},updateSqlInfo:function(t){(0,c.dm)("/ncnb/queryInfo/"+t.id,t).then(function(i){if((i==null?void 0:i.code)===200){h.ZP.success(i==null?void 0:i.msg);return}})},renameQuery:function(t){(0,c.dm)("/ncnb/queryInfo/"+t.id,t).then(function(i){(i==null?void 0:i.code)===200&&(h.ZP.success("\u4FEE\u6539\u6210\u529F"),r().dispatch.fetchTreeData({projectId:t.projectId}))})},removeQuery:function(t){var i=d.rV(_.s.PROJECT_ID)||"";(0,c.fU)("/ncnb/queryInfo/"+i+"/"+t.id,{}).then(function(a){(a==null?void 0:a.code)===200&&(h.ZP.success("\u5220\u9664\u6210\u529F"),r().dispatch.fetchTreeData({projectId:i}))})},addQuery:function(t){(0,c.D7)("/ncnb/queryInfo",t).then(function(i){(i==null?void 0:i.code)===200&&(h.ZP.success("\u65B0\u589E\u6210\u529F"),r().dispatch.fetchTreeData({projectId:t.projectId}))})},fetchQueryInfo:function(t){return(0,c.HT)("/ncnb/queryInfo/"+t,{})},fetchTreeData:function(t){var i=r().querySearchKey;return i&&f().set(t,"title",i),new Promise(function(a,s){(0,c.UC)("/ncnb/queryInfo/tree",t).then(function(o){(o==null?void 0:o.code)===200?(e({treeData:(o==null?void 0:o.data)||[]}),a((o==null?void 0:o.data)||[])):s(o==null?void 0:o.code)})})},setQuerySearchKey:function(t){return e((0,T.ZP)(function(i){i.querySearchKey=t}))},onSelectNode:function(t,i){return e((0,T.ZP)(function(a){var s=v.ZP.getState().dispatch;i.node.isLeaf&&s.addTab({group:v.v0.QUERY,module:i.node.key+"",entity:i.node.title+""})}))}}}});g.Z=u},56918:function(U,g,l){"use strict";l.d(g,{v0:function(){return d}});var D=l(31777),c=l(7599),T=l(1993),d=function(v){return v[v.MODEL=0]="MODEL",v[v.QUERY=1]="QUERY",v}({}),_="",E="ERD-ONLINE-SQL-QUERY",f=(0,D.Z)(function(v,h){return{selectTabId:_,tableTabs:[],dispatch:{addTab:function(u){return v((0,c.ZP)(function(e){e.tableTabs.find(function(r){return(r==null?void 0:r.entity)===u.entity&&(r==null?void 0:r.module)===u.module})||e.tableTabs.push(u),e.selectTabId="".concat(u.module,"###").concat(u.entity)}))},activeTab:function(u){return v((0,c.ZP)(function(e){if(e.selectTabId="".concat(u.module,"###").concat(u.entity),u.group===d.MODEL){var r=T.ZP.getState().dispatch;r.setCurrentModule(u.module),r.setCurrentEntity(u.entity)}}))},removeTab:function(u){return v((0,c.ZP)(function(e){var r=e.tableTabs.findIndex(function(i){return(i==null?void 0:i.entity)===u.entity&&(i==null?void 0:i.module)===(u==null?void 0:u.module)});if(r>-1&&(e.tableTabs=e.tableTabs.filter(function(i,a){return a!==r}),h().selectTabId==="".concat(u==null?void 0:u.module,"###").concat(u==null?void 0:u.entity))){if(r===0)e.selectTabId=_;else if(r>0){var n=e.tableTabs[r-1];if(e.selectTabId="".concat(n==null?void 0:n.module,"###").concat(n==null?void 0:n.entity),u.group===d.MODEL){var t=T.ZP.getState().dispatch;t.setCurrentModule(n.module),t.setCurrentEntity(n.entity)}}}}))},removeLeftTab:function(u){return v((0,c.ZP)(function(e){var r=e.tableTabs.findIndex(function(n){return(n==null?void 0:n.entity)===u.entity&&(n==null?void 0:n.module)===(u==null?void 0:u.module)});r>-1&&(e.tableTabs=e.tableTabs.filter(function(n,t){return t>=r})),e.selectTabId="".concat(u.module,"###").concat(u.entity)}))},removeRightTab:function(u){return v((0,c.ZP)(function(e){var r=e.tableTabs.findIndex(function(n){return(n==null?void 0:n.entity)===u.entity&&(n==null?void 0:n.module)===(u==null?void 0:u.module)});r>-1&&(e.tableTabs=e.tableTabs.filter(function(n,t){return t<=r})),e.selectTabId="".concat(u.module,"###").concat(u.entity)}))},removeAllTab:function(u){return v((0,c.ZP)(function(e){e.tableTabs=[],e.selectTabId=_}))},containTab:function(u){return!!h().tableTabs.find(function(e){return e.entity===u})}}}});g.ZP=f}}]);
